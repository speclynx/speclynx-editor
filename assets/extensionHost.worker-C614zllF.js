var oo;(function(t){t[t["Uninitialized"]=0]="Uninitialized";t[t["Running"]=1]="Running";t[t["Completed"]=2]="Completed"})(oo||(oo={}));class $i{constructor(e){this.executor=e;this._state=oo.Uninitialized}get hasValue(){return this._state===oo.Completed}get value(){if(this._state===oo.Uninitialized){this._state=oo.Running;try{this._value=this.executor()}catch(e){this._error=e}finally{this._state=oo.Completed}}else if(this._state===oo.Running){throw new Error("Cannot read the value of a lazy that is being initialized")}if(this._error){throw this._error}return this._value}get rawValue(){return this._value}}let B5=class SW{constructor(){this.listeners=[];this.unexpectedErrorHandler=function(e){setTimeout(()=>{if(e.stack){if(lr.isErrorNoTelemetry(e)){throw new lr(e.message+"\n\n"+e.stack)}throw new Error(e.message+"\n\n"+e.stack)}throw e},0)}}addListener(e){this.listeners.push(e);return()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(i=>{i(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e);this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};const sf=new B5;function y1(t){sf.setUnexpectedErrorHandler(t)}function od(t){sf.onUnexpectedError(t);return void 0}function Ti(t){if(!Ls(t)){sf.onUnexpectedError(t)}return void 0}function S1(t){if(!Ls(t)){sf.onUnexpectedExternalError(t)}return void 0}function Rc(t){if(t instanceof Error){const{name:e,message:i,cause:n}=t;const s=t.stacktrace||t.stack;return{$isError:true,name:e,message:i,stack:s,noTelemetry:lr.isErrorNoTelemetry(t),cause:n?Rc(n):void 0,code:t.code}}return t}function LT(t){let e;if(t.noTelemetry){e=new lr}else{e=new Error;e.name=t.name}e.message=t.message;e.stack=t.stack;if(t.code){e.code=t.code}if(t.cause){e.cause=LT(t.cause)}return e}const Rp="Canceled";function Ls(t){if(t instanceof Vi){return true}return t instanceof Error&&t.name===Rp&&t.message===Rp}class Vi extends Error{constructor(){super(Rp);this.name=this.message}}class ac extends Error{static{this._name="PendingMigrationError"}static is(e){return e instanceof ac||e instanceof Error&&e.name===ac._name}constructor(e){super(e);this.name=ac._name}}function tE(){const t=new Error(Rp);t.name=t.message;return t}function Ge(t){if(t){return new Error(`Illegal argument: ${t}`)}else{return new Error("Illegal argument")}}function mS(t){if(t){return new Error(`Illegal state: ${t}`)}else{return new Error("Illegal state")}}class xa extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}}function iE(t){if(!t){return"Error"}if(t.message){return t.message}if(t.stack){return t.stack.split("\n")[0]}return String(t)}class W5 extends Error{constructor(e){super("NotImplemented");if(e){this.message=e}}}class x1 extends Error{constructor(e){super("NotSupported");if(e){this.message=e}}}class lr extends Error{constructor(e){super(e);this.name="CodeExpectedError"}static fromError(e){if(e instanceof lr){return e}const i=new lr;i.message=e.message;i.stack=e.stack;return i}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class li extends Error{constructor(e){super(e||"An unexpected bug occurred.");Object.setPrototypeOf(this,li.prototype)}}function mn(t,e,i=(n,s)=>n===s){if(t===e){return true}if(!t||!e){return false}if(t.length!==e.length){return false}for(let n=0,s=t.length;n<s;n++){if(!i(t[n],e[n])){return false}}return true}function V5(t,e){const i=[];let n=void 0;for(const s of t.slice(0).sort(e)){if(!n||e(n[0],s)!==0){n=[s];i.push(n)}else{n.push(s)}}return i}function NT(t,e,i){const n=[];function s(a,l,c){if(l===0&&c.length===0){return}const u=n[n.length-1];if(u&&u.start+u.deleteCount===a){u.deleteCount+=l;u.toInsert.push(...c)}else{n.push({start:a,deleteCount:l,toInsert:c})}}let r=0;let o=0;while(true){if(r===t.length){s(r,0,e.slice(o));break}if(o===e.length){s(r,t.length-r,[]);break}const a=t[r];const l=e[o];const c=i(a,l);if(c===0){r+=1;o+=1}else if(c<0){s(r,1,[]);r+=1}else if(c>0){s(r,0,[l]);o+=1}}return n}function z5(t,e,i){const n=NT(t,e,i);const s=[];const r=[];for(const o of n){s.push(...t.slice(o.start,o.start+o.deleteCount));r.push(...o.toInsert)}return{removed:s,added:r}}function zt(t){return t.filter(e=>!!e)}function q5(t){let e=0;for(let i=0;i<t.length;i++){if(!!t[i]){t[e]=t[i];e+=1}}t.length=e}function _S(t){return!Array.isArray(t)||t.length===0}function rf(t){return Array.isArray(t)&&t.length>0}function Ea(t,e=i=>i){const i=new Set;return t.filter(n=>{const s=e(n);if(i.has(s)){return false}i.add(s);return true})}function nE(t,e){let i;{i=Math.random}for(let n=t.length-1;n>0;n-=1){const s=Math.floor(i()*(n+1));const r=t[n];t[n]=t[s];t[s]=r}}function E1(t,e){return Array.isArray(t)?t.map(e):e(t)}function Zn(t){return Array.isArray(t)?t:[t]}var C1;(function(t){function e(r){return r<0}t.isLessThan=e;function i(r){return r<=0}t.isLessThanOrEqual=i;function n(r){return r>0}t.isGreaterThan=n;function s(r){return r===0}t.isNeitherLessOrGreaterThan=s;t.greaterThan=1;t.lessThan=-1;t.neitherLessOrGreaterThan=0})(C1||(C1={}));class Qf{static{this.empty=new Qf(e=>{})}constructor(e){this.iterate=e}forEach(e){this.iterate(i=>{e(i);return true})}toArray(){const e=[];this.iterate(i=>{e.push(i);return true});return e}filter(e){return new Qf(i=>this.iterate(n=>e(n)?i(n):true))}map(e){return new Qf(i=>this.iterate(n=>i(e(n))))}some(e){let i=false;this.iterate(n=>{i=e(n);return!i});return i}findFirst(e){let i;this.iterate(n=>{if(e(n)){i=n;return false}return true});return i}findLast(e){let i;this.iterate(n=>{if(e(n)){i=n}return true});return i}findLastMaxBy(e){let i;let n=true;this.iterate(s=>{if(n||C1.isGreaterThan(e(s,i))){n=false;i=s}return true});return i}}function j5(t,e){const i=Object.create(null);for(const n of t){const s=e(n);let r=i[s];if(!r){r=i[s]=[]}r.push(n)}return i}function G5(t,e){const i=[];const n=[];for(const s of t){if(!e.has(s)){i.push(s)}}for(const s of e){if(!t.has(s)){n.push(s)}}return{removed:i,added:n}}var sE;var rE;var oE;function K5(t,e,i){let n=t.get(e);if(n===void 0){n=i;t.set(e,n)}return n}class Q5{constructor(e,i){this.uri=e;this.value=i}}function J5(t){return Array.isArray(t)}class It{static{this.defaultToKey=e=>e.toString()}constructor(e,i){this[sE]="ResourceMap";if(e instanceof It){this.map=new Map(e.map);this.toKey=i??It.defaultToKey}else if(J5(e)){this.map=new Map;this.toKey=i??It.defaultToKey;for(const[n,s]of e){this.set(n,s)}}else{this.map=new Map;this.toKey=e??It.defaultToKey}}set(e,i){this.map.set(this.toKey(e),new Q5(e,i));return this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,i){if(typeof i!=="undefined"){e=e.bind(i)}for(const[n,s]of this.map){e(s.value,s.uri,this)}}*values(){for(const e of this.map.values()){yield e.value}}*keys(){for(const e of this.map.values()){yield e.uri}}*entries(){for(const e of this.map.values()){yield[e.uri,e.value]}}*[(sE=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map){yield[e.uri,e.value]}}}class ad{constructor(e,i){this[rE]="ResourceSet";if(!e||typeof e==="function"){this._map=new It(e)}else{this._map=new It(i);e.forEach(this.add,this)}}get size(){return this._map.size}add(e){this._map.set(e,e);return this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,i){this._map.forEach((n,s)=>e.call(i,s,s,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(rE=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}var en;(function(t){t[t["None"]=0]="None";t[t["AsOld"]=1]="AsOld";t[t["AsNew"]=2]="AsNew"})(en||(en={}));class Y5{constructor(){this[oE]="LinkedMap";this._map=new Map;this._head=void 0;this._tail=void 0;this._size=0;this._state=0}clear(){this._map.clear();this._head=void 0;this._tail=void 0;this._size=0;this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,i=en.None){const n=this._map.get(e);if(!n){return void 0}if(i!==en.None){this.touch(n,i)}return n.value}set(e,i,n=en.None){let s=this._map.get(e);if(s){s.value=i;if(n!==en.None){this.touch(s,n)}}else{s={key:e,value:i,next:void 0,previous:void 0};switch(n){case en.None:this.addItemLast(s);break;case en.AsOld:this.addItemFirst(s);break;case en.AsNew:this.addItemLast(s);break;default:this.addItemLast(s);break}this._map.set(e,s);this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const i=this._map.get(e);if(!i){return void 0}this._map.delete(e);this.removeItem(i);this._size--;return i.value}shift(){if(!this._head&&!this._tail){return void 0}if(!this._head||!this._tail){throw new Error("Invalid list")}const e=this._head;this._map.delete(e.key);this.removeItem(e);this._size--;return e.value}forEach(e,i){const n=this._state;let s=this._head;while(s){if(i){e.bind(i)(s.value,s.key,this)}else{e(s.value,s.key,this)}if(this._state!==n){throw new Error(`LinkedMap got modified during iteration.`)}s=s.next}}keys(){const e=this;const i=this._state;let n=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==i){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:n.key,done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return s}values(){const e=this;const i=this._state;let n=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==i){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:n.value,done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return s}entries(){const e=this;const i=this._state;let n=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==i){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:[n.key,n.value],done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return s}[(oE=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size){return}if(e===0){this.clear();return}let i=this._head;let n=this.size;while(i&&n>e){this._map.delete(i.key);i=i.next;n--}this._head=i;this._size=n;if(i){i.previous=void 0}this._state++}trimNew(e){if(e>=this.size){return}if(e===0){this.clear();return}let i=this._tail;let n=this.size;while(i&&n>e){this._map.delete(i.key);i=i.previous;n--}this._tail=i;this._size=n;if(i){i.next=void 0}this._state++}addItemFirst(e){if(!this._head&&!this._tail){this._tail=e}else if(!this._head){throw new Error("Invalid list")}else{e.next=this._head;this._head.previous=e}this._head=e;this._state++}addItemLast(e){if(!this._head&&!this._tail){this._head=e}else if(!this._tail){throw new Error("Invalid list")}else{e.previous=this._tail;this._tail.next=e}this._tail=e;this._state++}removeItem(e){if(e===this._head&&e===this._tail){this._head=void 0;this._tail=void 0}else if(e===this._head){if(!e.next){throw new Error("Invalid list")}e.next.previous=void 0;this._head=e.next}else if(e===this._tail){if(!e.previous){throw new Error("Invalid list")}e.previous.next=void 0;this._tail=e.previous}else{const i=e.next;const n=e.previous;if(!i||!n){throw new Error("Invalid list")}i.previous=n;n.next=i}e.next=void 0;e.previous=void 0;this._state++}touch(e,i){if(!this._head||!this._tail){throw new Error("Invalid list")}if(i!==en.AsOld&&i!==en.AsNew){return}if(i===en.AsOld){if(e===this._head){return}const n=e.next;const s=e.previous;if(e===this._tail){s.next=void 0;this._tail=s}else{n.previous=s;s.next=n}e.previous=void 0;e.next=this._head;this._head.previous=e;this._head=e;this._state++}else if(i===en.AsNew){if(e===this._tail){return}const n=e.next;const s=e.previous;if(e===this._head){n.previous=void 0;this._head=n}else{n.previous=s;s.next=n}e.next=void 0;e.previous=this._tail;this._tail.next=e;this._tail=e;this._state++}}toJSON(){const e=[];this.forEach((i,n)=>{e.push([n,i])});return e}fromJSON(e){this.clear();for(const[i,n]of e){this.set(i,n)}}}let X5=class xW extends Y5{constructor(e,i=1){super();this._limit=e;this._ratio=Math.min(Math.max(0,i),1)}get limit(){return this._limit}set limit(e){this._limit=e;this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1);this.checkTrim()}get(e,i=en.AsNew){return super.get(e,i)}peek(e){return super.get(e,en.None)}set(e,i){super.set(e,i,en.AsNew);return this}checkTrim(){if(this.size>this._limit){this.trim(Math.round(this._limit*this._ratio))}}};class of extends X5{constructor(e,i=1){super(e,i)}trim(e){this.trimOld(e)}set(e,i){super.set(e,i);this.checkTrim();return this}}class Z5{constructor(){this.map=new Map}add(e,i){let n=this.map.get(e);if(!n){n=new Set;this.map.set(e,n)}n.add(i)}delete(e,i){const n=this.map.get(e);if(!n){return}n.delete(i);if(n.size===0){this.map.delete(e)}}forEach(e,i){const n=this.map.get(e);if(!n){return}n.forEach(i)}get(e){const i=this.map.get(e);if(!i){return new Set}return i}}function MT(t,e){const i=this;let n=false;let s;return function(){if(n){return s}n=true;{s=t.apply(i,arguments)}return s}}function tn(t,e){if(!t){throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}}function k1(t,e="Unreachable"){throw new Error(e)}function D1(t,e="unexpected state"){if(!t){const i=typeof e==="string"?new li(`Assertion Failed: ${e}`):e;throw i}}function OT(t){if(!t()){debugger;t();Ti(new li("Assertion Failed"))}}function Xe(t){return typeof t==="string"}function eR(t){return tR(t,Xe)}function tR(t,e){return Array.isArray(t)&&t.every(e)}function Gt(t){return typeof t==="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}function iR(t){const e=Object.getPrototypeOf(Uint8Array);return typeof t==="object"&&t instanceof e}function $a(t){return typeof t==="number"&&!isNaN(t)}function nR(t){return!!t&&typeof t[Symbol.iterator]==="function"}function Yu(t){return typeof t==="undefined"}function Un(t){return!ai(t)}function ai(t){return Yu(t)||t===null}function FT(t,e){if(!t){throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}}function Lc(t){D1(t!==null&&t!==void 0,"Argument is `undefined` or `null`.");return t}const sR=Object.prototype.hasOwnProperty;function UT(t){if(!Gt(t)){return false}for(const e in t){if(sR.call(t,e)){return false}}return true}function $T(t){return typeof t==="function"}function rR(t,e){const i=Math.min(t.length,e.length);for(let n=0;n<i;n++){HT(t[n],e[n])}}function HT(t,e){if(Xe(e)){if(typeof t!==e){throw new Error(`argument does not match constraint: typeof ${e}`)}}else if($T(e)){try{if(t instanceof e){return}}catch{}if(!ai(t)&&t.constructor===e){return}if(e.length===1&&e.call(void 0,t)===true){return}throw new Error(`argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true`)}}function mo(t,e){for(const i in e){if(!(i in t)){return false}}return true}var qi;(function(t){function e(j){return!!j&&typeof j==="object"&&typeof j[Symbol.iterator]==="function"}t.is=e;const i=Object.freeze([]);function n(){return i}t.empty=n;function*s(j){yield j}t.single=s;function r(j){if(e(j)){return j}else{return s(j)}}t.wrap=r;function o(j){return j??i}t.from=o;function*a(j){for(let Q=j.length-1;Q>=0;Q--){yield j[Q]}}t.reverse=a;function l(j){return!j||j[Symbol.iterator]().next().done===true}t.isEmpty=l;function c(j){return j[Symbol.iterator]().next().value}t.first=c;function u(j,Q){let le=0;for(const Re of j){if(Q(Re,le++)){return true}}return false}t.some=u;function d(j,Q){let le=0;for(const Re of j){if(!Q(Re,le++)){return false}}return true}t.every=d;function f(j,Q){for(const le of j){if(Q(le)){return le}}return void 0}t.find=f;function*p(j,Q){for(const le of j){if(Q(le)){yield le}}}t.filter=p;function*m(j,Q){let le=0;for(const Re of j){yield Q(Re,le++)}}t.map=m;function*v(j,Q){let le=0;for(const Re of j){yield*Q(Re,le++)}}t.flatMap=v;function*y(...j){for(const Q of j){if(nR(Q)){yield*Q}else{yield Q}}}t.concat=y;function k(j,Q,le){let Re=le;for(const Ne of j){Re=Q(Re,Ne)}return Re}t.reduce=k;function S(j){let Q=0;for(const le of j){Q++}return Q}t.length=S;function*R(j,Q,le=j.length){if(Q<-j.length){Q=0}if(Q<0){Q+=j.length}if(le<0){le+=j.length}else if(le>j.length){le=j.length}for(;Q<le;Q++){yield j[Q]}}t.slice=R;function K(j,Q=Number.POSITIVE_INFINITY){const le=[];if(Q===0){return[le,j]}const Re=j[Symbol.iterator]();for(let Ne=0;Ne<Q;Ne++){const He=Re.next();if(He.done){return[le,t.empty()]}le.push(He.value)}return[le,{[Symbol.iterator](){return Re}}]}t.consume=K;async function q(j){const Q=[];for await(const le of j){Q.push(le)}return Q}t.asyncToArray=q;async function se(j){let Q=[];for await(const le of j){Q=Q.concat(le)}return Q}t.asyncToArrayFlat=se})(qi||(qi={}));function oR(t,e){}function I1(t){return t}function BT(t){return typeof t==="object"&&t!==null&&typeof t.dispose==="function"&&t.dispose.length===0}function Jn(t){if(qi.is(t)){const e=[];for(const i of t){if(i){try{i.dispose()}catch(n){e.push(n)}}}if(e.length===1){throw e[0]}else if(e.length>1){throw new AggregateError(e,"Encountered errors while disposing of store")}return Array.isArray(t)?[]:t}else if(t){t.dispose();return t}}function vS(...t){const e=ye(()=>Jn(t));return e}class aR{constructor(e){this._isDisposed=false;this._fn=e}dispose(){if(this._isDisposed){return}if(!this._fn){throw new Error(`Unbound disposable context: Need to use an arrow function to preserve the value of this`)}this._isDisposed=true;this._fn()}}function ye(t){return new aR(t)}class pe{static{this.DISABLE_DISPOSED_WARNING=false}constructor(){this._toDispose=new Set;this._isDisposed=false}dispose(){if(this._isDisposed){return}this._isDisposed=true;this.clear()}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size===0){return}try{Jn(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e||e===me.None){return e}if(e===this){throw new Error("Cannot register a disposable on itself!")}if(this._isDisposed){if(!pe.DISABLE_DISPOSED_WARNING){console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack)}}else{this._toDispose.add(e)}return e}delete(e){if(!e){return}if(e===this){throw new Error("Cannot dispose a disposable on itself!")}this._toDispose.delete(e);e.dispose()}deleteAndLeak(e){if(!e){return}if(this._toDispose.delete(e));}assertNotDisposed(){if(this._isDisposed){Ti(new li("Object disposed"))}}}let me=class EW{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new pe;oR(this._store)}dispose(){this._store.dispose()}_register(e){if(e===this){throw new Error("Cannot register a disposable on itself!")}return this._store.add(e)}};class $r{constructor(){this._isDisposed=false}get value(){return this._isDisposed?void 0:this._value}set value(e){if(this._isDisposed||e===this._value){return}this._value?.dispose();this._value=e}clear(){this.value=void 0}dispose(){this._isDisposed=true;this._value?.dispose();this._value=void 0}clearAndLeak(){const e=this._value;this._value=void 0;return e}}class af{constructor(e=new Map){this._isDisposed=false;this._store=e}dispose(){this._isDisposed=true;this.clearAndDisposeAll()}clearAndDisposeAll(){if(!this._store.size){return}try{Jn(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,i,n=false){if(this._isDisposed){console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack)}if(!n){this._store.get(e)?.dispose()}this._store.set(e,i)}deleteAndDispose(e){this._store.get(e)?.dispose();this._store.delete(e)}deleteAndLeak(e){const i=this._store.get(e);this._store.delete(e);return i}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}class lR extends af{constructor(){super(new It)}}function WT(t,e){return new cR(t,e)}class cR{constructor(e,i){this.reducer=e;this.options=i;this.state={flowing:false,ended:false,destroyed:false};this.buffer={data:[],error:[]};this.listeners={data:[],error:[],end:[]};this.pendingWritePromises=[]}pause(){if(this.state.destroyed){return}this.state.flowing=false}resume(){if(this.state.destroyed){return}if(!this.state.flowing){this.state.flowing=true;this.flowData();this.flowErrors();this.flowEnd()}}write(e){if(this.state.destroyed){return}if(this.state.flowing){this.emitData(e)}else{this.buffer.data.push(e);if(typeof this.options?.highWaterMark==="number"&&this.buffer.data.length>this.options.highWaterMark){return new Promise(i=>this.pendingWritePromises.push(i))}}}error(e){if(this.state.destroyed){return}if(this.state.flowing){this.emitError(e)}else{this.buffer.error.push(e)}}end(e){if(this.state.destroyed){return}if(typeof e!=="undefined"){this.write(e)}if(this.state.flowing){this.emitEnd();this.destroy()}else{this.state.ended=true}}emitData(e){this.listeners.data.slice(0).forEach(i=>i(e))}emitError(e){if(this.listeners.error.length===0){Ti(e)}else{this.listeners.error.slice(0).forEach(i=>i(e))}}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,i){if(this.state.destroyed){return}switch(e){case"data":this.listeners.data.push(i);this.resume();break;case"end":this.listeners.end.push(i);if(this.state.flowing&&this.flowEnd()){this.destroy()}break;case"error":this.listeners.error.push(i);if(this.state.flowing){this.flowErrors()}break}}removeListener(e,i){if(this.state.destroyed){return}let n=void 0;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){const s=n.indexOf(i);if(s>=0){n.splice(s,1)}}}flowData(){if(this.buffer.data.length===0){return}if(typeof this.reducer==="function"){const i=this.reducer(this.buffer.data);this.emitData(i)}else{for(const i of this.buffer.data){this.emitData(i)}}this.buffer.data.length=0;const e=[...this.pendingWritePromises];this.pendingWritePromises.length=0;e.forEach(i=>i())}flowErrors(){if(this.listeners.error.length>0){for(const e of this.buffer.error){this.emitError(e)}this.buffer.error.length=0}}flowEnd(){if(this.state.ended){this.emitEnd();return this.listeners.end.length>0}return false}destroy(){if(!this.state.destroyed){this.state.destroyed=true;this.state.ended=true;this.buffer.data.length=0;this.buffer.error.length=0;this.listeners.data.length=0;this.listeners.error.length=0;this.listeners.end.length=0;this.pendingWritePromises.length=0}}}function uR(t,e){const i=[];let n;while((n=t.read())!==null){i.push(n)}return e(i)}function VT(t,e){return new Promise((i,n)=>{const s=[];zT(t,{onData:r=>{if(e){s.push(r)}},onError:r=>{if(e){n(r)}else{i(void 0)}},onEnd:()=>{if(e){i(e(s))}else{i(void 0)}}})})}function zT(t,e,i){t.on("error",n=>{if(!i?.isCancellationRequested){e.onError(n)}});t.on("end",()=>{if(!i?.isCancellationRequested){e.onEnd()}});t.on("data",n=>{if(!i?.isCancellationRequested){e.onData(n)}})}function dR(t,e){const i=WT(e);i.end(t);return i}const Mu=typeof Buffer!=="undefined";const hR=new $i(()=>new Uint8Array(256));let Tv;let Pv;class ae{static alloc(e){if(Mu){return new ae(Buffer.allocUnsafe(e))}else{return new ae(new Uint8Array(e))}}static wrap(e){if(Mu&&!Buffer.isBuffer(e)){e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return new ae(e)}static fromString(e,i){const n=i?.dontUseNodeBuffer||false;if(!n&&Mu){return new ae(Buffer.from(e))}else{if(!Tv){Tv=new TextEncoder}return new ae(Tv.encode(e))}}static fromByteArray(e){const i=ae.alloc(e.length);for(let n=0,s=e.length;n<s;n++){i.buffer[n]=e[n]}return i}static concat(e,i){if(typeof i==="undefined"){i=0;for(let r=0,o=e.length;r<o;r++){i+=e[r].byteLength}}const n=ae.alloc(i);let s=0;for(let r=0,o=e.length;r<o;r++){const a=e[r];n.set(a,s);s+=a.byteLength}return n}static isNativeBuffer(e){return Mu&&Buffer.isBuffer(e)}constructor(e){this.buffer=e;this.byteLength=this.buffer.byteLength}clone(){const e=ae.alloc(this.byteLength);e.set(this);return e}toString(){if(Mu){return this.buffer.toString()}else{if(!Pv){Pv=new TextDecoder(void 0,{ignoreBOM:true})}return Pv.decode(this.buffer)}}slice(e,i){return new ae(this.buffer.subarray(e,i))}set(e,i){if(e instanceof ae){this.buffer.set(e.buffer,i)}else if(e instanceof Uint8Array){this.buffer.set(e,i)}else if(e instanceof ArrayBuffer){this.buffer.set(new Uint8Array(e),i)}else if(ArrayBuffer.isView(e)){this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i)}else{throw new Error(`Unknown argument 'array'`)}}readUInt32BE(e){return Jf(this.buffer,e)}writeUInt32BE(e,i){Yf(this.buffer,e,i)}readUInt32LE(e){return mR(this.buffer,e)}writeUInt32LE(e,i){_R(this.buffer,e,i)}readUInt8(e){return vR(this.buffer,e)}writeUInt8(e,i){wR(this.buffer,e,i)}indexOf(e,i=0){return fR(this.buffer,e instanceof ae?e.buffer:e,i)}equals(e){if(this===e){return true}if(this.byteLength!==e.byteLength){return false}return this.buffer.every((i,n)=>i===e.buffer[n])}}function fR(t,e,i=0){const n=e.byteLength;const s=t.byteLength;if(n===0){return 0}if(n===1){return t.indexOf(e[0],i)}if(n>s-i){return-1}const r=hR.value;r.fill(e.length);for(let c=0;c<e.length;c++){r[e[c]]=e.length-c-1}let o=i+e.length-1;let a=o;let l=-1;while(o<s){if(t[o]===e[a]){if(a===0){l=o;break}o--;a--}else{o+=Math.max(e.length-a,r[t[o]]);a=e.length-1}}return l}function pR(t,e){return t[e+0]<<0>>>0|t[e+1]<<8>>>0}function gR(t,e,i){t[i+0]=e&255;e=e>>>8;t[i+1]=e&255}function Jf(t,e){return t[e]*2**24+t[e+1]*2**16+t[e+2]*2**8+t[e+3]}function Yf(t,e,i){t[i+3]=e;e=e>>>8;t[i+2]=e;e=e>>>8;t[i+1]=e;e=e>>>8;t[i]=e}function mR(t,e){return t[e+0]<<0>>>0|t[e+1]<<8>>>0|t[e+2]<<16>>>0|t[e+3]<<24>>>0}function _R(t,e,i){t[i+0]=e&255;e=e>>>8;t[i+1]=e&255;e=e>>>8;t[i+2]=e&255;e=e>>>8;t[i+3]=e&255}function vR(t,e){return t[e]}function wR(t,e,i){t[i]=e}function bR(t){return uR(t,e=>ae.concat(e))}function yR(t){return VT(t,e=>ae.concat(e))}function SR(t){return dR(t,e=>ae.concat(e))}function Oo(t){let e=0;let i=0;let n=0;const s=new Uint8Array(Math.floor(t.length/4*3));const r=a=>{switch(i){case 3:s[n++]=e|a;i=0;break;case 2:s[n++]=e|a>>>2;e=a<<6;i=3;break;case 1:s[n++]=e|a>>>4;e=a<<4;i=2;break;default:e=a<<2;i=1}};for(let a=0;a<t.length;a++){const l=t.charCodeAt(a);if(l>=65&&l<=90){r(l-65)}else if(l>=97&&l<=122){r(l-97+26)}else if(l>=48&&l<=57){r(l-48+52)}else if(l===43||l===45){r(62)}else if(l===47||l===95){r(63)}else if(l===61){break}else{throw new SyntaxError(`Unexpected base64 character ${t[a]}`)}}const o=n;while(i>0){r(0)}return ae.wrap(s).slice(0,o)}const xR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const ER="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function vl({buffer:t},e=true,i=false){const n=i?ER:xR;let s="";const r=t.byteLength%3;let o=0;for(;o<t.byteLength-r;o+=3){const a=t[o+0];const l=t[o+1];const c=t[o+2];s+=n[a>>>2];s+=n[(a<<4|l>>>4)&63];s+=n[(l<<2|c>>>6)&63];s+=n[c&63]}if(r===1){const a=t[o+0];s+=n[a>>>2];s+=n[a<<4&63];if(e){s+="=="}}else if(r===2){const a=t[o+0];const l=t[o+1];s+=n[a>>>2];s+=n[(a<<4|l>>>4)&63];s+=n[l<<2&63];if(e){s+="="}}return s}const aE="0123456789abcdef";function qT({buffer:t}){let e="";for(let i=0;i<t.length;i++){const n=t[i];e+=aE[n>>>4];e+=aE[n&15]}return e}function CR(t){if(t.length%2!==0){throw new SyntaxError("Hex string must have an even length")}const e=new Uint8Array(t.length>>1);for(let i=0;i<t.length;){e[i>>1]=lE(t,i++)<<4|lE(t,i++)}return ae.wrap(e)}function lE(t,e){const i=t.charCodeAt(e);if(i>=48&&i<=57){return i-48}else if(i>=97&&i<=102){return i-87}else if(i>=65&&i<=70){return i-55}else{throw new SyntaxError(`Invalid hex character at position ${e}`)}}let Yt=class Xf{static{this.Undefined=new Xf(void 0)}constructor(e){this.element=e;this.next=Xf.Undefined;this.prev=Xf.Undefined}};class Go{constructor(){this._first=Yt.Undefined;this._last=Yt.Undefined;this._size=0}get size(){return this._size}isEmpty(){return this._first===Yt.Undefined}clear(){let e=this._first;while(e!==Yt.Undefined){const i=e.next;e.prev=Yt.Undefined;e.next=Yt.Undefined;e=i}this._first=Yt.Undefined;this._last=Yt.Undefined;this._size=0}unshift(e){return this._insert(e,false)}push(e){return this._insert(e,true)}_insert(e,i){const n=new Yt(e);if(this._first===Yt.Undefined){this._first=n;this._last=n}else if(i){const r=this._last;this._last=n;n.prev=r;r.next=n}else{const r=this._first;this._first=n;n.next=r;r.prev=n}this._size+=1;let s=false;return()=>{if(!s){s=true;this._remove(n)}}}shift(){if(this._first===Yt.Undefined){return void 0}else{const e=this._first.element;this._remove(this._first);return e}}pop(){if(this._last===Yt.Undefined){return void 0}else{const e=this._last.element;this._remove(this._last);return e}}peek(){if(this._last===Yt.Undefined){return void 0}else{const e=this._last.element;return e}}_remove(e){if(e.prev!==Yt.Undefined&&e.next!==Yt.Undefined){const i=e.prev;i.next=e.next;e.next.prev=i}else if(e.prev===Yt.Undefined&&e.next===Yt.Undefined){this._first=Yt.Undefined;this._last=Yt.Undefined}else if(e.next===Yt.Undefined){this._last=this._last.prev;this._last.next=Yt.Undefined}else if(e.prev===Yt.Undefined){this._first=this._first.next;this._first.prev=Yt.Undefined}this._size-=1}*[Symbol.iterator](){let e=this._first;while(e!==Yt.Undefined){yield e.element;e=e.next}}}const kR=globalThis.performance.now.bind(globalThis.performance);class Wr{static create(e){return new Wr(e)}constructor(e){this._now=e===false?Date.now:kR;this._startTime=this._now();this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now();this._stopTime=-1}elapsed(){if(this._stopTime!==-1){return this._stopTime-this._startTime}return this._now()-this._startTime}}var wt;(function(t){t.None=()=>me.None;function e(Z,Y,J){return f(Z,()=>void 0,0,void 0,Y??true,void 0,J)}t.defer=e;function i(Z){return(Y,J=null,re)=>{let ce=false;let Le=void 0;Le=Z(qe=>{if(ce){return}else if(Le){Le.dispose()}else{ce=true}return Y.call(J,qe)},null,re);if(ce){Le.dispose()}return Le}}t.once=i;function n(Z,Y){return t.once(t.filter(Z,Y))}t.onceIf=n;function s(Z,Y,J){return u((re,ce=null,Le)=>Z(qe=>re.call(ce,Y(qe)),null,Le),J)}t.map=s;function r(Z,Y,J){return u((re,ce=null,Le)=>Z(qe=>{Y(qe);re.call(ce,qe)},null,Le),J)}t.forEach=r;function o(Z,Y,J){return u((re,ce=null,Le)=>Z(qe=>Y(qe)&&re.call(ce,qe),null,Le),J)}t.filter=o;function a(Z){return Z}t.signal=a;function l(...Z){return(Y,J=null,re)=>{const ce=vS(...Z.map(Le=>Le(qe=>Y.call(J,qe))));return d(ce,re)}}t.any=l;function c(Z,Y,J,re){let ce=J;return s(Z,Le=>{ce=Y(ce,Le);return ce},re)}t.reduce=c;function u(Z,Y){let J;const re={onWillAddFirstListener(){J=Z(ce.fire,ce)},onDidRemoveLastListener(){J?.dispose()}};const ce=new L(re);Y?.add(ce);return ce.event}function d(Z,Y){if(Y instanceof Array){Y.push(Z)}else if(Y){Y.add(Z)}return Z}function f(Z,Y,J=100,re=false,ce=false,Le,qe){let ze;let ct=void 0;let Lt=void 0;let Ke=0;let Ht;const bi={leakWarningThreshold:Le,onWillAddFirstListener(){ze=Z(Us=>{Ke++;ct=Y(ct,Us);if(re&&!Lt){ti.fire(ct);ct=void 0}Ht=()=>{const is=ct;ct=void 0;Lt=void 0;if(!re||Ke>1){ti.fire(is)}Ke=0};if(typeof J==="number"){if(Lt){clearTimeout(Lt)}Lt=setTimeout(Ht,J)}else{if(Lt===void 0){Lt=null;queueMicrotask(Ht)}}})},onWillRemoveListener(){if(ce&&Ke>0){Ht?.()}},onDidRemoveLastListener(){Ht=void 0;ze.dispose()}};const ti=new L(bi);qe?.add(ti);return ti.event}t.debounce=f;function p(Z,Y=0,J,re){return t.debounce(Z,(ce,Le)=>{if(!ce){return[Le]}ce.push(Le);return ce},Y,void 0,J??true,void 0,re)}t.accumulate=p;function m(Z,Y,J=100,re=true,ce=true,Le,qe){let ze;let ct=void 0;let Lt=void 0;let Ke=0;const Ht={leakWarningThreshold:Le,onWillAddFirstListener(){ze=Z(ti=>{Ke++;ct=Y(ct,ti);if(Lt===void 0){if(re){bi.fire(ct);ct=void 0;Ke=0}if(typeof J==="number"){Lt=setTimeout(()=>{if(ce&&Ke>0){bi.fire(ct)}ct=void 0;Lt=void 0;Ke=0},J)}else{Lt=0;queueMicrotask(()=>{if(ce&&Ke>0){bi.fire(ct)}ct=void 0;Lt=void 0;Ke=0})}}})},onDidRemoveLastListener(){ze.dispose()}};const bi=new L(Ht);qe?.add(bi);return bi.event}t.throttle=m;function v(Z,Y=(re,ce)=>re===ce,J){let re=true;let ce;return o(Z,Le=>{const qe=re||!Y(Le,ce);re=false;ce=Le;return qe},J)}t.latch=v;function y(Z,Y,J){return[t.filter(Z,Y,J),t.filter(Z,re=>!Y(re),J)]}t.split=y;function k(Z,Y=false,J=[],re){let ce=J.slice();let Le=Z(ct=>{if(ce){ce.push(ct)}else{ze.fire(ct)}});if(re){re.add(Le)}const qe=()=>{ce?.forEach(ct=>ze.fire(ct));ce=null};const ze=new L({onWillAddFirstListener(){if(!Le){Le=Z(ct=>ze.fire(ct));if(re){re.add(Le)}}},onDidAddFirstListener(){if(ce){if(Y){setTimeout(qe)}else{qe()}}},onDidRemoveLastListener(){if(Le){Le.dispose()}Le=null}});if(re){re.add(ze)}return ze.event}t.buffer=k;function S(Z,Y){const J=(re,ce,Le)=>{const qe=Y(new K);return Z(function(ze){const ct=qe.evaluate(ze);if(ct!==R){re.call(ce,ct)}},void 0,Le)};return J}t.chain=S;const R=Symbol("HaltChainable");class K{constructor(){this.steps=[]}map(Y){this.steps.push(Y);return this}forEach(Y){this.steps.push(J=>{Y(J);return J});return this}filter(Y){this.steps.push(J=>Y(J)?J:R);return this}reduce(Y,J){let re=J;this.steps.push(ce=>{re=Y(re,ce);return re});return this}latch(Y=(J,re)=>J===re){let J=true;let re;this.steps.push(ce=>{const Le=J||!Y(ce,re);J=false;re=ce;return Le?ce:R});return this}evaluate(Y){for(const J of this.steps){Y=J(Y);if(Y===R){break}}return Y}}function q(Z,Y,J=re=>re){const re=(...ze)=>qe.fire(J(...ze));const ce=()=>Z.on(Y,re);const Le=()=>Z.removeListener(Y,re);const qe=new L({onWillAddFirstListener:ce,onDidRemoveLastListener:Le});return qe.event}t.fromNodeEventEmitter=q;function se(Z,Y,J=re=>re){const re=(...ze)=>qe.fire(J(...ze));const ce=()=>Z.addEventListener(Y,re);const Le=()=>Z.removeEventListener(Y,re);const qe=new L({onWillAddFirstListener:ce,onDidRemoveLastListener:Le});return qe.event}t.fromDOMEventEmitter=se;function j(Z,Y){let J;let re;const ce=new Promise(Le=>{re=i(Z)(Le);T1(re,Y);J=()=>{cE(re,Y)}});ce.cancel=J;if(Y){ce.finally(()=>cE(re,Y))}return ce}t.toPromise=j;function Q(Z,Y){return Z(J=>Y.fire(J))}t.forward=Q;function le(Z,Y,J){Y(J);return Z(re=>Y(re))}t.runAndSubscribe=le;class Re{constructor(Y,J){this._observable=Y;this._counter=0;this._hasChanged=false;const re={onWillAddFirstListener:()=>{Y.addObserver(this);this._observable.reportChanges()},onDidRemoveLastListener:()=>{Y.removeObserver(this)}};this.emitter=new L(re);if(J){J.add(this.emitter)}}beginUpdate(Y){this._counter++}handlePossibleChange(Y){}handleChange(Y,J){this._hasChanged=true}endUpdate(Y){this._counter--;if(this._counter===0){this._observable.reportChanges();if(this._hasChanged){this._hasChanged=false;this.emitter.fire(this._observable.get())}}}}function Ne(Z,Y){const J=new Re(Z,Y);return J.emitter.event}t.fromObservable=Ne;function He(Z){return(Y,J,re)=>{let ce=0;let Le=false;const qe={beginUpdate(){ce++},endUpdate(){ce--;if(ce===0){Z.reportChanges();if(Le){Le=false;Y.call(J)}}},handlePossibleChange(){},handleChange(){Le=true}};Z.addObserver(qe);Z.reportChanges();const ze={dispose(){Z.removeObserver(qe)}};T1(ze,re);return ze}}t.fromObservableLight=He})(wt||(wt={}));class Lp{static{this.all=new Set}static{this._idPool=0}constructor(e){this.listenerCount=0;this.invocationCount=0;this.elapsedOverall=0;this.durations=[];this.name=`${e}_${Lp._idPool++}`;Lp.all.add(this)}start(e){this._stopWatch=new Wr;this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e);this.elapsedOverall+=e;this.invocationCount+=1;this._stopWatch=void 0}}}let DR=-1;class wS{static{this._idPool=1}constructor(e,i,n=(wS._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=i;this.name=n;this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,i){const n=this.threshold;if(n<=0||i<n){return void 0}if(!this._stacks){this._stacks=new Map}const s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s+1);this._warnCountdown-=1;if(this._warnCountdown<=0){this._warnCountdown=n*.5;const[r,o]=this.getMostFrequentStack();const a=`[${this.name}] potential listener LEAK detected, having ${i} listeners already. MOST frequent listener (${o}):`;console.warn(a);console.warn(r);const l=new IR(a,r);this._errorHandler(l)}return()=>{const r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks){return void 0}let e;let i=0;for(const[n,s]of this._stacks){if(!e||i<s){e=[n,s];i=s}}return e}}class bS{static create(){const e=new Error;return new bS(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split("\n").slice(2).join("\n"))}}class IR extends Error{constructor(e,i){super(e);this.name="ListenerLeakError";this.stack=i}}class TR extends Error{constructor(e,i){super(e);this.name="ListenerRefusalError";this.stack=i}}let PR=0;class Zf{constructor(e){this.value=e;this.id=PR++}}const AR=2;const RR=(t,e)=>{if(t instanceof Zf){e(t)}else{for(let i=0;i<t.length;i++){const n=t[i];if(n){e(n)}}}};class L{constructor(e){this._size=0;this._options=e;this._leakageMon=this._options?.leakWarningThreshold?new wS(e?.onListenerError??Ti,this._options?.leakWarningThreshold??DR):void 0;this._perfMon=this._options?._profName?new Lp(this._options._profName):void 0;this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){this._disposed=true;if(this._deliveryQueue?.current===this){this._deliveryQueue.reset()}if(this._listeners){this._listeners=void 0;this._size=0}this._options?.onDidRemoveLastListener?.();this._leakageMon?.dispose()}}get event(){this._event??=(e,i,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const a=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(a);const l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1];const c=new TR(`${a}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);const u=this._options?.onListenerError||Ti;u(c);return me.None}if(this._disposed){return me.None}if(i){e=e.bind(i)}const s=new Zf(e);let r;if(this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)){s.stack=bS.create();r=this._leakageMon.check(s.stack,this._size+1)}if(!this._listeners){this._options?.onWillAddFirstListener?.(this);this._listeners=s;this._options?.onDidAddFirstListener?.(this)}else if(this._listeners instanceof Zf){this._deliveryQueue??=new LR;this._listeners=[this._listeners,s]}else{this._listeners.push(s)}this._options?.onDidAddListener?.(this);this._size++;const o=ye(()=>{r?.();this._removeListener(s)});T1(o,n);return o};return this._event}_removeListener(e){this._options?.onWillRemoveListener?.(this);if(!this._listeners){return}if(this._size===1){this._listeners=void 0;this._options?.onDidRemoveLastListener?.(this);this._size=0;return}const i=this._listeners;const n=i.indexOf(e);if(n===-1){console.log("disposed?",this._disposed);console.log("size?",this._size);console.log("arr?",JSON.stringify(this._listeners));throw new Error("Attempted to dispose unknown listener")}this._size--;i[n]=void 0;const s=this._deliveryQueue.current===this;if(this._size*AR<=i.length){let r=0;for(let o=0;o<i.length;o++){if(i[o]){i[r++]=i[o]}else if(s&&r<this._deliveryQueue.end){this._deliveryQueue.end--;if(r<this._deliveryQueue.i){this._deliveryQueue.i--}}}i.length=r}}_deliver(e,i){if(!e){return}const n=this._options?.onListenerError||Ti;if(!n){e.value(i);return}try{e.value(i)}catch(s){n(s)}}_deliverQueue(e){const i=e.current._listeners;while(e.i<e.end){this._deliver(i[e.i++],e.value)}e.reset()}fire(e){if(this._deliveryQueue?.current){this._deliverQueue(this._deliveryQueue);this._perfMon?.stop()}this._perfMon?.start(this._size);if(!this._listeners);else if(this._listeners instanceof Zf){this._deliver(this._listeners,e)}else{const i=this._deliveryQueue;i.enqueue(this,e,this._listeners.length);this._deliverQueue(i)}this._perfMon?.stop()}hasListeners(){return this._size>0}}class LR{constructor(){this.i=-1;this.end=0}enqueue(e,i,n){this.i=0;this.end=n;this.current=e;this.value=i}reset(){this.i=this.end;this.current=void 0;this.value=void 0}}class ld extends L{async fireAsync(e,i,n){if(!this._listeners){return}if(!this._asyncDeliveryQueue){this._asyncDeliveryQueue=new Go}RR(this._listeners,s=>this._asyncDeliveryQueue.push([s.value,e]));while(this._asyncDeliveryQueue.size>0&&!i.isCancellationRequested){const[s,r]=this._asyncDeliveryQueue.shift();const o=[];const a={...r,token:i,waitUntil:l=>{if(Object.isFrozen(o)){throw new Error("waitUntil can NOT be called asynchronous")}if(n){l=n(l,s)}o.push(l)}};try{s(a)}catch(l){Ti(l);continue}await Promise.allSettled(o).then(l=>{for(const c of l){if(c.status==="rejected"){Ti(c.reason)}}})}}}class Np extends L{get isPaused(){return this._isPaused!==0}constructor(e){super(e);this._isPaused=0;this._eventQueue=new Go;this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0){if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear();super.fire(this._mergeFn(e))}}else{while(!this._isPaused&&this._eventQueue.size!==0){super.fire(this._eventQueue.shift())}}}}fire(e){if(this._size){if(this._isPaused!==0){this._eventQueue.push(e)}else{super.fire(e)}}}}class NR extends Np{constructor(e){super(e);this._delay=e.delay??100}fire(e){if(!this._handle){this.pause();this._handle=setTimeout(()=>{this._handle=void 0;this.resume()},this._delay)}super.fire(e)}}class MR extends L{constructor(e){super(e);this._queuedEvents=[];this._mergeFn=e?.merge}fire(e){if(!this.hasListeners()){return}this._queuedEvents.push(e);if(this._queuedEvents.length===1){queueMicrotask(()=>{if(this._mergeFn){super.fire(this._mergeFn(this._queuedEvents))}else{this._queuedEvents.forEach(i=>super.fire(i))}this._queuedEvents=[]})}}}function T1(t,e){if(e instanceof pe){e.add(t)}else if(Array.isArray(e)){e.push(t)}}function cE(t,e){if(e instanceof pe){e.delete(t)}else if(Array.isArray(e)){const i=e.indexOf(t);if(i!==-1){e.splice(i,1)}}t.dispose()}var Wd;(function(t){t[t["Desktop"]=1]="Desktop";t[t["Web"]=2]="Web"})(Wd||(Wd={}));var uE;(function(t){t[t["VersionMismatch"]=55]="VersionMismatch";t[t["UnexpectedError"]=81]="UnexpectedError"})(uE||(uE={}));var Is;(function(t){t[t["Initialized"]=0]="Initialized";t[t["Ready"]=1]="Ready";t[t["Terminate"]=2]="Terminate"})(Is||(Is={}));function dE(t){const e=ae.alloc(1);switch(t){case Is.Initialized:e.writeUInt8(1,0);break;case Is.Ready:e.writeUInt8(2,0);break;case Is.Terminate:e.writeUInt8(3,0);break}return e}function OR(t,e){if(t.byteLength!==1){return false}switch(t.readUInt8(0)){case 1:return e===Is.Initialized;case 2:return e===Is.Ready;case 3:return e===Is.Terminate;default:return false}}var hE;(function(t){t["Start"]="START_NATIVE_LOG";t["End"]="END_NATIVE_LOG"})(hE||(hE={}));function Av(t){const e=[];if(typeof t==="number"){e.push("code/timeOrigin",t)}function i(s,r){e.push(s,r?.startTime??Date.now())}function n(){const s=[];for(let r=0;r<e.length;r+=2){s.push({name:e[r],startTime:e[r+1]})}return s}return{mark:i,getMarks:n}}function FR(){if(typeof performance==="object"&&typeof performance.mark==="function"&&!performance.nodeTiming){if(typeof performance.timeOrigin!=="number"&&!performance.timing){return Av()}else{return{mark(t,e){performance.mark(t,e)},getMarks(){let t=performance.timeOrigin;if(typeof t!=="number"){t=(performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart)??0}const e=[{name:"code/timeOrigin",startTime:Math.round(t)}];for(const i of performance.getEntriesByType("mark")){e.push({name:i.name,startTime:Math.round(t+i.startTime)})}return e}}}}else if(typeof process==="object"){const t=performance?.timeOrigin;return Av(t)}else{console.trace("perf-util loaded in UNKNOWN environment");return Av()}}function UR(t){if(!t.MonacoPerformanceMarks){t.MonacoPerformanceMarks=FR()}return t.MonacoPerformanceMarks}const jT=UR(globalThis);const pn=jT.mark;const $R=jT.getMarks;var M;(function(t){t[t["Null"]=0]="Null";t[t["Backspace"]=8]="Backspace";t[t["Tab"]=9]="Tab";t[t["LineFeed"]=10]="LineFeed";t[t["CarriageReturn"]=13]="CarriageReturn";t[t["Space"]=32]="Space";t[t["ExclamationMark"]=33]="ExclamationMark";t[t["DoubleQuote"]=34]="DoubleQuote";t[t["Hash"]=35]="Hash";t[t["DollarSign"]=36]="DollarSign";t[t["PercentSign"]=37]="PercentSign";t[t["Ampersand"]=38]="Ampersand";t[t["SingleQuote"]=39]="SingleQuote";t[t["OpenParen"]=40]="OpenParen";t[t["CloseParen"]=41]="CloseParen";t[t["Asterisk"]=42]="Asterisk";t[t["Plus"]=43]="Plus";t[t["Comma"]=44]="Comma";t[t["Dash"]=45]="Dash";t[t["Period"]=46]="Period";t[t["Slash"]=47]="Slash";t[t["Digit0"]=48]="Digit0";t[t["Digit1"]=49]="Digit1";t[t["Digit2"]=50]="Digit2";t[t["Digit3"]=51]="Digit3";t[t["Digit4"]=52]="Digit4";t[t["Digit5"]=53]="Digit5";t[t["Digit6"]=54]="Digit6";t[t["Digit7"]=55]="Digit7";t[t["Digit8"]=56]="Digit8";t[t["Digit9"]=57]="Digit9";t[t["Colon"]=58]="Colon";t[t["Semicolon"]=59]="Semicolon";t[t["LessThan"]=60]="LessThan";t[t["Equals"]=61]="Equals";t[t["GreaterThan"]=62]="GreaterThan";t[t["QuestionMark"]=63]="QuestionMark";t[t["AtSign"]=64]="AtSign";t[t["A"]=65]="A";t[t["B"]=66]="B";t[t["C"]=67]="C";t[t["D"]=68]="D";t[t["E"]=69]="E";t[t["F"]=70]="F";t[t["G"]=71]="G";t[t["H"]=72]="H";t[t["I"]=73]="I";t[t["J"]=74]="J";t[t["K"]=75]="K";t[t["L"]=76]="L";t[t["M"]=77]="M";t[t["N"]=78]="N";t[t["O"]=79]="O";t[t["P"]=80]="P";t[t["Q"]=81]="Q";t[t["R"]=82]="R";t[t["S"]=83]="S";t[t["T"]=84]="T";t[t["U"]=85]="U";t[t["V"]=86]="V";t[t["W"]=87]="W";t[t["X"]=88]="X";t[t["Y"]=89]="Y";t[t["Z"]=90]="Z";t[t["OpenSquareBracket"]=91]="OpenSquareBracket";t[t["Backslash"]=92]="Backslash";t[t["CloseSquareBracket"]=93]="CloseSquareBracket";t[t["Caret"]=94]="Caret";t[t["Underline"]=95]="Underline";t[t["BackTick"]=96]="BackTick";t[t["a"]=97]="a";t[t["b"]=98]="b";t[t["c"]=99]="c";t[t["d"]=100]="d";t[t["e"]=101]="e";t[t["f"]=102]="f";t[t["g"]=103]="g";t[t["h"]=104]="h";t[t["i"]=105]="i";t[t["j"]=106]="j";t[t["k"]=107]="k";t[t["l"]=108]="l";t[t["m"]=109]="m";t[t["n"]=110]="n";t[t["o"]=111]="o";t[t["p"]=112]="p";t[t["q"]=113]="q";t[t["r"]=114]="r";t[t["s"]=115]="s";t[t["t"]=116]="t";t[t["u"]=117]="u";t[t["v"]=118]="v";t[t["w"]=119]="w";t[t["x"]=120]="x";t[t["y"]=121]="y";t[t["z"]=122]="z";t[t["OpenCurlyBrace"]=123]="OpenCurlyBrace";t[t["Pipe"]=124]="Pipe";t[t["CloseCurlyBrace"]=125]="CloseCurlyBrace";t[t["Tilde"]=126]="Tilde";t[t["NoBreakSpace"]=160]="NoBreakSpace";t[t["U_Combining_Grave_Accent"]=768]="U_Combining_Grave_Accent";t[t["U_Combining_Acute_Accent"]=769]="U_Combining_Acute_Accent";t[t["U_Combining_Circumflex_Accent"]=770]="U_Combining_Circumflex_Accent";t[t["U_Combining_Tilde"]=771]="U_Combining_Tilde";t[t["U_Combining_Macron"]=772]="U_Combining_Macron";t[t["U_Combining_Overline"]=773]="U_Combining_Overline";t[t["U_Combining_Breve"]=774]="U_Combining_Breve";t[t["U_Combining_Dot_Above"]=775]="U_Combining_Dot_Above";t[t["U_Combining_Diaeresis"]=776]="U_Combining_Diaeresis";t[t["U_Combining_Hook_Above"]=777]="U_Combining_Hook_Above";t[t["U_Combining_Ring_Above"]=778]="U_Combining_Ring_Above";t[t["U_Combining_Double_Acute_Accent"]=779]="U_Combining_Double_Acute_Accent";t[t["U_Combining_Caron"]=780]="U_Combining_Caron";t[t["U_Combining_Vertical_Line_Above"]=781]="U_Combining_Vertical_Line_Above";t[t["U_Combining_Double_Vertical_Line_Above"]=782]="U_Combining_Double_Vertical_Line_Above";t[t["U_Combining_Double_Grave_Accent"]=783]="U_Combining_Double_Grave_Accent";t[t["U_Combining_Candrabindu"]=784]="U_Combining_Candrabindu";t[t["U_Combining_Inverted_Breve"]=785]="U_Combining_Inverted_Breve";t[t["U_Combining_Turned_Comma_Above"]=786]="U_Combining_Turned_Comma_Above";t[t["U_Combining_Comma_Above"]=787]="U_Combining_Comma_Above";t[t["U_Combining_Reversed_Comma_Above"]=788]="U_Combining_Reversed_Comma_Above";t[t["U_Combining_Comma_Above_Right"]=789]="U_Combining_Comma_Above_Right";t[t["U_Combining_Grave_Accent_Below"]=790]="U_Combining_Grave_Accent_Below";t[t["U_Combining_Acute_Accent_Below"]=791]="U_Combining_Acute_Accent_Below";t[t["U_Combining_Left_Tack_Below"]=792]="U_Combining_Left_Tack_Below";t[t["U_Combining_Right_Tack_Below"]=793]="U_Combining_Right_Tack_Below";t[t["U_Combining_Left_Angle_Above"]=794]="U_Combining_Left_Angle_Above";t[t["U_Combining_Horn"]=795]="U_Combining_Horn";t[t["U_Combining_Left_Half_Ring_Below"]=796]="U_Combining_Left_Half_Ring_Below";t[t["U_Combining_Up_Tack_Below"]=797]="U_Combining_Up_Tack_Below";t[t["U_Combining_Down_Tack_Below"]=798]="U_Combining_Down_Tack_Below";t[t["U_Combining_Plus_Sign_Below"]=799]="U_Combining_Plus_Sign_Below";t[t["U_Combining_Minus_Sign_Below"]=800]="U_Combining_Minus_Sign_Below";t[t["U_Combining_Palatalized_Hook_Below"]=801]="U_Combining_Palatalized_Hook_Below";t[t["U_Combining_Retroflex_Hook_Below"]=802]="U_Combining_Retroflex_Hook_Below";t[t["U_Combining_Dot_Below"]=803]="U_Combining_Dot_Below";t[t["U_Combining_Diaeresis_Below"]=804]="U_Combining_Diaeresis_Below";t[t["U_Combining_Ring_Below"]=805]="U_Combining_Ring_Below";t[t["U_Combining_Comma_Below"]=806]="U_Combining_Comma_Below";t[t["U_Combining_Cedilla"]=807]="U_Combining_Cedilla";t[t["U_Combining_Ogonek"]=808]="U_Combining_Ogonek";t[t["U_Combining_Vertical_Line_Below"]=809]="U_Combining_Vertical_Line_Below";t[t["U_Combining_Bridge_Below"]=810]="U_Combining_Bridge_Below";t[t["U_Combining_Inverted_Double_Arch_Below"]=811]="U_Combining_Inverted_Double_Arch_Below";t[t["U_Combining_Caron_Below"]=812]="U_Combining_Caron_Below";t[t["U_Combining_Circumflex_Accent_Below"]=813]="U_Combining_Circumflex_Accent_Below";t[t["U_Combining_Breve_Below"]=814]="U_Combining_Breve_Below";t[t["U_Combining_Inverted_Breve_Below"]=815]="U_Combining_Inverted_Breve_Below";t[t["U_Combining_Tilde_Below"]=816]="U_Combining_Tilde_Below";t[t["U_Combining_Macron_Below"]=817]="U_Combining_Macron_Below";t[t["U_Combining_Low_Line"]=818]="U_Combining_Low_Line";t[t["U_Combining_Double_Low_Line"]=819]="U_Combining_Double_Low_Line";t[t["U_Combining_Tilde_Overlay"]=820]="U_Combining_Tilde_Overlay";t[t["U_Combining_Short_Stroke_Overlay"]=821]="U_Combining_Short_Stroke_Overlay";t[t["U_Combining_Long_Stroke_Overlay"]=822]="U_Combining_Long_Stroke_Overlay";t[t["U_Combining_Short_Solidus_Overlay"]=823]="U_Combining_Short_Solidus_Overlay";t[t["U_Combining_Long_Solidus_Overlay"]=824]="U_Combining_Long_Solidus_Overlay";t[t["U_Combining_Right_Half_Ring_Below"]=825]="U_Combining_Right_Half_Ring_Below";t[t["U_Combining_Inverted_Bridge_Below"]=826]="U_Combining_Inverted_Bridge_Below";t[t["U_Combining_Square_Below"]=827]="U_Combining_Square_Below";t[t["U_Combining_Seagull_Below"]=828]="U_Combining_Seagull_Below";t[t["U_Combining_X_Above"]=829]="U_Combining_X_Above";t[t["U_Combining_Vertical_Tilde"]=830]="U_Combining_Vertical_Tilde";t[t["U_Combining_Double_Overline"]=831]="U_Combining_Double_Overline";t[t["U_Combining_Grave_Tone_Mark"]=832]="U_Combining_Grave_Tone_Mark";t[t["U_Combining_Acute_Tone_Mark"]=833]="U_Combining_Acute_Tone_Mark";t[t["U_Combining_Greek_Perispomeni"]=834]="U_Combining_Greek_Perispomeni";t[t["U_Combining_Greek_Koronis"]=835]="U_Combining_Greek_Koronis";t[t["U_Combining_Greek_Dialytika_Tonos"]=836]="U_Combining_Greek_Dialytika_Tonos";t[t["U_Combining_Greek_Ypogegrammeni"]=837]="U_Combining_Greek_Ypogegrammeni";t[t["U_Combining_Bridge_Above"]=838]="U_Combining_Bridge_Above";t[t["U_Combining_Equals_Sign_Below"]=839]="U_Combining_Equals_Sign_Below";t[t["U_Combining_Double_Vertical_Line_Below"]=840]="U_Combining_Double_Vertical_Line_Below";t[t["U_Combining_Left_Angle_Below"]=841]="U_Combining_Left_Angle_Below";t[t["U_Combining_Not_Tilde_Above"]=842]="U_Combining_Not_Tilde_Above";t[t["U_Combining_Homothetic_Above"]=843]="U_Combining_Homothetic_Above";t[t["U_Combining_Almost_Equal_To_Above"]=844]="U_Combining_Almost_Equal_To_Above";t[t["U_Combining_Left_Right_Arrow_Below"]=845]="U_Combining_Left_Right_Arrow_Below";t[t["U_Combining_Upwards_Arrow_Below"]=846]="U_Combining_Upwards_Arrow_Below";t[t["U_Combining_Grapheme_Joiner"]=847]="U_Combining_Grapheme_Joiner";t[t["U_Combining_Right_Arrowhead_Above"]=848]="U_Combining_Right_Arrowhead_Above";t[t["U_Combining_Left_Half_Ring_Above"]=849]="U_Combining_Left_Half_Ring_Above";t[t["U_Combining_Fermata"]=850]="U_Combining_Fermata";t[t["U_Combining_X_Below"]=851]="U_Combining_X_Below";t[t["U_Combining_Left_Arrowhead_Below"]=852]="U_Combining_Left_Arrowhead_Below";t[t["U_Combining_Right_Arrowhead_Below"]=853]="U_Combining_Right_Arrowhead_Below";t[t["U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below"]=854]="U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below";t[t["U_Combining_Right_Half_Ring_Above"]=855]="U_Combining_Right_Half_Ring_Above";t[t["U_Combining_Dot_Above_Right"]=856]="U_Combining_Dot_Above_Right";t[t["U_Combining_Asterisk_Below"]=857]="U_Combining_Asterisk_Below";t[t["U_Combining_Double_Ring_Below"]=858]="U_Combining_Double_Ring_Below";t[t["U_Combining_Zigzag_Above"]=859]="U_Combining_Zigzag_Above";t[t["U_Combining_Double_Breve_Below"]=860]="U_Combining_Double_Breve_Below";t[t["U_Combining_Double_Breve"]=861]="U_Combining_Double_Breve";t[t["U_Combining_Double_Macron"]=862]="U_Combining_Double_Macron";t[t["U_Combining_Double_Macron_Below"]=863]="U_Combining_Double_Macron_Below";t[t["U_Combining_Double_Tilde"]=864]="U_Combining_Double_Tilde";t[t["U_Combining_Double_Inverted_Breve"]=865]="U_Combining_Double_Inverted_Breve";t[t["U_Combining_Double_Rightwards_Arrow_Below"]=866]="U_Combining_Double_Rightwards_Arrow_Below";t[t["U_Combining_Latin_Small_Letter_A"]=867]="U_Combining_Latin_Small_Letter_A";t[t["U_Combining_Latin_Small_Letter_E"]=868]="U_Combining_Latin_Small_Letter_E";t[t["U_Combining_Latin_Small_Letter_I"]=869]="U_Combining_Latin_Small_Letter_I";t[t["U_Combining_Latin_Small_Letter_O"]=870]="U_Combining_Latin_Small_Letter_O";t[t["U_Combining_Latin_Small_Letter_U"]=871]="U_Combining_Latin_Small_Letter_U";t[t["U_Combining_Latin_Small_Letter_C"]=872]="U_Combining_Latin_Small_Letter_C";t[t["U_Combining_Latin_Small_Letter_D"]=873]="U_Combining_Latin_Small_Letter_D";t[t["U_Combining_Latin_Small_Letter_H"]=874]="U_Combining_Latin_Small_Letter_H";t[t["U_Combining_Latin_Small_Letter_M"]=875]="U_Combining_Latin_Small_Letter_M";t[t["U_Combining_Latin_Small_Letter_R"]=876]="U_Combining_Latin_Small_Letter_R";t[t["U_Combining_Latin_Small_Letter_T"]=877]="U_Combining_Latin_Small_Letter_T";t[t["U_Combining_Latin_Small_Letter_V"]=878]="U_Combining_Latin_Small_Letter_V";t[t["U_Combining_Latin_Small_Letter_X"]=879]="U_Combining_Latin_Small_Letter_X";t[t["LINE_SEPARATOR"]=8232]="LINE_SEPARATOR";t[t["PARAGRAPH_SEPARATOR"]=8233]="PARAGRAPH_SEPARATOR";t[t["NEXT_LINE"]=133]="NEXT_LINE";t[t["U_CIRCUMFLEX"]=94]="U_CIRCUMFLEX";t[t["U_GRAVE_ACCENT"]=96]="U_GRAVE_ACCENT";t[t["U_DIAERESIS"]=168]="U_DIAERESIS";t[t["U_MACRON"]=175]="U_MACRON";t[t["U_ACUTE_ACCENT"]=180]="U_ACUTE_ACCENT";t[t["U_CEDILLA"]=184]="U_CEDILLA";t[t["U_MODIFIER_LETTER_LEFT_ARROWHEAD"]=706]="U_MODIFIER_LETTER_LEFT_ARROWHEAD";t[t["U_MODIFIER_LETTER_RIGHT_ARROWHEAD"]=707]="U_MODIFIER_LETTER_RIGHT_ARROWHEAD";t[t["U_MODIFIER_LETTER_UP_ARROWHEAD"]=708]="U_MODIFIER_LETTER_UP_ARROWHEAD";t[t["U_MODIFIER_LETTER_DOWN_ARROWHEAD"]=709]="U_MODIFIER_LETTER_DOWN_ARROWHEAD";t[t["U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING"]=722]="U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING";t[t["U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING"]=723]="U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING";t[t["U_MODIFIER_LETTER_UP_TACK"]=724]="U_MODIFIER_LETTER_UP_TACK";t[t["U_MODIFIER_LETTER_DOWN_TACK"]=725]="U_MODIFIER_LETTER_DOWN_TACK";t[t["U_MODIFIER_LETTER_PLUS_SIGN"]=726]="U_MODIFIER_LETTER_PLUS_SIGN";t[t["U_MODIFIER_LETTER_MINUS_SIGN"]=727]="U_MODIFIER_LETTER_MINUS_SIGN";t[t["U_BREVE"]=728]="U_BREVE";t[t["U_DOT_ABOVE"]=729]="U_DOT_ABOVE";t[t["U_RING_ABOVE"]=730]="U_RING_ABOVE";t[t["U_OGONEK"]=731]="U_OGONEK";t[t["U_SMALL_TILDE"]=732]="U_SMALL_TILDE";t[t["U_DOUBLE_ACUTE_ACCENT"]=733]="U_DOUBLE_ACUTE_ACCENT";t[t["U_MODIFIER_LETTER_RHOTIC_HOOK"]=734]="U_MODIFIER_LETTER_RHOTIC_HOOK";t[t["U_MODIFIER_LETTER_CROSS_ACCENT"]=735]="U_MODIFIER_LETTER_CROSS_ACCENT";t[t["U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR"]=741]="U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR";t[t["U_MODIFIER_LETTER_HIGH_TONE_BAR"]=742]="U_MODIFIER_LETTER_HIGH_TONE_BAR";t[t["U_MODIFIER_LETTER_MID_TONE_BAR"]=743]="U_MODIFIER_LETTER_MID_TONE_BAR";t[t["U_MODIFIER_LETTER_LOW_TONE_BAR"]=744]="U_MODIFIER_LETTER_LOW_TONE_BAR";t[t["U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR"]=745]="U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR";t[t["U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK"]=746]="U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK";t[t["U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK"]=747]="U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK";t[t["U_MODIFIER_LETTER_UNASPIRATED"]=749]="U_MODIFIER_LETTER_UNASPIRATED";t[t["U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD"]=751]="U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD";t[t["U_MODIFIER_LETTER_LOW_UP_ARROWHEAD"]=752]="U_MODIFIER_LETTER_LOW_UP_ARROWHEAD";t[t["U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD"]=753]="U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD";t[t["U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD"]=754]="U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD";t[t["U_MODIFIER_LETTER_LOW_RING"]=755]="U_MODIFIER_LETTER_LOW_RING";t[t["U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT"]=756]="U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT";t[t["U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT"]=757]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT";t[t["U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT"]=758]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT";t[t["U_MODIFIER_LETTER_LOW_TILDE"]=759]="U_MODIFIER_LETTER_LOW_TILDE";t[t["U_MODIFIER_LETTER_RAISED_COLON"]=760]="U_MODIFIER_LETTER_RAISED_COLON";t[t["U_MODIFIER_LETTER_BEGIN_HIGH_TONE"]=761]="U_MODIFIER_LETTER_BEGIN_HIGH_TONE";t[t["U_MODIFIER_LETTER_END_HIGH_TONE"]=762]="U_MODIFIER_LETTER_END_HIGH_TONE";t[t["U_MODIFIER_LETTER_BEGIN_LOW_TONE"]=763]="U_MODIFIER_LETTER_BEGIN_LOW_TONE";t[t["U_MODIFIER_LETTER_END_LOW_TONE"]=764]="U_MODIFIER_LETTER_END_LOW_TONE";t[t["U_MODIFIER_LETTER_SHELF"]=765]="U_MODIFIER_LETTER_SHELF";t[t["U_MODIFIER_LETTER_OPEN_SHELF"]=766]="U_MODIFIER_LETTER_OPEN_SHELF";t[t["U_MODIFIER_LETTER_LOW_LEFT_ARROW"]=767]="U_MODIFIER_LETTER_LOW_LEFT_ARROW";t[t["U_GREEK_LOWER_NUMERAL_SIGN"]=885]="U_GREEK_LOWER_NUMERAL_SIGN";t[t["U_GREEK_TONOS"]=900]="U_GREEK_TONOS";t[t["U_GREEK_DIALYTIKA_TONOS"]=901]="U_GREEK_DIALYTIKA_TONOS";t[t["U_GREEK_KORONIS"]=8125]="U_GREEK_KORONIS";t[t["U_GREEK_PSILI"]=8127]="U_GREEK_PSILI";t[t["U_GREEK_PERISPOMENI"]=8128]="U_GREEK_PERISPOMENI";t[t["U_GREEK_DIALYTIKA_AND_PERISPOMENI"]=8129]="U_GREEK_DIALYTIKA_AND_PERISPOMENI";t[t["U_GREEK_PSILI_AND_VARIA"]=8141]="U_GREEK_PSILI_AND_VARIA";t[t["U_GREEK_PSILI_AND_OXIA"]=8142]="U_GREEK_PSILI_AND_OXIA";t[t["U_GREEK_PSILI_AND_PERISPOMENI"]=8143]="U_GREEK_PSILI_AND_PERISPOMENI";t[t["U_GREEK_DASIA_AND_VARIA"]=8157]="U_GREEK_DASIA_AND_VARIA";t[t["U_GREEK_DASIA_AND_OXIA"]=8158]="U_GREEK_DASIA_AND_OXIA";t[t["U_GREEK_DASIA_AND_PERISPOMENI"]=8159]="U_GREEK_DASIA_AND_PERISPOMENI";t[t["U_GREEK_DIALYTIKA_AND_VARIA"]=8173]="U_GREEK_DIALYTIKA_AND_VARIA";t[t["U_GREEK_DIALYTIKA_AND_OXIA"]=8174]="U_GREEK_DIALYTIKA_AND_OXIA";t[t["U_GREEK_VARIA"]=8175]="U_GREEK_VARIA";t[t["U_GREEK_OXIA"]=8189]="U_GREEK_OXIA";t[t["U_GREEK_DASIA"]=8190]="U_GREEK_DASIA";t[t["U_IDEOGRAPHIC_FULL_STOP"]=12290]="U_IDEOGRAPHIC_FULL_STOP";t[t["U_LEFT_CORNER_BRACKET"]=12300]="U_LEFT_CORNER_BRACKET";t[t["U_RIGHT_CORNER_BRACKET"]=12301]="U_RIGHT_CORNER_BRACKET";t[t["U_LEFT_BLACK_LENTICULAR_BRACKET"]=12304]="U_LEFT_BLACK_LENTICULAR_BRACKET";t[t["U_RIGHT_BLACK_LENTICULAR_BRACKET"]=12305]="U_RIGHT_BLACK_LENTICULAR_BRACKET";t[t["U_OVERLINE"]=8254]="U_OVERLINE";t[t["UTF8_BOM"]=65279]="UTF8_BOM";t[t["U_FULLWIDTH_SEMICOLON"]=65307]="U_FULLWIDTH_SEMICOLON";t[t["U_FULLWIDTH_COMMA"]=65292]="U_FULLWIDTH_COMMA"})(M||(M={}));var nt;(function(t){t[t["Uri"]=1]="Uri";t[t["Regexp"]=2]="Regexp";t[t["ScmResource"]=3]="ScmResource";t[t["ScmResourceGroup"]=4]="ScmResourceGroup";t[t["ScmProvider"]=5]="ScmProvider";t[t["CommentController"]=6]="CommentController";t[t["CommentThread"]=7]="CommentThread";t[t["CommentThreadInstance"]=8]="CommentThreadInstance";t[t["CommentThreadReply"]=9]="CommentThreadReply";t[t["CommentNode"]=10]="CommentNode";t[t["CommentThreadNode"]=11]="CommentThreadNode";t[t["TimelineActionContext"]=12]="TimelineActionContext";t[t["NotebookCellActionContext"]=13]="NotebookCellActionContext";t[t["NotebookActionContext"]=14]="NotebookActionContext";t[t["TerminalContext"]=15]="TerminalContext";t[t["TestItemContext"]=16]="TestItemContext";t[t["Date"]=17]="Date";t[t["TestMessageMenuArgs"]=18]="TestMessageMenuArgs";t[t["ChatViewContext"]=19]="ChatViewContext";t[t["LanguageModelToolResult"]=20]="LanguageModelToolResult";t[t["LanguageModelTextPart"]=21]="LanguageModelTextPart";t[t["LanguageModelThinkingPart"]=22]="LanguageModelThinkingPart";t[t["LanguageModelPromptTsxPart"]=23]="LanguageModelPromptTsxPart";t[t["LanguageModelDataPart"]=24]="LanguageModelDataPart";t[t["AgentSessionContext"]=25]="AgentSessionContext";t[t["ChatResponsePullRequestPart"]=26]="ChatResponsePullRequestPart"})(nt||(nt={}));function HR(){return globalThis._VSCODE_NLS_MESSAGES}function GT(){return globalThis._VSCODE_NLS_LANGUAGE}const BR=GT()==="pseudo"||typeof document!=="undefined"&&document.location&&typeof document.location.hash==="string"&&document.location.hash.indexOf("pseudo=true")>=0;function Mp(t,e){let i;if(e.length===0){i=t}else{i=t.replace(/\{(\d+)\}/g,(n,s)=>{const r=s[0];const o=e[r];let a=n;if(typeof o==="string"){a=o}else if(typeof o==="number"||typeof o==="boolean"||o===void 0||o===null){a=String(o)}return a})}if(BR){i=""+i.replace(/[aouei]/g,"$&$&")+""}return i}function h(t,e,...i){if(typeof t==="number"){return Mp(KT(t,e),i)}return Mp(e,i)}function KT(t,e){const i=HR()?.[t];if(typeof i!=="string"){if(typeof e==="string"){return e}throw new Error(`!!! NLS MISSING: ${t} !!!`)}return i}function I_(t,e,...i){let n;if(typeof t==="number"){n=KT(t,e)}else{n=e}const s=Mp(n,i);return{value:s,original:e===n?s:Mp(e,i)}}const xo="en";let Vd=false;let zd=false;let cd=false;let QT=false;let yS=false;let SS=false;let JT=false;let YT=false;let kf=void 0;let ep=xo;let fE=xo;let WR=void 0;let mr=void 0;const Hr=globalThis;let xn=void 0;if(typeof Hr.vscode!=="undefined"&&typeof Hr.vscode.process!=="undefined"){xn=Hr.vscode.process}else if(typeof process!=="undefined"&&typeof process?.versions?.node==="string"){xn=process}const VR=typeof xn?.versions?.electron==="string";const zR=VR&&xn?.type==="renderer";if(typeof xn==="object"){Vd=xn.platform==="win32";zd=xn.platform==="darwin";cd=xn.platform==="linux";cd&&!!xn.env["SNAP"]&&!!xn.env["SNAP_REVISION"];JT=!!xn.env["CI"]||!!xn.env["BUILD_ARTIFACTSTAGINGDIRECTORY"]||!!xn.env["GITHUB_WORKSPACE"];kf=xo;ep=xo;const t=xn.env["VSCODE_NLS_CONFIG"];if(t){try{const e=JSON.parse(t);kf=e.userLocale;fE=e.osLocale;ep=e.resolvedLanguage||xo;WR=e.languagePack?.translationsConfigFile}catch(e){}}QT=true}else if(typeof navigator==="object"&&!zR){mr=navigator.userAgent;Vd=mr.indexOf("Windows")>=0;zd=mr.indexOf("Macintosh")>=0;SS=(mr.indexOf("Macintosh")>=0||mr.indexOf("iPad")>=0||mr.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0;cd=mr.indexOf("Linux")>=0;YT=mr?.indexOf("Mobi")>=0;yS=true;ep=GT()||xo;kf=navigator.language.toLowerCase();fE=kf}else{console.error("Unable to resolve platform.")}var xs;(function(t){t[t["Web"]=0]="Web";t[t["Mac"]=1]="Mac";t[t["Linux"]=2]="Linux";t[t["Windows"]=3]="Windows"})(xs||(xs={}));function qR(t){switch(t){case xs.Web:return"Web";case xs.Mac:return"Mac";case xs.Linux:return"Linux";case xs.Windows:return"Windows"}}xs.Web;if(zd){xs.Mac}else if(Vd){xs.Windows}else if(cd){xs.Linux}const nn=Vd;const vn=zd;const Fo=cd;const XT=QT;const _u=yS;const qd=yS&&typeof Hr.importScripts==="function";const jR=qd?Hr.origin:void 0;const GR=SS;const KR=YT;const sa=JT;const cr=mr;const Xr=ep;var pE;(function(t){function e(){return Xr}t.value=e;function i(){if(Xr.length===2){return Xr==="en"}else if(Xr.length>=3){return Xr[0]==="e"&&Xr[1]==="n"&&Xr[2]==="-"}else{return false}}t.isDefaultVariant=i;function n(){return Xr==="en"}t.isDefault=n})(pE||(pE={}));const QR=typeof Hr.postMessage==="function"&&!Hr.importScripts;const ZT=(()=>{if(QR){const t=[];Hr.addEventListener("message",i=>{if(i.data&&i.data.vscodeScheduleAsyncWork){for(let n=0,s=t.length;n<s;n++){const r=t[n];if(r.id===i.data.vscodeScheduleAsyncWork){t.splice(n,1);r.callback();return}}}});let e=0;return i=>{const n=++e;t.push({id:n,callback:i});Hr.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})();var Hn;(function(t){t[t["Windows"]=1]="Windows";t[t["Macintosh"]=2]="Macintosh";t[t["Linux"]=3]="Linux"})(Hn||(Hn={}));const Xu=zd||SS?Hn.Macintosh:Vd?Hn.Windows:Hn.Linux;let gE=true;let mE=false;function e4(){if(!mE){mE=true;const t=new Uint8Array(2);t[0]=1;t[1]=2;const e=new Uint16Array(t.buffer);gE=e[0]===(2<<8)+1}return gE}const xS=!!(cr&&cr.indexOf("Chrome")>=0);const JR=!!(cr&&cr.indexOf("Firefox")>=0);const YR=!!(!xS&&(cr&&cr.indexOf("Safari")>=0));const t4=!!(cr&&cr.indexOf("Edg/")>=0);!!(cr&&cr.indexOf("Android")>=0);var _E={};let Ha;const Rv=globalThis.vscode;if(typeof Rv!=="undefined"&&typeof Rv.process!=="undefined"){const t=Rv.process;Ha={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd(){return t.cwd()}}}else if(typeof process!=="undefined"&&typeof process?.versions?.node==="string"){Ha={get platform(){return process.platform},get arch(){return process.arch},get env(){return _E},cwd(){return _E["VSCODE_CWD"]||process.cwd()}}}else{Ha={get platform(){return nn?"win32":vn?"darwin":"linux"},get arch(){return void 0},get env(){return{}},cwd(){return"/"}}}const Nc=Ha.cwd;const jd=Ha.env;const XR=Ha.platform;Ha.arch;const ZR=65;const eL=97;const tL=90;const iL=122;const Ba=46;const Ri=47;const Sn=92;const hr=58;const nL=63;class i4 extends Error{constructor(e,i,n){let s;if(typeof i==="string"&&i.indexOf("not ")===0){s="must not be";i=i.replace(/^not /,"")}else{s="must be"}const r=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${r} ${s} of type ${i}`;o+=`. Received type ${typeof n}`;super(o);this.code="ERR_INVALID_ARG_TYPE"}}function sL(t,e){if(t===null||typeof t!=="object"){throw new i4(e,"Object",t)}}function si(t,e){if(typeof t!=="string"){throw new i4(e,"string",t)}}const Fs=XR==="win32";function Qe(t){return t===Ri||t===Sn}function P1(t){return t===Ri}function fr(t){return t>=ZR&&t<=tL||t>=eL&&t<=iL}function Op(t,e,i,n){let s="";let r=0;let o=-1;let a=0;let l=0;for(let c=0;c<=t.length;++c){if(c<t.length){l=t.charCodeAt(c)}else if(n(l)){break}else{l=Ri}if(n(l)){if(o===c-1||a===1);else if(a===2){if(s.length<2||r!==2||s.charCodeAt(s.length-1)!==Ba||s.charCodeAt(s.length-2)!==Ba){if(s.length>2){const u=s.lastIndexOf(i);if(u===-1){s="";r=0}else{s=s.slice(0,u);r=s.length-1-s.lastIndexOf(i)}o=c;a=0;continue}else if(s.length!==0){s="";r=0;o=c;a=0;continue}}if(e){s+=s.length>0?`${i}..`:"..";r=2}}else{if(s.length>0){s+=`${i}${t.slice(o+1,c)}`}else{s=t.slice(o+1,c)}r=c-o-1}o=c;a=0}else if(l===Ba&&a!==-1){++a}else{a=-1}}return s}function rL(t){return t?`${t[0]==="."?"":"."}${t}`:""}function n4(t,e){sL(e,"pathObject");const i=e.dir||e.root;const n=e.base||`${e.name||""}${rL(e.ext)}`;if(!i){return n}return i===e.root?`${i}${n}`:`${i}${t}${n}`}const Bi={resolve(...t){let e="";let i="";let n=false;for(let s=t.length-1;s>=-1;s--){let r;if(s>=0){r=t[s];si(r,`paths[${s}]`);if(r.length===0){continue}}else if(e.length===0){r=Nc()}else{r=jd[`=${e}`]||Nc();if(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===Sn){r=`${e}\\`}}const o=r.length;let a=0;let l="";let c=false;const u=r.charCodeAt(0);if(o===1){if(Qe(u)){a=1;c=true}}else if(Qe(u)){c=true;if(Qe(r.charCodeAt(1))){let d=2;let f=d;while(d<o&&!Qe(r.charCodeAt(d))){d++}if(d<o&&d!==f){const p=r.slice(f,d);f=d;while(d<o&&Qe(r.charCodeAt(d))){d++}if(d<o&&d!==f){f=d;while(d<o&&!Qe(r.charCodeAt(d))){d++}if(d===o||d!==f){l=`\\\\${p}\\${r.slice(f,d)}`;a=d}}}}else{a=1}}else if(fr(u)&&r.charCodeAt(1)===hr){l=r.slice(0,2);a=2;if(o>2&&Qe(r.charCodeAt(2))){c=true;a=3}}if(l.length>0){if(e.length>0){if(l.toLowerCase()!==e.toLowerCase()){continue}}else{e=l}}if(n){if(e.length>0){break}}else{i=`${r.slice(a)}\\${i}`;n=c;if(c&&e.length>0){break}}}i=Op(i,!n,"\\",Qe);return n?`${e}\\${i}`:`${e}${i}`||"."},normalize(t){si(t,"path");const e=t.length;if(e===0){return"."}let i=0;let n;let s=false;const r=t.charCodeAt(0);if(e===1){return P1(r)?"\\":t}if(Qe(r)){s=true;if(Qe(t.charCodeAt(1))){let a=2;let l=a;while(a<e&&!Qe(t.charCodeAt(a))){a++}if(a<e&&a!==l){const c=t.slice(l,a);l=a;while(a<e&&Qe(t.charCodeAt(a))){a++}if(a<e&&a!==l){l=a;while(a<e&&!Qe(t.charCodeAt(a))){a++}if(a===e){return`\\\\${c}\\${t.slice(l)}\\`}if(a!==l){n=`\\\\${c}\\${t.slice(l,a)}`;i=a}}}}else{i=1}}else if(fr(r)&&t.charCodeAt(1)===hr){n=t.slice(0,2);i=2;if(e>2&&Qe(t.charCodeAt(2))){s=true;i=3}}let o=i<e?Op(t.slice(i),!s,"\\",Qe):"";if(o.length===0&&!s){o="."}if(o.length>0&&Qe(t.charCodeAt(e-1))){o+="\\"}if(!s&&n===void 0&&t.includes(":")){if(o.length>=2&&fr(o.charCodeAt(0))&&o.charCodeAt(1)===hr){return`.\\${o}`}let a=t.indexOf(":");do{if(a===e-1||Qe(t.charCodeAt(a+1))){return`.\\${o}`}}while((a=t.indexOf(":",a+1))!==-1)}if(n===void 0){return s?`\\${o}`:o}return s?`${n}\\${o}`:`${n}${o}`},isAbsolute(t){si(t,"path");const e=t.length;if(e===0){return false}const i=t.charCodeAt(0);return Qe(i)||e>2&&fr(i)&&t.charCodeAt(1)===hr&&Qe(t.charCodeAt(2))},join(...t){if(t.length===0){return"."}let e;let i;for(let r=0;r<t.length;++r){const o=t[r];si(o,"path");if(o.length>0){if(e===void 0){e=i=o}else{e+=`\\${o}`}}}if(e===void 0){return"."}let n=true;let s=0;if(typeof i==="string"&&Qe(i.charCodeAt(0))){++s;const r=i.length;if(r>1&&Qe(i.charCodeAt(1))){++s;if(r>2){if(Qe(i.charCodeAt(2))){++s}else{n=false}}}}if(n){while(s<e.length&&Qe(e.charCodeAt(s))){s++}if(s>=2){e=`\\${e.slice(s)}`}}return Bi.normalize(e)},relative(t,e){si(t,"from");si(e,"to");if(t===e){return""}const i=Bi.resolve(t);const n=Bi.resolve(e);if(i===n){return""}t=i.toLowerCase();e=n.toLowerCase();if(t===e){return""}if(i.length!==t.length||n.length!==e.length){const m=i.split("\\");const v=n.split("\\");if(m[m.length-1]===""){m.pop()}if(v[v.length-1]===""){v.pop()}const y=m.length;const k=v.length;const S=y<k?y:k;let R;for(R=0;R<S;R++){if(m[R].toLowerCase()!==v[R].toLowerCase()){break}}if(R===0){return n}else if(R===S){if(k>S){return v.slice(R).join("\\")}if(y>S){return"..\\".repeat(y-1-R)+".."}return""}return"..\\".repeat(y-R)+v.slice(R).join("\\")}let s=0;while(s<t.length&&t.charCodeAt(s)===Sn){s++}let r=t.length;while(r-1>s&&t.charCodeAt(r-1)===Sn){r--}const o=r-s;let a=0;while(a<e.length&&e.charCodeAt(a)===Sn){a++}let l=e.length;while(l-1>a&&e.charCodeAt(l-1)===Sn){l--}const c=l-a;const u=o<c?o:c;let d=-1;let f=0;for(;f<u;f++){const m=t.charCodeAt(s+f);if(m!==e.charCodeAt(a+f)){break}else if(m===Sn){d=f}}if(f!==u){if(d===-1){return n}}else{if(c>u){if(e.charCodeAt(a+f)===Sn){return n.slice(a+f+1)}if(f===2){return n.slice(a+f)}}if(o>u){if(t.charCodeAt(s+f)===Sn){d=f}else if(f===2){d=3}}if(d===-1){d=0}}let p="";for(f=s+d+1;f<=r;++f){if(f===r||t.charCodeAt(f)===Sn){p+=p.length===0?"..":"\\.."}}a+=d;if(p.length>0){return`${p}${n.slice(a,l)}`}if(n.charCodeAt(a)===Sn){++a}return n.slice(a,l)},toNamespacedPath(t){if(typeof t!=="string"||t.length===0){return t}const e=Bi.resolve(t);if(e.length<=2){return t}if(e.charCodeAt(0)===Sn){if(e.charCodeAt(1)===Sn){const i=e.charCodeAt(2);if(i!==nL&&i!==Ba){return`\\\\?\\UNC\\${e.slice(2)}`}}}else if(fr(e.charCodeAt(0))&&e.charCodeAt(1)===hr&&e.charCodeAt(2)===Sn){return`\\\\?\\${e}`}return e},dirname(t){si(t,"path");const e=t.length;if(e===0){return"."}let i=-1;let n=0;const s=t.charCodeAt(0);if(e===1){return Qe(s)?t:"."}if(Qe(s)){i=n=1;if(Qe(t.charCodeAt(1))){let a=2;let l=a;while(a<e&&!Qe(t.charCodeAt(a))){a++}if(a<e&&a!==l){l=a;while(a<e&&Qe(t.charCodeAt(a))){a++}if(a<e&&a!==l){l=a;while(a<e&&!Qe(t.charCodeAt(a))){a++}if(a===e){return t}if(a!==l){i=n=a+1}}}}}else if(fr(s)&&t.charCodeAt(1)===hr){i=e>2&&Qe(t.charCodeAt(2))?3:2;n=i}let r=-1;let o=true;for(let a=e-1;a>=n;--a){if(Qe(t.charCodeAt(a))){if(!o){r=a;break}}else{o=false}}if(r===-1){if(i===-1){return"."}r=i}return t.slice(0,r)},basename(t,e){if(e!==void 0){si(e,"suffix")}si(t,"path");let i=0;let n=-1;let s=true;let r;if(t.length>=2&&fr(t.charCodeAt(0))&&t.charCodeAt(1)===hr){i=2}if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t){return""}let o=e.length-1;let a=-1;for(r=t.length-1;r>=i;--r){const l=t.charCodeAt(r);if(Qe(l)){if(!s){i=r+1;break}}else{if(a===-1){s=false;a=r+1}if(o>=0){if(l===e.charCodeAt(o)){if(--o===-1){n=r}}else{o=-1;n=a}}}}if(i===n){n=a}else if(n===-1){n=t.length}return t.slice(i,n)}for(r=t.length-1;r>=i;--r){if(Qe(t.charCodeAt(r))){if(!s){i=r+1;break}}else if(n===-1){s=false;n=r+1}}if(n===-1){return""}return t.slice(i,n)},extname(t){si(t,"path");let e=0;let i=-1;let n=0;let s=-1;let r=true;let o=0;if(t.length>=2&&t.charCodeAt(1)===hr&&fr(t.charCodeAt(0))){e=n=2}for(let a=t.length-1;a>=e;--a){const l=t.charCodeAt(a);if(Qe(l)){if(!r){n=a+1;break}continue}if(s===-1){r=false;s=a+1}if(l===Ba){if(i===-1){i=a}else if(o!==1){o=1}}else if(i!==-1){o=-1}}if(i===-1||s===-1||o===0||o===1&&i===s-1&&i===n+1){return""}return t.slice(i,s)},format:n4.bind(null,"\\"),parse(t){si(t,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0){return e}const i=t.length;let n=0;let s=t.charCodeAt(0);if(i===1){if(Qe(s)){e.root=e.dir=t;return e}e.base=e.name=t;return e}if(Qe(s)){n=1;if(Qe(t.charCodeAt(1))){let d=2;let f=d;while(d<i&&!Qe(t.charCodeAt(d))){d++}if(d<i&&d!==f){f=d;while(d<i&&Qe(t.charCodeAt(d))){d++}if(d<i&&d!==f){f=d;while(d<i&&!Qe(t.charCodeAt(d))){d++}if(d===i){n=d}else if(d!==f){n=d+1}}}}}else if(fr(s)&&t.charCodeAt(1)===hr){if(i<=2){e.root=e.dir=t;return e}n=2;if(Qe(t.charCodeAt(2))){if(i===3){e.root=e.dir=t;return e}n=3}}if(n>0){e.root=t.slice(0,n)}let r=-1;let o=n;let a=-1;let l=true;let c=t.length-1;let u=0;for(;c>=n;--c){s=t.charCodeAt(c);if(Qe(s)){if(!l){o=c+1;break}continue}if(a===-1){l=false;a=c+1}if(s===Ba){if(r===-1){r=c}else if(u!==1){u=1}}else if(r!==-1){u=-1}}if(a!==-1){if(r===-1||u===0||u===1&&r===a-1&&r===o+1){e.base=e.name=t.slice(o,a)}else{e.name=t.slice(o,r);e.base=t.slice(o,a);e.ext=t.slice(r,a)}}if(o>0&&o!==n){e.dir=t.slice(0,o-1)}else{e.dir=e.root}return e},sep:"\\",delimiter:";",win32:null,posix:null};const oL=(()=>{if(Fs){const t=/\\/g;return()=>{const e=Nc().replace(t,"/");return e.slice(e.indexOf("/"))}}return()=>Nc()})();const mt={resolve(...t){let e="";let i=false;for(let n=t.length-1;n>=0&&!i;n--){const s=t[n];si(s,`paths[${n}]`);if(s.length===0){continue}e=`${s}/${e}`;i=s.charCodeAt(0)===Ri}if(!i){const n=oL();e=`${n}/${e}`;i=n.charCodeAt(0)===Ri}e=Op(e,!i,"/",P1);if(i){return`/${e}`}return e.length>0?e:"."},normalize(t){si(t,"path");if(t.length===0){return"."}const e=t.charCodeAt(0)===Ri;const i=t.charCodeAt(t.length-1)===Ri;t=Op(t,!e,"/",P1);if(t.length===0){if(e){return"/"}return i?"./":"."}if(i){t+="/"}return e?`/${t}`:t},isAbsolute(t){si(t,"path");return t.length>0&&t.charCodeAt(0)===Ri},join(...t){if(t.length===0){return"."}const e=[];for(let i=0;i<t.length;++i){const n=t[i];si(n,"path");if(n.length>0){e.push(n)}}if(e.length===0){return"."}return mt.normalize(e.join("/"))},relative(t,e){si(t,"from");si(e,"to");if(t===e){return""}t=mt.resolve(t);e=mt.resolve(e);if(t===e){return""}const i=1;const n=t.length;const s=n-i;const r=1;const o=e.length-r;const a=s<o?s:o;let l=-1;let c=0;for(;c<a;c++){const d=t.charCodeAt(i+c);if(d!==e.charCodeAt(r+c)){break}else if(d===Ri){l=c}}if(c===a){if(o>a){if(e.charCodeAt(r+c)===Ri){return e.slice(r+c+1)}if(c===0){return e.slice(r+c)}}else if(s>a){if(t.charCodeAt(i+c)===Ri){l=c}else if(c===0){l=0}}}let u="";for(c=i+l+1;c<=n;++c){if(c===n||t.charCodeAt(c)===Ri){u+=u.length===0?"..":"/.."}}return`${u}${e.slice(r+l)}`},toNamespacedPath(t){return t},dirname(t){si(t,"path");if(t.length===0){return"."}const e=t.charCodeAt(0)===Ri;let i=-1;let n=true;for(let s=t.length-1;s>=1;--s){if(t.charCodeAt(s)===Ri){if(!n){i=s;break}}else{n=false}}if(i===-1){return e?"/":"."}if(e&&i===1){return"//"}return t.slice(0,i)},basename(t,e){if(e!==void 0){si(e,"suffix")}si(t,"path");let i=0;let n=-1;let s=true;let r;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t){return""}let o=e.length-1;let a=-1;for(r=t.length-1;r>=0;--r){const l=t.charCodeAt(r);if(l===Ri){if(!s){i=r+1;break}}else{if(a===-1){s=false;a=r+1}if(o>=0){if(l===e.charCodeAt(o)){if(--o===-1){n=r}}else{o=-1;n=a}}}}if(i===n){n=a}else if(n===-1){n=t.length}return t.slice(i,n)}for(r=t.length-1;r>=0;--r){if(t.charCodeAt(r)===Ri){if(!s){i=r+1;break}}else if(n===-1){s=false;n=r+1}}if(n===-1){return""}return t.slice(i,n)},extname(t){si(t,"path");let e=-1;let i=0;let n=-1;let s=true;let r=0;for(let o=t.length-1;o>=0;--o){const a=t[o];if(a==="/"){if(!s){i=o+1;break}continue}if(n===-1){s=false;n=o+1}if(a==="."){if(e===-1){e=o}else if(r!==1){r=1}}else if(e!==-1){r=-1}}if(e===-1||n===-1||r===0||r===1&&e===n-1&&e===i+1){return""}return t.slice(e,n)},format:n4.bind(null,"/"),parse(t){si(t,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0){return e}const i=t.charCodeAt(0)===Ri;let n;if(i){e.root="/";n=1}else{n=0}let s=-1;let r=0;let o=-1;let a=true;let l=t.length-1;let c=0;for(;l>=n;--l){const u=t.charCodeAt(l);if(u===Ri){if(!a){r=l+1;break}continue}if(o===-1){a=false;o=l+1}if(u===Ba){if(s===-1){s=l}else if(c!==1){c=1}}else if(s!==-1){c=-1}}if(o!==-1){const u=r===0&&i?1:r;if(s===-1||c===0||c===1&&s===o-1&&s===r+1){e.base=e.name=t.slice(u,o)}else{e.name=t.slice(u,s);e.base=t.slice(u,o);e.ext=t.slice(s,o)}}if(r>0){e.dir=t.slice(0,r-1)}else if(i){e.dir="/"}return e},sep:"/",delimiter:":",win32:null,posix:null};mt.win32=Bi.win32=Bi;mt.posix=Bi.posix=mt;const Mc=Fs?Bi.normalize:mt.normalize;const Fp=Fs?Bi.isAbsolute:mt.isAbsolute;const A1=Fs?Bi.join:mt.join;const aL=Fs?Bi.resolve:mt.resolve;const Gd=Fs?Bi.relative:mt.relative;const lc=Fs?Bi.dirname:mt.dirname;const kn=Fs?Bi.basename:mt.basename;const Up=Fs?Bi.extname:mt.extname;Fs?Bi.parse:mt.parse;const Yn=Fs?Bi.sep:mt.sep;const lL=/^\w[\w\d+.-]*$/;const cL=/^\//;const uL=/^\/\//;function dL(t,e){if(!t.scheme&&e){throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`)}if(t.scheme&&!lL.test(t.scheme)){throw new Error("[UriError]: Scheme contains illegal characters.")}if(t.path){if(t.authority){if(!cL.test(t.path)){throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}}else{if(uL.test(t.path)){throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}}}function hL(t,e){if(!t&&!e){return"file"}return t}function fL(t,e){switch(t){case"https":case"http":case"file":if(!e){e=_s}else if(e[0]!==_s){e=_s+e}break}return e}const Ut="";const _s="/";const pL=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class b{static isUri(e){if(e instanceof b){return true}if(!e||typeof e!=="object"){return false}return typeof e.authority==="string"&&typeof e.fragment==="string"&&typeof e.path==="string"&&typeof e.query==="string"&&typeof e.scheme==="string"&&typeof e.fsPath==="string"&&typeof e.with==="function"&&typeof e.toString==="function"}constructor(e,i,n,s,r,o=false){if(typeof e==="object"){this.scheme=e.scheme||Ut;this.authority=e.authority||Ut;this.path=e.path||Ut;this.query=e.query||Ut;this.fragment=e.fragment||Ut}else{this.scheme=hL(e,o);this.authority=i||Ut;this.path=fL(this.scheme,n||Ut);this.query=s||Ut;this.fragment=r||Ut;dL(this,o)}}get fsPath(){return Hp(this,false)}with(e){if(!e){return this}let{scheme:i,authority:n,path:s,query:r,fragment:o}=e;if(i===void 0){i=this.scheme}else if(i===null){i=Ut}if(n===void 0){n=this.authority}else if(n===null){n=Ut}if(s===void 0){s=this.path}else if(s===null){s=Ut}if(r===void 0){r=this.query}else if(r===null){r=Ut}if(o===void 0){o=this.fragment}else if(o===null){o=Ut}if(i===this.scheme&&n===this.authority&&s===this.path&&r===this.query&&o===this.fragment){return this}return new Tl(i,n,s,r,o)}static parse(e,i=false){const n=pL.exec(e);if(!n){return new Tl(Ut,Ut,Ut,Ut,Ut)}return new Tl(n[2]||Ut,Df(n[4]||Ut),Df(n[5]||Ut),Df(n[7]||Ut),Df(n[9]||Ut),i)}static file(e){let i=Ut;if(nn){e=e.replace(/\\/g,_s)}if(e[0]===_s&&e[1]===_s){const n=e.indexOf(_s,2);if(n===-1){i=e.substring(2);e=_s}else{i=e.substring(2,n);e=e.substring(n)||_s}}return new Tl("file",i,e,Ut,Ut)}static from(e,i){const n=new Tl(e.scheme,e.authority,e.path,e.query,e.fragment,i);return n}static joinPath(e,...i){if(!e.path){throw new Error(`[UriError]: cannot call joinPath on URI without path`)}let n;if(nn&&e.scheme==="file"){n=b.file(Bi.join(Hp(e,true),...i)).path}else{n=mt.join(e.path,...i)}return e.with({path:n})}toString(e=false){return R1(this,e)}toJSON(){return this}static revive(e){if(!e){return e}else if(e instanceof b){return e}else{const i=new Tl(e);i._formatted=e.external??null;i._fsPath=e._sep===s4?e.fsPath??null:null;return i}}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}}function $p(t){if(!t||typeof t!=="object"){return false}return typeof t.scheme==="string"&&(typeof t.authority==="string"||typeof t.authority==="undefined")&&(typeof t.path==="string"||typeof t.path==="undefined")&&(typeof t.query==="string"||typeof t.query==="undefined")&&(typeof t.fragment==="string"||typeof t.fragment==="undefined")}const s4=nn?1:void 0;class Tl extends b{constructor(){super(...arguments);this._formatted=null;this._fsPath=null}get fsPath(){if(!this._fsPath){this._fsPath=Hp(this,false)}return this._fsPath}toString(e=false){if(!e){if(!this._formatted){this._formatted=R1(this,false)}return this._formatted}else{return R1(this,true)}}toJSON(){const e={$mid:nt.Uri};if(this._fsPath){e.fsPath=this._fsPath;e._sep=s4}if(this._formatted){e.external=this._formatted}if(this.path){e.path=this.path}if(this.scheme){e.scheme=this.scheme}if(this.authority){e.authority=this.authority}if(this.query){e.query=this.query}if(this.fragment){e.fragment=this.fragment}return e}}const r4={[M.Colon]:"%3A",[M.Slash]:"%2F",[M.QuestionMark]:"%3F",[M.Hash]:"%23",[M.OpenSquareBracket]:"%5B",[M.CloseSquareBracket]:"%5D",[M.AtSign]:"%40",[M.ExclamationMark]:"%21",[M.DollarSign]:"%24",[M.Ampersand]:"%26",[M.SingleQuote]:"%27",[M.OpenParen]:"%28",[M.CloseParen]:"%29",[M.Asterisk]:"%2A",[M.Plus]:"%2B",[M.Comma]:"%2C",[M.Semicolon]:"%3B",[M.Equals]:"%3D",[M.Space]:"%20"};function vE(t,e,i){let n=void 0;let s=-1;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);if(o>=M.a&&o<=M.z||o>=M.A&&o<=M.Z||o>=M.Digit0&&o<=M.Digit9||o===M.Dash||o===M.Period||o===M.Underline||o===M.Tilde||e&&o===M.Slash||i&&o===M.OpenSquareBracket||i&&o===M.CloseSquareBracket||i&&o===M.Colon){if(s!==-1){n+=encodeURIComponent(t.substring(s,r));s=-1}if(n!==void 0){n+=t.charAt(r)}}else{if(n===void 0){n=t.substr(0,r)}const a=r4[o];if(a!==void 0){if(s!==-1){n+=encodeURIComponent(t.substring(s,r));s=-1}n+=a}else if(s===-1){s=r}}}if(s!==-1){n+=encodeURIComponent(t.substring(s))}return n!==void 0?n:t}function gL(t){let e=void 0;for(let i=0;i<t.length;i++){const n=t.charCodeAt(i);if(n===M.Hash||n===M.QuestionMark){if(e===void 0){e=t.substr(0,i)}e+=r4[n]}else{if(e!==void 0){e+=t[i]}}}return e!==void 0?e:t}function Hp(t,e){let i;if(t.authority&&t.path.length>1&&t.scheme==="file"){i=`//${t.authority}${t.path}`}else if(t.path.charCodeAt(0)===M.Slash&&(t.path.charCodeAt(1)>=M.A&&t.path.charCodeAt(1)<=M.Z||t.path.charCodeAt(1)>=M.a&&t.path.charCodeAt(1)<=M.z)&&t.path.charCodeAt(2)===M.Colon){if(!e){i=t.path[1].toLowerCase()+t.path.substr(2)}else{i=t.path.substr(1)}}else{i=t.path}if(nn){i=i.replace(/\//g,"\\")}return i}function R1(t,e){const i=!e?vE:gL;let n="";let{scheme:s,authority:r,path:o,query:a,fragment:l}=t;if(s){n+=s;n+=":"}if(r||s==="file"){n+=_s;n+=_s}if(r){let c=r.indexOf("@");if(c!==-1){const u=r.substr(0,c);r=r.substr(c+1);c=u.lastIndexOf(":");if(c===-1){n+=i(u,false,false)}else{n+=i(u.substr(0,c),false,false);n+=":";n+=i(u.substr(c+1),false,true)}n+="@"}r=r.toLowerCase();c=r.lastIndexOf(":");if(c===-1){n+=i(r,false,true)}else{n+=i(r.substr(0,c),false,true);n+=r.substr(c)}}if(o){if(o.length>=3&&o.charCodeAt(0)===M.Slash&&o.charCodeAt(2)===M.Colon){const c=o.charCodeAt(1);if(c>=M.A&&c<=M.Z){o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`}}else if(o.length>=2&&o.charCodeAt(1)===M.Colon){const c=o.charCodeAt(0);if(c>=M.A&&c<=M.Z){o=`${String.fromCharCode(c+32)}:${o.substr(2)}`}}n+=i(o,true,false)}if(a){n+="?";n+=i(a,false,false)}if(l){n+="#";n+=!e?vE(l,false,false):l}return n}function o4(t){try{return decodeURIComponent(t)}catch{if(t.length>3){return t.substr(0,3)+o4(t.substr(3))}else{return t}}}const wE=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Df(t){if(!t.match(wE)){return t}return t.replace(wE,e=>o4(e))}class T_{static{this.count=0}constructor(e){this._proxyIdentifierBrand=void 0;this.sid=e;this.nid=++T_.count}}const a4=[];function B(t){const e=new T_(t);a4[e.nid]=e;return e}function If(t){return a4[t].sid}class ji{constructor(e){this.value=e}}var bE;(function(t){t[t["Default"]=0]="Default";t[t["InCenter"]=1]="InCenter";t[t["InCenterIfOutsideViewport"]=2]="InCenterIfOutsideViewport";t[t["AtTop"]=3]="AtTop"})(bE||(bE={}));var An;(function(t){t[t["UnknownInput"]=0]="UnknownInput";t[t["TextInput"]=1]="TextInput";t[t["TextDiffInput"]=2]="TextDiffInput";t[t["TextMergeInput"]=3]="TextMergeInput";t[t["NotebookInput"]=4]="NotebookInput";t[t["NotebookDiffInput"]=5]="NotebookDiffInput";t[t["CustomEditorInput"]=6]="CustomEditorInput";t[t["WebviewEditorInput"]=7]="WebviewEditorInput";t[t["TerminalEditorInput"]=8]="TerminalEditorInput";t[t["InteractiveEditorInput"]=9]="InteractiveEditorInput";t[t["ChatEditorInput"]=10]="ChatEditorInput";t[t["MultiDiffEditorInput"]=11]="MultiDiffEditorInput"})(An||(An={}));var Ar;(function(t){t[t["TAB_OPEN"]=0]="TAB_OPEN";t[t["TAB_CLOSE"]=1]="TAB_CLOSE";t[t["TAB_UPDATE"]=2]="TAB_UPDATE";t[t["TAB_MOVE"]=3]="TAB_MOVE"})(Ar||(Ar={}));var yE;(function(t){t[t["Editable"]=0]="Editable";t[t["SupportsHotExit"]=1]="SupportsHotExit"})(yE||(yE={}));var Zt;(function(t){t[t["Int8Array"]=1]="Int8Array";t[t["Uint8Array"]=2]="Uint8Array";t[t["Uint8ClampedArray"]=3]="Uint8ClampedArray";t[t["Int16Array"]=4]="Int16Array";t[t["Uint16Array"]=5]="Uint16Array";t[t["Int32Array"]=6]="Int32Array";t[t["Uint32Array"]=7]="Uint32Array";t[t["Float32Array"]=8]="Float32Array";t[t["Float64Array"]=9]="Float64Array";t[t["BigInt64Array"]=10]="BigInt64Array";t[t["BigUint64Array"]=11]="BigUint64Array"})(Zt||(Zt={}));var SE;(function(t){t[t["Text"]=1]="Text";t[t["Error"]=2]="Error";t[t["Rich"]=3]="Rich"})(SE||(SE={}));var xE;(function(t){t[t["Default"]=0]="Default";t[t["InCenter"]=1]="InCenter";t[t["InCenterIfOutsideViewport"]=2]="InCenterIfOutsideViewport";t[t["AtTop"]=3]="AtTop"})(xE||(xE={}));var L1;(function(t){t[t["None"]=0]="None";t[t["Process"]=1]="Process";t[t["Output"]=2]="Output";t[t["Hybrid"]=3]="Hybrid"})(L1||(L1={}));var Ue;(function(t){t["label"]="a";t["kind"]="b";t["detail"]="c";t["documentation"]="d";t["sortText"]="e";t["filterText"]="f";t["preselect"]="g";t["insertText"]="h";t["insertTextRules"]="i";t["range"]="j";t["commitCharacters"]="k";t["additionalTextEdits"]="l";t["kindModifier"]="m";t["commandIdent"]="n";t["commandId"]="o";t["commandArguments"]="p"})(Ue||(Ue={}));var zl;(function(t){t["defaultRanges"]="a";t["completions"]="b";t["isIncomplete"]="c";t["duration"]="d"})(zl||(zl={}));var EE;(function(t){t[t["Workspace"]=0]="Workspace";t[t["TextDocument"]=1]="TextDocument"})(EE||(EE={}));var ud;(function(t){t["Header"]="header";t["WellKnown"]="wellKnown";t["None"]="none"})(ud||(ud={}));var dd;(function(t){t["ResourceMetadata"]="resourceMetadata";t["WellKnown"]="wellKnown";t["Default"]="default"})(dd||(dd={}));const ee={MainThreadAuthentication:B("MainThreadAuthentication"),MainThreadBulkEdits:B("MainThreadBulkEdits"),MainThreadLanguageModels:B("MainThreadLanguageModels"),MainThreadEmbeddings:B("MainThreadEmbeddings"),MainThreadChatAgents2:B("MainThreadChatAgents2"),MainThreadCodeMapper:B("MainThreadCodeMapper"),MainThreadLanguageModelTools:B("MainThreadChatSkills"),MainThreadClipboard:B("MainThreadClipboard"),MainThreadCommands:B("MainThreadCommands"),MainThreadComments:B("MainThreadComments"),MainThreadConfiguration:B("MainThreadConfiguration"),MainThreadConsole:B("MainThreadConsole"),MainThreadDebugService:B("MainThreadDebugService"),MainThreadDecorations:B("MainThreadDecorations"),MainThreadDiagnostics:B("MainThreadDiagnostics"),MainThreadDialogs:B("MainThreadDiaglogs"),MainThreadDocuments:B("MainThreadDocuments"),MainThreadDocumentContentProviders:B("MainThreadDocumentContentProviders"),MainThreadTextEditors:B("MainThreadTextEditors"),MainThreadEditorInsets:B("MainThreadEditorInsets"),MainThreadEditorTabs:B("MainThreadEditorTabs"),MainThreadErrors:B("MainThreadErrors"),MainThreadTreeViews:B("MainThreadTreeViews"),MainThreadDownloadService:B("MainThreadDownloadService"),MainThreadLanguageFeatures:B("MainThreadLanguageFeatures"),MainThreadLanguages:B("MainThreadLanguages"),MainThreadLogger:B("MainThreadLogger"),MainThreadMessageService:B("MainThreadMessageService"),MainThreadOutputService:B("MainThreadOutputService"),MainThreadProgress:B("MainThreadProgress"),MainThreadQuickDiff:B("MainThreadQuickDiff"),MainThreadQuickOpen:B("MainThreadQuickOpen"),MainThreadStatusBar:B("MainThreadStatusBar"),MainThreadSecretState:B("MainThreadSecretState"),MainThreadStorage:B("MainThreadStorage"),MainThreadSpeech:B("MainThreadSpeechProvider"),MainThreadTelemetry:B("MainThreadTelemetry"),MainThreadTerminalService:B("MainThreadTerminalService"),MainThreadTerminalShellIntegration:B("MainThreadTerminalShellIntegration"),MainThreadWebviews:B("MainThreadWebviews"),MainThreadWebviewPanels:B("MainThreadWebviewPanels"),MainThreadWebviewViews:B("MainThreadWebviewViews"),MainThreadCustomEditors:B("MainThreadCustomEditors"),MainThreadUrls:B("MainThreadUrls"),MainThreadUriOpeners:B("MainThreadUriOpeners"),MainThreadProfileContentHandlers:B("MainThreadProfileContentHandlers"),MainThreadWorkspace:B("MainThreadWorkspace"),MainThreadFileSystem:B("MainThreadFileSystem"),MainThreadFileSystemEventService:B("MainThreadFileSystemEventService"),MainThreadExtensionService:B("MainThreadExtensionService"),MainThreadSCM:B("MainThreadSCM"),MainThreadSearch:B("MainThreadSearch"),MainThreadShare:B("MainThreadShare"),MainThreadTask:B("MainThreadTask"),MainThreadWindow:B("MainThreadWindow"),MainThreadLabelService:B("MainThreadLabelService"),MainThreadNotebook:B("MainThreadNotebook"),MainThreadNotebookDocuments:B("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:B("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:B("MainThreadNotebookKernels"),MainThreadNotebookRenderers:B("MainThreadNotebookRenderers"),MainThreadInteractive:B("MainThreadInteractive"),MainThreadTheming:B("MainThreadTheming"),MainThreadTunnelService:B("MainThreadTunnelService"),MainThreadManagedSockets:B("MainThreadManagedSockets"),MainThreadTimeline:B("MainThreadTimeline"),MainThreadTesting:B("MainThreadTesting"),MainThreadLocalization:B("MainThreadLocalizationShape"),MainThreadMcp:B("MainThreadMcpShape"),MainThreadAiRelatedInformation:B("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:B("MainThreadAiEmbeddingVector"),MainThreadChatStatus:B("MainThreadChatStatus"),MainThreadAiSettingsSearch:B("MainThreadAiSettingsSearch"),MainThreadDataChannels:B("MainThreadDataChannels"),MainThreadChatSessions:B("MainThreadChatSessions"),MainThreadChatOutputRenderer:B("MainThreadChatOutputRenderer"),MainThreadChatContext:B("MainThreadChatContext")};const ge={ExtHostCodeMapper:B("ExtHostCodeMapper"),ExtHostCommands:B("ExtHostCommands"),ExtHostConfiguration:B("ExtHostConfiguration"),ExtHostDiagnostics:B("ExtHostDiagnostics"),ExtHostDebugService:B("ExtHostDebugService"),ExtHostDecorations:B("ExtHostDecorations"),ExtHostDocumentsAndEditors:B("ExtHostDocumentsAndEditors"),ExtHostDocuments:B("ExtHostDocuments"),ExtHostDocumentContentProviders:B("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:B("ExtHostDocumentSaveParticipant"),ExtHostEditors:B("ExtHostEditors"),ExtHostTreeViews:B("ExtHostTreeViews"),ExtHostFileSystem:B("ExtHostFileSystem"),ExtHostFileSystemInfo:B("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:B("ExtHostFileSystemEventService"),ExtHostLanguages:B("ExtHostLanguages"),ExtHostLanguageFeatures:B("ExtHostLanguageFeatures"),ExtHostQuickOpen:B("ExtHostQuickOpen"),ExtHostQuickDiff:B("ExtHostQuickDiff"),ExtHostStatusBar:B("ExtHostStatusBar"),ExtHostShare:B("ExtHostShare"),ExtHostExtensionService:B("ExtHostExtensionService"),ExtHostLogLevelServiceShape:B("ExtHostLogLevelServiceShape"),ExtHostTerminalService:B("ExtHostTerminalService"),ExtHostTerminalShellIntegration:B("ExtHostTerminalShellIntegration"),ExtHostSCM:B("ExtHostSCM"),ExtHostSearch:B("ExtHostSearch"),ExtHostTask:B("ExtHostTask"),ExtHostWorkspace:B("ExtHostWorkspace"),ExtHostWindow:B("ExtHostWindow"),ExtHostWebviews:B("ExtHostWebviews"),ExtHostWebviewPanels:B("ExtHostWebviewPanels"),ExtHostCustomEditors:B("ExtHostCustomEditors"),ExtHostWebviewViews:B("ExtHostWebviewViews"),ExtHostEditorInsets:B("ExtHostEditorInsets"),ExtHostEditorTabs:B("ExtHostEditorTabs"),ExtHostProgress:B("ExtHostProgress"),ExtHostComments:B("ExtHostComments"),ExtHostSecretState:B("ExtHostSecretState"),ExtHostStorage:B("ExtHostStorage"),ExtHostUrls:B("ExtHostUrls"),ExtHostUriOpeners:B("ExtHostUriOpeners"),ExtHostChatOutputRenderer:B("ExtHostChatOutputRenderer"),ExtHostProfileContentHandlers:B("ExtHostProfileContentHandlers"),ExtHostOutputService:B("ExtHostOutputService"),ExtHostLabelService:B("ExtHostLabelService"),ExtHostNotebook:B("ExtHostNotebook"),ExtHostNotebookDocuments:B("ExtHostNotebookDocuments"),ExtHostNotebookEditors:B("ExtHostNotebookEditors"),ExtHostNotebookKernels:B("ExtHostNotebookKernels"),ExtHostNotebookRenderers:B("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:B("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:B("ExtHostInteractive"),ExtHostChatAgents2:B("ExtHostChatAgents"),ExtHostLanguageModelTools:B("ExtHostChatSkills"),ExtHostChatProvider:B("ExtHostChatProvider"),ExtHostChatContext:B("ExtHostChatContext"),ExtHostSpeech:B("ExtHostSpeech"),ExtHostEmbeddings:B("ExtHostEmbeddings"),ExtHostAiRelatedInformation:B("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:B("ExtHostAiEmbeddingVector"),ExtHostAiSettingsSearch:B("ExtHostAiSettingsSearch"),ExtHostTheming:B("ExtHostTheming"),ExtHostTunnelService:B("ExtHostTunnelService"),ExtHostManagedSockets:B("ExtHostManagedSockets"),ExtHostAuthentication:B("ExtHostAuthentication"),ExtHostTimeline:B("ExtHostTimeline"),ExtHostTesting:B("ExtHostTesting"),ExtHostTelemetry:B("ExtHostTelemetry"),ExtHostLocalization:B("ExtHostLocalization"),ExtHostMcp:B("ExtHostMcp"),ExtHostDataChannels:B("ExtHostDataChannels"),ExtHostChatSessions:B("ExtHostChatSessions")};const l4=Object.freeze(function(t,e){const i=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(i)}}});var Ze;(function(t){function e(i){if(i===t.None||i===t.Cancelled){return true}if(i instanceof tp){return true}if(!i||typeof i!=="object"){return false}return typeof i.isCancellationRequested==="boolean"&&typeof i.onCancellationRequested==="function"}t.isCancellationToken=e;t.None=Object.freeze({isCancellationRequested:false,onCancellationRequested:wt.None});t.Cancelled=Object.freeze({isCancellationRequested:true,onCancellationRequested:l4})})(Ze||(Ze={}));class tp{constructor(){this._isCancelled=false;this._emitter=null}cancel(){if(!this._isCancelled){this._isCancelled=true;if(this._emitter){this._emitter.fire(void 0);this.dispose()}}}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){if(this._isCancelled){return l4}if(!this._emitter){this._emitter=new L}return this._emitter.event}dispose(){if(this._emitter){this._emitter.dispose();this._emitter=null}}}class Tt{constructor(e){this._token=void 0;this._parentListener=void 0;this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){if(!this._token){this._token=new tp}return this._token}cancel(){if(!this._token){this._token=Ze.Cancelled}else if(this._token instanceof tp){this._token.cancel()}}dispose(e=false){if(e){this.cancel()}this._parentListener?.dispose();if(!this._token){this._token=Ze.None}else if(this._token instanceof tp){this._token.dispose()}}}function mL(t){return t}class _L{constructor(e,i){this.lastCache=void 0;this.lastArgKey=void 0;if(typeof e==="function"){this._fn=e;this._computeKey=mL}else{this._fn=i;this._computeKey=e.getCacheKey}}get(e){const i=this._computeKey(e);if(this.lastArgKey!==i){this.lastArgKey=i;this.lastCache=this._fn(e)}return this.lastCache}}var Ni;(function(t){t[t["MAX_SAFE_SMALL_INTEGER"]=1073741824]="MAX_SAFE_SMALL_INTEGER";t[t["MIN_SAFE_SMALL_INTEGER"]=-1073741824]="MIN_SAFE_SMALL_INTEGER";t[t["MAX_UINT_8"]=255]="MAX_UINT_8";t[t["MAX_UINT_16"]=65535]="MAX_UINT_16";t[t["MAX_UINT_32"]=4294967295]="MAX_UINT_32";t[t["UNICODE_SUPPLEMENTARY_PLANE_BEGIN"]=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(Ni||(Ni={}));function CE(t){if(t<0){return 0}if(t>Ni.MAX_UINT_8){return Ni.MAX_UINT_8}return t|0}function Pl(t){if(t<0){return 0}if(t>Ni.MAX_UINT_32){return Ni.MAX_UINT_32}return t|0}function Oc(t){if(!t||typeof t!=="string"){return true}return t.trim().length===0}const vL=/{(\d+)}/g;function wL(t,...e){if(e.length===0){return t}return t.replace(vL,function(i,n){const s=parseInt(n,10);return isNaN(s)||s<0||s>=e.length?i:e[s]})}const bL=/{([^}]+)}/g;function kE(t,e){if(Object.keys(e).length===0){return t}return t.replace(bL,(i,n)=>e[n]??i)}function sl(t){return t.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function yL(t,e){let i=0;let n=t.indexOf(e);while(n!==-1){i++;n=t.indexOf(e,n+e.length)}return i}function SL(t,e){if(!t||!e){return t}const i=e.length;let n=0;if(i===1){const s=e.charCodeAt(0);while(n<t.length&&t.charCodeAt(n)===s){n++}}else{while(t.startsWith(e,n)){n+=i}}return t.substring(n)}function N1(t,e){if(!t||!e){return t}const i=e.length,n=t.length;if(i===1){let r=n;const o=e.charCodeAt(0);while(r>0&&t.charCodeAt(r-1)===o){r--}return t.substring(0,r)}let s=n;while(s>0&&t.endsWith(e,s)){s-=i}return t.substring(0,s)}function xL(t,e,i={}){if(!t){throw new Error("Cannot create regex from empty string")}if(!e){t=sl(t)}if(i.wholeWord){if(!/\B/.test(t.charAt(0))){t="\\b"+t}if(!/\B/.test(t.charAt(t.length-1))){t=t+"\\b"}}let n="";if(i.global){n+="g"}if(!i.matchCase){n+="i"}if(i.multiline){n+="m"}if(i.unicode){n+="u"}return new RegExp(t,n)}function c4(t){if(t.source==="^"||t.source==="^$"||t.source==="$"||t.source==="^\\s*$"){return false}const e=t.exec("");return!!(e&&t.lastIndex===0)}function u4(t){return t.split(/\r\n|\r|\n/)}function Lv(t){for(let e=0,i=t.length;e<i;e++){const n=t.charCodeAt(e);if(n!==M.Space&&n!==M.Tab){return e}}return-1}function EL(t,e=t.length-1){for(let i=e;i>=0;i--){const n=t.charCodeAt(i);if(n!==M.Space&&n!==M.Tab){return i}}return-1}function rl(t,e){if(t<e){return-1}else if(t>e){return 1}else{return 0}}function ES(t,e,i=0,n=t.length,s=0,r=e.length){for(;i<n&&s<r;i++,s++){const l=t.charCodeAt(i);const c=e.charCodeAt(s);if(l<c){return-1}else if(l>c){return 1}}const o=n-i;const a=r-s;if(o<a){return-1}else if(o>a){return 1}return 0}function M1(t,e){return vu(t,e,0,t.length,0,e.length)}function vu(t,e,i=0,n=t.length,s=0,r=e.length){for(;i<n&&s<r;i++,s++){let l=t.charCodeAt(i);let c=e.charCodeAt(s);if(l===c){continue}if(l>=128||c>=128){return ES(t.toLowerCase(),e.toLowerCase(),i,n,s,r)}if(DE(l)){l-=32}if(DE(c)){c-=32}const u=l-c;if(u===0){continue}return u}const o=n-i;const a=r-s;if(o<a){return-1}else if(o>a){return 1}return 0}function DE(t){return t>=M.a&&t<=M.z}function Rr(t,e){return t.length===e.length&&vu(t,e)===0}function Nv(t,e,i){return t===e||!!i&&t!==void 0&&e!==void 0&&Rr(t,e)}function CS(t,e){const i=e.length;return i<=t.length&&vu(t,e,0,i)===0}function CL(t,e){const i=t.length;const n=i-e.length;return n>=0&&vu(t,e,n,i)===0}function kL(t,e){const i=Math.min(t.length,e.length);let n;for(n=0;n<i;n++){if(t.charCodeAt(n)!==e.charCodeAt(n)){return n}}return i}function kS(t){return 55296<=t&&t<=56319}function d4(t){return 56320<=t&&t<=57343}function h4(t,e){return(t-55296<<10)+(e-56320)+65536}function f4(t,e,i){const n=t.charCodeAt(i);if(kS(n)&&i+1<e){const s=t.charCodeAt(i+1);if(d4(s)){return h4(n,s)}}return n}function DL(t,e){const i=t.charCodeAt(e-1);if(d4(i)&&e>1){const n=t.charCodeAt(e-2);if(kS(n)){return h4(n,i)}}return i}class IL{get offset(){return this._offset}constructor(e,i=0){this._str=e;this._len=e.length;this._offset=i}setOffset(e){this._offset=e}prevCodePoint(){const e=DL(this._str,this._offset);this._offset-=e>=Ni.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1;return e}nextCodePoint(){const e=f4(this._str,this._len,this._offset);this._offset+=e>=Ni.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1;return e}eol(){return this._offset>=this._len}}class TL{get offset(){return this._iterator.offset}constructor(e,i=0){this._iterator=new IL(e,i)}nextGraphemeLength(){const e=Ca.getInstance();const i=this._iterator;const n=i.offset;let s=e.getGraphemeBreakType(i.nextCodePoint());while(!i.eol()){const r=i.offset;const o=e.getGraphemeBreakType(i.nextCodePoint());if(PE(s,o)){i.setOffset(r);break}s=o}return i.offset-n}prevGraphemeLength(){const e=Ca.getInstance();const i=this._iterator;const n=i.offset;let s=e.getGraphemeBreakType(i.prevCodePoint());while(i.offset>0){const r=i.offset;const o=e.getGraphemeBreakType(i.prevCodePoint());if(PE(o,s)){i.setOffset(r);break}s=o}return n-i.offset}eol(){return this._iterator.eol()}}function IE(t,e){const i=new TL(t,e);return i.nextGraphemeLength()}let Mv=void 0;function PL(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function p4(t){if(!Mv){Mv=PL()}return Mv.test(t)}const AL=/^[\t\n\r\x20-\x7E]*$/;function RL(t){return AL.test(t)}const LL=/[\u2028\u2029]/;function g4(t){return LL.test(t)}const NL=String.fromCharCode(M.UTF8_BOM);function ML(t){return!!(t&&t.length>0&&t.charCodeAt(0)===M.UTF8_BOM)}function TE(t,e=false){if(!t){return false}if(e){t=t.replace(/\\./g,"")}return t.toLowerCase()!==t}function OL(t,e=1){if(e===0){return""}let i=-1;do{i=t.indexOf("\n",i+1);e--}while(e>0&&i>=0);if(i===-1){return t}if(t[i-1]==="\r"){i--}return t.substr(0,i)}function PE(t,e){if(t===at.Other){return e!==at.Extend&&e!==at.SpacingMark}if(t===at.CR){if(e===at.LF){return false}}if(t===at.Control||t===at.CR||t===at.LF){return true}if(e===at.Control||e===at.CR||e===at.LF){return true}if(t===at.L){if(e===at.L||e===at.V||e===at.LV||e===at.LVT){return false}}if(t===at.LV||t===at.V){if(e===at.V||e===at.T){return false}}if(t===at.LVT||t===at.T){if(e===at.T){return false}}if(e===at.Extend||e===at.ZWJ){return false}if(e===at.SpacingMark){return false}if(t===at.Prepend){return false}if(t===at.ZWJ&&e===at.Extended_Pictographic){return false}if(t===at.Regional_Indicator&&e===at.Regional_Indicator){return false}return true}var at;(function(t){t[t["Other"]=0]="Other";t[t["Prepend"]=1]="Prepend";t[t["CR"]=2]="CR";t[t["LF"]=3]="LF";t[t["Control"]=4]="Control";t[t["Extend"]=5]="Extend";t[t["Regional_Indicator"]=6]="Regional_Indicator";t[t["SpacingMark"]=7]="SpacingMark";t[t["L"]=8]="L";t[t["V"]=9]="V";t[t["T"]=10]="T";t[t["LV"]=11]="LV";t[t["LVT"]=12]="LVT";t[t["ZWJ"]=13]="ZWJ";t[t["Extended_Pictographic"]=14]="Extended_Pictographic"})(at||(at={}));class Ca{static{this._INSTANCE=null}static getInstance(){if(!Ca._INSTANCE){Ca._INSTANCE=new Ca}return Ca._INSTANCE}constructor(){this._data=FL()}getGraphemeBreakType(e){if(e<32){if(e===M.LineFeed){return at.LF}if(e===M.CarriageReturn){return at.CR}return at.Control}if(e<127){return at.Other}const i=this._data;const n=i.length/3;let s=1;while(s<=n){if(e<i[3*s]){s=2*s}else if(e>i[3*s+1]){s=2*s+1}else{return i[3*s+2]}}return at.Other}}function FL(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var AE;(function(t){t[t["zwj"]=8205]="zwj";t[t["emojiVariantSelector"]=65039]="emojiVariantSelector";t[t["enclosingKeyCap"]=8419]="enclosingKeyCap";t[t["space"]=32]="space"})(AE||(AE={}));class Zu{static{this.ambiguousCharacterData=new $i(()=>{return JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}')})}static{this.cache=new _L(e=>{const i=e.split(",");function n(d){const f=new Map;for(let p=0;p<d.length;p+=2){f.set(d[p],d[p+1])}return f}function s(d,f){const p=new Map(d);for(const[m,v]of f){p.set(m,v)}return p}function r(d,f){if(!d){return f}const p=new Map;for(const[m,v]of d){if(f.has(m)){p.set(m,v)}}return p}const o=this.ambiguousCharacterData.value;let a=i.filter(d=>!d.startsWith("_")&&Object.hasOwn(o,d));if(a.length===0){a=["_default"]}let l=void 0;for(const d of a){const f=n(o[d]);l=r(l,f)}const c=n(o["_common"]);const u=s(c,l);return new Zu(u)})}static getInstance(e){return Zu.cache.get(Array.from(e).join(","))}static{this._locales=new $i(()=>Object.keys(Zu.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return Zu._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let i=0;i<e.length;i++){const n=e.codePointAt(i);if(typeof n==="number"&&this.isAmbiguous(n)){return true}}return false}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}var RE;(function(t){t[t["BASE"]=36]="BASE";t[t["TMIN"]=1]="TMIN";t[t["TMAX"]=26]="TMAX";t[t["SKEW"]=38]="SKEW";t[t["DAMP"]=700]="DAMP";t[t["INITIAL_BIAS"]=72]="INITIAL_BIAS";t[t["INITIAL_N"]=128]="INITIAL_N";t[t["DELIMITER"]=45]="DELIMITER"})(RE||(RE={}));function Zr(t){return t===M.Slash||t===M.Backslash}function m4(t){return t.replace(/[\\/]/g,mt.sep)}function UL(t){if(t.indexOf("/")===-1){t=m4(t)}if(/^[a-zA-Z]:(\/|$)/.test(t)){t="/"+t}return t}function LE(t,e=mt.sep){if(!t){return""}const i=t.length;const n=t.charCodeAt(0);if(Zr(n)){if(Zr(t.charCodeAt(1))){if(!Zr(t.charCodeAt(2))){let r=3;const o=r;for(;r<i;r++){if(Zr(t.charCodeAt(r))){break}}if(o!==r&&!Zr(t.charCodeAt(r+1))){r+=1;for(;r<i;r++){if(Zr(t.charCodeAt(r))){return t.slice(0,r+1).replace(/[\\/]/g,e)}}}}}return e}else if(_4(n)){if(t.charCodeAt(1)===M.Colon){if(Zr(t.charCodeAt(2))){return t.slice(0,2)+e}else{return t.slice(0,2)}}}let s=t.indexOf("://");if(s!==-1){s+=3;for(;s<i;s++){if(Zr(t.charCodeAt(s))){return t.slice(0,s+1)}}}return""}function Bp(t,e,i,n=Yn){if(t===e){return true}if(!t||!e){return false}if(e.length>t.length){return false}if(i){const s=CS(t,e);if(!s){return false}if(e.length===t.length){return true}let r=e.length;if(e.charAt(e.length-1)===n){r--}return t.charAt(r)===n}if(e.charAt(e.length-1)!==n){e+=n}return t.indexOf(e)===0}function _4(t){return t>=M.A&&t<=M.Z||t>=M.a&&t<=M.z}function $L(t,e=nn){if(e){return _4(t.charCodeAt(0))&&t.charCodeAt(1)===M.Colon}return false}var ne;(function(t){t.inMemory="inmemory";t.vscode="vscode";t.internal="private";t.walkThrough="walkThrough";t.walkThroughSnippet="walkThroughSnippet";t.http="http";t.https="https";t.file="file";t.mailto="mailto";t.untitled="untitled";t.data="data";t.command="command";t.vscodeRemote="vscode-remote";t.vscodeRemoteResource="vscode-remote-resource";t.vscodeManagedRemoteResource="vscode-managed-remote-resource";t.vscodeUserData="vscode-userdata";t.vscodeCustomEditor="vscode-custom-editor";t.vscodeNotebookCell="vscode-notebook-cell";t.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata";t.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff";t.vscodeNotebookCellOutput="vscode-notebook-cell-output";t.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff";t.vscodeNotebookMetadata="vscode-notebook-metadata";t.vscodeInteractiveInput="vscode-interactive-input";t.vscodeSettings="vscode-settings";t.vscodeWorkspaceTrust="vscode-workspace-trust";t.vscodeTerminal="vscode-terminal";t.vscodeChatCodeBlock="vscode-chat-code-block";t.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block";t.vscodeChatEditor="vscode-chat-editor";t.vscodeChatInput="chatSessionInput";t.vscodeLocalChatSession="vscode-chat-session";t.webviewPanel="webview-panel";t.vscodeWebview="vscode-webview";t.vscodeBrowser="vscode-browser";t.extension="extension";t.vscodeFileResource="vscode-file";t.tmp="tmp";t.vsls="vsls";t.vscodeSourceControl="vscode-scm";t.commentsInput="comment";t.codeSetting="code-setting";t.outputChannel="output";t.accessibleView="accessible-view";t.chatEditingSnapshotScheme="chat-editing-snapshot-text-model";t.chatEditingModel="chat-editing-text-model";t.copilotPr="copilot-pr"})(ne||(ne={}));function O1(t,e){if(b.isUri(t)){return Rr(t.scheme,e)}else{return CS(t,e+":")}}function HL(t,...e){return e.some(i=>O1(t,i))}const BL="tkn";class WL{constructor(){this._hosts=Object.create(null);this._ports=Object.create(null);this._connectionTokens=Object.create(null);this._preferredWebSchema="http";this._delegate=null;this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,i){this._serverRootPath=mt.join(i??"/",zL(e))}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return mt.join(this._serverRootPath,ne.vscodeRemoteResource)}set(e,i,n){this._hosts[e]=i;this._ports[e]=n}setConnectionToken(e,i){this._connectionTokens[e]=i}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate){try{return this._delegate(e)}catch(a){Ti(a);return e}}const i=e.authority;let n=this._hosts[i];if(n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1){n=`[${n}]`}const s=this._ports[i];const r=this._connectionTokens[i];let o=`path=${encodeURIComponent(e.path)}`;if(typeof r==="string"){o+=`&${BL}=${encodeURIComponent(r)}`}return b.from({scheme:_u?this._preferredWebSchema:ne.vscodeRemoteResource,authority:`${n}:${s}`,path:this._remoteResourcesPath,query:o})}}const VL=new WL;function zL(t){return`${t.quality??"oss"}-${t.commit??"dev"}`}const qL="vscode-app";class hd{constructor(){this.staticBrowserUris=new It;this.appResourcePathUrls=new Map;this.appResourceUrlMapper=[]}static{this.FALLBACK_AUTHORITY=qL}registerAppResourcePathUrl(e,i){this.appResourcePathUrls.set(e,i)}registerAppResourceLoader(e){this.appResourceUrlMapper.push(e)}toUrl(e){let i=this.appResourcePathUrls.get(e);if(typeof i==="function"){i=i()}for(const n of this.appResourceUrlMapper){const s=n(e);if(s){return s}}return new URL(i??e,globalThis.location?.href??import.meta.url).toString()}asBrowserUri(e){const i=this.toUri(e);return this.uriToBrowserUri(i)}uriToBrowserUri(e){if(e.scheme===ne.vscodeRemote){return VL.rewrite(e)}if(e.scheme===ne.file&&(XT||jR===`${ne.vscodeFileResource}://${hd.FALLBACK_AUTHORITY}`)){return e.with({scheme:ne.vscodeFileResource,authority:e.authority||hd.FALLBACK_AUTHORITY,query:null,fragment:null})}return this.staticBrowserUris.get(e)??e}asFileUri(e){const i=this.toUri(e);return this.uriToFileUri(i)}uriToFileUri(e){if(e.scheme===ne.vscodeFileResource){return e.with({scheme:ne.file,authority:e.authority!==hd.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null})}return e}toUri(e){if(b.isUri(e)){return e}if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i)){return b.joinPath(b.parse(i,true),e)}const n=A1(i,e);return b.file(n)}return b.parse(this.toUrl(e))}registerStaticBrowserUri(e,i){this.staticBrowserUris.set(e,i);return ye(()=>{if(this.staticBrowserUris.get(e)===i){this.staticBrowserUris.delete(e)}})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}}new hd;var NE;(function(t){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);t.CoopAndCoep=Object.freeze(e.get("3"));const i="vscode-coi";function n(r){let o;if(typeof r==="string"){o=new URL(r).searchParams}else if(r instanceof URL){o=r.searchParams}else if(b.isUri(r)){o=new URL(r.toString(true)).searchParams}const a=o?.get(i);if(!a){return void 0}return e.get(a)}t.getHeadersFromQuery=n;function s(r,o,a){if(!globalThis.crossOriginIsolated){return}const l=o&&a?"3":a?"2":"1";if(r instanceof URLSearchParams){r.set(i,l)}else{r[i]=l}}t.addSearchParam=s})(NE||(NE={}));function os(t){return Hp(t,true)}class wu{constructor(e){this._ignorePathCasing=e}compare(e,i,n=false){if(e===i){return 0}return rl(this.getComparisonKey(e,n),this.getComparisonKey(i,n))}isEqual(e,i,n=false){if(e===i){return true}if(!e||!i){return false}return this.getComparisonKey(e,n)===this.getComparisonKey(i,n)}getComparisonKey(e,i=false){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:i?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,i,n=false){if(e.scheme===i.scheme){if(e.scheme===ne.file){return Bp(os(e),os(i),this._ignorePathCasing(e))&&e.query===i.query&&(n||e.fragment===i.fragment)}if(ME(e.authority,i.authority)){return Bp(e.path,i.path,this._ignorePathCasing(e),"/")&&e.query===i.query&&(n||e.fragment===i.fragment)}}return false}joinPath(e,...i){return b.joinPath(e,...i)}basenameOrAuthority(e){return ts(e)||e.authority}basename(e){return mt.basename(e.path)}extname(e){return mt.extname(e.path)}dirname(e){if(e.path.length===0){return e}let i;if(e.scheme===ne.file){i=b.file(lc(os(e))).path}else{i=mt.dirname(e.path);if(e.authority&&i.length&&i.charCodeAt(0)!==M.Slash){console.error(`dirname("${e.toString})) resulted in a relative path`);i="/"}}return e.with({path:i})}normalizePath(e){if(!e.path.length){return e}let i;if(e.scheme===ne.file){i=b.file(Mc(os(e))).path}else{i=mt.normalize(e.path)}return e.with({path:i})}relativePath(e,i){if(e.scheme!==i.scheme||!ME(e.authority,i.authority)){return void 0}if(e.scheme===ne.file){const r=Gd(os(e),os(i));return nn?m4(r):r}let n=e.path||"/";const s=i.path||"/";if(this._ignorePathCasing(e)){let r=0;for(const o=Math.min(n.length,s.length);r<o;r++){if(n.charCodeAt(r)!==s.charCodeAt(r)){if(n.charAt(r).toLowerCase()!==s.charAt(r).toLowerCase()){break}}}n=s.substr(0,r)+n.substr(r)}return mt.relative(n,s)}resolvePath(e,i){if(e.scheme===ne.file){const n=b.file(aL(os(e),i));return e.with({authority:n.authority,path:n.path})}i=UL(i);return e.with({path:mt.resolve(e.path,i)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,i){return e===i||e!==void 0&&i!==void 0&&Rr(e,i)}hasTrailingPathSeparator(e,i=Yn){if(e.scheme===ne.file){const n=os(e);return n.length>LE(n).length&&n[n.length-1]===i}else{const n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===M.Slash&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,i=Yn){if(OE(e,i)){return e.with({path:e.path.substr(0,e.path.length-1)})}return e}addTrailingPathSeparator(e,i=Yn){let n=false;if(e.scheme===ne.file){const s=os(e);n=s!==void 0&&s.length===LE(s).length&&s[s.length-1]===i}else{i="/";const s=e.path;n=s.length===1&&s.charCodeAt(s.length-1)===M.Slash}if(!n&&!OE(e,i)){return e.with({path:e.path+"/"})}return e}}const ft=new wu(()=>false);const jL=new wu(t=>{return t.scheme===ne.file?!Fo:true});const GL=new wu(t=>true);const Fc=ft.isEqual.bind(ft);ft.isEqualOrParent.bind(ft);ft.getComparisonKey.bind(ft);const F1=ft.basenameOrAuthority.bind(ft);const ts=ft.basename.bind(ft);const KL=ft.extname.bind(ft);const lf=ft.dirname.bind(ft);const Mi=ft.joinPath.bind(ft);ft.normalizePath.bind(ft);const v4=ft.relativePath.bind(ft);ft.resolvePath.bind(ft);const QL=ft.isAbsolutePath.bind(ft);const ME=ft.isEqualAuthority.bind(ft);const OE=ft.hasTrailingPathSeparator.bind(ft);ft.removeTrailingPathSeparator.bind(ft);ft.addTrailingPathSeparator.bind(ft);var FE;(function(t){t.META_DATA_LABEL="label";t.META_DATA_DESCRIPTION="description";t.META_DATA_SIZE="size";t.META_DATA_MIME="mime";function e(i){const n=new Map;const s=i.path.substring(i.path.indexOf(";")+1,i.path.lastIndexOf(";"));s.split(";").forEach(o=>{const[a,l]=o.split(":");if(a&&l){n.set(a,l)}});const r=i.path.substring(0,i.path.indexOf(";"));if(r){n.set(t.META_DATA_MIME,r)}return n}t.parseMetaData=e})(FE||(FE={}));const JL=Symbol("MicrotaskDelay");function Uo(t){return!!t&&typeof t.then==="function"}function YL(t){const e=new Tt;const i=t(e.token);let n=false;const s=new Promise((r,o)=>{const a=e.token.onCancellationRequested(()=>{n=true;a.dispose();o(new Vi)});Promise.resolve(i).then(l=>{a.dispose();e.dispose();if(!n){r(l)}else if(BT(l)){l.dispose()}},l=>{a.dispose();e.dispose();o(l)})});return new class{cancel(){e.cancel();e.dispose()}then(r,o){return s.then(r,o)}catch(r){return this.then(void 0,r)}finally(r){return s.finally(r)}}}function w4(t,e,i){return new Promise((n,s)=>{const r=e.onCancellationRequested(()=>{r.dispose();n(i)});t.then(n,s).finally(()=>r.dispose())})}function DS(t,e){return new Promise((i,n)=>{const s=e.onCancellationRequested(()=>{s.dispose();n(new Vi)});t.then(i,n).finally(()=>s.dispose())})}function Hi(t){return new Promise((e,i)=>{const n=t();if(Uo(n)){n.then(e,i)}else{e(n)}})}function XL(){let t;let e;const i=new Promise((n,s)=>{t=n;e=s});return{promise:i,resolve:t,reject:e}}let ZL=class CW{constructor(){this.activePromise=null;this.queuedPromise=null;this.queuedPromiseFactory=null;this.cancellationTokenSource=new Tt}queue(e){if(this.cancellationTokenSource.token.isCancellationRequested){return Promise.reject(new Error("Throttler is disposed"))}if(this.activePromise){this.queuedPromiseFactory=e;if(!this.queuedPromise){const i=()=>{this.queuedPromise=null;if(this.cancellationTokenSource.token.isCancellationRequested){return}const n=this.queue(this.queuedPromiseFactory);this.queuedPromiseFactory=null;return n};this.queuedPromise=new Promise(n=>{this.activePromise.then(i,i).then(n)})}return new Promise((i,n)=>{this.queuedPromise.then(i,n)})}this.activePromise=e(this.cancellationTokenSource.token);return new Promise((i,n)=>{this.activePromise.then(s=>{this.activePromise=null;i(s)},s=>{this.activePromise=null;n(s)})})}dispose(){this.cancellationTokenSource.cancel()}};class e8{constructor(){this.current=Promise.resolve(null)}queue(e){return this.current=this.current.then(()=>e(),()=>e())}}class b4{constructor(){this.promiseMap=new Map}queue(e,i){const n=this.promiseMap.get(e)??Promise.resolve();const s=n.catch(()=>{}).then(i).finally(()=>{if(this.promiseMap.get(e)===s){this.promiseMap.delete(e)}});this.promiseMap.set(e,s);return s}peek(e){return this.promiseMap.get(e)||void 0}keys(){return this.promiseMap.keys()}}const t8=(t,e)=>{let i=true;const n=setTimeout(()=>{i=false;e()},t);return{isTriggered:()=>i,dispose:()=>{clearTimeout(n);i=false}}};const i8=t=>{let e=true;queueMicrotask(()=>{if(e){e=false;t()}});return{isTriggered:()=>e,dispose:()=>{e=false}}};class n8{constructor(e){this.defaultDelay=e;this.deferred=null;this.completionPromise=null;this.doResolve=null;this.doReject=null;this.task=null}trigger(e,i=this.defaultDelay){this.task=e;this.cancelTimeout();if(!this.completionPromise){this.completionPromise=new Promise((s,r)=>{this.doResolve=s;this.doReject=r}).then(()=>{this.completionPromise=null;this.doResolve=null;if(this.task){const s=this.task;this.task=null;return s()}return void 0})}const n=()=>{this.deferred=null;this.doResolve?.(null)};this.deferred=i===JL?i8(n):t8(i,n);return this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout();if(this.completionPromise){this.doReject?.(new Vi);this.completionPromise=null}}cancelTimeout(){this.deferred?.dispose();this.deferred=null}dispose(){this.cancel()}}class y4{constructor(e){this.delayer=new n8(e);this.throttler=new ZL}trigger(e,i){return this.delayer.trigger(()=>this.throttler.queue(e),i)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose();this.throttler.dispose()}}class Es{constructor(){this._isOpen=false;this._promise=new Promise((e,i)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=true;this._completePromise(true)}wait(){return this._promise}}function Ts(t,e){if(!e){return YL(i=>Ts(t,i))}return new Promise((i,n)=>{const s=setTimeout(()=>{r.dispose();i()},t);const r=e.onCancellationRequested(()=>{clearTimeout(s);r.dispose();n(new Vi)})})}function s8(t,e=0,i){const n=setTimeout(()=>{t()},e);const s=ye(()=>{clearTimeout(n)});return s}class r8{constructor(e){this._size=0;this._isDisposed=false;this.maxDegreeOfParalellism=e;this.outstandingPromises=[];this.runningPromises=0;this._onDrained=new L}whenIdle(){return this.size>0?wt.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed){throw new Error("Object has been disposed")}this._size++;return new Promise((i,n)=>{this.outstandingPromises.push({factory:e,c:i,e:n});this.consume()})}consume(){while(this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism){const e=this.outstandingPromises.shift();this.runningPromises++;const i=e.factory();i.then(e.c,e.e);i.then(()=>this.consumed(),()=>this.consumed())}}consumed(){if(this._isDisposed){return}this.runningPromises--;if(--this._size===0){this._onDrained.fire()}if(this.outstandingPromises.length>0){this.consume()}}clear(){if(this._isDisposed){throw new Error("Object has been disposed")}this.outstandingPromises.length=0;this._size=this.runningPromises}dispose(){this._isDisposed=true;this.outstandingPromises.length=0;this._size=0;this._onDrained.dispose()}}class o8 extends r8{constructor(){super(1)}}class a8{constructor(){this.queues=new Map;this.drainers=new Set;this.drainListeners=void 0;this.drainListenerCount=0}async whenDrained(){if(this.isDrained()){return}const e=new Bn;this.drainers.add(e);return e.p}isDrained(){for(const[,e]of this.queues){if(e.size>0){return false}}return true}queueSize(e,i=ft){const n=i.getComparisonKey(e);return this.queues.get(n)?.size??0}queueFor(e,i,n=ft){const s=n.getComparisonKey(e);let r=this.queues.get(s);if(!r){r=new o8;const o=this.drainListenerCount++;const a=wt.once(r.onDrained)(()=>{r?.dispose();this.queues.delete(s);this.onDidQueueDrain();this.drainListeners?.deleteAndDispose(o);if(this.drainListeners?.size===0){this.drainListeners.dispose();this.drainListeners=void 0}});if(!this.drainListeners){this.drainListeners=new af}this.drainListeners.set(o,a);this.queues.set(s,r)}return r.queue(i)}onDidQueueDrain(){if(!this.isDrained()){return}this.releaseDrainers()}releaseDrainers(){for(const e of this.drainers){e.complete()}this.drainers.clear()}dispose(){for(const[,e]of this.queues){e.dispose()}this.queues.clear();this.releaseDrainers();this.drainListeners?.dispose()}}class l8{constructor(){this.disposable=void 0;this.isDisposed=false}cancel(){this.disposable?.dispose();this.disposable=void 0}cancelAndSet(e,i,n=globalThis){if(this.isDisposed){throw new li(`Calling 'cancelAndSet' on a disposed IntervalTimer`)}this.cancel();const s=n.setInterval(()=>{e()},i);this.disposable=ye(()=>{n.clearInterval(s);this.disposable=void 0})}dispose(){this.cancel();this.isDisposed=true}}class wl{constructor(e,i){this.timeoutToken=void 0;this.runner=e;this.timeout=i;this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel();this.runner=null}cancel(){if(this.isScheduled()){clearTimeout(this.timeoutToken);this.timeoutToken=void 0}}schedule(e=this.timeout){this.cancel();this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==void 0}flush(){if(this.isScheduled()){this.cancel();this.doRun()}}onTimeout(){this.timeoutToken=void 0;if(this.runner){this.doRun()}}doRun(){this.runner?.()}}let S4;let ip;(function(){const t=globalThis;if(typeof t.requestIdleCallback!=="function"||typeof t.cancelIdleCallback!=="function"){ip=(e,i,n)=>{ZT(()=>{if(s){return}const r=Date.now()+15;const o={didTimeout:true,timeRemaining(){return Math.max(0,r-Date.now())}};i(Object.freeze(o))});let s=false;return{dispose(){if(s){return}s=true}}}}else{ip=(e,i,n)=>{const s=e.requestIdleCallback(i,typeof n==="number"?{timeout:n}:void 0);let r=false;return{dispose(){if(r){return}r=true;e.cancelIdleCallback(s)}}}}S4=(e,i)=>ip(globalThis,e,i)})();class c8{constructor(e,i){this._didRun=false;this._executor=()=>{try{this._value=i()}catch(n){this._error=n}finally{this._didRun=true}};this._handle=ip(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(!this._didRun){this._handle.dispose();this._executor()}if(this._error){throw this._error}return this._value}get isInitialized(){return this._didRun}}class u8 extends c8{constructor(e){super(globalThis,e)}}var fa;(function(t){t[t["Resolved"]=0]="Resolved";t[t["Rejected"]=1]="Rejected"})(fa||(fa={}));class Bn{static fromPromise(e){const i=new Bn;i.settleWith(e);return i}get isRejected(){return this.outcome?.outcome===fa.Rejected}get isResolved(){return this.outcome?.outcome===fa.Resolved}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===fa.Resolved?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,i)=>{this.completeCallback=e;this.errorCallback=i})}complete(e){if(this.isSettled){return Promise.resolve()}return new Promise(i=>{this.completeCallback(e);this.outcome={outcome:fa.Resolved,value:e};i()})}error(e){if(this.isSettled){return Promise.resolve()}return new Promise(i=>{this.errorCallback(e);this.outcome={outcome:fa.Rejected,value:e};i()})}settleWith(e){return e.then(i=>this.complete(i),i=>this.error(i))}cancel(){return this.error(new Vi)}}var Uc;(function(t){async function e(n){let s=void 0;const r=await Promise.all(n.map(o=>o.then(a=>a,a=>{if(!s){s=a}return void 0})));if(typeof s!=="undefined"){throw s}return r}t.settled=e;function i(n){return new Promise(async(s,r)=>{try{await n(s,r)}catch(o){r(o)}})}t.withAsyncBody=i})(Uc||(Uc={}));var as;(function(t){t[t["Initial"]=0]="Initial";t[t["DoneOK"]=1]="DoneOK";t[t["DoneError"]=2]="DoneError"})(as||(as={}));class Zi{static fromArray(e){return new Zi(i=>{i.emitMany(e)})}static fromPromise(e){return new Zi(async i=>{i.emitMany(await e)})}static fromPromisesResolveOrder(e){return new Zi(async i=>{await Promise.all(e.map(async n=>i.emitOne(await n)))})}static merge(e){return new Zi(async i=>{await Promise.all(e.map(async n=>{for await(const s of n){i.emitOne(s)}}))})}static{this.EMPTY=Zi.fromArray([])}constructor(e,i){this._state=as.Initial;this._results=[];this._error=null;this._onReturn=i;this._onStateChanged=new L;queueMicrotask(async()=>{const n={emitOne:s=>this.emitOne(s),emitMany:s=>this.emitMany(s),reject:s=>this.reject(s)};try{await Promise.resolve(e(n));this.resolve()}catch(s){this.reject(s)}finally{n.emitOne=void 0;n.emitMany=void 0;n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===as.DoneError){throw this._error}if(e<this._results.length){return{done:false,value:this._results[e++]}}if(this._state===as.DoneOK){return{done:true,value:void 0}}await wt.toPromise(this._onStateChanged.event)}while(true)},return:async()=>{this._onReturn?.();return{done:true,value:void 0}}}}static map(e,i){return new Zi(async n=>{for await(const s of e){n.emitOne(i(s))}})}map(e){return Zi.map(this,e)}static filter(e,i){return new Zi(async n=>{for await(const s of e){if(i(s)){n.emitOne(s)}}})}filter(e){return Zi.filter(this,e)}static coalesce(e){return Zi.filter(e,i=>!!i)}coalesce(){return Zi.coalesce(this)}static async toPromise(e){const i=[];for await(const n of e){i.push(n)}return i}toPromise(){return Zi.toPromise(this)}emitOne(e){if(this._state!==as.Initial){return}this._results.push(e);this._onStateChanged.fire()}emitMany(e){if(this._state!==as.Initial){return}this._results=this._results.concat(e);this._onStateChanged.fire()}resolve(){if(this._state!==as.Initial){return}this._state=as.DoneOK;this._onStateChanged.fire()}reject(e){if(this._state!==as.Initial){return}this._state=as.DoneError;this._error=e;this._onStateChanged.fire()}}class d8{constructor(e){this._deferred=new Bn;this._asyncIterable=new Zi(s=>{if(i){s.reject(i);return}if(n){s.emitMany(n)}this._errorFn=r=>s.reject(r);this._emitOneFn=r=>s.emitOne(r);this._emitManyFn=r=>s.emitMany(r);return this._deferred.p},e);let i;let n;this._errorFn=s=>{if(!i){i=s}};this._emitOneFn=s=>{if(!n){n=[]}n.push(s)};this._emitManyFn=s=>{if(!n){n=s.slice()}else{s.forEach(r=>n.push(r))}}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e);this._deferred.complete()}emitOne(e){this._emitOneFn(e)}emitMany(e){this._emitManyFn(e)}}class h8{constructor(){this._unsatisfiedConsumers=[];this._unconsumedValues=[]}get hasFinalValue(){return!!this._finalValue}produce(e){this._ensureNoFinalValue();if(this._unsatisfiedConsumers.length>0){const i=this._unsatisfiedConsumers.shift();this._resolveOrRejectDeferred(i,e)}else{this._unconsumedValues.push(e)}}produceFinal(e){this._ensureNoFinalValue();this._finalValue=e;for(const i of this._unsatisfiedConsumers){this._resolveOrRejectDeferred(i,e)}this._unsatisfiedConsumers.length=0}_ensureNoFinalValue(){if(this._finalValue){throw new li("ProducerConsumer: cannot produce after final value has been set")}}_resolveOrRejectDeferred(e,i){if(i.ok){e.complete(i.value)}else{e.error(i.error)}}consume(){if(this._unconsumedValues.length>0||this._finalValue){const e=this._unconsumedValues.length>0?this._unconsumedValues.shift():this._finalValue;if(e.ok){return Promise.resolve(e.value)}else{return Promise.reject(e.error)}}else{const e=new Bn;this._unsatisfiedConsumers.push(e);return e.p}}}class Yi{constructor(e,i){this._onReturn=i;this._producerConsumer=new h8;this._iterator={next:()=>this._producerConsumer.consume(),return:()=>{this._onReturn?.();return Promise.resolve({done:true,value:void 0})},throw:async n=>{this._finishError(n);return{done:true,value:void 0}}};queueMicrotask(async()=>{const n=e({emitOne:s=>this._producerConsumer.produce({ok:true,value:{done:false,value:s}}),emitMany:s=>{for(const r of s){this._producerConsumer.produce({ok:true,value:{done:false,value:r}})}},reject:s=>this._finishError(s)});if(!this._producerConsumer.hasFinalValue){try{await n;this._finishOk()}catch(s){this._finishError(s)}}})}static fromArray(e){return new Yi(i=>{i.emitMany(e)})}static fromPromise(e){return new Yi(async i=>{i.emitMany(await e)})}static fromPromisesResolveOrder(e){return new Yi(async i=>{await Promise.all(e.map(async n=>i.emitOne(await n)))})}static merge(e){return new Yi(async i=>{await Promise.all(e.map(async n=>{for await(const s of n){i.emitOne(s)}}))})}static{this.EMPTY=Yi.fromArray([])}static map(e,i){return new Yi(async n=>{for await(const s of e){n.emitOne(i(s))}})}static tee(e){let i;let n;const s=new Bn;const r=async()=>{if(!i||!n){return}try{for await(const l of e){i.emitOne(l);n.emitOne(l)}}catch(l){i.reject(l);n.reject(l)}finally{s.complete()}};const o=new Yi(async l=>{i=l;r();return s.p});const a=new Yi(async l=>{n=l;r();return s.p});return[o,a]}map(e){return Yi.map(this,e)}static coalesce(e){return Yi.filter(e,i=>!!i)}coalesce(){return Yi.coalesce(this)}static filter(e,i){return new Yi(async n=>{for await(const s of e){if(i(s)){n.emitOne(s)}}})}filter(e){return Yi.filter(this,e)}_finishOk(){if(!this._producerConsumer.hasFinalValue){this._producerConsumer.produceFinal({ok:true,value:{done:true,value:void 0}})}}_finishError(e){if(!this._producerConsumer.hasFinalValue){this._producerConsumer.produceFinal({ok:false,error:e})}}[Symbol.asyncIterator](){return this._iterator}}function x4(t,e,i,n){if(!t||n>200){return null}if(typeof t==="object"){if(t.$mid===nt.Uri){return i?b.revive(e.transformIncoming(t)):e.transformIncoming(t)}if(t instanceof ae){return null}for(const s in t){if(Object.hasOwnProperty.call(t,s)){const r=x4(t[s],e,i,n+1);if(r!==null){t[s]=r}}}}return null}function Ou(t,e){const i=x4(t,e,false,0);if(i===null){return t}return i}class E4{constructor(){this._actual=null;this._actualOk=null;this._actualErr=null;this._hasValue=false;this._value=null;this._hasErr=false;this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){if(!this._actual){this._actual=new Promise((e,i)=>{this._actualOk=e;this._actualErr=i;if(this._hasValue){this._actualOk(this._value)}if(this._hasErr){this._actualErr(this._err)}})}return this._actual}resolveOk(e){if(this._hasValue||this._hasErr){return}this._hasValue=true;this._value=e;if(this._actual){this._actualOk(e)}}resolveErr(e){if(this._hasValue||this._hasErr){return}this._hasErr=true;this._err=e;if(this._actual){this._actualErr(e)}else{Ti(e)}}then(e,i){return this._ensureActual().then(e,i)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}}class f8 extends E4{constructor(){super();this._hasErr=true;this._err=new Vi}}var UE;function U1(t,e){try{return JSON.stringify(t,e)}catch(i){return"null"}}const IS="$$ref$$";const p8={[IS]:-1};function $E(t,e=null,i=false){const n=[];const s=(i?U1:JSON.stringify)(t,(r,o)=>{if(typeof o==="undefined"){return p8}else if(typeof o==="object"){if(o instanceof ae){const a=n.push(o)-1;return{[IS]:a}}if(e){return e(r,o)}}return o});return{jsonString:s,referencedBuffers:n}}function C4(t,e,i){return JSON.parse(t,(n,s)=>{if(s){const r=s[IS];if(typeof r==="number"){return e[r]}if(i&&s.$mid===nt.Uri){return i.transformIncoming(s)}}return s})}function HE(t,e){return JSON.stringify(t,e)}function g8(t){if(!t){return null}return(e,i)=>{if(i&&i.$mid===nt.Uri){return t.transformOutgoing(i)}return i}}var Gn;(function(t){t[t["LocalSide"]=0]="LocalSide";t[t["OtherSide"]=1]="OtherSide"})(Gn||(Gn={}));var fd;(function(t){t[t["Responsive"]=0]="Responsive";t[t["Unresponsive"]=1]="Unresponsive"})(fd||(fd={}));const m8=()=>{};const _8=Symbol.for("rpcProtocol");const v8=Symbol.for("rpcProxy");class Wp extends me{static{UE=_8}static{this.UNRESPONSIVE_TIME=3*1e3}constructor(e,i=null,n=null){super();this[UE]=true;this._onDidChangeResponsiveState=this._register(new L);this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event;this._protocol=e;this._logger=i;this._uriTransformer=n;this._uriReplacer=g8(this._uriTransformer);this._isDisposed=false;this._locals=[];this._proxies=[];for(let s=0,r=T_.count;s<r;s++){this._locals[s]=null;this._proxies[s]=null}this._lastMessageId=0;this._cancelInvokedHandlers=Object.create(null);this._pendingRPCReplies={};this._responsiveState=fd.Responsive;this._unacknowledgedCount=0;this._unresponsiveTime=0;this._asyncCheckUresponsive=this._register(new wl(()=>this._checkUnresponsive(),1e3));this._register(this._protocol.onMessage(s=>this._receiveOneMessage(s)))}dispose(){this._isDisposed=true;Object.keys(this._pendingRPCReplies).forEach(e=>{const i=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e];i.resolveErr(tE())});super.dispose()}drain(){if(typeof this._protocol.drain==="function"){return this._protocol.drain()}return Promise.resolve()}_onWillSendRequest(e){if(this._unacknowledgedCount===0){this._unresponsiveTime=Date.now()+Wp.UNRESPONSIVE_TIME}this._unacknowledgedCount++;if(!this._asyncCheckUresponsive.isScheduled()){this._asyncCheckUresponsive.schedule()}}_onDidReceiveAcknowledge(e){this._unresponsiveTime=Date.now()+Wp.UNRESPONSIVE_TIME;this._unacknowledgedCount--;if(this._unacknowledgedCount===0){this._asyncCheckUresponsive.cancel()}this._setResponsiveState(fd.Responsive)}_checkUnresponsive(){if(this._unacknowledgedCount===0){return}if(Date.now()>this._unresponsiveTime){this._setResponsiveState(fd.Unresponsive)}else{this._asyncCheckUresponsive.schedule()}}_setResponsiveState(e){if(this._responsiveState===e){return}this._responsiveState=e;this._onDidChangeResponsiveState.fire(this._responsiveState)}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){if(!this._uriTransformer){return e}return Ou(e,this._uriTransformer)}getProxy(e){const{nid:i,sid:n}=e;if(!this._proxies[i]){this._proxies[i]=this._createProxy(i,n)}return this._proxies[i]}_createProxy(e,i){const n={get:(s,r)=>{if(typeof r==="string"&&!s[r]&&r.charCodeAt(0)===M.DollarSign){s[r]=(...o)=>{return this._remoteCall(e,r,o)}}if(r===v8){return i}return s[r]}};return new Proxy(Object.create(null),n)}set(e,i){this._locals[e.nid]=i;return i}assertRegistered(e){for(let i=0,n=e.length;i<n;i++){const s=e[i];if(!this._locals[s.nid]){throw new Error(`Missing proxy instance ${s.sid}`)}}}_receiveOneMessage(e){if(this._isDisposed){return}const i=e.byteLength;const n=Wt.read(e,0);const s=n.readUInt8();const r=n.readUInt32();switch(s){case Mt.RequestJSONArgs:case Mt.RequestJSONArgsWithCancellation:{let{rpcId:o,method:a,args:l}=jn.deserializeRequestJSONArgs(n);if(this._uriTransformer){l=Ou(l,this._uriTransformer)}this._receiveRequest(i,r,o,a,l,s===Mt.RequestJSONArgsWithCancellation);break}case Mt.RequestMixedArgs:case Mt.RequestMixedArgsWithCancellation:{let{rpcId:o,method:a,args:l}=jn.deserializeRequestMixedArgs(n);if(this._uriTransformer){l=Ou(l,this._uriTransformer)}this._receiveRequest(i,r,o,a,l,s===Mt.RequestMixedArgsWithCancellation);break}case Mt.Acknowledged:{this._logger?.logIncoming(i,r,Gn.LocalSide,`ack`);this._onDidReceiveAcknowledge(r);break}case Mt.Cancel:{this._receiveCancel(i,r);break}case Mt.ReplyOKEmpty:{this._receiveReply(i,r,void 0);break}case Mt.ReplyOKJSON:{let o=jn.deserializeReplyOKJSON(n);if(this._uriTransformer){o=Ou(o,this._uriTransformer)}this._receiveReply(i,r,o);break}case Mt.ReplyOKJSONWithBuffers:{const o=jn.deserializeReplyOKJSONWithBuffers(n,this._uriTransformer);this._receiveReply(i,r,o);break}case Mt.ReplyOKVSBuffer:{const o=jn.deserializeReplyOKVSBuffer(n);this._receiveReply(i,r,o);break}case Mt.ReplyErrError:{let o=jn.deserializeReplyErrError(n);if(this._uriTransformer){o=Ou(o,this._uriTransformer)}this._receiveReplyErr(i,r,o);break}case Mt.ReplyErrEmpty:{this._receiveReplyErr(i,r,void 0);break}default:console.error(`received unexpected message`);console.error(e)}}_receiveRequest(e,i,n,s,r,o){this._logger?.logIncoming(e,i,Gn.OtherSide,`receiveRequest ${If(n)}.${s}(`,r);const a=String(i);let l;let c;if(o){const d=new Tt;r.push(d.token);l=this._invokeHandler(n,s,r);c=()=>d.cancel()}else{l=this._invokeHandler(n,s,r);c=m8}this._cancelInvokedHandlers[a]=c;const u=jn.serializeAcknowledged(i);this._logger?.logOutgoing(u.byteLength,i,Gn.OtherSide,`ack`);this._protocol.send(u);l.then(d=>{delete this._cancelInvokedHandlers[a];const f=jn.serializeReplyOK(i,d,this._uriReplacer);this._logger?.logOutgoing(f.byteLength,i,Gn.OtherSide,`reply:`,d);this._protocol.send(f)},d=>{delete this._cancelInvokedHandlers[a];const f=jn.serializeReplyErr(i,d);this._logger?.logOutgoing(f.byteLength,i,Gn.OtherSide,`replyErr:`,d);this._protocol.send(f)})}_receiveCancel(e,i){this._logger?.logIncoming(e,i,Gn.OtherSide,`receiveCancel`);const n=String(i);this._cancelInvokedHandlers[n]?.()}_receiveReply(e,i,n){this._logger?.logIncoming(e,i,Gn.LocalSide,`receiveReply:`,n);const s=String(i);if(!this._pendingRPCReplies.hasOwnProperty(s)){return}const r=this._pendingRPCReplies[s];delete this._pendingRPCReplies[s];r.resolveOk(n)}_receiveReplyErr(e,i,n){this._logger?.logIncoming(e,i,Gn.LocalSide,`receiveReplyErr:`,n);const s=String(i);if(!this._pendingRPCReplies.hasOwnProperty(s)){return}const r=this._pendingRPCReplies[s];delete this._pendingRPCReplies[s];let o=void 0;if(n){if(n.$isError){o=new Error;o.name=n.name;o.message=n.message;o.stack=n.stack}else{o=n}}r.resolveErr(o)}_invokeHandler(e,i,n){try{return Promise.resolve(this._doInvokeHandler(e,i,n))}catch(s){return Promise.reject(s)}}_doInvokeHandler(e,i,n){const s=this._locals[e];if(!s){throw new Error("Unknown actor "+If(e))}const r=s[i];if(typeof r!=="function"){throw new Error("Unknown method "+i+" on actor "+If(e))}return r.apply(s,n)}_remoteCall(e,i,n){if(this._isDisposed){return new f8}let s=null;if(n.length>0&&Ze.isCancellationToken(n[n.length-1])){s=n.pop()}if(s&&s.isCancellationRequested){return Promise.reject(tE())}const r=jn.serializeRequestArguments(n,this._uriReplacer);const o=++this._lastMessageId;const a=String(o);const l=new E4;const c=new pe;if(s){c.add(s.onCancellationRequested(()=>{const d=jn.serializeCancel(o);this._logger?.logOutgoing(d.byteLength,o,Gn.LocalSide,`cancel`);this._protocol.send(d)}))}this._pendingRPCReplies[a]=new w8(l,c);this._onWillSendRequest(o);const u=jn.serializeRequest(o,e,i,r,!!s);this._logger?.logOutgoing(u.byteLength,o,Gn.LocalSide,`request: ${If(e)}.${i}(`,n);this._protocol.send(u);return l}}class w8{constructor(e,i){this._promise=e;this._disposable=i}resolveOk(e){this._promise.resolveOk(e);this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e);this._disposable.dispose()}}class Wt{static alloc(e,i,n){const s=new Wt(ae.alloc(n+1+4),0);s.writeUInt8(e);s.writeUInt32(i);return s}static read(e,i){return new Wt(e,i)}get buffer(){return this._buff}constructor(e,i){this._buff=e;this._offset=i}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(e){this._buff.writeUInt8(e,this._offset);this._offset+=1}readUInt8(){const e=this._buff.readUInt8(this._offset);this._offset+=1;return e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset);this._offset+=4}readUInt32(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;return e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset);this._offset+=1;this._buff.set(e,this._offset);this._offset+=e.byteLength}readShortString(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const i=this._buff.slice(this._offset,this._offset+e);const n=i.toString();this._offset+=e;return n}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset);this._offset+=4;this._buff.set(e,this._offset);this._offset+=e.byteLength}readLongString(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+e);const n=i.toString();this._offset+=e;return n}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset);this._offset+=4;this._buff.set(e,this._offset);this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset);this._offset+=4;this._buff.set(e,this._offset);this._offset+=e.byteLength}readVSBuffer(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+e);this._offset+=e;return i}static sizeMixedArray(e){let i=0;i+=1;for(let n=0,s=e.length;n<s;n++){const r=e[n];i+=1;switch(r.type){case pi.String:i+=this.sizeLongString(r.value);break;case pi.VSBuffer:i+=this.sizeVSBuffer(r.value);break;case pi.SerializedObjectWithBuffers:i+=this.sizeUInt32;i+=this.sizeLongString(r.value);for(let o=0;o<r.buffers.length;++o){i+=this.sizeVSBuffer(r.buffers[o])}break}}return i}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset);this._offset+=1;for(let i=0,n=e.length;i<n;i++){const s=e[i];switch(s.type){case pi.String:this.writeUInt8(pi.String);this.writeLongString(s.value);break;case pi.VSBuffer:this.writeUInt8(pi.VSBuffer);this.writeVSBuffer(s.value);break;case pi.SerializedObjectWithBuffers:this.writeUInt8(pi.SerializedObjectWithBuffers);this.writeUInt32(s.buffers.length);this.writeLongString(s.value);for(let r=0;r<s.buffers.length;++r){this.writeBuffer(s.buffers[r])}break;case pi.Undefined:this.writeUInt8(pi.Undefined);break}}}readMixedArray(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const i=new Array(e);for(let n=0;n<e;n++){const s=this.readUInt8();switch(s){case pi.String:i[n]=this.readLongString();break;case pi.VSBuffer:i[n]=this.readVSBuffer();break;case pi.SerializedObjectWithBuffers:{const r=this.readUInt32();const o=this.readLongString();const a=[];for(let l=0;l<r;++l){a.push(this.readVSBuffer())}i[n]=new ji(C4(o,a,null));break}case pi.Undefined:i[n]=void 0;break}}return i}}var ql;(function(t){t[t["Simple"]=0]="Simple";t[t["Mixed"]=1]="Mixed"})(ql||(ql={}));class jn{static _useMixedArgSerialization(e){for(let i=0,n=e.length;i<n;i++){if(e[i]instanceof ae){return true}if(e[i]instanceof ji){return true}if(typeof e[i]==="undefined"){return true}}return false}static serializeRequestArguments(e,i){if(this._useMixedArgSerialization(e)){const n=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];if(o instanceof ae){n[s]={type:pi.VSBuffer,value:o}}else if(typeof o==="undefined"){n[s]={type:pi.Undefined}}else if(o instanceof ji){const{jsonString:a,referencedBuffers:l}=$E(o.value,i);n[s]={type:pi.SerializedObjectWithBuffers,value:ae.fromString(a),buffers:l}}else{n[s]={type:pi.String,value:ae.fromString(HE(o,i))}}}return{type:ql.Mixed,args:n}}return{type:ql.Simple,args:HE(e,i)}}static serializeRequest(e,i,n,s,r){switch(s.type){case ql.Simple:return this._requestJSONArgs(e,i,n,s.args,r);case ql.Mixed:return this._requestMixedArgs(e,i,n,s.args,r)}}static _requestJSONArgs(e,i,n,s,r){const o=ae.fromString(n);const a=ae.fromString(s);let l=0;l+=Wt.sizeUInt8();l+=Wt.sizeShortString(o);l+=Wt.sizeLongString(a);const c=Wt.alloc(r?Mt.RequestJSONArgsWithCancellation:Mt.RequestJSONArgs,e,l);c.writeUInt8(i);c.writeShortString(o);c.writeLongString(a);return c.buffer}static deserializeRequestJSONArgs(e){const i=e.readUInt8();const n=e.readShortString();const s=e.readLongString();return{rpcId:i,method:n,args:JSON.parse(s)}}static _requestMixedArgs(e,i,n,s,r){const o=ae.fromString(n);let a=0;a+=Wt.sizeUInt8();a+=Wt.sizeShortString(o);a+=Wt.sizeMixedArray(s);const l=Wt.alloc(r?Mt.RequestMixedArgsWithCancellation:Mt.RequestMixedArgs,e,a);l.writeUInt8(i);l.writeShortString(o);l.writeMixedArray(s);return l.buffer}static deserializeRequestMixedArgs(e){const i=e.readUInt8();const n=e.readShortString();const s=e.readMixedArray();const r=new Array(s.length);for(let o=0,a=s.length;o<a;o++){const l=s[o];if(typeof l==="string"){r[o]=JSON.parse(l)}else{r[o]=l}}return{rpcId:i,method:n,args:r}}static serializeAcknowledged(e){return Wt.alloc(Mt.Acknowledged,e,0).buffer}static serializeCancel(e){return Wt.alloc(Mt.Cancel,e,0).buffer}static serializeReplyOK(e,i,n){if(typeof i==="undefined"){return this._serializeReplyOKEmpty(e)}else if(i instanceof ae){return this._serializeReplyOKVSBuffer(e,i)}else if(i instanceof ji){const{jsonString:s,referencedBuffers:r}=$E(i.value,n,true);return this._serializeReplyOKJSONWithBuffers(e,s,r)}else{return this._serializeReplyOKJSON(e,U1(i,n))}}static _serializeReplyOKEmpty(e){return Wt.alloc(Mt.ReplyOKEmpty,e,0).buffer}static _serializeReplyOKVSBuffer(e,i){let n=0;n+=Wt.sizeVSBuffer(i);const s=Wt.alloc(Mt.ReplyOKVSBuffer,e,n);s.writeVSBuffer(i);return s.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,i){const n=ae.fromString(i);let s=0;s+=Wt.sizeLongString(n);const r=Wt.alloc(Mt.ReplyOKJSON,e,s);r.writeLongString(n);return r.buffer}static _serializeReplyOKJSONWithBuffers(e,i,n){const s=ae.fromString(i);let r=0;r+=Wt.sizeUInt32;r+=Wt.sizeLongString(s);for(const a of n){r+=Wt.sizeVSBuffer(a)}const o=Wt.alloc(Mt.ReplyOKJSONWithBuffers,e,r);o.writeUInt32(n.length);o.writeLongString(s);for(const a of n){o.writeBuffer(a)}return o.buffer}static deserializeReplyOKJSON(e){const i=e.readLongString();return JSON.parse(i)}static deserializeReplyOKJSONWithBuffers(e,i){const n=e.readUInt32();const s=e.readLongString();const r=[];for(let o=0;o<n;++o){r.push(e.readVSBuffer())}return new ji(C4(s,r,i))}static serializeReplyErr(e,i){const n=i?U1(Rc(i),null):void 0;if(typeof n!=="string"){return this._serializeReplyErrEmpty(e)}const s=ae.fromString(n);let r=0;r+=Wt.sizeLongString(s);const o=Wt.alloc(Mt.ReplyErrError,e,r);o.writeLongString(s);return o.buffer}static deserializeReplyErrError(e){const i=e.readLongString();return JSON.parse(i)}static _serializeReplyErrEmpty(e){return Wt.alloc(Mt.ReplyErrEmpty,e,0).buffer}}var Mt;(function(t){t[t["RequestJSONArgs"]=1]="RequestJSONArgs";t[t["RequestJSONArgsWithCancellation"]=2]="RequestJSONArgsWithCancellation";t[t["RequestMixedArgs"]=3]="RequestMixedArgs";t[t["RequestMixedArgsWithCancellation"]=4]="RequestMixedArgsWithCancellation";t[t["Acknowledged"]=5]="Acknowledged";t[t["Cancel"]=6]="Cancel";t[t["ReplyOKEmpty"]=7]="ReplyOKEmpty";t[t["ReplyOKVSBuffer"]=8]="ReplyOKVSBuffer";t[t["ReplyOKJSON"]=9]="ReplyOKJSON";t[t["ReplyOKJSONWithBuffers"]=10]="ReplyOKJSONWithBuffers";t[t["ReplyErrError"]=11]="ReplyErrError";t[t["ReplyErrEmpty"]=12]="ReplyErrEmpty"})(Mt||(Mt={}));var pi;(function(t){t[t["String"]=1]="String";t[t["VSBuffer"]=2]="VSBuffer";t[t["SerializedObjectWithBuffers"]=3]="SerializedObjectWithBuffers";t[t["Undefined"]=4]="Undefined"})(pi||(pi={}));function k4(t){if(!t){return void 0}const e=t.indexOf("+");if(e<0){return t}return t.substr(0,e)}const b8=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var BE;(function(t){t[t["System"]=0]="System";t[t["User"]=1]="User"})(BE||(BE={}));var $1;(function(t){t["WIN32_X64"]="win32-x64";t["WIN32_ARM64"]="win32-arm64";t["LINUX_X64"]="linux-x64";t["LINUX_ARM64"]="linux-arm64";t["LINUX_ARMHF"]="linux-armhf";t["ALPINE_X64"]="alpine-x64";t["ALPINE_ARM64"]="alpine-arm64";t["DARWIN_X64"]="darwin-x64";t["DARWIN_ARM64"]="darwin-arm64";t["WEB"]="web";t["UNIVERSAL"]="universal";t["UNKNOWN"]="unknown";t["UNDEFINED"]="undefined"})($1||($1={}));class ht{constructor(e){this.value=e;this._lower=e.toLowerCase()}static equals(e,i){if(typeof e==="undefined"||e===null){return typeof i==="undefined"||i===null}if(typeof i==="undefined"||i===null){return false}if(typeof e==="string"||typeof i==="string"){const n=typeof e==="string"?e:e.value;const s=typeof i==="string"?i:i.value;return Rr(n,s)}return e._lower===i._lower}static toKey(e){if(typeof e==="string"){return e.toLowerCase()}return e._lower}}class bl{get size(){return this._set.size}constructor(e){this._set=new Set;if(e){for(const i of e){this.add(i)}}}add(e){this._set.add(ht.toKey(e))}delete(e){return this._set.delete(ht.toKey(e))}has(e){return this._set.has(ht.toKey(e))}}class $o{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(ht.toKey(e))}get(e){return this._map.get(ht.toKey(e))}has(e){return this._map.has(ht.toKey(e))}set(e,i){this._map.set(ht.toKey(e),i)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}}class D4 extends Error{constructor(e,i,n){super(`Error in extension ${ht.toKey(e)}: ${n??i.message}`,{cause:i});this.name="ExtensionError";this.extension=e}}var Cs;(function(t){t.serviceIds=new Map;t.DI_TARGET="$di$target";t.DI_DEPENDENCIES="$di$dependencies";function e(i){return i[t.DI_DEPENDENCIES]||[]}t.getServiceDependencies=e})(Cs||(Cs={}));const yl=te("instantiationService");function y8(t,e,i){if(e[Cs.DI_TARGET]===e){e[Cs.DI_DEPENDENCIES].push({id:t,index:i})}else{e[Cs.DI_DEPENDENCIES]=[{id:t,index:i}];e[Cs.DI_TARGET]=e}}function te(t){if(Cs.serviceIds.has(t)){return Cs.serviceIds.get(t)}const e=function(i,n,s){if(arguments.length!==3){throw new Error("@IServiceName-decorator can only be used to decorate a parameter")}y8(e,i,s)};e.toString=()=>t;Cs.serviceIds.set(t,e);return e}function S8(t){return t}const et=te("logService");const Ko=te("loggerService");class vs{constructor(e,i=[],n=false){this.ctor=e;this.staticArguments=i;this.supportsDelayedInstantiation=n}}const I4=[];var bt;(function(t){t[t["Eager"]=0]="Eager";t[t["Delayed"]=1]="Delayed"})(bt||(bt={}));function xt(t,e,i){if(!(e instanceof vs)){e=new vs(e,[],Boolean(i))}I4.push([t,e])}function x8(){return I4}class TS{constructor(...e){this._entries=new Map;for(const[i,n]of e){this.set(i,n)}}set(e,i){const n=this._entries.get(e);this._entries.set(e,i);return n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const wi=te("IExtHostInitDataService");let E8=class kW{constructor(e,i){this.key=e;this.data=i;this.incoming=new Map;this.outgoing=new Map}};class WE{constructor(e){this._hashFn=e;this._nodes=new Map}roots(){const e=[];for(const i of this._nodes.values()){if(i.outgoing.size===0){e.push(i)}}return e}insertEdge(e,i){const n=this.lookupOrInsertNode(e);const s=this.lookupOrInsertNode(i);n.outgoing.set(s.key,s);s.incoming.set(n.key,n)}removeNode(e){const i=this._hashFn(e);this._nodes.delete(i);for(const n of this._nodes.values()){n.outgoing.delete(i);n.incoming.delete(i)}}lookupOrInsertNode(e){const i=this._hashFn(e);let n=this._nodes.get(i);if(!n){n=new E8(i,e);this._nodes.set(i,n)}return n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[i,n]of this._nodes){e.push(`${i}
	(-> incoming)[${[...n.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...n.outgoing.keys()].join(",")}]
`)}return e.join("\n")}findCycleSlow(){for(const[e,i]of this._nodes){const n=new Set([e]);const s=this._findCycle(i,n);if(s){return s}}return void 0}_findCycle(e,i){for(const[n,s]of e.outgoing){if(i.has(n)){return[...i,n].join(" -> ")}i.add(n);const r=this._findCycle(s,i);if(r){return r}i.delete(n)}return void 0}}const C8=false;class VE extends Error{constructor(e){super("cyclic dependency between services");this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class Vp{constructor(e=new TS,i=false,n,s=C8){this._services=e;this._strict=i;this._parent=n;this._enableTracing=s;this._isDisposed=false;this._servicesToMaybeDispose=new Set;this._children=new Set;this._activeInstantiations=new Set;this._services.set(yl,this);this._globalGraph=s?n?._globalGraph??new WE(r=>r):void 0}dispose(){if(!this._isDisposed){this._isDisposed=true;Jn(this._children);this._children.clear();for(const e of this._servicesToMaybeDispose){if(BT(e)){e.dispose()}}this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed){throw new Error("InstantiationService has been disposed")}}createChild(e,i){this._throwIfDisposed();const n=this;const s=new class extends Vp{dispose(){n._children.delete(s);super.dispose()}}(e,this._strict,this,this._enableTracing);this._children.add(s);i?.add(s);return s}invokeFunction(e,...i){this._throwIfDisposed();const n=Nn.traceInvocation(this._enableTracing,e);let s=false;try{const r={get:o=>{if(s){throw mS("service accessor is only valid during the invocation of its target method")}const a=this._getOrCreateServiceInstance(o,n);if(!a){this._throwIfStrict(`[invokeFunction] unknown service '${o}'`,false)}return a}};return e(r,...i)}finally{s=true;n.stop()}}createInstance(e,...i){this._throwIfDisposed();let n;let s;if(e instanceof vs){n=Nn.traceCreation(this._enableTracing,e.ctor);s=this._createInstance(e.ctor,e.staticArguments.concat(i),n)}else{n=Nn.traceCreation(this._enableTracing,e);s=this._createInstance(e,i,n)}n.stop();return s}_createInstance(e,i=[],n){const s=Cs.getServiceDependencies(e).sort((a,l)=>a.index-l.index);const r=[];for(const a of s){const l=this._getOrCreateServiceInstance(a.id,n);if(!l){this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,false)}r.push(l)}const o=s.length>0?s[0].index:i.length;if(i.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${i.length} static arguments`);const a=o-i.length;if(a>0){i=i.concat(new Array(a))}else{i=i.slice(0,o)}}return Reflect.construct(e,i.concat(r))}_setCreatedServiceInstance(e,i){if(this._services.get(e)instanceof vs){this._services.set(e,i)}else if(this._parent){this._parent._setCreatedServiceInstance(e,i)}else{throw new Error("illegalState - setting UNKNOWN service instance")}}_getServiceInstanceOrDescriptor(e){const i=this._services.get(e);if(!i&&this._parent){return this._parent._getServiceInstanceOrDescriptor(e)}else{return i}}_getOrCreateServiceInstance(e,i){if(this._globalGraph&&this._globalGraphImplicitDependency){this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e))}const n=this._getServiceInstanceOrDescriptor(e);if(n instanceof vs){return this._safeCreateAndCacheServiceInstance(e,n,i.branch(e,true))}else{i.branch(e,false);return n}}_safeCreateAndCacheServiceInstance(e,i,n){if(this._activeInstantiations.has(e)){throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`)}this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,i,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,i,n){const s=new WE(l=>l.id.toString());let r=0;const o=[{id:e,desc:i,_trace:n}];const a=new Set;while(o.length){const l=o.pop();if(a.has(String(l.id))){continue}a.add(String(l.id));s.lookupOrInsertNode(l);if(r++>1e3){throw new VE(s)}for(const c of Cs.getServiceDependencies(l.desc.ctor)){const u=this._getServiceInstanceOrDescriptor(c.id);if(!u){this._throwIfStrict(`[createInstance] ${e} depends on ${c.id} which is NOT registered.`,true)}this._globalGraph?.insertEdge(String(l.id),String(c.id));if(u instanceof vs){const d={id:c.id,desc:u,_trace:l._trace.branch(c.id,true)};if(!s.lookup(d)){o.push(d)}s.insertEdge(l,d)}}}while(true){const l=s.roots();if(l.length===0){if(!s.isEmpty()){throw new VE(s)}break}for(const{data:c}of l){const u=this._getServiceInstanceOrDescriptor(c.id);if(u instanceof vs){const d=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setCreatedServiceInstance(c.id,d)}s.removeNode(c)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,i,n=[],s,r){if(this._services.get(e)instanceof vs){return this._createServiceInstance(e,i,n,s,r,this._servicesToMaybeDispose)}else if(this._parent){return this._parent._createServiceInstanceWithOwner(e,i,n,s,r)}else{throw new Error(`illegalState - creating UNKNOWN service instance ${i.name}`)}}_createServiceInstance(e,i,n=[],s,r,o){if(!s){const a=this._createInstance(i,n,r);o.add(a);return a}else{const a=new Vp(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map;const c=new u8(()=>{const u=a._createInstance(i,n,r);for(const[d,f]of l){const p=u[d];if(typeof p==="function"){for(const m of f){m.disposable=p.apply(u,m.listener)}}}l.clear();o.add(u);return u});return new Proxy(Object.create(null),{get(u,d){if(!c.isInitialized){if(typeof d==="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let m=l.get(d);if(!m){m=new Go;l.set(d,m)}const v=(y,k,S)=>{if(c.isInitialized){return c.value[d](y,k,S)}else{const R={listener:[y,k,S],disposable:void 0};const K=m.push(R);const q=ye(()=>{K();R.disposable?.dispose()});return q}};return v}}if(d in u){return u[d]}const f=c.value;let p=f[d];if(typeof p!=="function"){return p}p=p.bind(f);u[d]=p;return p},set(u,d,f){c.value[d]=f;return true},getPrototypeOf(u){return i.prototype}})}}_throwIfStrict(e,i){if(i){console.warn(e)}if(this._strict){throw new Error(e)}}}var pa;(function(t){t[t["None"]=0]="None";t[t["Creation"]=1]="Creation";t[t["Invocation"]=2]="Invocation";t[t["Branch"]=3]="Branch"})(pa||(pa={}));class Nn{static{this.all=new Set}static{this._None=new class extends Nn{constructor(){super(pa.None,null)}stop(){}branch(){return this}}}static traceInvocation(e,i){return!e?Nn._None:new Nn(pa.Invocation,i.name||new Error().stack.split("\n").slice(3,4).join("\n"))}static traceCreation(e,i){return!e?Nn._None:new Nn(pa.Creation,i.name)}static{this._totals=0}constructor(e,i){this.type=e;this.name=i;this._start=Date.now();this._dep=[]}branch(e,i){const n=new Nn(pa.Branch,e.toString());this._dep.push([e,i,n]);return n}stop(){const e=Date.now()-this._start;Nn._totals+=e;let i=false;function n(r,o){const a=[];const l=new Array(r+1).join("	");for(const[c,u,d]of o._dep){if(u&&d){i=true;a.push(`${l}CREATES -> ${c}`);const f=n(r+1,d);if(f){a.push(f)}}else{a.push(`${l}uses -> ${c}`)}}return a.join("\n")}const s=[`${this.type===pa.Creation?"CREATE":"CALL"} ${this.name}`,`${n(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${Nn._totals.toFixed(2)}ms)`];if(e>2||i){Nn.all.add(s.join("\n"))}}}const st=te("IExtHostRpcService");class k8{constructor(e){this.getProxy=e.getProxy.bind(e);this.set=e.set.bind(e);this.dispose=e.dispose.bind(e);this.assertRegistered=e.assertRegistered.bind(e);this.drain=e.drain.bind(e)}}const P_=te("IURITransformerService");class D8{constructor(e){if(!e){this.transformIncoming=i=>i;this.transformOutgoing=i=>i;this.transformOutgoingURI=i=>i;this.transformOutgoingScheme=i=>i}else{this.transformIncoming=e.transformIncoming.bind(e);this.transformOutgoing=e.transformOutgoing.bind(e);this.transformOutgoingURI=e.transformOutgoingURI.bind(e);this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)}}}function W(t,e,i,n){var s=arguments.length,r=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)if(o=t[a])r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r;return s>3&&r&&Object.defineProperty(e,i,r),r}function P(t,e){return function(i,n){e(i,n,t)}}class I8{constructor(){this._value="";this._pos=0}reset(e){this._value=e;this._pos=0;return this}next(){this._pos+=1;return this}hasNext(){return this._pos<this._value.length-1}cmp(e){const i=e.charCodeAt(0);const n=this._value.charCodeAt(this._pos);return i-n}value(){return this._value[this._pos]}}class T8{constructor(e=true){this._caseSensitive=e}reset(e){this._value=e;this._from=0;this._to=0;return this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=true;for(;this._to<this._value.length;this._to++){const i=this._value.charCodeAt(this._to);if(i===M.Period){if(e){this._from++}else{break}}else{e=false}}return this}cmp(e){return this._caseSensitive?ES(e,this._value,0,e.length,this._from,this._to):vu(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class T4{constructor(e=true,i=true){this._splitOnBackslash=e;this._caseSensitive=i}reset(e){this._from=0;this._to=0;this._value=e;this._valueLen=e.length;for(let i=e.length-1;i>=0;i--,this._valueLen--){const n=this._value.charCodeAt(i);if(!(n===M.Slash||this._splitOnBackslash&&n===M.Backslash)){break}}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=true;for(;this._to<this._valueLen;this._to++){const i=this._value.charCodeAt(this._to);if(i===M.Slash||this._splitOnBackslash&&i===M.Backslash){if(e){this._from++}else{break}}else{e=false}}return this}cmp(e){return this._caseSensitive?ES(e,this._value,0,e.length,this._from,this._to):vu(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}var Ei;(function(t){t[t["Scheme"]=1]="Scheme";t[t["Authority"]=2]="Authority";t[t["Path"]=3]="Path";t[t["Query"]=4]="Query";t[t["Fragment"]=5]="Fragment"})(Ei||(Ei={}));class P4{constructor(e,i){this._ignorePathCasing=e;this._ignoreQueryAndFragment=i;this._states=[];this._stateIdx=0}reset(e){this._value=e;this._states=[];if(this._value.scheme){this._states.push(Ei.Scheme)}if(this._value.authority){this._states.push(Ei.Authority)}if(this._value.path){this._pathIterator=new T4(false,!this._ignorePathCasing(e));this._pathIterator.reset(e.path);if(this._pathIterator.value()){this._states.push(Ei.Path)}}if(!this._ignoreQueryAndFragment(e)){if(this._value.query){this._states.push(Ei.Query)}if(this._value.fragment){this._states.push(Ei.Fragment)}}this._stateIdx=0;return this}next(){if(this._states[this._stateIdx]===Ei.Path&&this._pathIterator.hasNext()){this._pathIterator.next()}else{this._stateIdx+=1}return this}hasNext(){return this._states[this._stateIdx]===Ei.Path&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===Ei.Scheme){return M1(e,this._value.scheme)}else if(this._states[this._stateIdx]===Ei.Authority){return M1(e,this._value.authority)}else if(this._states[this._stateIdx]===Ei.Path){return this._pathIterator.cmp(e)}else if(this._states[this._stateIdx]===Ei.Query){return rl(e,this._value.query)}else if(this._states[this._stateIdx]===Ei.Fragment){return rl(e,this._value.fragment)}throw new Error}value(){if(this._states[this._stateIdx]===Ei.Scheme){return this._value.scheme}else if(this._states[this._stateIdx]===Ei.Authority){return this._value.authority}else if(this._states[this._stateIdx]===Ei.Path){return this._pathIterator.value()}else if(this._states[this._stateIdx]===Ei.Query){return this._value.query}else if(this._states[this._stateIdx]===Ei.Fragment){return this._value.fragment}throw new Error}}class qs{static{this.Val=Symbol("undefined_placeholder")}static wrap(e){return e===void 0?qs.Val:e}static unwrap(e){return e===qs.Val?void 0:e}}class Tf{constructor(){this.height=1;this.value=void 0;this.key=void 0;this.left=void 0;this.mid=void 0;this.right=void 0}isEmpty(){return!this.left&&!this.mid&&!this.right&&this.value===void 0}rotateLeft(){const e=this.right;this.right=e.left;e.left=this;this.updateHeight();e.updateHeight();return e}rotateRight(){const e=this.left;this.left=e.right;e.right=this;this.updateHeight();e.updateHeight();return e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}}var St;(function(t){t[t["Left"]=-1]="Left";t[t["Mid"]=0]="Mid";t[t["Right"]=1]="Right"})(St||(St={}));class Xs{static forUris(e=()=>false,i=()=>false){return new Xs(new P4(e,i))}static forPaths(e=false){return new Xs(new T4(void 0,!e))}static forStrings(){return new Xs(new I8)}static forConfigKeys(){return new Xs(new T8)}constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,i){if(i){const n=i.slice(0);nE(n);for(const s of n){this.set(s,e)}}else{const n=e.slice(0);nE(n);for(const s of n){this.set(s[0],s[1])}}}set(e,i){const n=this._iter.reset(e);let s;if(!this._root){this._root=new Tf;this._root.segment=n.value()}const r=[];s=this._root;while(true){const a=n.cmp(s.segment);if(a>0){if(!s.left){s.left=new Tf;s.left.segment=n.value()}r.push([St.Left,s]);s=s.left}else if(a<0){if(!s.right){s.right=new Tf;s.right.segment=n.value()}r.push([St.Right,s]);s=s.right}else if(n.hasNext()){n.next();if(!s.mid){s.mid=new Tf;s.mid.segment=n.value()}r.push([St.Mid,s]);s=s.mid}else{break}}const o=qs.unwrap(s.value);s.value=qs.wrap(i);s.key=e;for(let a=r.length-1;a>=0;a--){const l=r[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const u=r[a][0];const d=r[a+1][0];if(u===St.Right&&d===St.Right){r[a][1]=l.rotateLeft()}else if(u===St.Left&&d===St.Left){r[a][1]=l.rotateRight()}else if(u===St.Right&&d===St.Left){l.right=r[a+1][1]=r[a+1][1].rotateRight();r[a][1]=l.rotateLeft()}else if(u===St.Left&&d===St.Right){l.left=r[a+1][1]=r[a+1][1].rotateLeft();r[a][1]=l.rotateRight()}else{throw new Error}if(a>0){switch(r[a-1][0]){case St.Left:r[a-1][1].left=r[a][1];break;case St.Right:r[a-1][1].right=r[a][1];break;case St.Mid:r[a-1][1].mid=r[a][1];break}}else{this._root=r[0][1]}}}return o}get(e){return qs.unwrap(this._getNode(e)?.value)}_getNode(e){const i=this._iter.reset(e);let n=this._root;while(n){const s=i.cmp(n.segment);if(s>0){n=n.left}else if(s<0){n=n.right}else if(i.hasNext()){i.next();n=n.mid}else{break}}return n}has(e){const i=this._getNode(e);return!(i?.value===void 0&&i?.mid===void 0)}delete(e){return this._delete(e,false)}deleteSuperstr(e){return this._delete(e,true)}_delete(e,i){const n=this._iter.reset(e);const s=[];let r=this._root;while(r){const o=n.cmp(r.segment);if(o>0){s.push([St.Left,r]);r=r.left}else if(o<0){s.push([St.Right,r]);r=r.right}else if(n.hasNext()){n.next();s.push([St.Mid,r]);r=r.mid}else{break}}if(!r){return}if(i){r.left=void 0;r.mid=void 0;r.right=void 0;r.height=1}else{r.key=void 0;r.value=void 0}if(!r.mid&&!r.value){if(r.left&&r.right){const o=[[St.Right,r]];const a=this._min(r.right,o);if(a.key){r.key=a.key;r.value=a.value;r.segment=a.segment;const l=a.right;if(o.length>1){const[u,d]=o[o.length-1];switch(u){case St.Left:d.left=l;break;case St.Mid:D1(false);case St.Right:D1(false)}}else{r.right=l}const c=this._balanceByStack(o);if(s.length>0){const[u,d]=s[s.length-1];switch(u){case St.Left:d.left=c;break;case St.Mid:d.mid=c;break;case St.Right:d.right=c;break}}else{this._root=c}}}else{const o=r.left??r.right;if(s.length>0){const[a,l]=s[s.length-1];switch(a){case St.Left:l.left=o;break;case St.Mid:l.mid=o;break;case St.Right:l.right=o;break}}else{this._root=o}}}this._root=this._balanceByStack(s)??this._root}_min(e,i){while(e.left){i.push([St.Left,e]);e=e.left}return e}_balanceByStack(e){for(let i=e.length-1;i>=0;i--){const n=e[i][1];n.updateHeight();const s=n.balanceFactor();if(s>1){if(n.right.balanceFactor()>=0){e[i][1]=n.rotateLeft()}else{n.right=n.right.rotateRight();e[i][1]=n.rotateLeft()}}else if(s<-1){if(n.left.balanceFactor()<=0){e[i][1]=n.rotateRight()}else{n.left=n.left.rotateLeft();e[i][1]=n.rotateRight()}}if(i>0){switch(e[i-1][0]){case St.Left:e[i-1][1].left=e[i][1];break;case St.Right:e[i-1][1].right=e[i][1];break;case St.Mid:e[i-1][1].mid=e[i][1];break}}else{return e[0][1]}}return void 0}findSubstr(e){const i=this._iter.reset(e);let n=this._root;let s=void 0;while(n){const r=i.cmp(n.segment);if(r>0){n=n.left}else if(r<0){n=n.right}else if(i.hasNext()){i.next();s=qs.unwrap(n.value)||s;n=n.mid}else{break}}return n&&qs.unwrap(n.value)||s}findSuperstr(e){return this._findSuperstrOrElement(e,false)}_findSuperstrOrElement(e,i){const n=this._iter.reset(e);let s=this._root;while(s){const r=n.cmp(s.segment);if(r>0){s=s.left}else if(r<0){s=s.right}else if(n.hasNext()){n.next();s=s.mid}else{if(!s.mid){if(i){return qs.unwrap(s.value)}else{return void 0}}else{return this._entries(s.mid)}}}return void 0}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,true)!==void 0}forEach(e){for(const[i,n]of this){e(n,i)}}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const i=[];this._dfsEntries(e,i);return i[Symbol.iterator]()}_dfsEntries(e,i){if(!e){return}if(e.left){this._dfsEntries(e.left,i)}if(e.value!==void 0){i.push([e.key,qs.unwrap(e.value)])}if(e.mid){this._dfsEntries(e.mid,i)}if(e.right){this._dfsEntries(e.right,i)}}_isBalanced(){const e=i=>{if(!i){return true}const n=i.balanceFactor();if(n<-1||n>1){return false}return e(i.left)&&e(i.right)};return e(this._root)}}function Pt(t){if(!t||typeof t!=="object"){return t}if(t instanceof RegExp){return t}const e=Array.isArray(t)?[]:{};Object.entries(t).forEach(([i,n])=>{e[i]=n&&typeof n==="object"?Pt(n):n});return e}function H1(t){if(!t||typeof t!=="object"){return t}const e=[t];while(e.length>0){const i=e.shift();for(const n in i){if(A4.call(i,n)){const s=i[n];if(typeof s==="object"&&!Object.isFrozen(s)&&!iR(s)){e.push(s)}}}}return t}const A4=Object.prototype.hasOwnProperty;function $c(t,e){return B1(t,e,new Set)}function B1(t,e,i){if(ai(t)){return t}const n=e(t);if(typeof n!=="undefined"){return n}if(Array.isArray(t)){const s=[];for(const r of t){s.push(B1(r,e,i))}return s}if(Gt(t)){if(i.has(t)){throw new Error("Cannot clone recursive data-structure")}i.add(t);const s={};for(const r in t){if(A4.call(t,r)){s[r]=B1(t[r],e,i)}}i.delete(t);return s}return t}function ol(t,e,i=true){if(!Gt(t)){return e}if(Gt(e)){Object.keys(e).forEach(n=>{if(n in t){if(i){if(Gt(t[n])&&Gt(e[n])){ol(t[n],e[n],i)}else{t[n]=e[n]}}}else{t[n]=e[n]}})}return t}function Gi(t,e){if(t===e){return true}if(t===null||t===void 0||e===null||e===void 0){return false}if(typeof t!==typeof e){return false}if(typeof t!=="object"){return false}if(Array.isArray(t)!==Array.isArray(e)){return false}let i;let n;if(Array.isArray(t)){if(t.length!==e.length){return false}for(i=0;i<t.length;i++){if(!Gi(t[i],e[i])){return false}}}else{const s=[];for(n in t){s.push(n)}s.sort();const r=[];for(n in e){r.push(n)}r.sort();if(!Gi(s,r)){return false}for(i=0;i<s.length;i++){if(!Gi(t[s[i]],e[s[i]])){return false}}}return true}function P8(t){const e=new Set;return JSON.stringify(t,(i,n)=>{if(Gt(n)||Array.isArray(n)){if(e.has(n)){return"[Circular]"}else{e.add(n)}}if(typeof n==="bigint"){return`[BigInt ${n.toString()}]`}return n})}function zE(t,e){const i=Object.create(null);for(const[n,s]of Object.entries(t)){if(e(n,s)){i[n]=s}}return i}class A8{constructor(){this._next=0}getNext(){return this._next++}}var Wa;(function(t){t[t["Unknown"]=0]="Unknown";t[t["File"]=1]="File";t[t["Directory"]=2]="Directory";t[t["SymbolicLink"]=64]="SymbolicLink"})(Wa||(Wa={}));var Va;(function(t){t[t["Readonly"]=1]="Readonly";t[t["Locked"]=2]="Locked";t[t["Executable"]=4]="Executable"})(Va||(Va={}));var ao;(function(t){t[t["UPDATED"]=2]="UPDATED";t[t["ADDED"]=4]="ADDED";t[t["DELETED"]=8]="DELETED"})(ao||(ao={}));var ws;(function(t){t[t["None"]=0]="None";t[t["FileReadWrite"]=2]="FileReadWrite";t[t["FileOpenReadWriteClose"]=4]="FileOpenReadWriteClose";t[t["FileReadStream"]=16]="FileReadStream";t[t["FileFolderCopy"]=8]="FileFolderCopy";t[t["PathCaseSensitive"]=1024]="PathCaseSensitive";t[t["Readonly"]=2048]="Readonly";t[t["Trash"]=4096]="Trash";t[t["FileWriteUnlock"]=8192]="FileWriteUnlock";t[t["FileAtomicRead"]=16384]="FileAtomicRead";t[t["FileAtomicWrite"]=32768]="FileAtomicWrite";t[t["FileAtomicDelete"]=65536]="FileAtomicDelete";t[t["FileClone"]=131072]="FileClone";t[t["FileRealpath"]=262144]="FileRealpath";t[t["FileAppend"]=524288]="FileAppend"})(ws||(ws={}));var Oe;(function(t){t["FileExists"]="EntryExists";t["FileNotFound"]="EntryNotFound";t["FileNotADirectory"]="EntryNotADirectory";t["FileIsADirectory"]="EntryIsADirectory";t["FileExceedsStorageQuota"]="EntryExceedsStorageQuota";t["FileTooLarge"]="EntryTooLarge";t["FileWriteLocked"]="EntryWriteLocked";t["NoPermissions"]="NoPermissions";t["Unavailable"]="Unavailable";t["Unknown"]="Unknown"})(Oe||(Oe={}));class A_ extends Error{static create(e,i){const n=new A_(e.toString(),i);R4(n,i);return n}constructor(e,i){super(e);this.code=i}}function R4(t,e){t.name=e?`${e} (FileSystemError)`:`FileSystemError`;return t}function zp(t){if(!t){return Oe.Unknown}if(t instanceof A_){return t.code}const e=/^(.+) \(FileSystemError\)$/.exec(t.name);if(!e){return Oe.Unknown}switch(e[1]){case Oe.FileExists:return Oe.FileExists;case Oe.FileIsADirectory:return Oe.FileIsADirectory;case Oe.FileNotADirectory:return Oe.FileNotADirectory;case Oe.FileNotFound:return Oe.FileNotFound;case Oe.FileTooLarge:return Oe.FileTooLarge;case Oe.FileWriteLocked:return Oe.FileWriteLocked;case Oe.NoPermissions:return Oe.NoPermissions;case Oe.Unavailable:return Oe.Unavailable}return Oe.Unknown}function R8(t){if(t instanceof np){return t.fileOperationResult}switch(zp(t)){case Oe.FileNotFound:return Mn.FILE_NOT_FOUND;case Oe.FileIsADirectory:return Mn.FILE_IS_DIRECTORY;case Oe.FileNotADirectory:return Mn.FILE_NOT_DIRECTORY;case Oe.FileWriteLocked:return Mn.FILE_WRITE_LOCKED;case Oe.NoPermissions:return Mn.FILE_PERMISSION_DENIED;case Oe.FileExists:return Mn.FILE_MOVE_CONFLICT;case Oe.FileTooLarge:return Mn.FILE_TOO_LARGE;default:return Mn.FILE_OTHER_ERROR}}var Vs;(function(t){t[t["CREATE"]=0]="CREATE";t[t["DELETE"]=1]="DELETE";t[t["MOVE"]=2]="MOVE";t[t["COPY"]=3]="COPY";t[t["WRITE"]=4]="WRITE"})(Vs||(Vs={}));var pd;(function(t){t[t["UPDATED"]=0]="UPDATED";t[t["ADDED"]=1]="ADDED";t[t["DELETED"]=2]="DELETED"})(pd||(pd={}));class np extends Error{constructor(e,i,n){super(e);this.fileOperationResult=i;this.options=n}}var Mn;(function(t){t[t["FILE_IS_DIRECTORY"]=0]="FILE_IS_DIRECTORY";t[t["FILE_NOT_FOUND"]=1]="FILE_NOT_FOUND";t[t["FILE_NOT_MODIFIED_SINCE"]=2]="FILE_NOT_MODIFIED_SINCE";t[t["FILE_MODIFIED_SINCE"]=3]="FILE_MODIFIED_SINCE";t[t["FILE_MOVE_CONFLICT"]=4]="FILE_MOVE_CONFLICT";t[t["FILE_WRITE_LOCKED"]=5]="FILE_WRITE_LOCKED";t[t["FILE_PERMISSION_DENIED"]=6]="FILE_PERMISSION_DENIED";t[t["FILE_TOO_LARGE"]=7]="FILE_TOO_LARGE";t[t["FILE_INVALID_PATH"]=8]="FILE_INVALID_PATH";t[t["FILE_NOT_DIRECTORY"]=9]="FILE_NOT_DIRECTORY";t[t["FILE_OTHER_ERROR"]=10]="FILE_OTHER_ERROR"})(Mn||(Mn={}));var qE;(function(t){t[t["FILE"]=0]="FILE";t[t["FOLDER"]=1]="FOLDER";t[t["ROOT_FOLDER"]=2]="ROOT_FOLDER"})(qE||(qE={}));const L8="";function jE(t){if(typeof t.size!=="number"||typeof t.mtime!=="number"){return void 0}return t.mtime.toString(29)+t.size.toString(31)}class cn{static{this.KB=1024}static{this.MB=cn.KB*cn.KB}static{this.GB=cn.MB*cn.KB}static{this.TB=cn.GB*cn.KB}static formatSize(e){if(!$a(e)){e=0}if(e<cn.KB){return h(1941,"{0}B",e.toFixed(0))}if(e<cn.MB){return h(1942,"{0}KB",(e/cn.KB).toFixed(2))}if(e<cn.GB){return h(1943,"{0}MB",(e/cn.MB).toFixed(2))}if(e<cn.TB){return h(1944,"{0}GB",(e/cn.GB).toFixed(2))}return h(1945,"{0}TB",(e/cn.TB).toFixed(2))}}var Kd;(function(t){t[t["Ignore"]=0]="Ignore";t[t["Info"]=1]="Info";t[t["Warning"]=2]="Warning";t[t["Error"]=3]="Error"})(Kd||(Kd={}));(function(t){const e="error";const i="warning";const n="warn";const s="info";const r="ignore";function o(l){if(!l){return t.Ignore}if(Rr(e,l)){return t.Error}if(Rr(i,l)||Rr(n,l)){return t.Warning}if(Rr(s,l)){return t.Info}return t.Ignore}t.fromValue=o;function a(l){switch(l){case t.Error:return e;case t.Warning:return i;case t.Info:return s;default:return r}}t.toString=a})(Kd||(Kd={}));var gt=Kd;var GE;(function(t){t[t["DEFAULT"]=0]="DEFAULT";t[t["OPTIONAL"]=1]="OPTIONAL";t[t["SILENT"]=2]="SILENT";t[t["URGENT"]=3]="URGENT"})(GE||(GE={}));var KE;(function(t){t[t["WORKSPACE"]=0]="WORKSPACE";t[t["PROFILE"]=1]="PROFILE";t[t["APPLICATION"]=2]="APPLICATION"})(KE||(KE={}));var QE;(function(t){t[t["OFF"]=0]="OFF";t[t["ERROR"]=1]="ERROR"})(QE||(QE={}));function N8(t){const e=t;return typeof e?.id==="string"&&b.isUri(e.uri)}function M8(t){const e=t;return typeof e?.id==="string"&&b.isUri(e.configPath)}var qp;(function(t){t[t["EMPTY"]=1]="EMPTY";t[t["FOLDER"]=2]="FOLDER";t[t["WORKSPACE"]=3]="WORKSPACE"})(qp||(qp={}));let O8=class DW{get folders(){return this._folders}set folders(e){this._folders=e;this.updateFoldersMap()}constructor(e,i,n,s,r,o){this._id=e;this._transient=n;this._configuration=s;this.ignorePathCasing=r;this._isAgentSessionsWorkspace=o;this.foldersMap=Xs.forUris(this.ignorePathCasing,()=>true);this.folders=i}update(e){this._id=e.id;this._configuration=e.configuration;this._transient=e.transient;this.ignorePathCasing=e.ignorePathCasing;this._isAgentSessionsWorkspace=e.isAgentSessionsWorkspace;this.folders=e.folders}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}get isAgentSessionsWorkspace(){return this._isAgentSessionsWorkspace}getFolder(e){if(!e){return null}return this.foldersMap.findSubstr(e)||null}updateFoldersMap(){this.foldersMap=Xs.forUris(this.ignorePathCasing,()=>true);for(const e of this.folders){this.foldersMap.set(e.uri,e)}}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration,isAgentSessionsWorkspace:this.isAgentSessionsWorkspace}}};class L4{constructor(e,i){this.raw=i;this.uri=e.uri;this.index=e.index;this.name=e.name}toResource(e){return Mi(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}function Ov(t){return new L4({uri:t,index:0,name:F1(t)},{uri:t.toString()})}const F8="code-workspace";[{name:h(2474,"Code Workspace"),extensions:[F8]}];class U8{constructor(){this._systemSchemes=new Set(Object.keys(ne));this._providerInfo=new Map;this.extUri=new wu(e=>{const i=this._providerInfo.get(e.scheme);if(i===void 0){return false}if(i&ws.PathCaseSensitive){return false}return true})}$acceptProviderInfos(e,i){if(i===null){this._providerInfo.delete(e.scheme)}else{this._providerInfo.set(e.scheme,i)}}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const bu=te("IExtHostFileSystemInfo");const Pi=(function(){if(typeof crypto.randomUUID==="function"){return crypto.randomUUID.bind(crypto)}const t=new Uint8Array(16);const e=[];for(let i=0;i<256;i++){e.push(i.toString(16).padStart(2,"0"))}return function i(){crypto.getRandomValues(t);t[6]=t[6]&15|64;t[8]=t[8]&63|128;let n=0;let s="";s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+="-";s+=e[t[n++]];s+=e[t[n++]];s+="-";s+=e[t[n++]];s+=e[t[n++]];s+="-";s+=e[t[n++]];s+=e[t[n++]];s+="-";s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];return s}})();const W1=Object.freeze({create:t=>{return Ea(t.map(e=>e.toString())).join("\r\n")},split:t=>{return t.split("\r\n")},parse:t=>{return W1.split(t).filter(e=>!e.startsWith("#"))}});var JE;(function(t){t[t["InitialConsonant"]=4352]="InitialConsonant";t[t["Vowel"]=4449]="Vowel";t[t["FinalConsonant"]=4520]="FinalConsonant";t[t["CompatibilityJamo"]=12593]="CompatibilityJamo"})(JE||(JE={}));var oe;(function(t){t[t["NUL"]=0]="NUL";t[t["A"]=65]="A";t[t["B"]=66]="B";t[t["C"]=67]="C";t[t["D"]=68]="D";t[t["E"]=69]="E";t[t["F"]=70]="F";t[t["G"]=71]="G";t[t["H"]=72]="H";t[t["I"]=73]="I";t[t["J"]=74]="J";t[t["K"]=75]="K";t[t["L"]=76]="L";t[t["M"]=77]="M";t[t["N"]=78]="N";t[t["O"]=79]="O";t[t["P"]=80]="P";t[t["Q"]=81]="Q";t[t["R"]=82]="R";t[t["S"]=83]="S";t[t["T"]=84]="T";t[t["U"]=85]="U";t[t["V"]=86]="V";t[t["W"]=87]="W";t[t["X"]=88]="X";t[t["Y"]=89]="Y";t[t["Z"]=90]="Z";t[t["a"]=97]="a";t[t["b"]=98]="b";t[t["c"]=99]="c";t[t["d"]=100]="d";t[t["e"]=101]="e";t[t["f"]=102]="f";t[t["g"]=103]="g";t[t["h"]=104]="h";t[t["i"]=105]="i";t[t["j"]=106]="j";t[t["k"]=107]="k";t[t["l"]=108]="l";t[t["m"]=109]="m";t[t["n"]=110]="n";t[t["o"]=111]="o";t[t["p"]=112]="p";t[t["q"]=113]="q";t[t["r"]=114]="r";t[t["s"]=115]="s";t[t["t"]=116]="t";t[t["u"]=117]="u";t[t["v"]=118]="v";t[t["w"]=119]="w";t[t["x"]=120]="x";t[t["y"]=121]="y";t[t["z"]=122]="z"})(oe||(oe={}));var lt;(function(t){t[t["fa"]=24934]="fa";t[t["fg"]=26470]="fg";t[t["fq"]=29030]="fq";t[t["fr"]=29286]="fr";t[t["ft"]=29798]="ft";t[t["fv"]=30310]="fv";t[t["fx"]=30822]="fx";t[t["hk"]=27496]="hk";t[t["hl"]=27752]="hl";t[t["ho"]=28520]="ho";t[t["ml"]=27757]="ml";t[t["nj"]=27246]="nj";t[t["nl"]=27758]="nl";t[t["np"]=28782]="np";t[t["qt"]=29809]="qt";t[t["rt"]=29810]="rt";t[t["sg"]=26483]="sg";t[t["sw"]=30579]="sw"})(lt||(lt={}));new Uint8Array([oe.r,oe.R,oe.s,oe.e,oe.E,oe.f,oe.a,oe.q,oe.Q,oe.t,oe.T,oe.d,oe.w,oe.W,oe.c,oe.z,oe.x,oe.v,oe.g]);new Uint16Array([oe.k,oe.o,oe.i,oe.O,oe.j,oe.p,oe.u,oe.P,oe.h,lt.hk,lt.ho,lt.hl,oe.y,oe.n,lt.nj,lt.np,lt.nl,oe.b,oe.m,lt.ml,oe.l]);new Uint16Array([oe.r,oe.R,lt.rt,oe.s,lt.sw,lt.sg,oe.e,oe.f,lt.fr,lt.fa,lt.fq,lt.ft,lt.fx,lt.fv,lt.fg,oe.a,oe.q,lt.qt,oe.t,oe.T,oe.d,oe.w,oe.c,oe.z,oe.x,oe.v,oe.g]);new Uint16Array([oe.r,oe.R,lt.rt,oe.s,lt.sw,lt.sg,oe.e,oe.E,oe.f,lt.fr,lt.fa,lt.fq,lt.ft,lt.fx,lt.fv,lt.fg,oe.a,oe.q,oe.Q,lt.qt,oe.t,oe.T,oe.d,oe.w,oe.W,oe.c,oe.z,oe.x,oe.v,oe.g,oe.k,oe.o,oe.i,oe.O,oe.j,oe.p,oe.u,oe.P,oe.h,lt.hk,lt.ho,lt.hl,oe.y,oe.n,lt.nj,lt.np,lt.nl,oe.b,oe.m,lt.ml,oe.l]);const $8=new of(1e4);function H8(t){return W8(t,"NFD",$8)}const B8=/[^\u0000-\u0080]/;function W8(t,e,i){if(!t){return t}const n=i.get(t);if(n){return n}let s;if(B8.test(t)){s=t.normalize(e)}else{s=t}i.set(t,s);return s}(function(){const t=new of(1e4);const e=/[\u0300-\u036f]/g;return function(i){const n=t.get(i);if(n){return n}const s=H8(i).replace(e,"");const r=(s.length===i.length?s:i).toLowerCase();t.set(i,r);return r}})();function N4(...t){return function(e,i){for(let n=0,s=t.length;n<s;n++){const r=t[n](e,i);if(r){return r}}return null}}O4.bind(void 0,false);const M4=O4.bind(void 0,true);function O4(t,e,i){if(!i||i.length<e.length){return null}let n;if(t){n=CS(i,e)}else{n=i.indexOf(e)===0}if(!n){return null}return e.length>0?[{start:0,end:e.length}]:[]}function V8(t,e){if(t.length>e.length){return null}const i=e.toLowerCase().indexOf(t.toLowerCase());if(i===-1){return null}return[{start:i,end:i+t.length}]}function z8(t,e){if(t.length>e.length){return null}return V1(t.toLowerCase(),e.toLowerCase(),0,0)}function V1(t,e,i,n){if(i===t.length){return[]}else if(n===e.length){return null}else{if(t[i]===e[n]){let s=null;if(s=V1(t,e,i+1,n+1)){return U4({start:n,end:n+1},s)}return null}return V1(t,e,i,n+1)}}function PS(t){return M.a<=t&&t<=M.z}function R_(t){return M.A<=t&&t<=M.Z}function AS(t){return M.Digit0<=t&&t<=M.Digit9}function q8(t){return t===M.Space||t===M.Tab||t===M.LineFeed||t===M.CarriageReturn}const j8=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(t=>j8.add(t.charCodeAt(0)));function F4(t){return PS(t)||R_(t)||AS(t)}function U4(t,e){if(e.length===0){e=[t]}else if(t.end===e[0].start){e[0].start=t.start}else{e.unshift(t)}return e}function $4(t,e){for(let i=e;i<t.length;i++){const n=t.charCodeAt(i);if(R_(n)||AS(n)||i>0&&!F4(t.charCodeAt(i-1))){return i}}return t.length}function z1(t,e,i,n){if(i===t.length){return[]}else if(n===e.length){return null}else if(t[i]!==e[n].toLowerCase()){return null}else{let s=null;let r=n+1;s=z1(t,e,i+1,n+1);while(!s&&(r=$4(e,r))<e.length){s=z1(t,e,i+1,r);r++}return s===null?null:U4({start:n,end:n+1},s)}}function G8(t){let e=0,i=0,n=0,s=0,r=0;for(let u=0;u<t.length;u++){r=t.charCodeAt(u);if(R_(r)){e++}if(PS(r)){i++}if(F4(r)){n++}if(AS(r)){s++}}const o=e/t.length;const a=i/t.length;const l=n/t.length;const c=s/t.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function K8(t){const{upperPercent:e,lowerPercent:i}=t;return i===0&&e>.6}function Q8(t){const{upperPercent:e,lowerPercent:i,alphaPercent:n,numericPercent:s}=t;return i>.2&&e<.8&&n>.6&&s<.2}function J8(t){let e=0,i=0,n=0,s=0;for(let r=0;r<t.length;r++){n=t.charCodeAt(r);if(R_(n)){e++}if(PS(n)){i++}if(q8(n)){s++}}if((e===0||i===0)&&s===0){return t.length<=30}else{return e<=5}}function H4(t,e){if(!e){return null}e=e.trim();if(e.length===0){return null}if(!J8(t)){return null}if(e.length>60){e=e.substring(0,60)}const i=G8(e);if(!Q8(i)){if(!K8(i)){return null}e=e.toLowerCase()}let n=null;let s=0;t=t.toLowerCase();while(s<e.length&&(n=z1(t,e,0,s))===null){s=$4(e,s+1)}return n}N4(M4,H4,V8);N4(M4,H4,z8);new of(1e4);const YE=128;function RS(){const t=[];const e=[];for(let i=0;i<=YE;i++){e[i]=0}for(let i=0;i<=YE;i++){t.push(e.slice(0))}return t}RS();RS();RS();var XE;(function(t){t[t["Diag"]=1]="Diag";t[t["Left"]=2]="Left";t[t["LeftLeft"]=3]="LeftLeft"})(XE||(XE={}));var ZE;(function(t){t.Default=[-100,0];function e(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}t.isDefault=e})(ZE||(ZE={}));const q1=Object.create(null);function g(t,e){if(Xe(e)){const i=q1[e];if(i===void 0){throw new Error(`${t} references an unknown codicon: ${e}`)}e=i}q1[t]=e;return{id:t}}function Y8(){return q1}const X8={add:g("add",6e4),plus:g("plus",6e4),gistNew:g("gist-new",6e4),repoCreate:g("repo-create",6e4),lightbulb:g("lightbulb",60001),lightBulb:g("light-bulb",60001),repo:g("repo",60002),repoDelete:g("repo-delete",60002),gistFork:g("gist-fork",60003),repoForked:g("repo-forked",60003),gitPullRequest:g("git-pull-request",60004),gitPullRequestAbandoned:g("git-pull-request-abandoned",60004),recordKeys:g("record-keys",60005),keyboard:g("keyboard",60005),tag:g("tag",60006),gitPullRequestLabel:g("git-pull-request-label",60006),tagAdd:g("tag-add",60006),tagRemove:g("tag-remove",60006),person:g("person",60007),personFollow:g("person-follow",60007),personOutline:g("person-outline",60007),personFilled:g("person-filled",60007),sourceControl:g("source-control",60008),mirror:g("mirror",60009),mirrorPublic:g("mirror-public",60009),star:g("star",60010),starAdd:g("star-add",60010),starDelete:g("star-delete",60010),starEmpty:g("star-empty",60010),comment:g("comment",60011),commentAdd:g("comment-add",60011),alert:g("alert",60012),warning:g("warning",60012),search:g("search",60013),searchSave:g("search-save",60013),logOut:g("log-out",60014),signOut:g("sign-out",60014),logIn:g("log-in",60015),signIn:g("sign-in",60015),eye:g("eye",60016),eyeUnwatch:g("eye-unwatch",60016),eyeWatch:g("eye-watch",60016),circleFilled:g("circle-filled",60017),primitiveDot:g("primitive-dot",60017),closeDirty:g("close-dirty",60017),debugBreakpoint:g("debug-breakpoint",60017),debugBreakpointDisabled:g("debug-breakpoint-disabled",60017),debugHint:g("debug-hint",60017),terminalDecorationSuccess:g("terminal-decoration-success",60017),primitiveSquare:g("primitive-square",60018),edit:g("edit",60019),pencil:g("pencil",60019),info:g("info",60020),issueOpened:g("issue-opened",60020),gistPrivate:g("gist-private",60021),gitForkPrivate:g("git-fork-private",60021),lock:g("lock",60021),mirrorPrivate:g("mirror-private",60021),close:g("close",60022),removeClose:g("remove-close",60022),x:g("x",60022),repoSync:g("repo-sync",60023),sync:g("sync",60023),clone:g("clone",60024),desktopDownload:g("desktop-download",60024),beaker:g("beaker",60025),microscope:g("microscope",60025),vm:g("vm",60026),deviceDesktop:g("device-desktop",60026),file:g("file",60027),more:g("more",60028),ellipsis:g("ellipsis",60028),kebabHorizontal:g("kebab-horizontal",60028),mailReply:g("mail-reply",60029),reply:g("reply",60029),organization:g("organization",60030),organizationFilled:g("organization-filled",60030),organizationOutline:g("organization-outline",60030),newFile:g("new-file",60031),fileAdd:g("file-add",60031),newFolder:g("new-folder",60032),fileDirectoryCreate:g("file-directory-create",60032),trash:g("trash",60033),trashcan:g("trashcan",60033),history:g("history",60034),clock:g("clock",60034),folder:g("folder",60035),fileDirectory:g("file-directory",60035),symbolFolder:g("symbol-folder",60035),logoGithub:g("logo-github",60036),markGithub:g("mark-github",60036),github:g("github",60036),terminal:g("terminal",60037),console:g("console",60037),repl:g("repl",60037),zap:g("zap",60038),symbolEvent:g("symbol-event",60038),error:g("error",60039),stop:g("stop",60039),variable:g("variable",60040),symbolVariable:g("symbol-variable",60040),array:g("array",60042),symbolArray:g("symbol-array",60042),symbolModule:g("symbol-module",60043),symbolPackage:g("symbol-package",60043),symbolNamespace:g("symbol-namespace",60043),symbolObject:g("symbol-object",60043),symbolMethod:g("symbol-method",60044),symbolFunction:g("symbol-function",60044),symbolConstructor:g("symbol-constructor",60044),symbolBoolean:g("symbol-boolean",60047),symbolNull:g("symbol-null",60047),symbolNumeric:g("symbol-numeric",60048),symbolNumber:g("symbol-number",60048),symbolStructure:g("symbol-structure",60049),symbolStruct:g("symbol-struct",60049),symbolParameter:g("symbol-parameter",60050),symbolTypeParameter:g("symbol-type-parameter",60050),symbolKey:g("symbol-key",60051),symbolText:g("symbol-text",60051),symbolReference:g("symbol-reference",60052),goToFile:g("go-to-file",60052),symbolEnum:g("symbol-enum",60053),symbolValue:g("symbol-value",60053),symbolRuler:g("symbol-ruler",60054),symbolUnit:g("symbol-unit",60054),activateBreakpoints:g("activate-breakpoints",60055),archive:g("archive",60056),arrowBoth:g("arrow-both",60057),arrowDown:g("arrow-down",60058),arrowLeft:g("arrow-left",60059),arrowRight:g("arrow-right",60060),arrowSmallDown:g("arrow-small-down",60061),arrowSmallLeft:g("arrow-small-left",60062),arrowSmallRight:g("arrow-small-right",60063),arrowSmallUp:g("arrow-small-up",60064),arrowUp:g("arrow-up",60065),bell:g("bell",60066),bold:g("bold",60067),book:g("book",60068),bookmark:g("bookmark",60069),debugBreakpointConditionalUnverified:g("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:g("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:g("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:g("debug-breakpoint-data-unverified",60072),debugBreakpointData:g("debug-breakpoint-data",60073),debugBreakpointDataDisabled:g("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:g("debug-breakpoint-log-unverified",60074),debugBreakpointLog:g("debug-breakpoint-log",60075),debugBreakpointLogDisabled:g("debug-breakpoint-log-disabled",60075),briefcase:g("briefcase",60076),broadcast:g("broadcast",60077),browser:g("browser",60078),bug:g("bug",60079),calendar:g("calendar",60080),caseSensitive:g("case-sensitive",60081),check:g("check",60082),checklist:g("checklist",60083),chevronDown:g("chevron-down",60084),chevronLeft:g("chevron-left",60085),chevronRight:g("chevron-right",60086),chevronUp:g("chevron-up",60087),chromeClose:g("chrome-close",60088),chromeMaximize:g("chrome-maximize",60089),chromeMinimize:g("chrome-minimize",60090),chromeRestore:g("chrome-restore",60091),circleOutline:g("circle-outline",60092),circle:g("circle",60092),debugBreakpointUnverified:g("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:g("terminal-decoration-incomplete",60092),circleSlash:g("circle-slash",60093),circuitBoard:g("circuit-board",60094),clearAll:g("clear-all",60095),clippy:g("clippy",60096),closeAll:g("close-all",60097),cloudDownload:g("cloud-download",60098),cloudUpload:g("cloud-upload",60099),code:g("code",60100),collapseAll:g("collapse-all",60101),colorMode:g("color-mode",60102),commentDiscussion:g("comment-discussion",60103),creditCard:g("credit-card",60105),dash:g("dash",60108),dashboard:g("dashboard",60109),database:g("database",60110),debugContinue:g("debug-continue",60111),debugDisconnect:g("debug-disconnect",60112),debugPause:g("debug-pause",60113),debugRestart:g("debug-restart",60114),debugStart:g("debug-start",60115),debugStepInto:g("debug-step-into",60116),debugStepOut:g("debug-step-out",60117),debugStepOver:g("debug-step-over",60118),debugStop:g("debug-stop",60119),debug:g("debug",60120),deviceCameraVideo:g("device-camera-video",60121),deviceCamera:g("device-camera",60122),deviceMobile:g("device-mobile",60123),diffAdded:g("diff-added",60124),diffIgnored:g("diff-ignored",60125),diffModified:g("diff-modified",60126),diffRemoved:g("diff-removed",60127),diffRenamed:g("diff-renamed",60128),diff:g("diff",60129),diffSidebyside:g("diff-sidebyside",60129),discard:g("discard",60130),editorLayout:g("editor-layout",60131),emptyWindow:g("empty-window",60132),exclude:g("exclude",60133),extensions:g("extensions",60134),eyeClosed:g("eye-closed",60135),fileBinary:g("file-binary",60136),fileCode:g("file-code",60137),fileMedia:g("file-media",60138),filePdf:g("file-pdf",60139),fileSubmodule:g("file-submodule",60140),fileSymlinkDirectory:g("file-symlink-directory",60141),fileSymlinkFile:g("file-symlink-file",60142),fileZip:g("file-zip",60143),files:g("files",60144),filter:g("filter",60145),flame:g("flame",60146),foldDown:g("fold-down",60147),foldUp:g("fold-up",60148),fold:g("fold",60149),folderActive:g("folder-active",60150),folderOpened:g("folder-opened",60151),gear:g("gear",60152),gift:g("gift",60153),gistSecret:g("gist-secret",60154),gist:g("gist",60155),gitCommit:g("git-commit",60156),gitCompare:g("git-compare",60157),compareChanges:g("compare-changes",60157),gitMerge:g("git-merge",60158),githubAction:g("github-action",60159),githubAlt:g("github-alt",60160),globe:g("globe",60161),grabber:g("grabber",60162),graph:g("graph",60163),gripper:g("gripper",60164),heart:g("heart",60165),home:g("home",60166),horizontalRule:g("horizontal-rule",60167),hubot:g("hubot",60168),inbox:g("inbox",60169),issueReopened:g("issue-reopened",60171),issues:g("issues",60172),italic:g("italic",60173),jersey:g("jersey",60174),json:g("json",60175),bracket:g("bracket",60175),kebabVertical:g("kebab-vertical",60176),key:g("key",60177),law:g("law",60178),lightbulbAutofix:g("lightbulb-autofix",60179),linkExternal:g("link-external",60180),link:g("link",60181),listOrdered:g("list-ordered",60182),listUnordered:g("list-unordered",60183),liveShare:g("live-share",60184),loading:g("loading",60185),location:g("location",60186),mailRead:g("mail-read",60187),mail:g("mail",60188),markdown:g("markdown",60189),megaphone:g("megaphone",60190),mention:g("mention",60191),milestone:g("milestone",60192),gitPullRequestMilestone:g("git-pull-request-milestone",60192),mortarBoard:g("mortar-board",60193),move:g("move",60194),multipleWindows:g("multiple-windows",60195),mute:g("mute",60196),noNewline:g("no-newline",60197),note:g("note",60198),octoface:g("octoface",60199),openPreview:g("open-preview",60200),package:g("package",60201),paintcan:g("paintcan",60202),pin:g("pin",60203),play:g("play",60204),run:g("run",60204),plug:g("plug",60205),preserveCase:g("preserve-case",60206),preview:g("preview",60207),project:g("project",60208),pulse:g("pulse",60209),question:g("question",60210),quote:g("quote",60211),radioTower:g("radio-tower",60212),reactions:g("reactions",60213),references:g("references",60214),refresh:g("refresh",60215),regex:g("regex",60216),remoteExplorer:g("remote-explorer",60217),remote:g("remote",60218),remove:g("remove",60219),replaceAll:g("replace-all",60220),replace:g("replace",60221),repoClone:g("repo-clone",60222),repoForcePush:g("repo-force-push",60223),repoPull:g("repo-pull",60224),repoPush:g("repo-push",60225),report:g("report",60226),requestChanges:g("request-changes",60227),rocket:g("rocket",60228),rootFolderOpened:g("root-folder-opened",60229),rootFolder:g("root-folder",60230),rss:g("rss",60231),ruby:g("ruby",60232),saveAll:g("save-all",60233),saveAs:g("save-as",60234),save:g("save",60235),screenFull:g("screen-full",60236),screenNormal:g("screen-normal",60237),searchStop:g("search-stop",60238),server:g("server",60240),settingsGear:g("settings-gear",60241),settings:g("settings",60242),shield:g("shield",60243),smiley:g("smiley",60244),sortPrecedence:g("sort-precedence",60245),splitHorizontal:g("split-horizontal",60246),splitVertical:g("split-vertical",60247),squirrel:g("squirrel",60248),starFull:g("star-full",60249),starHalf:g("star-half",60250),symbolClass:g("symbol-class",60251),symbolColor:g("symbol-color",60252),symbolConstant:g("symbol-constant",60253),symbolEnumMember:g("symbol-enum-member",60254),symbolField:g("symbol-field",60255),symbolFile:g("symbol-file",60256),symbolInterface:g("symbol-interface",60257),symbolKeyword:g("symbol-keyword",60258),symbolMisc:g("symbol-misc",60259),symbolOperator:g("symbol-operator",60260),symbolProperty:g("symbol-property",60261),wrench:g("wrench",60261),wrenchSubaction:g("wrench-subaction",60261),symbolSnippet:g("symbol-snippet",60262),tasklist:g("tasklist",60263),telescope:g("telescope",60264),textSize:g("text-size",60265),threeBars:g("three-bars",60266),thumbsdown:g("thumbsdown",60267),thumbsup:g("thumbsup",60268),tools:g("tools",60269),triangleDown:g("triangle-down",60270),triangleLeft:g("triangle-left",60271),triangleRight:g("triangle-right",60272),triangleUp:g("triangle-up",60273),twitter:g("twitter",60274),unfold:g("unfold",60275),unlock:g("unlock",60276),unmute:g("unmute",60277),unverified:g("unverified",60278),verified:g("verified",60279),versions:g("versions",60280),vmActive:g("vm-active",60281),vmOutline:g("vm-outline",60282),vmRunning:g("vm-running",60283),watch:g("watch",60284),whitespace:g("whitespace",60285),wholeWord:g("whole-word",60286),window:g("window",60287),wordWrap:g("word-wrap",60288),zoomIn:g("zoom-in",60289),zoomOut:g("zoom-out",60290),listFilter:g("list-filter",60291),listFlat:g("list-flat",60292),listSelection:g("list-selection",60293),selection:g("selection",60293),listTree:g("list-tree",60294),debugBreakpointFunctionUnverified:g("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:g("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:g("debug-breakpoint-function-disabled",60296),debugStackframeActive:g("debug-stackframe-active",60297),circleSmallFilled:g("circle-small-filled",60298),debugStackframeDot:g("debug-stackframe-dot",60298),terminalDecorationMark:g("terminal-decoration-mark",60298),debugStackframe:g("debug-stackframe",60299),debugStackframeFocused:g("debug-stackframe-focused",60299),debugBreakpointUnsupported:g("debug-breakpoint-unsupported",60300),symbolString:g("symbol-string",60301),debugReverseContinue:g("debug-reverse-continue",60302),debugStepBack:g("debug-step-back",60303),debugRestartFrame:g("debug-restart-frame",60304),debugAlt:g("debug-alt",60305),callIncoming:g("call-incoming",60306),callOutgoing:g("call-outgoing",60307),menu:g("menu",60308),expandAll:g("expand-all",60309),feedback:g("feedback",60310),gitPullRequestReviewer:g("git-pull-request-reviewer",60310),groupByRefType:g("group-by-ref-type",60311),ungroupByRefType:g("ungroup-by-ref-type",60312),account:g("account",60313),gitPullRequestAssignee:g("git-pull-request-assignee",60313),bellDot:g("bell-dot",60314),debugConsole:g("debug-console",60315),library:g("library",60316),output:g("output",60317),runAll:g("run-all",60318),syncIgnored:g("sync-ignored",60319),pinned:g("pinned",60320),githubInverted:g("github-inverted",60321),serverProcess:g("server-process",60322),serverEnvironment:g("server-environment",60323),pass:g("pass",60324),issueClosed:g("issue-closed",60324),stopCircle:g("stop-circle",60325),playCircle:g("play-circle",60326),record:g("record",60327),debugAltSmall:g("debug-alt-small",60328),vmConnect:g("vm-connect",60329),cloud:g("cloud",60330),merge:g("merge",60331),export:g("export",60332),graphLeft:g("graph-left",60333),magnet:g("magnet",60334),notebook:g("notebook",60335),redo:g("redo",60336),checkAll:g("check-all",60337),pinnedDirty:g("pinned-dirty",60338),passFilled:g("pass-filled",60339),circleLargeFilled:g("circle-large-filled",60340),circleLarge:g("circle-large",60341),circleLargeOutline:g("circle-large-outline",60341),combine:g("combine",60342),gather:g("gather",60342),table:g("table",60343),variableGroup:g("variable-group",60344),typeHierarchy:g("type-hierarchy",60345),typeHierarchySub:g("type-hierarchy-sub",60346),typeHierarchySuper:g("type-hierarchy-super",60347),gitPullRequestCreate:g("git-pull-request-create",60348),runAbove:g("run-above",60349),runBelow:g("run-below",60350),notebookTemplate:g("notebook-template",60351),debugRerun:g("debug-rerun",60352),workspaceTrusted:g("workspace-trusted",60353),workspaceUntrusted:g("workspace-untrusted",60354),workspaceUnknown:g("workspace-unknown",60355),terminalCmd:g("terminal-cmd",60356),terminalDebian:g("terminal-debian",60357),terminalLinux:g("terminal-linux",60358),terminalPowershell:g("terminal-powershell",60359),terminalTmux:g("terminal-tmux",60360),terminalUbuntu:g("terminal-ubuntu",60361),terminalBash:g("terminal-bash",60362),arrowSwap:g("arrow-swap",60363),copy:g("copy",60364),personAdd:g("person-add",60365),filterFilled:g("filter-filled",60366),wand:g("wand",60367),debugLineByLine:g("debug-line-by-line",60368),inspect:g("inspect",60369),layers:g("layers",60370),layersDot:g("layers-dot",60371),layersActive:g("layers-active",60372),compass:g("compass",60373),compassDot:g("compass-dot",60374),compassActive:g("compass-active",60375),azure:g("azure",60376),issueDraft:g("issue-draft",60377),gitPullRequestClosed:g("git-pull-request-closed",60378),gitPullRequestDraft:g("git-pull-request-draft",60379),debugAll:g("debug-all",60380),debugCoverage:g("debug-coverage",60381),runErrors:g("run-errors",60382),folderLibrary:g("folder-library",60383),debugContinueSmall:g("debug-continue-small",60384),beakerStop:g("beaker-stop",60385),graphLine:g("graph-line",60386),graphScatter:g("graph-scatter",60387),pieChart:g("pie-chart",60388),bracketDot:g("bracket-dot",60389),bracketError:g("bracket-error",60390),lockSmall:g("lock-small",60391),azureDevops:g("azure-devops",60392),verifiedFilled:g("verified-filled",60393),newline:g("newline",60394),layout:g("layout",60395),layoutActivitybarLeft:g("layout-activitybar-left",60396),layoutActivitybarRight:g("layout-activitybar-right",60397),layoutPanelLeft:g("layout-panel-left",60398),layoutPanelCenter:g("layout-panel-center",60399),layoutPanelJustify:g("layout-panel-justify",60400),layoutPanelRight:g("layout-panel-right",60401),layoutPanel:g("layout-panel",60402),layoutSidebarLeft:g("layout-sidebar-left",60403),layoutSidebarRight:g("layout-sidebar-right",60404),layoutStatusbar:g("layout-statusbar",60405),layoutMenubar:g("layout-menubar",60406),layoutCentered:g("layout-centered",60407),target:g("target",60408),indent:g("indent",60409),recordSmall:g("record-small",60410),errorSmall:g("error-small",60411),terminalDecorationError:g("terminal-decoration-error",60411),arrowCircleDown:g("arrow-circle-down",60412),arrowCircleLeft:g("arrow-circle-left",60413),arrowCircleRight:g("arrow-circle-right",60414),arrowCircleUp:g("arrow-circle-up",60415),layoutSidebarRightOff:g("layout-sidebar-right-off",60416),layoutPanelOff:g("layout-panel-off",60417),layoutSidebarLeftOff:g("layout-sidebar-left-off",60418),blank:g("blank",60419),heartFilled:g("heart-filled",60420),map:g("map",60421),mapHorizontal:g("map-horizontal",60421),foldHorizontal:g("fold-horizontal",60421),mapFilled:g("map-filled",60422),mapHorizontalFilled:g("map-horizontal-filled",60422),foldHorizontalFilled:g("fold-horizontal-filled",60422),circleSmall:g("circle-small",60423),bellSlash:g("bell-slash",60424),bellSlashDot:g("bell-slash-dot",60425),commentUnresolved:g("comment-unresolved",60426),gitPullRequestGoToChanges:g("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:g("git-pull-request-new-changes",60428),searchFuzzy:g("search-fuzzy",60429),commentDraft:g("comment-draft",60430),send:g("send",60431),sparkle:g("sparkle",60432),insert:g("insert",60433),mic:g("mic",60434),thumbsdownFilled:g("thumbsdown-filled",60435),thumbsupFilled:g("thumbsup-filled",60436),coffee:g("coffee",60437),snake:g("snake",60438),game:g("game",60439),vr:g("vr",60440),chip:g("chip",60441),piano:g("piano",60442),music:g("music",60443),micFilled:g("mic-filled",60444),repoFetch:g("repo-fetch",60445),copilot:g("copilot",60446),lightbulbSparkle:g("lightbulb-sparkle",60447),robot:g("robot",60448),sparkleFilled:g("sparkle-filled",60449),diffSingle:g("diff-single",60450),diffMultiple:g("diff-multiple",60451),surroundWith:g("surround-with",60452),share:g("share",60453),gitStash:g("git-stash",60454),gitStashApply:g("git-stash-apply",60455),gitStashPop:g("git-stash-pop",60456),vscode:g("vscode",60457),vscodeInsiders:g("vscode-insiders",60458),codeOss:g("code-oss",60459),runCoverage:g("run-coverage",60460),runAllCoverage:g("run-all-coverage",60461),coverage:g("coverage",60462),githubProject:g("github-project",60463),mapVertical:g("map-vertical",60464),foldVertical:g("fold-vertical",60464),mapVerticalFilled:g("map-vertical-filled",60465),foldVerticalFilled:g("fold-vertical-filled",60465),goToSearch:g("go-to-search",60466),percentage:g("percentage",60467),sortPercentage:g("sort-percentage",60467),attach:g("attach",60468),goToEditingSession:g("go-to-editing-session",60469),editSession:g("edit-session",60470),codeReview:g("code-review",60471),copilotWarning:g("copilot-warning",60472),python:g("python",60473),copilotLarge:g("copilot-large",60474),copilotWarningLarge:g("copilot-warning-large",60475),keyboardTab:g("keyboard-tab",60476),copilotBlocked:g("copilot-blocked",60477),copilotNotConnected:g("copilot-not-connected",60478),flag:g("flag",60479),lightbulbEmpty:g("lightbulb-empty",60480),symbolMethodArrow:g("symbol-method-arrow",60481),copilotUnavailable:g("copilot-unavailable",60482),repoPinned:g("repo-pinned",60483),keyboardTabAbove:g("keyboard-tab-above",60484),keyboardTabBelow:g("keyboard-tab-below",60485),gitPullRequestDone:g("git-pull-request-done",60486),mcp:g("mcp",60487),extensionsLarge:g("extensions-large",60488),layoutPanelDock:g("layout-panel-dock",60489),layoutSidebarLeftDock:g("layout-sidebar-left-dock",60490),layoutSidebarRightDock:g("layout-sidebar-right-dock",60491),copilotInProgress:g("copilot-in-progress",60492),copilotError:g("copilot-error",60493),copilotSuccess:g("copilot-success",60494),chatSparkle:g("chat-sparkle",60495),searchSparkle:g("search-sparkle",60496),editSparkle:g("edit-sparkle",60497),copilotSnooze:g("copilot-snooze",60498),sendToRemoteAgent:g("send-to-remote-agent",60499),commentDiscussionSparkle:g("comment-discussion-sparkle",60500),chatSparkleWarning:g("chat-sparkle-warning",60501),chatSparkleError:g("chat-sparkle-error",60502),collection:g("collection",60503),newCollection:g("new-collection",60504),thinking:g("thinking",60505),build:g("build",60506),commentDiscussionQuote:g("comment-discussion-quote",60507),cursor:g("cursor",60508),eraser:g("eraser",60509),fileText:g("file-text",60510),quotes:g("quotes",60512),rename:g("rename",60513),runWithDeps:g("run-with-deps",60514),debugConnected:g("debug-connected",60515),strikethrough:g("strikethrough",60516),openInProduct:g("open-in-product",60517),indexZero:g("index-zero",60518),agent:g("agent",60519),editCode:g("edit-code",60520),repoSelected:g("repo-selected",60521),skip:g("skip",60522),mergeInto:g("merge-into",60523),gitBranchChanges:g("git-branch-changes",60524),gitBranchStagedChanges:g("git-branch-staged-changes",60525),gitBranchConflicts:g("git-branch-conflicts",60526),gitBranch:g("git-branch",60527),gitBranchCreate:g("git-branch-create",60527),gitBranchDelete:g("git-branch-delete",60527),searchLarge:g("search-large",60528),terminalGitBash:g("terminal-git-bash",60529),windowActive:g("window-active",60530),forward:g("forward",60531),download:g("download",60532),clockface:g("clockface",60533),unarchive:g("unarchive",60534),sessionInProgress:g("session-in-progress",60535),collectionSmall:g("collection-small",60536),vmSmall:g("vm-small",60537),cloudSmall:g("cloud-small",60538),addSmall:g("add-small",60539),removeSmall:g("remove-small",60540),worktreeSmall:g("worktree-small",60541),worktree:g("worktree",60542),screenCut:g("screen-cut",60543),ask:g("ask",60544),openai:g("openai",60545),claude:g("claude",60546)};const Z8={dialogError:g("dialog-error","error"),dialogWarning:g("dialog-warning","warning"),dialogInfo:g("dialog-info","info"),dialogClose:g("dialog-close","close"),treeItemExpanded:g("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:g("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:g("tree-filter-on-type-off","list-selection"),treeFilterClear:g("tree-filter-clear","close"),treeItemLoading:g("tree-item-loading","loading"),menuSelection:g("menu-selection","check"),menuSubmenu:g("menu-submenu","chevron-right"),menuBarMore:g("menubar-more","more"),scrollbarButtonLeft:g("scrollbar-button-left","triangle-left"),scrollbarButtonRight:g("scrollbar-button-right","triangle-right"),scrollbarButtonUp:g("scrollbar-button-up","triangle-up"),scrollbarButtonDown:g("scrollbar-button-down","triangle-down"),toolBarMore:g("toolbar-more","more"),quickInputBack:g("quick-input-back","arrow-left"),dropDownButton:g("drop-down-button",60084),symbolCustomColor:g("symbol-customcolor",60252),exportIcon:g("export",60332),workspaceUnspecified:g("workspace-unspecified",60355),newLine:g("newline",60394),thumbsDownFilled:g("thumbsdown-filled",60435),thumbsUpFilled:g("thumbsup-filled",60436),gitFetch:g("git-fetch",60445),lightbulbSparkleAutofix:g("lightbulb-sparkle-autofix",60447),debugBreakpointPending:g("debug-breakpoint-pending",60377)};const _e={...X8,...Z8};var Hc;(function(t){function e(i){return!!i&&typeof i==="object"&&typeof i.id==="string"}t.isThemeColor=e})(Hc||(Hc={}));var Kt;(function(t){t.iconNameSegment="[A-Za-z0-9]+";t.iconNameExpression="[A-Za-z0-9-]+";t.iconModifierExpression="~[A-Za-z]+";t.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${t.iconNameExpression})(${t.iconModifierExpression})?$`);function i(m){const v=e.exec(m.id);if(!v){return i(_e.error)}const[,y,k]=v;const S=["codicon","codicon-"+y];if(k){S.push("codicon-modifier-"+k.substring(1))}return S}t.asClassNameArray=i;function n(m){return i(m).join(" ")}t.asClassName=n;function s(m){return"."+i(m).join(".")}t.asCSSSelector=s;function r(m){return!!m&&typeof m==="object"&&typeof m.id==="string"&&(typeof m.color==="undefined"||Hc.isThemeColor(m.color))}t.isThemeIcon=r;const o=new RegExp(`^\\$\\((${t.iconNameExpression}(?:${t.iconModifierExpression})?)\\)$`);function a(m){const v=o.exec(m);if(!v){return void 0}const[,y]=v;return{id:y}}t.fromString=a;function l(m){return{id:m}}t.fromId=l;function c(m,v){let y=m.id;const k=y.lastIndexOf("~");if(k!==-1){y=y.substring(0,k)}if(v){y=`${y}~${v}`}return{id:y}}t.modify=c;function u(m){const v=m.id.lastIndexOf("~");if(v!==-1){return m.id.substring(v+1)}return void 0}t.getModifier=u;function d(m,v){return m.id===v.id&&m.color?.id===v.color?.id}t.isEqual=d;function f(m){return m?.id===_e.file.id}t.isFile=f;function p(m){return m?.id===_e.folder.id}t.isFolder=p})(Kt||(Kt={}));const LS=new RegExp(`\\$\\(${Kt.iconNameExpression}(?:${Kt.iconModifierExpression})?\\)`,"g");const e7=new RegExp(`(\\\\)?${LS.source}`,"g");function t7(t){return t.replace(e7,(e,i)=>i?e:`\\${e}`)}new RegExp(`\\\\${LS.source}`,"g");new RegExp(`(\\s)?(\\\\)?${LS.source}(\\s)?`,"g");new RegExp(`\\$\\(${Kt.iconNameCharacter}+\\)`,"g");var jp;(function(t){t[t["Paragraph"]=0]="Paragraph";t[t["Break"]=1]="Break"})(jp||(jp={}));let Ho=class B4{static lift(e){const i=new B4(e.value,e);i.uris=e.uris;i.baseUri=e.baseUri?b.revive(e.baseUri):void 0;return i}constructor(e="",i=false){this.value=e;if(typeof this.value!=="string"){throw Ge("value")}if(typeof i==="boolean"){this.isTrusted=i;this.supportThemeIcons=false;this.supportHtml=false;this.supportAlertSyntax=false}else{this.isTrusted=i.isTrusted??void 0;this.supportThemeIcons=i.supportThemeIcons??false;this.supportHtml=i.supportHtml??false;this.supportAlertSyntax=i.supportAlertSyntax??false}}appendText(e,i=jp.Paragraph){this.value+=i7(this.supportThemeIcons?t7(e):e).replace(/([ \t]+)/g,(n,s)=>"&nbsp;".repeat(s.length)).replace(/\>/gm,"\\>").replace(/\n/g,i===jp.Break?"\\\n":"\n\n");return this}appendMarkdown(e){this.value+=e;return this}appendCodeblock(e,i){this.value+=`
${n7(i,e)}
`;return this}appendLink(e,i,n){this.value+="[";this.value+=this._escape(i,"]");this.value+="](";this.value+=this._escape(String(e),")");if(n){this.value+=` "${this._escape(this._escape(n,'"'),")")}"`}this.value+=")";return this}_escape(e,i){const n=new RegExp(sl(i),"g");return e.replace(n,(s,r)=>{if(e.charAt(r-1)!=="\\"){return`\\${s}`}else{return s}})}};function Qo(t){if(t instanceof Ho){return true}else if(t&&typeof t==="object"){return typeof t.value==="string"&&(typeof t.isTrusted==="boolean"||typeof t.isTrusted==="object"||t.isTrusted===void 0)&&(typeof t.supportThemeIcons==="boolean"||t.supportThemeIcons===void 0)&&(typeof t.supportAlertSyntax==="boolean"||t.supportAlertSyntax===void 0)}return false}function i7(t){return t.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function n7(t,e){const i=t.match(/^`+/gm)?.reduce((s,r)=>s.length>r.length?s:r).length??0;const n=i>=3?i+1:3;return[`${"`".repeat(n)}${e}`,t,`${"`".repeat(n)}`].join("\n")}function s7(t){const e=[];const i=t.split("|").map(s=>s.trim());t=i[0];const n=i[1];if(n){const s=/height=(\d+)/.exec(n);const r=/width=(\d+)/.exec(n);const o=s?s[1]:"";const a=r?r[1]:"";const l=isFinite(parseInt(a));const c=isFinite(parseInt(o));if(l){e.push(`width="${a}"`)}if(c){e.push(`height="${o}"`)}}return{href:t,dimensions:e}}function NS(){return{async:false,breaks:false,extensions:null,gfm:true,hooks:null,pedantic:false,renderer:null,silent:false,tokenizer:null,walkTokens:null}}let Sl=NS();function W4(t){Sl=t}const V4=/[&<>"']/;const r7=new RegExp(V4.source,"g");const z4=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;const o7=new RegExp(z4.source,"g");const a7={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};const e2=t=>a7[t];function On(t,e){if(e){if(V4.test(t)){return t.replace(r7,e2)}}else{if(z4.test(t)){return t.replace(o7,e2)}}return t}const l7=/(^|[^\[])\^/g;function Ft(t,e){let i=typeof t==="string"?t:t.source;e=e||"";const n={replace:(s,r)=>{let o=typeof r==="string"?r:r.source;o=o.replace(l7,"$1");i=i.replace(s,o);return n},getRegex:()=>{return new RegExp(i,e)}};return n}function t2(t){try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const gd={exec:()=>null};function i2(t,e){const i=t.replace(/\|/g,(r,o,a)=>{let l=false;let c=o;while(--c>=0&&a[c]==="\\")l=!l;if(l){return"|"}else{return" |"}}),n=i.split(/ \|/);let s=0;if(!n[0].trim()){n.shift()}if(n.length>0&&!n[n.length-1].trim()){n.pop()}if(e){if(n.length>e){n.splice(e)}else{while(n.length<e)n.push("")}}for(;s<n.length;s++){n[s]=n[s].trim().replace(/\\\|/g,"|")}return n}function Fu(t,e,i){const n=t.length;if(n===0){return""}let s=0;while(s<n){const r=t.charAt(n-s-1);if(r===e&&true){s++}else{break}}return t.slice(0,n-s)}function c7(t,e){if(t.indexOf(e[1])===-1){return-1}let i=0;for(let n=0;n<t.length;n++){if(t[n]==="\\"){n++}else if(t[n]===e[0]){i++}else if(t[n]===e[1]){i--;if(i<0){return n}}}return-1}function n2(t,e,i,n){const s=e.href;const r=e.title?On(e.title):null;const o=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){n.state.inLink=true;const a={type:"link",raw:i,href:s,title:r,text:o,tokens:n.inlineTokens(o)};n.state.inLink=false;return a}return{type:"image",raw:i,href:s,title:r,text:On(o)}}function u7(t,e){const i=t.match(/^(\s+)(?:```)/);if(i===null){return e}const n=i[1];return e.split("\n").map(s=>{const r=s.match(/^\s+/);if(r===null){return s}const[o]=r;if(o.length>=n.length){return s.slice(n.length)}return s}).join("\n")}class Gp{options;rules;lexer;constructor(e){this.options=e||Sl}space(e){const i=this.rules.block.newline.exec(e);if(i&&i[0].length>0){return{type:"space",raw:i[0]}}}code(e){const i=this.rules.block.code.exec(e);if(i){const n=i[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:i[0],codeBlockStyle:"indented",text:!this.options.pedantic?Fu(n,"\n"):n}}}fences(e){const i=this.rules.block.fences.exec(e);if(i){const n=i[0];const s=u7(n,i[3]||"");return{type:"code",raw:n,lang:i[2]?i[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):i[2],text:s}}}heading(e){const i=this.rules.block.heading.exec(e);if(i){let n=i[2].trim();if(/#$/.test(n)){const s=Fu(n,"#");if(this.options.pedantic){n=s.trim()}else if(!s||/ $/.test(s)){n=s.trim()}}return{type:"heading",raw:i[0],depth:i[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const i=this.rules.block.hr.exec(e);if(i){return{type:"hr",raw:Fu(i[0],"\n")}}}blockquote(e){const i=this.rules.block.blockquote.exec(e);if(i){let n=Fu(i[0],"\n").split("\n");let s="";let r="";const o=[];while(n.length>0){let a=false;const l=[];let c;for(c=0;c<n.length;c++){if(/^ {0,3}>/.test(n[c])){l.push(n[c]);a=true}else if(!a){l.push(n[c])}else{break}}n=n.slice(c);const u=l.join("\n");const d=u.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,"\n    $1").replace(/^ {0,3}>[ \t]?/gm,"");s=s?`${s}
${u}`:u;r=r?`${r}
${d}`:d;const f=this.lexer.state.top;this.lexer.state.top=true;this.lexer.blockTokens(d,o,true);this.lexer.state.top=f;if(n.length===0){break}const p=o[o.length-1];if(p?.type==="code"){break}else if(p?.type==="blockquote"){const m=p;const v=m.raw+"\n"+n.join("\n");const y=this.blockquote(v);o[o.length-1]=y;s=s.substring(0,s.length-m.raw.length)+y.raw;r=r.substring(0,r.length-m.text.length)+y.text;break}else if(p?.type==="list"){const m=p;const v=m.raw+"\n"+n.join("\n");const y=this.list(v);o[o.length-1]=y;s=s.substring(0,s.length-p.raw.length)+y.raw;r=r.substring(0,r.length-m.raw.length)+y.raw;n=v.substring(o[o.length-1].raw.length).split("\n");continue}}return{type:"blockquote",raw:s,tokens:o,text:r}}}list(e){let i=this.rules.block.list.exec(e);if(i){let n=i[1].trim();const s=n.length>1;const r={type:"list",raw:"",ordered:s,start:s?+n.slice(0,-1):"",loose:false,items:[]};n=s?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`;if(this.options.pedantic){n=s?n:"[*+-]"}const o=new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a=false;while(e){let l=false;let c="";let u="";if(!(i=o.exec(e))){break}if(this.rules.block.hr.test(e)){break}c=i[0];e=e.substring(c.length);let d=i[2].split("\n",1)[0].replace(/^\t+/,k=>" ".repeat(3*k.length));let f=e.split("\n",1)[0];let p=!d.trim();let m=0;if(this.options.pedantic){m=2;u=d.trimStart()}else if(p){m=i[1].length+1}else{m=i[2].search(/[^ ]/);m=m>4?1:m;u=d.slice(m);m+=i[1].length}if(p&&/^ *$/.test(f)){c+=f+"\n";e=e.substring(f.length+1);l=true}if(!l){const k=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`);const S=new RegExp(`^ {0,${Math.min(3,m-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`);const R=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:\`\`\`|~~~)`);const K=new RegExp(`^ {0,${Math.min(3,m-1)}}#`);while(e){const q=e.split("\n",1)[0];f=q;if(this.options.pedantic){f=f.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")}if(R.test(f)){break}if(K.test(f)){break}if(k.test(f)){break}if(S.test(e)){break}if(f.search(/[^ ]/)>=m||!f.trim()){u+="\n"+f.slice(m)}else{if(p){break}if(d.search(/[^ ]/)>=4){break}if(R.test(d)){break}if(K.test(d)){break}if(S.test(d)){break}u+="\n"+f}if(!p&&!f.trim()){p=true}c+=q+"\n";e=e.substring(q.length+1);d=f.slice(m)}}if(!r.loose){if(a){r.loose=true}else if(/\n *\n *$/.test(c)){a=true}}let v=null;let y;if(this.options.gfm){v=/^\[[ xX]\] /.exec(u);if(v){y=v[0]!=="[ ] ";u=u.replace(/^\[[ xX]\] +/,"")}}r.items.push({type:"list_item",raw:c,task:!!v,checked:y,loose:false,text:u,tokens:[]});r.raw+=c}r.items[r.items.length-1].raw=r.items[r.items.length-1].raw.trimEnd();r.items[r.items.length-1].text=r.items[r.items.length-1].text.trimEnd();r.raw=r.raw.trimEnd();for(let l=0;l<r.items.length;l++){this.lexer.state.top=false;r.items[l].tokens=this.lexer.blockTokens(r.items[l].text,[]);if(!r.loose){const c=r.items[l].tokens.filter(d=>d.type==="space");const u=c.length>0&&c.some(d=>/\n.*\n/.test(d.raw));r.loose=u}}if(r.loose){for(let l=0;l<r.items.length;l++){r.items[l].loose=true}}return r}}html(e){const i=this.rules.block.html.exec(e);if(i){const n={type:"html",block:true,raw:i[0],pre:i[1]==="pre"||i[1]==="script"||i[1]==="style",text:i[0]};return n}}def(e){const i=this.rules.block.def.exec(e);if(i){const n=i[1].toLowerCase().replace(/\s+/g," ");const s=i[2]?i[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"";const r=i[3]?i[3].substring(1,i[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):i[3];return{type:"def",tag:n,raw:i[0],href:s,title:r}}}table(e){const i=this.rules.block.table.exec(e);if(!i){return}if(!/[:|]/.test(i[2])){return}const n=i2(i[1]);const s=i[2].replace(/^\||\| *$/g,"").split("|");const r=i[3]&&i[3].trim()?i[3].replace(/\n[ \t]*$/,"").split("\n"):[];const o={type:"table",raw:i[0],header:[],align:[],rows:[]};if(n.length!==s.length){return}for(const a of s){if(/^ *-+: *$/.test(a)){o.align.push("right")}else if(/^ *:-+: *$/.test(a)){o.align.push("center")}else if(/^ *:-+ *$/.test(a)){o.align.push("left")}else{o.align.push(null)}}for(let a=0;a<n.length;a++){o.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:true,align:o.align[a]})}for(const a of r){o.rows.push(i2(a,o.header.length).map((l,c)=>{return{text:l,tokens:this.lexer.inline(l),header:false,align:o.align[c]}}))}return o}lheading(e){const i=this.rules.block.lheading.exec(e);if(i){return{type:"heading",raw:i[0],depth:i[2].charAt(0)==="="?1:2,text:i[1],tokens:this.lexer.inline(i[1])}}}paragraph(e){const i=this.rules.block.paragraph.exec(e);if(i){const n=i[1].charAt(i[1].length-1)==="\n"?i[1].slice(0,-1):i[1];return{type:"paragraph",raw:i[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const i=this.rules.block.text.exec(e);if(i){return{type:"text",raw:i[0],text:i[0],tokens:this.lexer.inline(i[0])}}}escape(e){const i=this.rules.inline.escape.exec(e);if(i){return{type:"escape",raw:i[0],text:On(i[1])}}}tag(e){const i=this.rules.inline.tag.exec(e);if(i){if(!this.lexer.state.inLink&&/^<a /i.test(i[0])){this.lexer.state.inLink=true}else if(this.lexer.state.inLink&&/^<\/a>/i.test(i[0])){this.lexer.state.inLink=false}if(!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])){this.lexer.state.inRawBlock=true}else if(this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])){this.lexer.state.inRawBlock=false}return{type:"html",raw:i[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:false,text:i[0]}}}link(e){const i=this.rules.inline.link.exec(e);if(i){const n=i[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n)){return}const o=Fu(n.slice(0,-1),"\\");if((n.length-o.length)%2===0){return}}else{const o=c7(i[2],"()");if(o>-1){const a=i[0].indexOf("!")===0?5:4;const l=a+i[1].length+o;i[2]=i[2].substring(0,o);i[0]=i[0].substring(0,l).trim();i[3]=""}}let s=i[2];let r="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);if(o){s=o[1];r=o[3]}}else{r=i[3]?i[3].slice(1,-1):""}s=s.trim();if(/^</.test(s)){if(this.options.pedantic&&!/>$/.test(n)){s=s.slice(1)}else{s=s.slice(1,-1)}}return n2(i,{href:s?s.replace(this.rules.inline.anyPunctuation,"$1"):s,title:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r},i[0],this.lexer)}}reflink(e,i){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const s=(n[2]||n[1]).replace(/\s+/g," ");const r=i[s.toLowerCase()];if(!r){const o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return n2(n,r,n[0],this.lexer)}}emStrong(e,i,n=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s)return;if(s[3]&&n.match(/[\p{L}\p{N}]/u))return;const r=s[1]||s[2]||"";if(!r||!n||this.rules.inline.punctuation.exec(n)){const o=[...s[0]].length-1;let a,l,c=o,u=0;const d=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;d.lastIndex=0;i=i.slice(-1*e.length+o);while((s=d.exec(i))!=null){a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6];if(!a)continue;l=[...a].length;if(s[3]||s[4]){c+=l;continue}else if(s[5]||s[6]){if(o%3&&!((o+l)%3)){u+=l;continue}}c-=l;if(c>0)continue;l=Math.min(l,l+c+u);const f=[...s[0]][0].length;const p=e.slice(0,o+s.index+f+l);if(Math.min(o,l)%2){const v=p.slice(1,-1);return{type:"em",raw:p,text:v,tokens:this.lexer.inlineTokens(v)}}const m=p.slice(2,-2);return{type:"strong",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const i=this.rules.inline.code.exec(e);if(i){let n=i[2].replace(/\n/g," ");const s=/[^ ]/.test(n);const r=/^ /.test(n)&&/ $/.test(n);if(s&&r){n=n.substring(1,n.length-1)}n=On(n,true);return{type:"codespan",raw:i[0],text:n}}}br(e){const i=this.rules.inline.br.exec(e);if(i){return{type:"br",raw:i[0]}}}del(e){const i=this.rules.inline.del.exec(e);if(i){return{type:"del",raw:i[0],text:i[2],tokens:this.lexer.inlineTokens(i[2])}}}autolink(e){const i=this.rules.inline.autolink.exec(e);if(i){let n,s;if(i[2]==="@"){n=On(i[1]);s="mailto:"+n}else{n=On(i[1]);s=n}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let i;if(i=this.rules.inline.url.exec(e)){let n,s;if(i[2]==="@"){n=On(i[0]);s="mailto:"+n}else{let r;do{r=i[0];i[0]=this.rules.inline._backpedal.exec(i[0])?.[0]??""}while(r!==i[0]);n=On(i[0]);if(i[1]==="www."){s="http://"+i[0]}else{s=i[0]}}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){const i=this.rules.inline.text.exec(e);if(i){let n;if(this.lexer.state.inRawBlock){n=i[0]}else{n=On(i[0])}return{type:"text",raw:i[0],text:n}}}}const d7=/^(?: *(?:\n|$))+/;const h7=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/;const f7=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/;const cf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/;const p7=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/;const q4=/(?:[*+-]|\d{1,9}[.)])/;const j4=Ft(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,q4).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex();const MS=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/;const g7=/^[^\n]+/;const OS=/(?!\s*\])(?:\\.|[^\[\]\\])+/;const m7=Ft(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",OS).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex();const _7=Ft(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,q4).getRegex();const L_="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";const FS=/<!--(?:-?>|[\s\S]*?(?:-->|$))/;const v7=Ft("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",FS).replace("tag",L_).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();const G4=Ft(MS).replace("hr",cf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",L_).getRegex();const w7=Ft(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",G4).getRegex();const US={blockquote:w7,code:h7,def:m7,fences:f7,heading:p7,hr:cf,html:v7,lheading:j4,list:_7,newline:d7,paragraph:G4,table:gd,text:g7};const s2=Ft("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",cf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",L_).getRegex();const b7={...US,table:s2,paragraph:Ft(MS).replace("hr",cf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",s2).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",L_).getRegex()};const y7={...US,html:Ft(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",FS).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:gd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ft(MS).replace("hr",cf).replace("heading"," *#{1,6} *[^\n]").replace("lheading",j4).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()};const K4=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/;const S7=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/;const Q4=/^( {2,}|\\)\n(?!\s*$)/;const x7=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/;const uf="\\p{P}\\p{S}";const E7=Ft(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,uf).getRegex();const C7=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;const k7=Ft(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,uf).getRegex();const D7=Ft("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,uf).getRegex();const I7=Ft("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,uf).getRegex();const T7=Ft(/\\([punct])/,"gu").replace(/punct/g,uf).getRegex();const P7=Ft(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex();const A7=Ft(FS).replace("(?:-->|$)","-->").getRegex();const R7=Ft("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",A7).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex();const Kp=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;const L7=Ft(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Kp).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex();const J4=Ft(/^!?\[(label)\]\[(ref)\]/).replace("label",Kp).replace("ref",OS).getRegex();const Y4=Ft(/^!?\[(ref)\](?:\[\])?/).replace("ref",OS).getRegex();const N7=Ft("reflink|nolink(?!\\()","g").replace("reflink",J4).replace("nolink",Y4).getRegex();const $S={_backpedal:gd,anyPunctuation:T7,autolink:P7,blockSkip:C7,br:Q4,code:S7,del:gd,emStrongLDelim:k7,emStrongRDelimAst:D7,emStrongRDelimUnd:I7,escape:K4,link:L7,nolink:Y4,punctuation:E7,reflink:J4,reflinkSearch:N7,tag:R7,text:x7,url:gd};const M7={...$S,link:Ft(/^!?\[(label)\]\((.*?)\)/).replace("label",Kp).getRegex(),reflink:Ft(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Kp).getRegex()};const j1={...$S,escape:Ft(K4).replace("])","~|])").getRegex(),url:Ft(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};const O7={...j1,br:Ft(Q4).replace("{2,}","*").getRegex(),text:Ft(j1.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};const Pf={normal:US,gfm:b7,pedantic:y7};const Uu={normal:$S,gfm:j1,breaks:O7,pedantic:M7};class Zs{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[];this.tokens.links=Object.create(null);this.options=e||Sl;this.options.tokenizer=this.options.tokenizer||new Gp;this.tokenizer=this.options.tokenizer;this.tokenizer.options=this.options;this.tokenizer.lexer=this;this.inlineQueue=[];this.state={inLink:false,inRawBlock:false,top:true};const i={block:Pf.normal,inline:Uu.normal};if(this.options.pedantic){i.block=Pf.pedantic;i.inline=Uu.pedantic}else if(this.options.gfm){i.block=Pf.gfm;if(this.options.breaks){i.inline=Uu.breaks}else{i.inline=Uu.gfm}}this.tokenizer.rules=i}static get rules(){return{block:Pf,inline:Uu}}static lex(e,i){const n=new Zs(i);return n.lex(e)}static lexInline(e,i){const n=new Zs(i);return n.inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,"\n");this.blockTokens(e,this.tokens);for(let i=0;i<this.inlineQueue.length;i++){const n=this.inlineQueue[i];this.inlineTokens(n.src,n.tokens)}this.inlineQueue=[];return this.tokens}blockTokens(e,i=[],n=false){if(this.options.pedantic){e=e.replace(/\t/g,"    ").replace(/^ +$/gm,"")}else{e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>{return l+"    ".repeat(c.length)})}let s;let r;let o;while(e){if(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>{if(s=a.call({lexer:this},e,i)){e=e.substring(s.raw.length);i.push(s);return true}return false})){continue}if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);if(s.raw.length===1&&i.length>0){i[i.length-1].raw+="\n"}else{i.push(s)}continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);r=i[i.length-1];if(r&&(r.type==="paragraph"||r.type==="text")){r.raw+="\n"+s.raw;r.text+="\n"+s.text;this.inlineQueue[this.inlineQueue.length-1].src=r.text}else{i.push(s)}continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);r=i[i.length-1];if(r&&(r.type==="paragraph"||r.type==="text")){r.raw+="\n"+s.raw;r.text+="\n"+s.raw;this.inlineQueue[this.inlineQueue.length-1].src=r.text}else if(!this.tokens.links[s.tag]){this.tokens.links[s.tag]={href:s.href,title:s.title}}continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length);i.push(s);continue}o=e;if(this.options.extensions&&this.options.extensions.startBlock){let a=Infinity;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},l);if(typeof c==="number"&&c>=0){a=Math.min(a,c)}});if(a<Infinity&&a>=0){o=e.substring(0,a+1)}}if(this.state.top&&(s=this.tokenizer.paragraph(o))){r=i[i.length-1];if(n&&r?.type==="paragraph"){r.raw+="\n"+s.raw;r.text+="\n"+s.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=r.text}else{i.push(s)}n=o.length!==e.length;e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);r=i[i.length-1];if(r&&r.type==="text"){r.raw+="\n"+s.raw;r.text+="\n"+s.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=r.text}else{i.push(s)}continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else{throw new Error(a)}}}this.state.top=true;return i}inline(e,i=[]){this.inlineQueue.push({src:e,tokens:i});return i}inlineTokens(e,i=[]){let n,s,r;let o=e;let a;let l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0){while((a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null){if(u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))){o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex)}}}}while((a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null){o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex)}while((a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null){o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex)}while(e){if(!l){c=""}l=false;if(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>{if(n=u.call({lexer:this},e,i)){e=e.substring(n.raw.length);i.push(n);return true}return false})){continue}if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length);s=i[i.length-1];if(s&&n.type==="text"&&s.type==="text"){s.raw+=n.raw;s.text+=n.text}else{i.push(n)}continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length);s=i[i.length-1];if(s&&n.type==="text"&&s.type==="text"){s.raw+=n.raw;s.text+=n.text}else{i.push(n)}continue}if(n=this.tokenizer.emStrong(e,o,c)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length);i.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length);i.push(n);continue}r=e;if(this.options.extensions&&this.options.extensions.startInline){let u=Infinity;const d=e.slice(1);let f;this.options.extensions.startInline.forEach(p=>{f=p.call({lexer:this},d);if(typeof f==="number"&&f>=0){u=Math.min(u,f)}});if(u<Infinity&&u>=0){r=e.substring(0,u+1)}}if(n=this.tokenizer.inlineText(r)){e=e.substring(n.raw.length);if(n.raw.slice(-1)!=="_"){c=n.raw.slice(-1)}l=true;s=i[i.length-1];if(s&&s.type==="text"){s.raw+=n.raw;s.text+=n.text}else{i.push(n)}continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else{throw new Error(u)}}}return i}}class Qp{options;parser;constructor(e){this.options=e||Sl}space(e){return""}code({text:e,lang:i,escaped:n}){const s=(i||"").match(/^\S*/)?.[0];const r=e.replace(/\n$/,"")+"\n";if(!s){return"<pre><code>"+(n?r:On(r,true))+"</code></pre>\n"}return'<pre><code class="language-'+On(s)+'">'+(n?r:On(r,true))+"</code></pre>\n"}blockquote({tokens:e}){const i=this.parser.parse(e);return`<blockquote>
${i}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:i}){return`<h${i}>${this.parser.parseInline(e)}</h${i}>
`}hr(e){return"<hr>\n"}list(e){const i=e.ordered;const n=e.start;let s="";for(let a=0;a<e.items.length;a++){const l=e.items[a];s+=this.listitem(l)}const r=i?"ol":"ul";const o=i&&n!==1?' start="'+n+'"':"";return"<"+r+o+">\n"+s+"</"+r+">\n"}listitem(e){let i="";if(e.task){const n=this.checkbox({checked:!!e.checked});if(e.loose){if(e.tokens.length>0&&e.tokens[0].type==="paragraph"){e.tokens[0].text=n+" "+e.tokens[0].text;if(e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"){e.tokens[0].tokens[0].text=n+" "+e.tokens[0].tokens[0].text}}else{e.tokens.unshift({type:"text",raw:n+" ",text:n+" "})}}else{i+=n+" "}}i+=this.parser.parse(e.tokens,!!e.loose);return`<li>${i}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let i="";let n="";for(let r=0;r<e.header.length;r++){n+=this.tablecell(e.header[r])}i+=this.tablerow({text:n});let s="";for(let r=0;r<e.rows.length;r++){const o=e.rows[r];n="";for(let a=0;a<o.length;a++){n+=this.tablecell(o[a])}s+=this.tablerow({text:n})}if(s)s=`<tbody>${s}</tbody>`;return"<table>\n<thead>\n"+i+"</thead>\n"+s+"</table>\n"}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const i=this.parser.parseInline(e.tokens);const n=e.header?"th":"td";const s=e.align?`<${n} align="${e.align}">`:`<${n}>`;return s+i+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:i,tokens:n}){const s=this.parser.parseInline(n);const r=t2(e);if(r===null){return s}e=r;let o='<a href="'+e+'"';if(i){o+=' title="'+i+'"'}o+=">"+s+"</a>";return o}image({href:e,title:i,text:n}){const s=t2(e);if(s===null){return n}e=s;let r=`<img src="${e}" alt="${n}"`;if(i){r+=` title="${i}"`}r+=">";return r}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class HS{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class er{options;renderer;textRenderer;constructor(e){this.options=e||Sl;this.options.renderer=this.options.renderer||new Qp;this.renderer=this.options.renderer;this.renderer.options=this.options;this.renderer.parser=this;this.textRenderer=new HS}static parse(e,i){const n=new er(i);return n.parse(e)}static parseInline(e,i){const n=new er(i);return n.parseInline(e)}parse(e,i=true){let n="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const a=r;const l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==false||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){n+=l||"";continue}}const o=r;switch(o.type){case"space":{n+=this.renderer.space(o);continue}case"hr":{n+=this.renderer.hr(o);continue}case"heading":{n+=this.renderer.heading(o);continue}case"code":{n+=this.renderer.code(o);continue}case"table":{n+=this.renderer.table(o);continue}case"blockquote":{n+=this.renderer.blockquote(o);continue}case"list":{n+=this.renderer.list(o);continue}case"html":{n+=this.renderer.html(o);continue}case"paragraph":{n+=this.renderer.paragraph(o);continue}case"text":{let a=o;let l=this.renderer.text(a);while(s+1<e.length&&e[s+1].type==="text"){a=e[++s];l+="\n"+this.renderer.text(a)}if(i){n+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]})}else{n+=l}continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(a);return""}else{throw new Error(a)}}}}return n}parseInline(e,i){i=i||this.renderer;let n="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const a=this.options.extensions.renderers[r.type].call({parser:this},r);if(a!==false||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){n+=a||"";continue}}const o=r;switch(o.type){case"escape":{n+=i.text(o);break}case"html":{n+=i.html(o);break}case"link":{n+=i.link(o);break}case"image":{n+=i.image(o);break}case"strong":{n+=i.strong(o);break}case"em":{n+=i.em(o);break}case"codespan":{n+=i.codespan(o);break}case"br":{n+=i.br(o);break}case"del":{n+=i.del(o);break}case"text":{n+=i.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(a);return""}else{throw new Error(a)}}}}return n}}class sp{options;constructor(e){this.options=e||Sl}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}class F7{defaults=NS();options=this.setOptions;parse=this.parseMarkdown(Zs.lex,er.parse);parseInline=this.parseMarkdown(Zs.lexInline,er.parseInline);Parser=er;Renderer=Qp;TextRenderer=HS;Lexer=Zs;Tokenizer=Gp;Hooks=sp;constructor(...e){this.use(...e)}walkTokens(e,i){let n=[];for(const s of e){n=n.concat(i.call(this,s));switch(s.type){case"table":{const r=s;for(const o of r.header){n=n.concat(this.walkTokens(o.tokens,i))}for(const o of r.rows){for(const a of o){n=n.concat(this.walkTokens(a.tokens,i))}}break}case"list":{const r=s;n=n.concat(this.walkTokens(r.items,i));break}default:{const r=s;if(this.defaults.extensions?.childTokens?.[r.type]){this.defaults.extensions.childTokens[r.type].forEach(o=>{const a=r[o].flat(Infinity);n=n.concat(this.walkTokens(a,i))})}else if(r.tokens){n=n.concat(this.walkTokens(r.tokens,i))}}}}return n}use(...e){const i=this.defaults.extensions||{renderers:{},childTokens:{}};e.forEach(n=>{const s={...n};s.async=this.defaults.async||s.async||false;if(n.extensions){n.extensions.forEach(r=>{if(!r.name){throw new Error("extension name required")}if("renderer"in r){const o=i.renderers[r.name];if(o){i.renderers[r.name]=function(...a){let l=r.renderer.apply(this,a);if(l===false){l=o.apply(this,a)}return l}}else{i.renderers[r.name]=r.renderer}}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline"){throw new Error("extension level must be 'block' or 'inline'")}const o=i[r.level];if(o){o.unshift(r.tokenizer)}else{i[r.level]=[r.tokenizer]}if(r.start){if(r.level==="block"){if(i.startBlock){i.startBlock.push(r.start)}else{i.startBlock=[r.start]}}else if(r.level==="inline"){if(i.startInline){i.startInline.push(r.start)}else{i.startInline=[r.start]}}}}if("childTokens"in r&&r.childTokens){i.childTokens[r.name]=r.childTokens}});s.extensions=i}if(n.renderer){const r=this.defaults.renderer||new Qp(this.defaults);for(const o in n.renderer){if(!(o in r)){throw new Error(`renderer '${o}' does not exist`)}if(["options","parser"].includes(o)){continue}const a=o;const l=n.renderer[a];const c=r[a];r[a]=(...u)=>{let d=l.apply(r,u);if(d===false){d=c.apply(r,u)}return d||""}}s.renderer=r}if(n.tokenizer){const r=this.defaults.tokenizer||new Gp(this.defaults);for(const o in n.tokenizer){if(!(o in r)){throw new Error(`tokenizer '${o}' does not exist`)}if(["options","rules","lexer"].includes(o)){continue}const a=o;const l=n.tokenizer[a];const c=r[a];r[a]=(...u)=>{let d=l.apply(r,u);if(d===false){d=c.apply(r,u)}return d}}s.tokenizer=r}if(n.hooks){const r=this.defaults.hooks||new sp;for(const o in n.hooks){if(!(o in r)){throw new Error(`hook '${o}' does not exist`)}if(o==="options"){continue}const a=o;const l=n.hooks[a];const c=r[a];if(sp.passThroughHooks.has(o)){r[a]=u=>{if(this.defaults.async){return Promise.resolve(l.call(r,u)).then(f=>{return c.call(r,f)})}const d=l.call(r,u);return c.call(r,d)}}else{r[a]=(...u)=>{let d=l.apply(r,u);if(d===false){d=c.apply(r,u)}return d}}}s.hooks=r}if(n.walkTokens){const r=this.defaults.walkTokens;const o=n.walkTokens;s.walkTokens=function(a){let l=[];l.push(o.call(this,a));if(r){l=l.concat(r.call(this,a))}return l}}this.defaults={...this.defaults,...s}});return this}setOptions(e){this.defaults={...this.defaults,...e};return this}lexer(e,i){return Zs.lex(e,i??this.defaults)}parser(e,i){return er.parse(e,i??this.defaults)}parseMarkdown(e,i){const n=(s,r)=>{const o={...r};const a={...this.defaults,...o};const l=this.onError(!!a.silent,!!a.async);if(this.defaults.async===true&&o.async===false){return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."))}if(typeof s==="undefined"||s===null){return l(new Error("marked(): input parameter is undefined or null"))}if(typeof s!=="string"){return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"))}if(a.hooks){a.hooks.options=a}if(a.async){return Promise.resolve(a.hooks?a.hooks.preprocess(s):s).then(c=>e(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>i(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(l)}try{if(a.hooks){s=a.hooks.preprocess(s)}let c=e(s,a);if(a.hooks){c=a.hooks.processAllTokens(c)}if(a.walkTokens){this.walkTokens(c,a.walkTokens)}let u=i(c,a);if(a.hooks){u=a.hooks.postprocess(u)}return u}catch(c){return l(c)}};return n}onError(e,i){return n=>{n.message+="\nPlease report this to https://github.com/markedjs/marked.";if(e){const s="<p>An error occurred:</p><pre>"+On(n.message+"",true)+"</pre>";if(i){return Promise.resolve(s)}return s}if(i){return Promise.reject(n)}throw n}}}const al=new F7;function Rt(t,e){return al.parse(t,e)}Rt.options=Rt.setOptions=function(t){al.setOptions(t);Rt.defaults=al.defaults;W4(Rt.defaults);return Rt};Rt.getDefaults=NS;Rt.defaults=Sl;Rt.use=function(...t){al.use(...t);Rt.defaults=al.defaults;W4(Rt.defaults);return Rt};Rt.walkTokens=function(t,e){return al.walkTokens(t,e)};Rt.parseInline=al.parseInline;Rt.Parser=er;Rt.parser=er.parse;Rt.Renderer=Qp;Rt.TextRenderer=HS;Rt.Lexer=Zs;Rt.lexer=Zs.lex;Rt.Tokenizer=Gp;Rt.Hooks=sp;Rt.parse=Rt;Rt.options;Rt.setOptions;Rt.use;Rt.walkTokens;Rt.parseInline;er.parse;Zs.lex;function U7(t){return JSON.stringify(t,$7)}function X4(t){let e=JSON.parse(t);e=Wi(e);return e}function $7(t,e){if(e instanceof RegExp){return{$mid:nt.Regexp,source:e.source,flags:e.flags}}return e}function Wi(t,e=0){if(!t||e>200){return t}if(typeof t==="object"){switch(t.$mid){case nt.Uri:return b.revive(t);case nt.Regexp:return new RegExp(t.source,t.flags);case nt.Date:return new Date(t.source)}if(t instanceof ae||t instanceof Uint8Array){return t}if(Array.isArray(t)){for(let i=0;i<t.length;++i){t[i]=Wi(t[i],e+1)}}else{for(const i in t){if(Object.hasOwnProperty.call(t,i)){t[i]=Wi(t[i],e+1)}}}}return t}const Ps=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"});const H7=/^(.+)\/(.+?)(;.+)?$/;function Z4(t,e){const i=H7.exec(t);if(!i){return e?void 0:t}return`${i[1].toLowerCase()}/${i[2].toLowerCase()}${i[3]??""}`}function eP(t){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(t)}const Xi=Symbol("unset");class B7{constructor(){this.root=new Fv;this._size=0}get size(){return this._size}get nodes(){return this.root.children?.values()||qi.empty()}get entries(){return this.root.children?.entries()||qi.empty()}insert(e,i,n){this.opNode(e,s=>s._value=i,n)}mutate(e,i){this.opNode(e,n=>n._value=i(n._value===Xi?void 0:n._value))}mutatePath(e,i){this.opNode(e,()=>{},n=>i(n))}delete(e){const i=this.getPathToKey(e);if(!i){return}let n=i.length-1;const s=i[n].node._value;if(s===Xi){return}this._size--;i[n].node._value=Xi;for(;n>0;n--){const{node:r,part:o}=i[n];if(r.children?.size||r._value!==Xi){break}i[n-1].node.children.delete(o)}return s}*deleteRecursive(e){const i=this.getPathToKey(e);if(!i){return}const n=i[i.length-1].node;for(let s=i.length-1;s>0;s--){const r=i[s-1];r.node.children.delete(i[s].part);if(r.node.children.size>0||r.node._value!==Xi){break}}for(const s of r2(n)){if(s._value!==Xi){this._size--;yield s._value}}if(n===this.root){this.root._value=Xi;this.root.children=void 0}}find(e){let i=this.root;for(const n of e){const s=i.children?.get(n);if(!s){return void 0}i=s}return i._value===Xi?void 0:i._value}hasKeyOrParent(e){let i=this.root;for(const n of e){const s=i.children?.get(n);if(!s){return false}if(s._value!==Xi){return true}i=s}return false}hasKeyOrChildren(e){let i=this.root;for(const n of e){const s=i.children?.get(n);if(!s){return false}i=s}return true}hasKey(e){let i=this.root;for(const n of e){const s=i.children?.get(n);if(!s){return false}i=s}return i._value!==Xi}getPathToKey(e){const i=[{part:"",node:this.root}];let n=0;for(const s of e){const r=i[n].node.children?.get(s);if(!r){return}i.push({part:s,node:r});n++}return i}opNode(e,i,n){let s=this.root;for(const a of e){if(!s.children){const l=new Fv;s.children=new Map([[a,l]]);s=l}else if(!s.children.has(a)){const l=new Fv;s.children.set(a,l);s=l}else{s=s.children.get(a)}n?.(s)}const r=s._value===Xi?0:1;i(s);const o=s._value===Xi?0:1;this._size+=o-r}*values(){for(const{_value:e}of r2(this.root)){if(e!==Xi){yield e}}}}function*r2(t){const e=[t];while(e.length>0){const i=e.pop();yield i;if(i.children){for(const n of i.children.values()){e.push(n)}}}}class Fv{constructor(){this._value=Xi}get value(){return this._value===Xi?void 0:this._value}set value(e){this._value=e===void 0?Xi:e}}var za;(function(t){t[t["Auto"]=1]="Auto";t[t["Hidden"]=2]="Hidden";t[t["Visible"]=3]="Visible"})(za||(za={}));const W7=new class{constructor(){this._zoomLevel=0;this._onDidChangeZoomLevel=new L;this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(t){t=Math.min(Math.max(-5,t),20);if(this._zoomLevel===t){return}this._zoomLevel=t;this._onDidChangeZoomLevel.fire(this._zoomLevel)}};const V7=vn?1.5:1.35;const Uv=8;class Jp{static _create(e,i,n,s,r,o,a,l,c){if(o===0){o=V7*n}else if(o<Uv){o=o*n}o=Math.round(o);if(o<Uv){o=Uv}const u=1+(c?0:W7.getZoomLevel()*.1);n*=u;o*=u;if(r===iP){if(i==="normal"||i==="bold"){r=tP}else{const d=parseInt(i,10);r=`'wght' ${d}`;i="normal"}}return new Jp({pixelRatio:l,fontFamily:e,fontWeight:i,fontSize:n,fontFeatureSettings:s,fontVariationSettings:r,lineHeight:o,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0;this.pixelRatio=e.pixelRatio;this.fontFamily=String(e.fontFamily);this.fontWeight=String(e.fontWeight);this.fontSize=e.fontSize;this.fontFeatureSettings=e.fontFeatureSettings;this.fontVariationSettings=e.fontVariationSettings;this.lineHeight=e.lineHeight|0;this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=nr.fontFamily;const i=Jp._wrapInQuotes(this.fontFamily);if(this.fontFamily!==e){return`${i}, ${e}`}return i}static _wrapInQuotes(e){if(/[,"']/.test(e)){return e}if(/[+ ]/.test(e)){return`"${e}"`}return e}}const z7=2;class q7 extends Jp{constructor(e,i){super(e);this._editorStylingBrand=void 0;this.version=z7;this.isTrusted=i;this.isMonospace=e.isMonospace;this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth;this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth;this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow;this.spaceWidth=e.spaceWidth;this.middotWidth=e.middotWidth;this.wsmiddotWidth=e.wsmiddotWidth;this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}const tP="normal";const iP="translate";const j7="Consolas, 'Courier New', monospace";const G7="Menlo, Monaco, 'Courier New', monospace";const K7="'Droid Sans Mono', monospace";const nr={fontFamily:vn?G7:nn?j7:K7,fontWeight:"normal",fontSize:vn?12:14,lineHeight:0,letterSpacing:0};const o2={bracketPairColorizationOptions:{enabled:true,independentColorPoolPerBracketType:false}};const nP="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function Q7(t=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const i of nP){if(t.indexOf(i)>=0){continue}e+="\\"+i}e+="\\s]+)";return new RegExp(e,"g")}const J7=Q7();function sP(t){let e=J7;if(t&&t instanceof RegExp){if(!t.global){let i="g";if(t.ignoreCase){i+="i"}if(t.multiline){i+="m"}if(t.unicode){i+="u"}e=new RegExp(t.source,i)}else{e=t}}e.lastIndex=0;return e}const rP=new Go;rP.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function oP(t,e,i,n,s){e=sP(e);if(!s){s=qi.first(rP)}if(i.length>s.maxLen){let c=t-s.maxLen/2;if(c<0){c=0}else{n+=c}i=i.substring(c,t+s.maxLen/2);return oP(t,e,i,n,s)}const r=Date.now();const o=t-1-n;let a=-1;let l=null;for(let c=1;;c++){if(Date.now()-r>=s.timeBudget){break}const u=o-s.windowSize*c;e.lastIndex=Math.max(0,u);const d=Y7(e,i,o,a);if(!d&&l){break}l=d;if(u<=0){break}a=u}if(l){const c={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};e.lastIndex=0;return c}return null}function Y7(t,e,i,n){let s;while(s=t.exec(e)){const r=s.index||0;if(r<=i&&t.lastIndex>=i){return s}else if(n>0&&r>n){return null}}return null}var ie;(function(t){t[t["LParen"]=0]="LParen";t[t["RParen"]=1]="RParen";t[t["Neg"]=2]="Neg";t[t["Eq"]=3]="Eq";t[t["NotEq"]=4]="NotEq";t[t["Lt"]=5]="Lt";t[t["LtEq"]=6]="LtEq";t[t["Gt"]=7]="Gt";t[t["GtEq"]=8]="GtEq";t[t["RegexOp"]=9]="RegexOp";t[t["RegexStr"]=10]="RegexStr";t[t["True"]=11]="True";t[t["False"]=12]="False";t[t["In"]=13]="In";t[t["Not"]=14]="Not";t[t["And"]=15]="And";t[t["Or"]=16]="Or";t[t["Str"]=17]="Str";t[t["QuotedStr"]=18]="QuotedStr";t[t["Error"]=19]="Error";t[t["EOF"]=20]="EOF"})(ie||(ie={}));function $v(...t){switch(t.length){case 1:return h(1796,"Did you mean {0}?",t[0]);case 2:return h(1797,"Did you mean {0} or {1}?",t[0],t[1]);case 3:return h(1798,"Did you mean {0}, {1} or {2}?",t[0],t[1],t[2]);default:return void 0}}const X7=h(1799,"Did you forget to open or close the quote?");const Z7=h(1800,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");class _o{constructor(){this._input="";this._start=0;this._current=0;this._tokens=[];this._errors=[];this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case ie.LParen:return"(";case ie.RParen:return")";case ie.Neg:return"!";case ie.Eq:return e.isTripleEq?"===":"==";case ie.NotEq:return e.isTripleEq?"!==":"!=";case ie.Lt:return"<";case ie.LtEq:return"<=";case ie.Gt:return">=";case ie.GtEq:return">=";case ie.RegexOp:return"=~";case ie.RegexStr:return e.lexeme;case ie.True:return"true";case ie.False:return"false";case ie.In:return"in";case ie.Not:return"not";case ie.And:return"&&";case ie.Or:return"||";case ie.Str:return e.lexeme;case ie.QuotedStr:return e.lexeme;case ie.Error:return e.lexeme;case ie.EOF:return"EOF";default:throw mS(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)))}static{this._keywords=new Map([["not",ie.Not],["in",ie.In],["false",ie.False],["true",ie.True]])}get errors(){return this._errors}reset(e){this._input=e;this._start=0;this._current=0;this._tokens=[];this._errors=[];return this}scan(){while(!this._isAtEnd()){this._start=this._current;const e=this._advance();switch(e){case M.OpenParen:this._addToken(ie.LParen);break;case M.CloseParen:this._addToken(ie.RParen);break;case M.ExclamationMark:if(this._match(M.Equals)){const i=this._match(M.Equals);this._tokens.push({type:ie.NotEq,offset:this._start,isTripleEq:i})}else{this._addToken(ie.Neg)}break;case M.SingleQuote:this._quotedString();break;case M.Slash:this._regex();break;case M.Equals:if(this._match(M.Equals)){const i=this._match(M.Equals);this._tokens.push({type:ie.Eq,offset:this._start,isTripleEq:i})}else if(this._match(M.Tilde)){this._addToken(ie.RegexOp)}else{this._error($v("==","=~"))}break;case M.LessThan:this._addToken(this._match(M.Equals)?ie.LtEq:ie.Lt);break;case M.GreaterThan:this._addToken(this._match(M.Equals)?ie.GtEq:ie.Gt);break;case M.Ampersand:if(this._match(M.Ampersand)){this._addToken(ie.And)}else{this._error($v("&&"))}break;case M.Pipe:if(this._match(M.Pipe)){this._addToken(ie.Or)}else{this._error($v("||"))}break;case M.Space:case M.CarriageReturn:case M.Tab:case M.LineFeed:case M.NoBreakSpace:break;default:this._string()}}this._start=this._current;this._addToken(ie.EOF);return Array.from(this._tokens)}_match(e){if(this._isAtEnd()){return false}if(this._input.charCodeAt(this._current)!==e){return false}this._current++;return true}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?M.Null:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const i=this._start;const n=this._input.substring(this._start,this._current);const s={type:ie.Error,offset:this._start,lexeme:n};this._errors.push({offset:i,lexeme:n,additionalInfo:e});this._tokens.push(s)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const i=this._input.substring(this._start,this._current);const n=_o._keywords.get(i);if(n){this._addToken(n)}else{this._tokens.push({type:ie.Str,lexeme:i,offset:this._start})}}}_quotedString(){while(this._peek()!==M.SingleQuote&&!this._isAtEnd()){this._advance()}if(this._isAtEnd()){this._error(X7);return}this._advance();this._tokens.push({type:ie.QuotedStr,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current;let i=false;let n=false;while(true){if(e>=this._input.length){this._current=e;this._error(Z7);return}const r=this._input.charCodeAt(e);if(i){i=false}else if(r===M.Slash&&!n){e++;break}else if(r===M.OpenSquareBracket){n=true}else if(r===M.Backslash){i=true}else if(r===M.CloseSquareBracket){n=false}e++}while(e<this._input.length&&_o._regexFlags.has(this._input.charCodeAt(e))){e++}this._current=e;const s=this._input.substring(this._start,this._current);this._tokens.push({type:ie.RegexStr,lexeme:s,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}}const Ai=new Map;Ai.set("false",false);Ai.set("true",true);Ai.set("isMac",vn);Ai.set("isLinux",Fo);Ai.set("isWindows",nn);Ai.set("isWeb",_u);Ai.set("isMacNative",vn&&!_u);Ai.set("isEdge",t4);Ai.set("isFirefox",JR);Ai.set("isChrome",xS);Ai.set("isSafari",YR);const e6=Object.prototype.hasOwnProperty;var Vt;(function(t){t[t["False"]=0]="False";t[t["True"]=1]="True";t[t["Defined"]=2]="Defined";t[t["Not"]=3]="Not";t[t["Equals"]=4]="Equals";t[t["NotEquals"]=5]="NotEquals";t[t["And"]=6]="And";t[t["Regex"]=7]="Regex";t[t["NotRegex"]=8]="NotRegex";t[t["Or"]=9]="Or";t[t["In"]=10]="In";t[t["NotIn"]=11]="NotIn";t[t["Greater"]=12]="Greater";t[t["GreaterEquals"]=13]="GreaterEquals";t[t["Smaller"]=14]="Smaller";t[t["SmallerEquals"]=15]="SmallerEquals"})(Vt||(Vt={}));const t6={regexParsingWithErrorRecovery:true};const i6=h(1776,"Empty context key expression");const n6=h(1777,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively.");const s6=h(1778,"'in' after 'not'.");const a2=h(1779,"closing parenthesis ')'");const r6=h(1780,"Unexpected token");const o6=h(1781,"Did you forget to put && or || before the token?");const a6=h(1782,"Unexpected end of expression");const l6=h(1783,"Did you forget to put a context key?");class ka{static{this._parseError=new Error}get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=t6){this._config=e;this._scanner=new _o;this._tokens=[];this._current=0;this._parsingErrors=[];this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:i6,offset:0,lexeme:"",additionalInfo:n6});return void 0}this._tokens=this._scanner.reset(e).scan();this._current=0;this._parsingErrors=[];try{const i=this._expr();if(!this._isAtEnd()){const n=this._peek();const s=n.type===ie.Str?o6:void 0;this._parsingErrors.push({message:r6,offset:n.offset,lexeme:_o.getLexeme(n),additionalInfo:s});throw ka._parseError}return i}catch(i){if(!(i===ka._parseError)){throw i}return void 0}}_expr(){return this._or()}_or(){const e=[this._and()];while(this._matchOne(ie.Or)){const i=this._and();e.push(i)}return e.length===1?e[0]:ni.or(...e)}_and(){const e=[this._term()];while(this._matchOne(ie.And)){const i=this._term();e.push(i)}return e.length===1?e[0]:ni.and(...e)}_term(){if(this._matchOne(ie.Neg)){const e=this._peek();switch(e.type){case ie.True:this._advance();return Ki.INSTANCE;case ie.False:this._advance();return sn.INSTANCE;case ie.LParen:{this._advance();const i=this._expr();this._consume(ie.RParen,a2);return i?.negate()}case ie.Str:this._advance();return El.create(e.lexeme);default:throw this._errExpectedButGot(`KEY | true | false | '(' expression ')'`,e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case ie.True:this._advance();return ni.true();case ie.False:this._advance();return ni.false();case ie.LParen:{this._advance();const i=this._expr();this._consume(ie.RParen,a2);return i}case ie.Str:{const i=e.lexeme;this._advance();if(this._matchOne(ie.RegexOp)){const s=this._peek();if(!this._config.regexParsingWithErrorRecovery){this._advance();if(s.type!==ie.RegexStr){throw this._errExpectedButGot(`REGEX`,s)}const r=s.lexeme;const o=r.lastIndexOf("/");const a=o===r.length-1?void 0:this._removeFlagsGY(r.substring(o+1));let l;try{l=new RegExp(r.substring(1,o),a)}catch(c){throw this._errExpectedButGot(`REGEX`,s)}return Qd.create(i,l)}switch(s.type){case ie.RegexStr:case ie.Error:{const r=[s.lexeme];this._advance();let o=this._peek();let a=0;for(let f=0;f<s.lexeme.length;f++){if(s.lexeme.charCodeAt(f)===M.OpenParen){a++}else if(s.lexeme.charCodeAt(f)===M.CloseParen){a--}}while(!this._isAtEnd()&&o.type!==ie.And&&o.type!==ie.Or){switch(o.type){case ie.LParen:a++;break;case ie.RParen:a--;break;case ie.RegexStr:case ie.QuotedStr:for(let f=0;f<o.lexeme.length;f++){if(o.lexeme.charCodeAt(f)===M.OpenParen){a++}else if(s.lexeme.charCodeAt(f)===M.CloseParen){a--}}}if(a<0){break}r.push(_o.getLexeme(o));this._advance();o=this._peek()}const l=r.join("");const c=l.lastIndexOf("/");const u=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let d;try{d=new RegExp(l.substring(1,c),u)}catch(f){throw this._errExpectedButGot(`REGEX`,s)}return ni.regex(i,d)}case ie.QuotedStr:{const r=s.lexeme;this._advance();let o=null;if(!Oc(r)){const a=r.indexOf("/");const l=r.lastIndexOf("/");if(a!==l&&a>=0){const c=r.slice(a+1,l);const u=r[l+1]==="i"?"i":"";try{o=new RegExp(c,u)}catch(d){throw this._errExpectedButGot(`REGEX`,s)}}}if(o===null){throw this._errExpectedButGot("REGEX",s)}return Qd.create(i,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(ie.Not)){this._consume(ie.In,s6);const s=this._value();return ni.notIn(i,s)}const n=this._peek().type;switch(n){case ie.Eq:{this._advance();const s=this._value();if(this._previous().type===ie.QuotedStr){return ni.equals(i,s)}switch(s){case"true":return ni.has(i);case"false":return ni.not(i);default:return ni.equals(i,s)}}case ie.NotEq:{this._advance();const s=this._value();if(this._previous().type===ie.QuotedStr){return ni.notEquals(i,s)}switch(s){case"true":return ni.not(i);case"false":return ni.has(i);default:return ni.notEquals(i,s)}}case ie.Lt:this._advance();return pf.create(i,this._value());case ie.LtEq:this._advance();return gf.create(i,this._value());case ie.Gt:this._advance();return yu.create(i,this._value());case ie.GtEq:this._advance();return ff.create(i,this._value());case ie.In:this._advance();return ni.in(i,this._value());default:return ni.has(i)}}case ie.EOF:this._parsingErrors.push({message:a6,offset:e.offset,lexeme:"",additionalInfo:l6});throw ka._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case ie.Str:case ie.QuotedStr:this._advance();return e.lexeme;case ie.True:this._advance();return"true";case ie.False:this._advance();return"false";case ie.In:this._advance();return"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){if(this._check(e)){this._advance();return true}return false}_advance(){if(!this._isAtEnd()){this._current++}return this._previous()}_consume(e,i){if(this._check(e)){return this._advance()}throw this._errExpectedButGot(i,this._peek())}_errExpectedButGot(e,i,n){const s=h(1784,"Expected: {0}\nReceived: '{1}'.",e,_o.getLexeme(i));const r=i.offset;const o=_o.getLexeme(i);this._parsingErrors.push({message:s,offset:r,lexeme:o,additionalInfo:n});return ka._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===ie.EOF}}class ni{static false(){return Ki.INSTANCE}static true(){return sn.INSTANCE}static has(e){return xl.create(e)}static equals(e,i){return df.create(e,i)}static notEquals(e,i){return hf.create(e,i)}static regex(e,i){return Qd.create(e,i)}static in(e,i){return N_.create(e,i)}static notIn(e,i){return M_.create(e,i)}static not(e){return El.create(e)}static and(...e){return vo.create(e,null,true)}static or(...e){return Ks.create(e,null,true)}static greater(e,i){return yu.create(e,i)}static greaterEquals(e,i){return ff.create(e,i)}static smaller(e,i){return pf.create(e,i)}static smallerEquals(e,i){return gf.create(e,i)}static{this._parser=new ka({regexParsingWithErrorRecovery:false})}static deserialize(e){if(e===void 0||e===null){return void 0}const i=this._parser.parse(e);return i}}function c6(t){const e=new ka({regexParsingWithErrorRecovery:false});return t.map(i=>{e.parse(i);if(e.lexingErrors.length>0){return e.lexingErrors.map(n=>({errorMessage:n.additionalInfo?h(1785,"Unexpected token. Hint: {0}",n.additionalInfo):h(1786,"Unexpected token."),offset:n.offset,length:n.lexeme.length}))}else if(e.parsingErrors.length>0){return e.parsingErrors.map(n=>({errorMessage:n.additionalInfo?`${n.message}. ${n.additionalInfo}`:n.message,offset:n.offset,length:n.lexeme.length}))}else{return[]}})}function md(t,e){return t.cmp(e)}class Ki{static{this.INSTANCE=new Ki}constructor(){this.type=Vt.False}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return false}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return sn.INSTANCE}}class sn{static{this.INSTANCE=new sn}constructor(){this.type=Vt.True}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return true}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Ki.INSTANCE}}class xl{static create(e,i=null){const n=Ai.get(e);if(typeof n==="boolean"){return n?sn.INSTANCE:Ki.INSTANCE}return new xl(e,i)}constructor(e,i){this.key=e;this.negated=i;this.type=Vt.Defined}cmp(e){if(e.type!==this.type){return this.type-e.type}return lP(this.key,e.key)}equals(e){if(e.type===this.type){return this.key===e.key}return false}substituteConstants(){const e=Ai.get(this.key);if(typeof e==="boolean"){return e?sn.INSTANCE:Ki.INSTANCE}return this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){if(!this.negated){this.negated=El.create(this.key,this)}return this.negated}}class df{static create(e,i,n=null){if(typeof i==="boolean"){return i?xl.create(e,n):El.create(e,n)}const s=Ai.get(e);if(typeof s==="boolean"){const r=s?"true":"false";return i===r?sn.INSTANCE:Ki.INSTANCE}return new df(e,i,n)}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Vt.Equals}cmp(e){if(e.type!==this.type){return this.type-e.type}return Cl(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){const e=Ai.get(this.key);if(typeof e==="boolean"){const i=e?"true":"false";return this.value===i?sn.INSTANCE:Ki.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=hf.create(this.key,this.value,this)}return this.negated}}class N_{static create(e,i){return new N_(e,i)}constructor(e,i){this.key=e;this.valueKey=i;this.type=Vt.In;this.negated=null}cmp(e){if(e.type!==this.type){return this.type-e.type}return Cl(this.key,this.valueKey,e.key,e.valueKey)}equals(e){if(e.type===this.type){return this.key===e.key&&this.valueKey===e.valueKey}return false}substituteConstants(){return this}evaluate(e){const i=e.getValue(this.valueKey);const n=e.getValue(this.key);if(Array.isArray(i)){return i.includes(n)}if(typeof n==="string"&&typeof i==="object"&&i!==null){return e6.call(i,n)}return false}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){if(!this.negated){this.negated=M_.create(this.key,this.valueKey)}return this.negated}}class M_{static create(e,i){return new M_(e,i)}constructor(e,i){this.key=e;this.valueKey=i;this.type=Vt.NotIn;this._negated=N_.create(e,i)}cmp(e){if(e.type!==this.type){return this.type-e.type}return this._negated.cmp(e._negated)}equals(e){if(e.type===this.type){return this._negated.equals(e._negated)}return false}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}class hf{static create(e,i,n=null){if(typeof i==="boolean"){if(i){return El.create(e,n)}return xl.create(e,n)}const s=Ai.get(e);if(typeof s==="boolean"){const r=s?"true":"false";return i===r?Ki.INSTANCE:sn.INSTANCE}return new hf(e,i,n)}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Vt.NotEquals}cmp(e){if(e.type!==this.type){return this.type-e.type}return Cl(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){const e=Ai.get(this.key);if(typeof e==="boolean"){const i=e?"true":"false";return this.value===i?Ki.INSTANCE:sn.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=df.create(this.key,this.value,this)}return this.negated}}class El{static create(e,i=null){const n=Ai.get(e);if(typeof n==="boolean"){return n?Ki.INSTANCE:sn.INSTANCE}return new El(e,i)}constructor(e,i){this.key=e;this.negated=i;this.type=Vt.Not}cmp(e){if(e.type!==this.type){return this.type-e.type}return lP(this.key,e.key)}equals(e){if(e.type===this.type){return this.key===e.key}return false}substituteConstants(){const e=Ai.get(this.key);if(typeof e==="boolean"){return e?Ki.INSTANCE:sn.INSTANCE}return this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){if(!this.negated){this.negated=xl.create(this.key,this)}return this.negated}}function O_(t,e){if(typeof t==="string"){const i=parseFloat(t);if(!isNaN(i)){t=i}}if(typeof t==="string"||typeof t==="number"){return e(t)}return Ki.INSTANCE}class yu{static create(e,i,n=null){return O_(i,s=>new yu(e,s,n))}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Vt.Greater}cmp(e){if(e.type!==this.type){return this.type-e.type}return Cl(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){if(!this.negated){this.negated=gf.create(this.key,this.value,this)}return this.negated}}class ff{static create(e,i,n=null){return O_(i,s=>new ff(e,s,n))}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Vt.GreaterEquals}cmp(e){if(e.type!==this.type){return this.type-e.type}return Cl(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=pf.create(this.key,this.value,this)}return this.negated}}class pf{static create(e,i,n=null){return O_(i,s=>new pf(e,s,n))}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Vt.Smaller}cmp(e){if(e.type!==this.type){return this.type-e.type}return Cl(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){if(!this.negated){this.negated=ff.create(this.key,this.value,this)}return this.negated}}class gf{static create(e,i,n=null){return O_(i,s=>new gf(e,s,n))}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Vt.SmallerEquals}cmp(e){if(e.type!==this.type){return this.type-e.type}return Cl(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=yu.create(this.key,this.value,this)}return this.negated}}class Qd{static create(e,i){return new Qd(e,i)}constructor(e,i){this.key=e;this.regexp=i;this.type=Vt.Regex;this.negated=null}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.key<e.key){return-1}if(this.key>e.key){return 1}const i=this.regexp?this.regexp.source:"";const n=e.regexp?e.regexp.source:"";if(i<n){return-1}if(i>n){return 1}return 0}equals(e){if(e.type===this.type){const i=this.regexp?this.regexp.source:"";const n=e.regexp?e.regexp.source:"";return this.key===e.key&&i===n}return false}substituteConstants(){return this}evaluate(e){const i=e.getValue(this.key);return this.regexp?this.regexp.test(i):false}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){if(!this.negated){this.negated=Yp.create(this)}return this.negated}}class Yp{static create(e){return new Yp(e)}constructor(e){this._actual=e;this.type=Vt.NotRegex}cmp(e){if(e.type!==this.type){return this.type-e.type}return this._actual.cmp(e._actual)}equals(e){if(e.type===this.type){return this._actual.equals(e._actual)}return false}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new Yp(this._actual.map(e))}negate(){return this._actual}}function aP(t){let e=null;for(let i=0,n=t.length;i<n;i++){const s=t[i].substituteConstants();if(t[i]!==s){if(e===null){e=[];for(let r=0;r<i;r++){e[r]=t[r]}}}if(e!==null){e[i]=s}}if(e===null){return t}return e}class vo{static create(e,i,n){return vo._normalizeArr(e,i,n)}constructor(e,i){this.expr=e;this.negated=i;this.type=Vt.And}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.expr.length<e.expr.length){return-1}if(this.expr.length>e.expr.length){return 1}for(let i=0,n=this.expr.length;i<n;i++){const s=md(this.expr[i],e.expr[i]);if(s!==0){return s}}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length){return false}for(let i=0,n=this.expr.length;i<n;i++){if(!this.expr[i].equals(e.expr[i])){return false}}return true}return false}substituteConstants(){const e=aP(this.expr);if(e===this.expr){return this}return vo.create(e,this.negated,false)}evaluate(e){for(let i=0,n=this.expr.length;i<n;i++){if(!this.expr[i].evaluate(e)){return false}}return true}static _normalizeArr(e,i,n){const s=[];let r=false;for(const o of e){if(!o){continue}if(o.type===Vt.True){r=true;continue}if(o.type===Vt.False){return Ki.INSTANCE}if(o.type===Vt.And){s.push(...o.expr);continue}s.push(o)}if(s.length===0&&r){return sn.INSTANCE}if(s.length===0){return void 0}if(s.length===1){return s[0]}s.sort(md);for(let o=1;o<s.length;o++){if(s[o-1].equals(s[o])){s.splice(o,1);o--}}if(s.length===1){return s[0]}while(s.length>1){const o=s[s.length-1];if(o.type!==Vt.Or){break}s.pop();const a=s.pop();const l=s.length===0;const c=Ks.create(o.expr.map(u=>vo.create([u,a],null,n)),null,l);if(c){s.push(c);s.sort(md)}}if(s.length===1){return s[0]}if(n){for(let o=0;o<s.length;o++){for(let a=o+1;a<s.length;a++){if(s[o].negate().equals(s[a])){return Ki.INSTANCE}}}if(s.length===1){return s[0]}}return new vo(s,i)}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const i of this.expr){e.push(...i.keys())}return e}map(e){return new vo(this.expr.map(i=>i.map(e)),null)}negate(){if(!this.negated){const e=[];for(const i of this.expr){e.push(i.negate())}this.negated=Ks.create(e,this,true)}return this.negated}}class Ks{static create(e,i,n){return Ks._normalizeArr(e,i,n)}constructor(e,i){this.expr=e;this.negated=i;this.type=Vt.Or}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.expr.length<e.expr.length){return-1}if(this.expr.length>e.expr.length){return 1}for(let i=0,n=this.expr.length;i<n;i++){const s=md(this.expr[i],e.expr[i]);if(s!==0){return s}}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length){return false}for(let i=0,n=this.expr.length;i<n;i++){if(!this.expr[i].equals(e.expr[i])){return false}}return true}return false}substituteConstants(){const e=aP(this.expr);if(e===this.expr){return this}return Ks.create(e,this.negated,false)}evaluate(e){for(let i=0,n=this.expr.length;i<n;i++){if(this.expr[i].evaluate(e)){return true}}return false}static _normalizeArr(e,i,n){let s=[];let r=false;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(!l){continue}if(l.type===Vt.False){r=true;continue}if(l.type===Vt.True){return sn.INSTANCE}if(l.type===Vt.Or){s=s.concat(l.expr);continue}s.push(l)}if(s.length===0&&r){return Ki.INSTANCE}s.sort(md)}if(s.length===0){return void 0}if(s.length===1){return s[0]}for(let o=1;o<s.length;o++){if(s[o-1].equals(s[o])){s.splice(o,1);o--}}if(s.length===1){return s[0]}if(n){for(let o=0;o<s.length;o++){for(let a=o+1;a<s.length;a++){if(s[o].negate().equals(s[a])){return sn.INSTANCE}}}if(s.length===1){return s[0]}}return new Ks(s,i)}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const i of this.expr){e.push(...i.keys())}return e}map(e){return new Ks(this.expr.map(i=>i.map(e)),null)}negate(){if(!this.negated){const e=[];for(const i of this.expr){e.push(i.negate())}while(e.length>1){const i=e.shift();const n=e.shift();const s=[];for(const r of l2(i)){for(const o of l2(n)){s.push(vo.create([r,o],null,false))}}e.unshift(Ks.create(s,null,false))}this.negated=Ks.create(e,this,true)}return this.negated}}class E extends xl{static{this._info=[]}static all(){return E._info.values()}constructor(e,i,n){super(e,null);this._defaultValue=i;if(typeof n==="object"){E._info.push({...n,key:e})}else if(n!==true){E._info.push({key:e,description:n,type:i!==null&&i!==void 0?typeof i:void 0})}}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return df.create(this.key,e)}notEqualsTo(e){return hf.create(this.key,e)}greater(e){return yu.create(this.key,e)}}function lP(t,e){if(t<e){return-1}if(t>e){return 1}return 0}function Cl(t,e,i,n){if(t<i){return-1}if(t>i){return 1}if(e<n){return-1}if(e>n){return 1}return 0}function l2(t){if(t.type===Vt.Or){return t.expr}return[t]}var bs;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Disabled"]=1]="Disabled";t[t["Enabled"]=2]="Enabled"})(bs||(bs={}));new E("accessibilityModeEnabled",false);var wo;(function(t){t[t["None"]=0]="None";t[t["Keep"]=1]="Keep";t[t["Brackets"]=2]="Brackets";t[t["Advanced"]=3]="Advanced";t[t["Full"]=4]="Full"})(wo||(wo={}));const u6=8;class d6{constructor(){this.stableMinimapLayoutInput=null;this.stableFitMaxMinimapScale=0;this.stableFitRemainingWidth=0}}class Et{constructor(e,i,n,s){this.id=e;this.name=i;this.defaultValue=n;this.schema=s}applyUpdate(e,i){return F_(e,i)}compute(e,i,n){return n}}class rp{constructor(e,i){this.newValue=e;this.didChange=i}}function F_(t,e){if(typeof t!=="object"||typeof e!=="object"||!t||!e){return new rp(e,t!==e)}if(Array.isArray(t)||Array.isArray(e)){const n=Array.isArray(t)&&Array.isArray(e)&&mn(t,e);return new rp(e,!n)}let i=false;for(const n in e){if(e.hasOwnProperty(n)){const s=F_(t[n],e[n]);if(s.didChange){t[n]=s.newValue;i=true}}}return new rp(t,i)}class Jo{constructor(e,i){this.schema=void 0;this.id=e;this.name="_never_";this.defaultValue=i}applyUpdate(e,i){return F_(e,i)}validate(e){return this.defaultValue}}class Su{constructor(e,i,n,s){this.id=e;this.name=i;this.defaultValue=n;this.schema=s}applyUpdate(e,i){return F_(e,i)}compute(e,i,n){return n}}function ue(t,e){if(typeof t==="undefined"){return e}if(t==="false"){return false}return Boolean(t)}class Ce extends Su{constructor(e,i,n,s=void 0){if(typeof s!=="undefined"){s.type="boolean";s.default=n}super(e,i,n,s)}validate(e){return ue(e,this.defaultValue)}}function h6(t,e,i,n){if(typeof t==="string"){t=parseInt(t,10)}if(typeof t!=="number"||isNaN(t)){return e}let s=t;s=Math.max(i,s);s=Math.min(n,s);return s|0}class Je extends Su{static clampedInt(e,i,n,s){return h6(e,i,n,s)}constructor(e,i,n,s,r,o=void 0){if(typeof o!=="undefined"){o.type="integer";o.default=n;o.minimum=s;o.maximum=r}super(e,i,n,o);this.minimum=s;this.maximum=r}validate(e){return Je.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class In extends Su{static clamp(e,i,n){if(e<i){return i}if(e>n){return n}return e}static float(e,i){if(typeof e==="string"){e=parseFloat(e)}if(typeof e!=="number"||isNaN(e)){return i}return e}constructor(e,i,n,s,r,o,a){if(typeof r!=="undefined"){r.type="number";r.default=n;r.minimum=o;r.maximum=a}super(e,i,n,r);this.validationFn=s;this.minimum=o;this.maximum=a}validate(e){return this.validationFn(In.float(e,this.defaultValue))}}class Fi extends Su{static string(e,i){if(typeof e!=="string"){return i}return e}constructor(e,i,n,s=void 0){if(typeof s!=="undefined"){s.type="string";s.default=n}super(e,i,n,s)}validate(e){return Fi.string(e,this.defaultValue)}}function vt(t,e,i,n){if(typeof t!=="string"){return e}if(i.indexOf(t)===-1){return e}return t}class yt extends Su{constructor(e,i,n,s,r=void 0){if(typeof r!=="undefined"){r.type="string";r.enum=s.slice(0);r.default=n}super(e,i,n,r);this._allowedValues=s}validate(e){return vt(e,this.defaultValue,this._allowedValues)}}class $u extends Et{constructor(e,i,n,s,r,o,a=void 0){if(typeof a!=="undefined"){a.type="string";a.enum=r;a.default=s}super(e,i,n,a);this._allowedValues=r;this._convert=o}validate(e){if(typeof e!=="string"){return this.defaultValue}if(this._allowedValues.indexOf(e)===-1){return this.defaultValue}return this._convert(e)}}function f6(t){switch(t){case"none":return wo.None;case"keep":return wo.Keep;case"brackets":return wo.Brackets;case"advanced":return wo.Advanced;case"full":return wo.Full}}class p6 extends Et{constructor(){super(N.accessibilitySupport,"accessibilitySupport",bs.Unknown,{type:"string",enum:["auto","on","off"],enumDescriptions:[h(270,"Use platform APIs to detect when a Screen Reader is attached."),h(271,"Optimize for usage with a Screen Reader."),h(272,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h(273,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return bs.Unknown;case"off":return bs.Disabled;case"on":return bs.Enabled}return this.defaultValue}compute(e,i,n){if(n===bs.Unknown){return e.accessibilitySupport}return n}}class g6 extends Et{constructor(){const e={insertSpace:true,ignoreEmptyLines:true};super(N.comments,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h(274,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h(275,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{insertSpace:ue(i.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ue(i.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}var bo;(function(t){t[t["Hidden"]=0]="Hidden";t[t["Blink"]=1]="Blink";t[t["Smooth"]=2]="Smooth";t[t["Phase"]=3]="Phase";t[t["Expand"]=4]="Expand";t[t["Solid"]=5]="Solid"})(bo||(bo={}));function m6(t){switch(t){case"blink":return bo.Blink;case"smooth":return bo.Smooth;case"phase":return bo.Phase;case"expand":return bo.Expand;case"solid":return bo.Solid}}var Qn;(function(t){t[t["Line"]=1]="Line";t[t["Block"]=2]="Block";t[t["Underline"]=3]="Underline";t[t["LineThin"]=4]="LineThin";t[t["BlockOutline"]=5]="BlockOutline";t[t["UnderlineThin"]=6]="UnderlineThin"})(Qn||(Qn={}));function c2(t){switch(t){case"line":return Qn.Line;case"block":return Qn.Block;case"underline":return Qn.Underline;case"line-thin":return Qn.LineThin;case"block-outline":return Qn.BlockOutline;case"underline-thin":return Qn.UnderlineThin}}class _6 extends Jo{constructor(){super(N.editorClassName,"")}compute(e,i,n){const s=["monaco-editor"];if(i.get(N.extraEditorClassName)){s.push(i.get(N.extraEditorClassName))}if(e.extraEditorClassName){s.push(e.extraEditorClassName)}if(i.get(N.mouseStyle)==="default"){s.push("mouse-default")}else if(i.get(N.mouseStyle)==="copy"){s.push("mouse-copy")}if(i.get(N.showUnused)){s.push("showUnused")}if(i.get(N.showDeprecated)){s.push("showDeprecated")}return s.join(" ")}}class v6 extends Ce{constructor(){super(N.emptySelectionClipboard,"emptySelectionClipboard",true,{description:h(276,"Controls whether copying without a selection copies the current line.")})}compute(e,i,n){return n&&e.emptySelectionClipboard}}class w6 extends Et{constructor(){const e={cursorMoveOnType:true,findOnType:true,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:false,addExtraSpaceOnTop:true,loop:true,history:"workspace",replaceHistory:"workspace"};super(N.find,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h(277,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h(278,"Never seed search string from the editor selection."),h(279,"Always seed search string from the editor selection, including word at cursor position."),h(280,"Only seed search string from the editor selection.")],description:h(281,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h(282,"Never turn on Find in Selection automatically (default)."),h(283,"Always turn on Find in Selection automatically."),h(284,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h(285,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h(286,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:vn},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h(287,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:h(288,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[h(289,"Do not store search history from the find widget."),h(290,"Store search history across the active workspace")],description:h(291,"Controls how the find widget history should be stored")},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[h(292,"Do not store history from the replace widget."),h(293,"Store replace history across the active workspace")],description:h(294,"Controls how the replace widget history should be stored")},"editor.find.findOnType":{type:"boolean",default:e.findOnType,description:h(295,"Controls whether the Find Widget should search as you type.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{cursorMoveOnType:ue(i.cursorMoveOnType,this.defaultValue.cursorMoveOnType),findOnType:ue(i.findOnType,this.defaultValue.findOnType),seedSearchStringFromSelection:typeof i.seedSearchStringFromSelection==="boolean"?i.seedSearchStringFromSelection?"always":"never":vt(i.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof i.autoFindInSelection==="boolean"?i.autoFindInSelection?"always":"never":vt(i.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ue(i.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ue(i.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ue(i.loop,this.defaultValue.loop),history:vt(i.history,this.defaultValue.history,["never","workspace"]),replaceHistory:vt(i.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}}class ga extends Et{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(N.fontLigatures,"fontLigatures",ga.OFF,{anyOf:[{type:"boolean",description:h(296,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h(297,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h(298,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:false})}validate(e){if(typeof e==="undefined"){return this.defaultValue}if(typeof e==="string"){if(e==="false"||e.length===0){return ga.OFF}if(e==="true"){return ga.ON}return e}if(Boolean(e)){return ga.ON}return ga.OFF}}class ma extends Et{static{this.OFF=tP}static{this.TRANSLATE=iP}constructor(){super(N.fontVariations,"fontVariations",ma.OFF,{anyOf:[{type:"boolean",description:h(299,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h(300,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h(301,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:false})}validate(e){if(typeof e==="undefined"){return this.defaultValue}if(typeof e==="string"){if(e==="false"){return ma.OFF}if(e==="true"){return ma.TRANSLATE}return e}if(Boolean(e)){return ma.TRANSLATE}return ma.OFF}compute(e,i,n){return e.fontInfo.fontVariationSettings}}class b6 extends Jo{constructor(){super(N.fontInfo,new q7({pixelRatio:0,fontFamily:"",fontWeight:"",fontSize:0,fontFeatureSettings:"",fontVariationSettings:"",lineHeight:0,letterSpacing:0,isMonospace:false,typicalHalfwidthCharacterWidth:0,typicalFullwidthCharacterWidth:0,canUseHalfwidthRightwardsArrow:false,spaceWidth:0,middotWidth:0,wsmiddotWidth:0,maxDigitWidth:0},false))}compute(e,i,n){return e.fontInfo}}class y6 extends Jo{constructor(){super(N.effectiveCursorStyle,Qn.Line)}compute(e,i,n){return e.inputMode==="overtype"?i.get(N.overtypeCursorStyle):i.get(N.cursorStyle)}}class S6 extends Jo{constructor(){super(N.effectiveEditContext,false)}compute(e,i){return e.editContextSupported&&i.get(N.editContext)}}class x6 extends Jo{constructor(){super(N.effectiveAllowVariableFonts,false)}compute(e,i){const n=e.accessibilitySupport;if(n===bs.Enabled){return i.get(N.allowVariableFontsInAccessibilityMode)}else{return i.get(N.allowVariableFonts)}}}class E6 extends Su{constructor(){super(N.fontSize,"fontSize",nr.fontSize,{type:"number",minimum:6,maximum:100,default:nr.fontSize,description:h(302,"Controls the font size in pixels.")})}validate(e){const i=In.float(e,this.defaultValue);if(i===0){return nr.fontSize}return In.clamp(i,6,100)}compute(e,i,n){return e.fontInfo.fontSize}}class _a extends Et{static{this.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.MINIMUM_VALUE=1}static{this.MAXIMUM_VALUE=1e3}constructor(){super(N.fontWeight,"fontWeight",nr.fontWeight,{anyOf:[{type:"number",minimum:_a.MINIMUM_VALUE,maximum:_a.MAXIMUM_VALUE,errorMessage:h(303,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:_a.SUGGESTION_VALUES}],default:nr.fontWeight,description:h(304,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){if(e==="normal"||e==="bold"){return e}return String(Je.clampedInt(e,nr.fontWeight,_a.MINIMUM_VALUE,_a.MAXIMUM_VALUE))}}class C6 extends Et{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""};const i={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h(305,"Show Peek view of the results (default)"),h(306,"Go to the primary result and show a Peek view"),h(307,"Go to the primary result and enable Peek-less navigation to others")]};const n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(N.gotoLocation,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h(308,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h(309,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleTypeDefinitions":{description:h(310,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleDeclarations":{description:h(311,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleImplementations":{description:h(312,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleReferences":{description:h(313,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...i},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:h(314,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:h(315,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:h(316,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:h(317,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:h(318,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{multiple:vt(i.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:vt(i.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:vt(i.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:vt(i.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:vt(i.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:vt(i.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:vt(i.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Fi.string(i.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Fi.string(i.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Fi.string(i.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Fi.string(i.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Fi.string(i.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Fi.string(i.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class k6 extends Et{constructor(){const e={enabled:"on",delay:300,hidingDelay:300,sticky:true,above:true};super(N.hover,"hover",e,{"editor.hover.enabled":{type:"string",enum:["on","off","onKeyboardModifier"],default:e.enabled,markdownEnumDescriptions:[h(319,"Hover is enabled."),h(320,"Hover is disabled."),h(321,"Hover is shown when holding `{0}` or `Alt` (the opposite modifier of `#editor.multiCursorModifier#`)",vn?`Command`:`Control`)],description:h(322,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h(323,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h(324,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,markdownDescription:h(325,"Controls the delay in milliseconds after which the hover is hidden. Requires `#editor.hover.sticky#` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:h(326,"Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:vt(i.enabled,this.defaultValue.enabled,["on","off","onKeyboardModifier"]),delay:Je.clampedInt(i.delay,this.defaultValue.delay,0,1e4),sticky:ue(i.sticky,this.defaultValue.sticky),hidingDelay:Je.clampedInt(i.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ue(i.above,this.defaultValue.above)}}}var va;(function(t){t[t["None"]=0]="None";t[t["Text"]=1]="Text";t[t["Blocks"]=2]="Blocks"})(va||(va={}));class _d extends Jo{constructor(){super(N.layoutInfo,{width:0,height:0,glyphMarginLeft:0,glyphMarginWidth:0,glyphMarginDecorationLaneCount:0,lineNumbersLeft:0,lineNumbersWidth:0,decorationsLeft:0,decorationsWidth:0,contentLeft:0,contentWidth:0,minimap:{renderMinimap:va.None,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:false,minimapIsSampling:false,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:0,minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:0},viewportColumn:0,isWordWrapMinified:false,isViewportWrapping:false,wrappingColumn:-1,verticalScrollbarWidth:0,horizontalScrollbarHeight:0,overviewRuler:{top:0,width:0,height:0,right:0}})}compute(e,i,n){return _d.computeLayout(i,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const i=e.height/e.lineHeight;const n=Math.floor(e.paddingTop/e.lineHeight);let s=Math.floor(e.paddingBottom/e.lineHeight);if(e.scrollBeyondLastLine){s=Math.max(s,i-1)}const r=(n+e.viewLineCount+s)/(e.pixelRatio*e.height);const o=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:i,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:s,desiredRatio:r,minimapLineCount:o}}static _computeMinimapLayout(e,i){const n=e.outerWidth;const s=e.outerHeight;const r=e.pixelRatio;if(!e.minimap.enabled){return{renderMinimap:va.None,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:false,minimapIsSampling:false,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*s),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:s}}const o=i.stableMinimapLayoutInput;const a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping;const l=e.lineHeight;const c=e.typicalHalfwidthCharacterWidth;const u=e.scrollBeyondLastLine;const d=e.minimap.renderCharacters;let f=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const p=e.minimap.maxColumn;const m=e.minimap.size;const v=e.minimap.side;const y=e.verticalScrollbarWidth;const k=e.viewLineCount;const S=e.remainingWidth;const R=e.isViewportWrapping;const K=d?2:3;let q=Math.floor(r*s);const se=q/r;let j=false;let Q=false;let le=K*f;let Re=f/r;let Ne=1;if(m==="fill"||m==="fit"){const{typicalViewportLineCount:Le,extraLinesBeforeFirstLine:qe,extraLinesBeyondLastLine:ze,desiredRatio:ct,minimapLineCount:Lt}=_d.computeContainedMinimapLineCount({viewLineCount:k,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:s,lineHeight:l,pixelRatio:r});const Ke=k/Lt;if(Ke>1){j=true;Q=true;f=1;le=1;Re=f/r}else{let Ht=false;let bi=f+1;if(m==="fit"){const ti=Math.ceil((qe+k+ze)*le);if(R&&a&&S<=i.stableFitRemainingWidth){Ht=true;bi=i.stableFitMaxMinimapScale}else{Ht=ti>q}}if(m==="fill"||Ht){j=true;const ti=f;le=Math.min(l*r,Math.max(1,Math.floor(1/ct)));if(R&&a&&S<=i.stableFitRemainingWidth){bi=i.stableFitMaxMinimapScale}f=Math.min(bi,Math.max(1,Math.floor(le/K)));if(f>ti){Ne=Math.min(2,f/ti)}Re=f/r/Ne;q=Math.ceil(Math.max(Le,qe+k+ze)*le);if(R){i.stableMinimapLayoutInput=e;i.stableFitRemainingWidth=S;i.stableFitMaxMinimapScale=f}else{i.stableMinimapLayoutInput=null;i.stableFitRemainingWidth=0}}}}const He=Math.floor(p*Re);const Z=Math.min(He,Math.max(0,Math.floor((S-y-2)*Re/(c+Re)))+u6);let Y=Math.floor(r*Z);const J=Y/r;Y=Math.floor(Y*Ne);const re=d?va.Text:va.Blocks;const ce=v==="left"?0:n-Z-y;return{renderMinimap:re,minimapLeft:ce,minimapWidth:Z,minimapHeightIsEditorHeight:j,minimapIsSampling:Q,minimapScale:f,minimapLineHeight:le,minimapCanvasInnerWidth:Y,minimapCanvasInnerHeight:q,minimapCanvasOuterWidth:J,minimapCanvasOuterHeight:se}}static computeLayout(e,i){const n=i.outerWidth|0;const s=i.outerHeight|0;const r=i.lineHeight|0;const o=i.lineNumbersDigitCount|0;const a=i.typicalHalfwidthCharacterWidth;const l=i.maxDigitWidth;const c=i.pixelRatio;const u=i.viewLineCount;const d=e.get(N.wordWrapOverride2);const f=d==="inherit"?e.get(N.wordWrapOverride1):d;const p=f==="inherit"?e.get(N.wordWrap):f;const m=e.get(N.wordWrapColumn);const v=i.isDominatedByLongLines;const y=e.get(N.glyphMargin);const k=e.get(N.lineNumbers).renderType!==zi.Off;const S=e.get(N.lineNumbersMinChars);const R=e.get(N.scrollBeyondLastLine);const K=e.get(N.padding);const q=e.get(N.minimap);const se=e.get(N.scrollbar);const j=se.verticalScrollbarSize;const Q=se.verticalHasArrows;const le=se.arrowSize;const Re=se.horizontalScrollbarSize;const Ne=e.get(N.folding);const He=e.get(N.showFoldingControls)!=="never";let Z=e.get(N.lineDecorationsWidth);if(Ne&&He){Z+=16}let Y=0;if(k){const is=Math.max(o,S);Y=Math.round(is*l)}let J=0;if(y){J=r*i.glyphMarginDecorationLaneCount}let re=0;let ce=re+J;let Le=ce+Y;let qe=Le+Z;const ze=n-J-Y-Z;let ct=false;let Lt=false;let Ke=-1;if(e.get(N.accessibilitySupport)===bs.Enabled&&f==="inherit"&&v){ct=true;Lt=true}else if(p==="on"||p==="bounded"){Lt=true}else if(p==="wordWrapColumn"){Ke=m}const Ht=_d._computeMinimapLayout({outerWidth:n,outerHeight:s,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:R,paddingTop:K.top,paddingBottom:K.bottom,minimap:q,verticalScrollbarWidth:j,viewLineCount:u,remainingWidth:ze,isViewportWrapping:Lt},i.memory||new d6);if(Ht.renderMinimap!==va.None&&Ht.minimapLeft===0){re+=Ht.minimapWidth;ce+=Ht.minimapWidth;Le+=Ht.minimapWidth;qe+=Ht.minimapWidth}const bi=ze-Ht.minimapWidth;const ti=Math.max(1,Math.floor((bi-j-2)/a));const Us=Q?le:0;if(Lt){Ke=Math.max(1,ti);if(p==="bounded"){Ke=Math.min(Ke,m)}}return{width:n,height:s,glyphMarginLeft:re,glyphMarginWidth:J,glyphMarginDecorationLaneCount:i.glyphMarginDecorationLaneCount,lineNumbersLeft:ce,lineNumbersWidth:Y,decorationsLeft:Le,decorationsWidth:Z,contentLeft:qe,contentWidth:bi,minimap:Ht,viewportColumn:ti,isWordWrapMinified:ct,isViewportWrapping:Lt,wrappingColumn:Ke,verticalScrollbarWidth:j,horizontalScrollbarHeight:Re,overviewRuler:{top:Us,width:j,height:s-2*Us,right:0}}}}class D6 extends Et{constructor(){super(N.wrappingStrategy,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h(327,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h(328,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h(329,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return vt(e,"simple",["simple","advanced"])}compute(e,i,n){const s=i.get(N.accessibilitySupport);if(s===bs.Enabled){return"advanced"}return n}}var br;(function(t){t["Off"]="off";t["OnCode"]="onCode";t["On"]="on"})(br||(br={}));class I6 extends Et{constructor(){const e={enabled:br.OnCode};super(N.lightbulb,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[br.Off,br.OnCode,br.On],default:e.enabled,enumDescriptions:[h(330,"Disable the code action menu."),h(331,"Show the code action menu when the cursor is on lines with code."),h(332,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h(333,"Enables the Code Action lightbulb in the editor.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:vt(i.enabled,this.defaultValue.enabled,[br.Off,br.OnCode,br.On])}}}class T6 extends Et{constructor(){const e={enabled:true,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:true};super(N.stickyScroll,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h(334,"Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h(335,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h(336,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h(337,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ue(i.enabled,this.defaultValue.enabled),maxLineCount:Je.clampedInt(i.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:vt(i.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ue(i.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class P6 extends Et{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:false,maximumLength:43};super(N.inlayHints,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h(338,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h(339,"Inlay hints are enabled"),h(340,"Inlay hints are showing by default and hide when holding {0}",vn?`Ctrl+Option`:`Ctrl+Alt`),h(341,"Inlay hints are hidden by default and show when holding {0}",vn?`Ctrl+Option`:`Ctrl+Alt`),h(342,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h(343,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h(344,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h(345,"Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:h(346,"Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;if(typeof i.enabled==="boolean"){i.enabled=i.enabled?"on":"off"}return{enabled:vt(i.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Je.clampedInt(i.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Fi.string(i.fontFamily,this.defaultValue.fontFamily),padding:ue(i.padding,this.defaultValue.padding),maximumLength:Je.clampedInt(i.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}}class A6 extends Et{constructor(){super(N.lineDecorationsWidth,"lineDecorationsWidth",10)}validate(e){if(typeof e==="string"&&/^\d+(\.\d+)?ch$/.test(e)){const i=parseFloat(e.substring(0,e.length-2));return-i}else{return Je.clampedInt(e,this.defaultValue,0,1e3)}}compute(e,i,n){if(n<0){return Je.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3)}else{return n}}}class R6 extends In{constructor(){super(N.lineHeight,"lineHeight",nr.lineHeight,e=>In.clamp(e,0,150),{markdownDescription:h(347,"Controls the line height. \n - Use 0 to automatically compute the line height from the font size.\n - Values between 0 and 8 will be used as a multiplier with the font size.\n - Values greater than or equal to 8 will be used as effective values.")},0,150)}compute(e,i,n){return e.fontInfo.lineHeight}}class L6 extends Et{constructor(){const e={enabled:true,size:"proportional",side:"right",showSlider:"mouseover",autohide:"none",renderCharacters:true,maxColumn:120,scale:1,showRegionSectionHeaders:true,showMarkSectionHeaders:true,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(N.minimap,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h(348,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"string",enum:["none","mouseover","scroll"],enumDescriptions:[h(349,"The minimap is always shown."),h(350,"The minimap is hidden when mouse is not over the minimap and shown when mouse is over the minimap."),h(351,"The minimap is only shown when the editor is scrolled")],default:e.autohide,description:h(352,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h(353,"The minimap has the same size as the editor contents (and might scroll)."),h(354,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h(355,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:h(356,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h(357,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h(358,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h(359,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h(360,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h(361,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h(362,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h(363,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:h(364,"Defines the regular expression used to find section headers in comments. The regex must contain a named match group `label` (written as `(?<label>.+)`) that encapsulates the section header, otherwise it will not work. Optionally you can include another match group named `separator`. Use \\n in the pattern to match multi-line headers.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h(365,"Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:h(366,"Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;let n=this.defaultValue.markSectionHeaderRegex;const s=i.markSectionHeaderRegex;if(typeof s==="string"){try{new RegExp(s,"d");n=s}catch{}}return{enabled:ue(i.enabled,this.defaultValue.enabled),autohide:vt(i.autohide,this.defaultValue.autohide,["none","mouseover","scroll"]),size:vt(i.size,this.defaultValue.size,["proportional","fill","fit"]),side:vt(i.side,this.defaultValue.side,["right","left"]),showSlider:vt(i.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ue(i.renderCharacters,this.defaultValue.renderCharacters),scale:Je.clampedInt(i.scale,1,1,3),maxColumn:Je.clampedInt(i.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:ue(i.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:ue(i.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:n,sectionHeaderFontSize:In.clamp(In.float(i.sectionHeaderFontSize,this.defaultValue.sectionHeaderFontSize),4,32),sectionHeaderLetterSpacing:In.clamp(In.float(i.sectionHeaderLetterSpacing,this.defaultValue.sectionHeaderLetterSpacing),0,5)}}}function N6(t){if(t==="ctrlCmd"){return vn?"metaKey":"ctrlKey"}return"altKey"}class M6 extends Et{constructor(){super(N.padding,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h(367,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h(368,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{top:Je.clampedInt(i.top,0,0,1e3),bottom:Je.clampedInt(i.bottom,0,0,1e3)}}}class O6 extends Et{constructor(){const e={enabled:true,cycle:true};super(N.parameterHints,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h(369,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h(370,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ue(i.enabled,this.defaultValue.enabled),cycle:ue(i.cycle,this.defaultValue.cycle)}}}class F6 extends Jo{constructor(){super(N.pixelRatio,1)}compute(e,i,n){return e.pixelRatio}}class U6 extends Et{constructor(){super(N.placeholder,"placeholder",void 0)}validate(e){if(typeof e==="undefined"){return this.defaultValue}if(typeof e==="string"){return e}return this.defaultValue}}class $6 extends Et{constructor(){const e={other:"on",comments:"off",strings:"off"};const i=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h(371,"Quick suggestions show inside the suggest widget"),h(372,"Quick suggestions show as ghost text"),h(373,"Quick suggestions are disabled")]}];super(N.quickSuggestions,"quickSuggestions",e,{type:"object",additionalProperties:false,properties:{strings:{anyOf:i,default:e.strings,description:h(374,"Enable quick suggestions inside strings.")},comments:{anyOf:i,default:e.comments,description:h(375,"Enable quick suggestions inside comments.")},other:{anyOf:i,default:e.other,description:h(376,"Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:h(377,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")});this.defaultValue=e}validate(e){if(typeof e==="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!=="object"){return this.defaultValue}const{other:i,comments:n,strings:s}=e;const r=["on","inline","off"];let o;let a;let l;if(typeof i==="boolean"){o=i?"on":"off"}else{o=vt(i,this.defaultValue.other,r)}if(typeof n==="boolean"){a=n?"on":"off"}else{a=vt(n,this.defaultValue.comments,r)}if(typeof s==="boolean"){l=s?"on":"off"}else{l=vt(s,this.defaultValue.strings,r)}return{other:o,comments:a,strings:l}}}var zi;(function(t){t[t["Off"]=0]="Off";t[t["On"]=1]="On";t[t["Relative"]=2]="Relative";t[t["Interval"]=3]="Interval";t[t["Custom"]=4]="Custom"})(zi||(zi={}));class H6 extends Et{constructor(){super(N.lineNumbers,"lineNumbers",{renderType:zi.On,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h(378,"Line numbers are not rendered."),h(379,"Line numbers are rendered as absolute number."),h(380,"Line numbers are rendered as distance in lines to cursor position."),h(381,"Line numbers are rendered every 10 lines.")],default:"on",description:h(382,"Controls the display of line numbers.")})}validate(e){let i=this.defaultValue.renderType;let n=this.defaultValue.renderFn;if(typeof e!=="undefined"){if(typeof e==="function"){i=zi.Custom;n=e}else if(e==="interval"){i=zi.Interval}else if(e==="relative"){i=zi.Relative}else if(e==="on"){i=zi.On}else{i=zi.Off}}return{renderType:i,renderFn:n}}}class B6 extends Et{constructor(){const e=[];const i={type:"number",description:h(383,"Number of monospace characters at which this editor ruler will render.")};super(N.rulers,"rulers",e,{type:"array",items:{anyOf:[i,{type:["object"],properties:{column:i,color:{type:"string",description:h(384,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:h(385,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const i=[];for(const n of e){if(typeof n==="number"){i.push({column:Je.clampedInt(n,0,0,1e4),color:null})}else if(n&&typeof n==="object"){const s=n;i.push({column:Je.clampedInt(s.column,0,0,1e4),color:s.color})}}i.sort((n,s)=>n.column-s.column);return i}return this.defaultValue}}class W6 extends Et{constructor(){const e=void 0;super(N.readOnlyMessage,"readOnlyMessage",e)}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}return e}}function u2(t,e){if(typeof t!=="string"){return e}switch(t){case"hidden":return za.Hidden;case"visible":return za.Visible;default:return za.Auto}}class V6 extends Et{constructor(){const e={vertical:za.Auto,horizontal:za.Auto,arrowSize:11,useShadows:true,verticalHasArrows:false,horizontalHasArrows:false,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:true,alwaysConsumeMouseWheel:true,scrollByPage:false,ignoreHorizontalScrollbarInContentHeight:false};super(N.scrollbar,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(386,"The vertical scrollbar will be visible only when necessary."),h(387,"The vertical scrollbar will always be visible."),h(388,"The vertical scrollbar will always be hidden.")],default:"auto",description:h(389,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(390,"The horizontal scrollbar will be visible only when necessary."),h(391,"The horizontal scrollbar will always be visible."),h(392,"The horizontal scrollbar will always be hidden.")],default:"auto",description:h(393,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h(394,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h(395,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h(396,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h(397,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;const n=Je.clampedInt(i.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3);const s=Je.clampedInt(i.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Je.clampedInt(i.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:u2(i.vertical,this.defaultValue.vertical),horizontal:u2(i.horizontal,this.defaultValue.horizontal),useShadows:ue(i.useShadows,this.defaultValue.useShadows),verticalHasArrows:ue(i.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ue(i.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ue(i.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ue(i.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:Je.clampedInt(i.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:s,verticalSliderSize:Je.clampedInt(i.verticalSliderSize,s,0,1e3),scrollByPage:ue(i.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:ue(i.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}}const ns="inUntrustedWorkspace";const ra={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class z6 extends Et{constructor(){const e={nonBasicASCII:ns,invisibleCharacters:true,ambiguousCharacters:true,includeComments:ns,includeStrings:true,allowedCharacters:{},allowedLocales:{_os:true,_vscode:true}};super(N.unicodeHighlighting,"unicodeHighlight",e,{[ra.nonBasicASCII]:{restricted:true,type:["boolean","string"],enum:[true,false,ns],default:e.nonBasicASCII,description:h(398,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[ra.invisibleCharacters]:{restricted:true,type:"boolean",default:e.invisibleCharacters,description:h(399,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[ra.ambiguousCharacters]:{restricted:true,type:"boolean",default:e.ambiguousCharacters,description:h(400,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[ra.includeComments]:{restricted:true,type:["boolean","string"],enum:[true,false,ns],default:e.includeComments,description:h(401,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[ra.includeStrings]:{restricted:true,type:["boolean","string"],enum:[true,false,ns],default:e.includeStrings,description:h(402,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[ra.allowedCharacters]:{restricted:true,type:"object",default:e.allowedCharacters,description:h(403,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[ra.allowedLocales]:{restricted:true,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h(404,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,i){let n=false;if(i.allowedCharacters&&e){if(!Gi(e.allowedCharacters,i.allowedCharacters)){e={...e,allowedCharacters:i.allowedCharacters};n=true}}if(i.allowedLocales&&e){if(!Gi(e.allowedLocales,i.allowedLocales)){e={...e,allowedLocales:i.allowedLocales};n=true}}const s=super.applyUpdate(e,i);if(n){return new rp(s.newValue,true)}return s}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{nonBasicASCII:cc(i.nonBasicASCII,ns,[true,false,ns]),invisibleCharacters:ue(i.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ue(i.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:cc(i.includeComments,ns,[true,false,ns]),includeStrings:cc(i.includeStrings,ns,[true,false,ns]),allowedCharacters:this.validateBooleanMap(i.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(i.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,i){if(typeof e!=="object"||!e){return i}const n={};for(const[s,r]of Object.entries(e)){if(r===true){n[s]=true}}return n}}class q6 extends Et{constructor(){const e={enabled:true,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:false,keepOnBlur:false,fontFamily:"default",syntaxHighlightingEnabled:true,minShowDelay:0,suppressInSnippetMode:true,edits:{enabled:true,showCollapsed:false,renderSideBySide:"auto",allowCodeShifting:"always",showLongDistanceHint:true},triggerCommandOnProviderChange:false,experimental:{suppressInlineSuggestions:"",showOnSuggestConflict:"never",emptyResponseInformation:true}};super(N.inlineSuggest,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h(405,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h(406,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),h(407,"Show the inline suggestion toolbar when hovering over an inline suggestion."),h(408,"Never show the inline suggestion toolbar.")],description:h(409,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:h(410,"Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h(411,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.suppressInSnippetMode":{type:"boolean",default:e.suppressInSnippetMode,description:h(412,"Controls whether inline suggestions are suppressed when in snippet mode.")},"editor.inlineSuggest.minShowDelay":{type:"number",default:0,minimum:0,maximum:1e4,description:h(413,"Controls the minimal delay in milliseconds after which inline suggestions are shown after typing.")},"editor.inlineSuggest.experimental.suppressInlineSuggestions":{type:"string",default:e.experimental.suppressInlineSuggestions,tags:["experimental"],description:h(414,"Suppresses inline completions for specified extension IDs -- comma separated."),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.emptyResponseInformation":{type:"boolean",default:e.experimental.emptyResponseInformation,tags:["experimental"],description:h(415,"Controls whether to send request information from the inline suggestion provider."),experiment:{mode:"auto"}},"editor.inlineSuggest.triggerCommandOnProviderChange":{type:"boolean",default:e.triggerCommandOnProviderChange,tags:["experimental"],description:h(416,"Controls whether to trigger a command when the inline suggestion provider changes."),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.showOnSuggestConflict":{type:"string",default:e.experimental.showOnSuggestConflict,tags:["experimental"],enum:["always","never","whenSuggestListIsIncomplete"],description:h(417,"Controls whether to show inline suggestions when there is a suggest conflict."),experiment:{mode:"auto"}},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h(418,"Controls the font family of the inline suggestions.")},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:h(419,"Controls whether showing a suggestion will shift the code to make space for the suggestion inline."),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showLongDistanceHint":{type:"boolean",default:e.edits.showLongDistanceHint,description:h(420,"Controls whether long distance inline suggestions are shown."),tags:["nextEditSuggestions","experimental"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:h(421,"Controls whether larger suggestions can be shown side by side."),enum:["auto","never"],enumDescriptions:[h(422,"Larger suggestions will show side by side if there is enough space, otherwise they will be shown below."),h(423,"Larger suggestions are never shown side by side and will always be shown below.")],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:h(424,"Controls whether the suggestion will show as collapsed until jumping to it."),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ue(i.enabled,this.defaultValue.enabled),mode:vt(i.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:vt(i.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:ue(i.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ue(i.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Fi.string(i.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:ue(i.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),minShowDelay:Je.clampedInt(i.minShowDelay,0,0,1e4),suppressInSnippetMode:ue(i.suppressInSnippetMode,this.defaultValue.suppressInSnippetMode),edits:this._validateEdits(i.edits),triggerCommandOnProviderChange:ue(i.triggerCommandOnProviderChange,this.defaultValue.triggerCommandOnProviderChange),experimental:this._validateExperimental(i.experimental)}}_validateEdits(e){if(!e||typeof e!=="object"){return this.defaultValue.edits}const i=e;return{enabled:ue(i.enabled,this.defaultValue.edits.enabled),showCollapsed:ue(i.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:vt(i.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),showLongDistanceHint:ue(i.showLongDistanceHint,this.defaultValue.edits.showLongDistanceHint),renderSideBySide:vt(i.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"])}}_validateExperimental(e){if(!e||typeof e!=="object"){return this.defaultValue.experimental}const i=e;return{suppressInlineSuggestions:Fi.string(i.suppressInlineSuggestions,this.defaultValue.experimental.suppressInlineSuggestions),showOnSuggestConflict:vt(i.showOnSuggestConflict,this.defaultValue.experimental.showOnSuggestConflict,["always","never","whenSuggestListIsIncomplete"]),emptyResponseInformation:ue(i.emptyResponseInformation,this.defaultValue.experimental.emptyResponseInformation)}}}class j6 extends Et{constructor(){const e={enabled:o2.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:o2.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(N.bracketPairColorization,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(425,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h(426,"Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ue(i.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ue(i.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class G6 extends Et{constructor(){const e={bracketPairs:false,bracketPairsHorizontal:"active",highlightActiveBracketPair:true,indentation:true,highlightActiveIndentation:true};super(N.guides,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[true,"active",false],enumDescriptions:[h(427,"Enables bracket pair guides."),h(428,"Enables bracket pair guides only for the active bracket pair."),h(429,"Disables bracket pair guides.")],default:e.bracketPairs,description:h(430,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[true,"active",false],enumDescriptions:[h(431,"Enables horizontal guides as addition to vertical bracket pair guides."),h(432,"Enables horizontal guides only for the active bracket pair."),h(433,"Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:h(434,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h(435,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h(436,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[true,"always",false],enumDescriptions:[h(437,"Highlights the active indent guide."),h(438,"Highlights the active indent guide even if bracket guides are highlighted."),h(439,"Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:h(440,"Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{bracketPairs:cc(i.bracketPairs,this.defaultValue.bracketPairs,[true,false,"active"]),bracketPairsHorizontal:cc(i.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[true,false,"active"]),highlightActiveBracketPair:ue(i.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ue(i.indentation,this.defaultValue.indentation),highlightActiveIndentation:cc(i.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[true,false,"always"])}}}function cc(t,e,i){const n=i.indexOf(t);if(n===-1){return e}return i[n]}class K6 extends Et{constructor(){const e={insertMode:"insert",filterGraceful:true,snippetsPreventQuickSuggestions:false,localityBonus:false,shareSuggestSelections:false,selectionMode:"always",showIcons:true,showStatusBar:false,preview:false,previewMode:"subwordSmart",showInlineDetails:true,showMethods:true,showFunctions:true,showConstructors:true,showDeprecated:true,matchOnWordStartOnly:true,showFields:true,showVariables:true,showClasses:true,showStructs:true,showInterfaces:true,showModules:true,showProperties:true,showEvents:true,showOperators:true,showUnits:true,showValues:true,showConstants:true,showEnums:true,showEnumMembers:true,showKeywords:true,showWords:true,showColors:true,showFiles:true,showReferences:true,showFolders:true,showTypeParameters:true,showSnippets:true,showUsers:true,showIssues:true};super(N.suggest,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h(441,"Insert suggestion without overwriting text right of the cursor."),h(442,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:h(443,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h(444,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h(445,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h(446,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h(447,"Always select a suggestion when automatically triggering IntelliSense."),h(448,"Never select a suggestion when automatically triggering IntelliSense."),h(449,"Select a suggestion only when triggering IntelliSense from a trigger character."),h(450,"Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:h(451,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h(452,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h(453,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h(454,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h(455,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h(456,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h(457,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h(458,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:true,markdownDescription:h(459,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:true,markdownDescription:h(460,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:true,markdownDescription:h(461,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:true,markdownDescription:h(462,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:true,markdownDescription:h(463,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:true,markdownDescription:h(464,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:true,markdownDescription:h(465,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:true,markdownDescription:h(466,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:true,markdownDescription:h(467,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:true,markdownDescription:h(468,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:true,markdownDescription:h(469,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:true,markdownDescription:h(470,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:true,markdownDescription:h(471,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:true,markdownDescription:h(472,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:true,markdownDescription:h(473,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:true,markdownDescription:h(474,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:true,markdownDescription:h(475,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:true,markdownDescription:h(476,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:true,markdownDescription:h(477,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:true,markdownDescription:h(478,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:true,markdownDescription:h(479,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:true,markdownDescription:h(480,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:true,markdownDescription:h(481,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:true,markdownDescription:h(482,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:true,markdownDescription:h(483,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:true,markdownDescription:h(484,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:true,markdownDescription:h(485,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:true,markdownDescription:h(486,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:true,markdownDescription:h(487,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:true,markdownDescription:h(488,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{insertMode:vt(i.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ue(i.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ue(i.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ue(i.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ue(i.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:vt(i.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ue(i.showIcons,this.defaultValue.showIcons),showStatusBar:ue(i.showStatusBar,this.defaultValue.showStatusBar),preview:ue(i.preview,this.defaultValue.preview),previewMode:vt(i.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ue(i.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ue(i.showMethods,this.defaultValue.showMethods),showFunctions:ue(i.showFunctions,this.defaultValue.showFunctions),showConstructors:ue(i.showConstructors,this.defaultValue.showConstructors),showDeprecated:ue(i.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ue(i.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ue(i.showFields,this.defaultValue.showFields),showVariables:ue(i.showVariables,this.defaultValue.showVariables),showClasses:ue(i.showClasses,this.defaultValue.showClasses),showStructs:ue(i.showStructs,this.defaultValue.showStructs),showInterfaces:ue(i.showInterfaces,this.defaultValue.showInterfaces),showModules:ue(i.showModules,this.defaultValue.showModules),showProperties:ue(i.showProperties,this.defaultValue.showProperties),showEvents:ue(i.showEvents,this.defaultValue.showEvents),showOperators:ue(i.showOperators,this.defaultValue.showOperators),showUnits:ue(i.showUnits,this.defaultValue.showUnits),showValues:ue(i.showValues,this.defaultValue.showValues),showConstants:ue(i.showConstants,this.defaultValue.showConstants),showEnums:ue(i.showEnums,this.defaultValue.showEnums),showEnumMembers:ue(i.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ue(i.showKeywords,this.defaultValue.showKeywords),showWords:ue(i.showWords,this.defaultValue.showWords),showColors:ue(i.showColors,this.defaultValue.showColors),showFiles:ue(i.showFiles,this.defaultValue.showFiles),showReferences:ue(i.showReferences,this.defaultValue.showReferences),showFolders:ue(i.showFolders,this.defaultValue.showFolders),showTypeParameters:ue(i.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ue(i.showSnippets,this.defaultValue.showSnippets),showUsers:ue(i.showUsers,this.defaultValue.showUsers),showIssues:ue(i.showIssues,this.defaultValue.showIssues)}}}class Q6 extends Et{constructor(){super(N.smartSelect,"smartSelect",{selectLeadingAndTrailingWhitespace:true,selectSubwords:true},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h(489,"Whether leading and trailing whitespace should always be selected."),default:true,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h(490,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:true,type:"boolean"}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}return{selectLeadingAndTrailingWhitespace:ue(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ue(e.selectSubwords,this.defaultValue.selectSubwords)}}}class J6 extends Et{constructor(){const e=[];super(N.wordSegmenterLocales,"wordSegmenterLocales",e,{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:h(491,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"},default:e})}validate(e){if(typeof e==="string"){e=[e]}if(Array.isArray(e)){const i=[];for(const n of e){if(typeof n==="string"){try{if(Intl.Segmenter.supportedLocalesOf(n).length>0){i.push(n)}}catch{}}}return i}return this.defaultValue}}var yr;(function(t){t[t["None"]=0]="None";t[t["Same"]=1]="Same";t[t["Indent"]=2]="Indent";t[t["DeepIndent"]=3]="DeepIndent"})(yr||(yr={}));class Y6 extends Et{constructor(){super(N.wrappingIndent,"wrappingIndent",yr.Same,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h(492,"No indentation. Wrapped lines begin at column 1."),h(493,"Wrapped lines get the same indentation as the parent."),h(494,"Wrapped lines get +1 indentation toward the parent."),h(495,"Wrapped lines get +2 indentation toward the parent.")],description:h(496,"Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return yr.None;case"same":return yr.Same;case"indent":return yr.Indent;case"deepIndent":return yr.DeepIndent}return yr.Same}compute(e,i,n){const s=i.get(N.accessibilitySupport);if(s===bs.Enabled){return yr.None}return n}}class X6 extends Jo{constructor(){super(N.wrappingInfo,{isDominatedByLongLines:false,isWordWrapMinified:false,isViewportWrapping:false,wrappingColumn:-1})}compute(e,i,n){const s=i.get(N.layoutInfo);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:s.isWordWrapMinified,isViewportWrapping:s.isViewportWrapping,wrappingColumn:s.wrappingColumn}}}class Z6 extends Et{constructor(){const e={enabled:true,showDropSelector:"afterDrop"};super(N.dropIntoEditor,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(497,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h(498,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h(499,"Show the drop selector widget after a file is dropped into the editor."),h(500,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ue(i.enabled,this.defaultValue.enabled),showDropSelector:vt(i.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class e9 extends Et{constructor(){const e={enabled:true,showPasteSelector:"afterPaste"};super(N.pasteAs,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(501,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h(502,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h(503,"Show the paste selector widget after content is pasted into the editor."),h(504,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ue(i.enabled,this.defaultValue.enabled),showPasteSelector:vt(i.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const t9=[];function $(t){t9[t.id]=t;return t}var N;(function(t){t[t["acceptSuggestionOnCommitCharacter"]=0]="acceptSuggestionOnCommitCharacter";t[t["acceptSuggestionOnEnter"]=1]="acceptSuggestionOnEnter";t[t["accessibilitySupport"]=2]="accessibilitySupport";t[t["accessibilityPageSize"]=3]="accessibilityPageSize";t[t["allowOverflow"]=4]="allowOverflow";t[t["allowVariableLineHeights"]=5]="allowVariableLineHeights";t[t["allowVariableFonts"]=6]="allowVariableFonts";t[t["allowVariableFontsInAccessibilityMode"]=7]="allowVariableFontsInAccessibilityMode";t[t["ariaLabel"]=8]="ariaLabel";t[t["ariaRequired"]=9]="ariaRequired";t[t["autoClosingBrackets"]=10]="autoClosingBrackets";t[t["autoClosingComments"]=11]="autoClosingComments";t[t["screenReaderAnnounceInlineSuggestion"]=12]="screenReaderAnnounceInlineSuggestion";t[t["autoClosingDelete"]=13]="autoClosingDelete";t[t["autoClosingOvertype"]=14]="autoClosingOvertype";t[t["autoClosingQuotes"]=15]="autoClosingQuotes";t[t["autoIndent"]=16]="autoIndent";t[t["autoIndentOnPaste"]=17]="autoIndentOnPaste";t[t["autoIndentOnPasteWithinString"]=18]="autoIndentOnPasteWithinString";t[t["automaticLayout"]=19]="automaticLayout";t[t["autoSurround"]=20]="autoSurround";t[t["bracketPairColorization"]=21]="bracketPairColorization";t[t["guides"]=22]="guides";t[t["codeLens"]=23]="codeLens";t[t["codeLensFontFamily"]=24]="codeLensFontFamily";t[t["codeLensFontSize"]=25]="codeLensFontSize";t[t["colorDecorators"]=26]="colorDecorators";t[t["colorDecoratorsLimit"]=27]="colorDecoratorsLimit";t[t["columnSelection"]=28]="columnSelection";t[t["comments"]=29]="comments";t[t["contextmenu"]=30]="contextmenu";t[t["copyWithSyntaxHighlighting"]=31]="copyWithSyntaxHighlighting";t[t["cursorBlinking"]=32]="cursorBlinking";t[t["cursorSmoothCaretAnimation"]=33]="cursorSmoothCaretAnimation";t[t["cursorStyle"]=34]="cursorStyle";t[t["cursorSurroundingLines"]=35]="cursorSurroundingLines";t[t["cursorSurroundingLinesStyle"]=36]="cursorSurroundingLinesStyle";t[t["cursorWidth"]=37]="cursorWidth";t[t["cursorHeight"]=38]="cursorHeight";t[t["disableLayerHinting"]=39]="disableLayerHinting";t[t["disableMonospaceOptimizations"]=40]="disableMonospaceOptimizations";t[t["domReadOnly"]=41]="domReadOnly";t[t["dragAndDrop"]=42]="dragAndDrop";t[t["dropIntoEditor"]=43]="dropIntoEditor";t[t["editContext"]=44]="editContext";t[t["emptySelectionClipboard"]=45]="emptySelectionClipboard";t[t["experimentalGpuAcceleration"]=46]="experimentalGpuAcceleration";t[t["experimentalWhitespaceRendering"]=47]="experimentalWhitespaceRendering";t[t["extraEditorClassName"]=48]="extraEditorClassName";t[t["fastScrollSensitivity"]=49]="fastScrollSensitivity";t[t["find"]=50]="find";t[t["fixedOverflowWidgets"]=51]="fixedOverflowWidgets";t[t["folding"]=52]="folding";t[t["foldingStrategy"]=53]="foldingStrategy";t[t["foldingHighlight"]=54]="foldingHighlight";t[t["foldingImportsByDefault"]=55]="foldingImportsByDefault";t[t["foldingMaximumRegions"]=56]="foldingMaximumRegions";t[t["unfoldOnClickAfterEndOfLine"]=57]="unfoldOnClickAfterEndOfLine";t[t["fontFamily"]=58]="fontFamily";t[t["fontInfo"]=59]="fontInfo";t[t["fontLigatures"]=60]="fontLigatures";t[t["fontSize"]=61]="fontSize";t[t["fontWeight"]=62]="fontWeight";t[t["fontVariations"]=63]="fontVariations";t[t["formatOnPaste"]=64]="formatOnPaste";t[t["formatOnType"]=65]="formatOnType";t[t["glyphMargin"]=66]="glyphMargin";t[t["gotoLocation"]=67]="gotoLocation";t[t["hideCursorInOverviewRuler"]=68]="hideCursorInOverviewRuler";t[t["hover"]=69]="hover";t[t["inDiffEditor"]=70]="inDiffEditor";t[t["inlineSuggest"]=71]="inlineSuggest";t[t["letterSpacing"]=72]="letterSpacing";t[t["lightbulb"]=73]="lightbulb";t[t["lineDecorationsWidth"]=74]="lineDecorationsWidth";t[t["lineHeight"]=75]="lineHeight";t[t["lineNumbers"]=76]="lineNumbers";t[t["lineNumbersMinChars"]=77]="lineNumbersMinChars";t[t["linkedEditing"]=78]="linkedEditing";t[t["links"]=79]="links";t[t["matchBrackets"]=80]="matchBrackets";t[t["minimap"]=81]="minimap";t[t["mouseStyle"]=82]="mouseStyle";t[t["mouseWheelScrollSensitivity"]=83]="mouseWheelScrollSensitivity";t[t["mouseWheelZoom"]=84]="mouseWheelZoom";t[t["multiCursorMergeOverlapping"]=85]="multiCursorMergeOverlapping";t[t["multiCursorModifier"]=86]="multiCursorModifier";t[t["mouseMiddleClickAction"]=87]="mouseMiddleClickAction";t[t["multiCursorPaste"]=88]="multiCursorPaste";t[t["multiCursorLimit"]=89]="multiCursorLimit";t[t["occurrencesHighlight"]=90]="occurrencesHighlight";t[t["occurrencesHighlightDelay"]=91]="occurrencesHighlightDelay";t[t["overtypeCursorStyle"]=92]="overtypeCursorStyle";t[t["overtypeOnPaste"]=93]="overtypeOnPaste";t[t["overviewRulerBorder"]=94]="overviewRulerBorder";t[t["overviewRulerLanes"]=95]="overviewRulerLanes";t[t["padding"]=96]="padding";t[t["pasteAs"]=97]="pasteAs";t[t["parameterHints"]=98]="parameterHints";t[t["peekWidgetDefaultFocus"]=99]="peekWidgetDefaultFocus";t[t["placeholder"]=100]="placeholder";t[t["definitionLinkOpensInPeek"]=101]="definitionLinkOpensInPeek";t[t["quickSuggestions"]=102]="quickSuggestions";t[t["quickSuggestionsDelay"]=103]="quickSuggestionsDelay";t[t["readOnly"]=104]="readOnly";t[t["readOnlyMessage"]=105]="readOnlyMessage";t[t["renameOnType"]=106]="renameOnType";t[t["renderRichScreenReaderContent"]=107]="renderRichScreenReaderContent";t[t["renderControlCharacters"]=108]="renderControlCharacters";t[t["renderFinalNewline"]=109]="renderFinalNewline";t[t["renderLineHighlight"]=110]="renderLineHighlight";t[t["renderLineHighlightOnlyWhenFocus"]=111]="renderLineHighlightOnlyWhenFocus";t[t["renderValidationDecorations"]=112]="renderValidationDecorations";t[t["renderWhitespace"]=113]="renderWhitespace";t[t["revealHorizontalRightPadding"]=114]="revealHorizontalRightPadding";t[t["roundedSelection"]=115]="roundedSelection";t[t["rulers"]=116]="rulers";t[t["scrollbar"]=117]="scrollbar";t[t["scrollBeyondLastColumn"]=118]="scrollBeyondLastColumn";t[t["scrollBeyondLastLine"]=119]="scrollBeyondLastLine";t[t["scrollPredominantAxis"]=120]="scrollPredominantAxis";t[t["selectionClipboard"]=121]="selectionClipboard";t[t["selectionHighlight"]=122]="selectionHighlight";t[t["selectionHighlightMaxLength"]=123]="selectionHighlightMaxLength";t[t["selectionHighlightMultiline"]=124]="selectionHighlightMultiline";t[t["selectOnLineNumbers"]=125]="selectOnLineNumbers";t[t["showFoldingControls"]=126]="showFoldingControls";t[t["showUnused"]=127]="showUnused";t[t["snippetSuggestions"]=128]="snippetSuggestions";t[t["smartSelect"]=129]="smartSelect";t[t["smoothScrolling"]=130]="smoothScrolling";t[t["stickyScroll"]=131]="stickyScroll";t[t["stickyTabStops"]=132]="stickyTabStops";t[t["stopRenderingLineAfter"]=133]="stopRenderingLineAfter";t[t["suggest"]=134]="suggest";t[t["suggestFontSize"]=135]="suggestFontSize";t[t["suggestLineHeight"]=136]="suggestLineHeight";t[t["suggestOnTriggerCharacters"]=137]="suggestOnTriggerCharacters";t[t["suggestSelection"]=138]="suggestSelection";t[t["tabCompletion"]=139]="tabCompletion";t[t["tabIndex"]=140]="tabIndex";t[t["trimWhitespaceOnDelete"]=141]="trimWhitespaceOnDelete";t[t["unicodeHighlighting"]=142]="unicodeHighlighting";t[t["unusualLineTerminators"]=143]="unusualLineTerminators";t[t["useShadowDOM"]=144]="useShadowDOM";t[t["useTabStops"]=145]="useTabStops";t[t["wordBreak"]=146]="wordBreak";t[t["wordSegmenterLocales"]=147]="wordSegmenterLocales";t[t["wordSeparators"]=148]="wordSeparators";t[t["wordWrap"]=149]="wordWrap";t[t["wordWrapBreakAfterCharacters"]=150]="wordWrapBreakAfterCharacters";t[t["wordWrapBreakBeforeCharacters"]=151]="wordWrapBreakBeforeCharacters";t[t["wordWrapColumn"]=152]="wordWrapColumn";t[t["wordWrapOverride1"]=153]="wordWrapOverride1";t[t["wordWrapOverride2"]=154]="wordWrapOverride2";t[t["wrappingIndent"]=155]="wrappingIndent";t[t["wrappingStrategy"]=156]="wrappingStrategy";t[t["showDeprecated"]=157]="showDeprecated";t[t["inertialScroll"]=158]="inertialScroll";t[t["inlayHints"]=159]="inlayHints";t[t["wrapOnEscapedLineFeeds"]=160]="wrapOnEscapedLineFeeds";t[t["effectiveCursorStyle"]=161]="effectiveCursorStyle";t[t["editorClassName"]=162]="editorClassName";t[t["pixelRatio"]=163]="pixelRatio";t[t["tabFocusMode"]=164]="tabFocusMode";t[t["layoutInfo"]=165]="layoutInfo";t[t["wrappingInfo"]=166]="wrappingInfo";t[t["defaultColorDecorators"]=167]="defaultColorDecorators";t[t["colorDecoratorsActivatedOn"]=168]="colorDecoratorsActivatedOn";t[t["inlineCompletionsAccessibilityVerbose"]=169]="inlineCompletionsAccessibilityVerbose";t[t["effectiveEditContext"]=170]="effectiveEditContext";t[t["scrollOnMiddleClick"]=171]="scrollOnMiddleClick";t[t["effectiveAllowVariableFonts"]=172]="effectiveAllowVariableFonts"})(N||(N={}));({acceptSuggestionOnCommitCharacter:$(new Ce(N.acceptSuggestionOnCommitCharacter,"acceptSuggestionOnCommitCharacter",true,{markdownDescription:h(505,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:$(new yt(N.acceptSuggestionOnEnter,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h(506,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h(507,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:$(new p6),accessibilityPageSize:$(new Je(N.accessibilityPageSize,"accessibilityPageSize",500,1,Ni.MAX_SAFE_SMALL_INTEGER,{description:h(508,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),allowOverflow:$(new Ce(N.allowOverflow,"allowOverflow",true)),allowVariableLineHeights:$(new Ce(N.allowVariableLineHeights,"allowVariableLineHeights",true,{description:h(509,"Controls whether to allow using variable line heights in the editor.")})),allowVariableFonts:$(new Ce(N.allowVariableFonts,"allowVariableFonts",true,{description:h(510,"Controls whether to allow using variable fonts in the editor.")})),allowVariableFontsInAccessibilityMode:$(new Ce(N.allowVariableFontsInAccessibilityMode,"allowVariableFontsInAccessibilityMode",false,{description:h(511,"Controls whether to allow using variable fonts in the editor in the accessibility mode."),tags:["accessibility"]})),ariaLabel:$(new Fi(N.ariaLabel,"ariaLabel",h(512,"Editor content"))),ariaRequired:$(new Ce(N.ariaRequired,"ariaRequired",false,void 0)),screenReaderAnnounceInlineSuggestion:$(new Ce(N.screenReaderAnnounceInlineSuggestion,"screenReaderAnnounceInlineSuggestion",true,{description:h(513,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:$(new yt(N.autoClosingBrackets,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(514,"Use language configurations to determine when to autoclose brackets."),h(515,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h(516,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:$(new yt(N.autoClosingComments,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(517,"Use language configurations to determine when to autoclose comments."),h(518,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:h(519,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:$(new yt(N.autoClosingDelete,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h(520,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h(521,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:$(new yt(N.autoClosingOvertype,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h(522,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:h(523,"Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:$(new yt(N.autoClosingQuotes,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(524,"Use language configurations to determine when to autoclose quotes."),h(525,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h(526,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:$(new $u(N.autoIndent,"autoIndent",wo.Full,"full",["none","keep","brackets","advanced","full"],f6,{enumDescriptions:[h(527,"The editor will not insert indentation automatically."),h(528,"The editor will keep the current line's indentation."),h(529,"The editor will keep the current line's indentation and honor language defined brackets."),h(530,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h(531,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h(532,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),autoIndentOnPaste:$(new Ce(N.autoIndentOnPaste,"autoIndentOnPaste",false,{description:h(533,"Controls whether the editor should automatically auto-indent the pasted content.")})),autoIndentOnPasteWithinString:$(new Ce(N.autoIndentOnPasteWithinString,"autoIndentOnPasteWithinString",true,{description:h(534,"Controls whether the editor should automatically auto-indent the pasted content when pasted within a string. This takes effect when autoIndentOnPaste is true.")})),automaticLayout:$(new Ce(N.automaticLayout,"automaticLayout",false)),autoSurround:$(new yt(N.autoSurround,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h(535,"Use language configurations to determine when to automatically surround selections."),h(536,"Surround with quotes but not brackets."),h(537,"Surround with brackets but not quotes."),""],description:h(538,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:$(new j6),bracketPairGuides:$(new G6),stickyTabStops:$(new Ce(N.stickyTabStops,"stickyTabStops",false,{description:h(539,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:$(new Ce(N.codeLens,"codeLens",true,{description:h(540,"Controls whether the editor shows CodeLens.")})),codeLensFontFamily:$(new Fi(N.codeLensFontFamily,"codeLensFontFamily","",{description:h(541,"Controls the font family for CodeLens.")})),codeLensFontSize:$(new Je(N.codeLensFontSize,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h(542,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:$(new Ce(N.colorDecorators,"colorDecorators",true,{description:h(543,"Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:$(new yt(N.colorDecoratorsActivatedOn,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h(544,"Make the color picker appear both on click and hover of the color decorator"),h(545,"Make the color picker appear on hover of the color decorator"),h(546,"Make the color picker appear on click of the color decorator")],description:h(547,"Controls the condition to make a color picker appear from a color decorator.")})),colorDecoratorsLimit:$(new Je(N.colorDecoratorsLimit,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h(548,"Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:$(new Ce(N.columnSelection,"columnSelection",false,{description:h(549,"Enable that the selection with the mouse and keys is doing column selection.")})),comments:$(new g6),contextmenu:$(new Ce(N.contextmenu,"contextmenu",true)),copyWithSyntaxHighlighting:$(new Ce(N.copyWithSyntaxHighlighting,"copyWithSyntaxHighlighting",true,{description:h(550,"Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:$(new $u(N.cursorBlinking,"cursorBlinking",bo.Blink,"blink",["blink","smooth","phase","expand","solid"],m6,{description:h(551,"Control the cursor animation style.")})),cursorSmoothCaretAnimation:$(new yt(N.cursorSmoothCaretAnimation,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h(552,"Smooth caret animation is disabled."),h(553,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h(554,"Smooth caret animation is always enabled.")],description:h(555,"Controls whether the smooth caret animation should be enabled.")})),cursorStyle:$(new $u(N.cursorStyle,"cursorStyle",Qn.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],c2,{description:h(556,"Controls the cursor style in insert input mode.")})),overtypeCursorStyle:$(new $u(N.overtypeCursorStyle,"overtypeCursorStyle",Qn.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],c2,{description:h(557,"Controls the cursor style in overtype input mode.")})),cursorSurroundingLines:$(new Je(N.cursorSurroundingLines,"cursorSurroundingLines",0,0,Ni.MAX_SAFE_SMALL_INTEGER,{description:h(558,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:$(new yt(N.cursorSurroundingLinesStyle,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h(559,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h(560,"`cursorSurroundingLines` is enforced always.")],markdownDescription:h(561,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:$(new Je(N.cursorWidth,"cursorWidth",0,0,Ni.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(562,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),cursorHeight:$(new Je(N.cursorHeight,"cursorHeight",0,0,Ni.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(563,"Controls the height of the cursor when `#editor.cursorStyle#` is set to `line`. Cursor's max height depends on line height.")})),disableLayerHinting:$(new Ce(N.disableLayerHinting,"disableLayerHinting",false)),disableMonospaceOptimizations:$(new Ce(N.disableMonospaceOptimizations,"disableMonospaceOptimizations",false)),domReadOnly:$(new Ce(N.domReadOnly,"domReadOnly",false)),dragAndDrop:$(new Ce(N.dragAndDrop,"dragAndDrop",true,{description:h(564,"Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:$(new v6),dropIntoEditor:$(new Z6),editContext:$(new Ce(N.editContext,"editContext",true,{description:h(565,"Sets whether the EditContext API should be used instead of the text area to power input in the editor."),included:xS||t4||XT})),renderRichScreenReaderContent:$(new Ce(N.renderRichScreenReaderContent,"renderRichScreenReaderContent",false,{markdownDescription:h(566,"Whether to render rich screen reader content when the `#editor.editContext#` setting is enabled.")})),stickyScroll:$(new T6),experimentalGpuAcceleration:$(new yt(N.experimentalGpuAcceleration,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[h(567,"Use regular DOM-based rendering."),h(568,"Use GPU acceleration.")],description:h(569,"Controls whether to use the experimental GPU acceleration to render the editor.")})),experimentalWhitespaceRendering:$(new yt(N.experimentalWhitespaceRendering,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h(570,"Use a new rendering method with svgs."),h(571,"Use a new rendering method with font characters."),h(572,"Use the stable rendering method.")],description:h(573,"Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:$(new Fi(N.extraEditorClassName,"extraEditorClassName","")),fastScrollSensitivity:$(new In(N.fastScrollSensitivity,"fastScrollSensitivity",5,t=>t<=0?5:t,{markdownDescription:h(574,"Scrolling speed multiplier when pressing `Alt`.")})),find:$(new w6),fixedOverflowWidgets:$(new Ce(N.fixedOverflowWidgets,"fixedOverflowWidgets",false)),folding:$(new Ce(N.folding,"folding",true,{description:h(575,"Controls whether the editor has code folding enabled.")})),foldingStrategy:$(new yt(N.foldingStrategy,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h(576,"Use a language-specific folding strategy if available, else the indentation-based one."),h(577,"Use the indentation-based folding strategy.")],description:h(578,"Controls the strategy for computing folding ranges.")})),foldingHighlight:$(new Ce(N.foldingHighlight,"foldingHighlight",true,{description:h(579,"Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:$(new Ce(N.foldingImportsByDefault,"foldingImportsByDefault",false,{description:h(580,"Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:$(new Je(N.foldingMaximumRegions,"foldingMaximumRegions",5e3,10,65e3,{description:h(581,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:$(new Ce(N.unfoldOnClickAfterEndOfLine,"unfoldOnClickAfterEndOfLine",false,{description:h(582,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:$(new Fi(N.fontFamily,"fontFamily",nr.fontFamily,{description:h(583,"Controls the font family.")})),fontInfo:$(new b6),fontLigatures2:$(new ga),fontSize:$(new E6),fontWeight:$(new _a),fontVariations:$(new ma),formatOnPaste:$(new Ce(N.formatOnPaste,"formatOnPaste",false,{description:h(584,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:$(new Ce(N.formatOnType,"formatOnType",false,{description:h(585,"Controls whether the editor should automatically format the line after typing.")})),glyphMargin:$(new Ce(N.glyphMargin,"glyphMargin",true,{description:h(586,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:$(new C6),hideCursorInOverviewRuler:$(new Ce(N.hideCursorInOverviewRuler,"hideCursorInOverviewRuler",false,{description:h(587,"Controls whether the cursor should be hidden in the overview ruler.")})),hover:$(new k6),inDiffEditor:$(new Ce(N.inDiffEditor,"inDiffEditor",false)),inertialScroll:$(new Ce(N.inertialScroll,"inertialScroll",false,{description:h(588,"Make scrolling inertial - mostly useful with touchpad on linux.")})),letterSpacing:$(new In(N.letterSpacing,"letterSpacing",nr.letterSpacing,t=>In.clamp(t,-5,20),{description:h(589,"Controls the letter spacing in pixels.")})),lightbulb:$(new I6),lineDecorationsWidth:$(new A6),lineHeight:$(new R6),lineNumbers:$(new H6),lineNumbersMinChars:$(new Je(N.lineNumbersMinChars,"lineNumbersMinChars",5,1,300)),linkedEditing:$(new Ce(N.linkedEditing,"linkedEditing",false,{description:h(590,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:$(new Ce(N.links,"links",true,{description:h(591,"Controls whether the editor should detect links and make them clickable.")})),matchBrackets:$(new yt(N.matchBrackets,"matchBrackets","always",["always","near","never"],{description:h(592,"Highlight matching brackets.")})),minimap:$(new L6),mouseStyle:$(new yt(N.mouseStyle,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:$(new In(N.mouseWheelScrollSensitivity,"mouseWheelScrollSensitivity",1,t=>t===0?1:t,{markdownDescription:h(593,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:$(new Ce(N.mouseWheelZoom,"mouseWheelZoom",false,{markdownDescription:vn?h(594,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h(595,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:$(new Ce(N.multiCursorMergeOverlapping,"multiCursorMergeOverlapping",true,{description:h(596,"Merge multiple cursors when they are overlapping.")})),multiCursorModifier:$(new $u(N.multiCursorModifier,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],N6,{markdownEnumDescriptions:[h(597,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),h(598,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h(599,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),mouseMiddleClickAction:$(new yt(N.mouseMiddleClickAction,"mouseMiddleClickAction","default",["default","openLink","ctrlLeftClick"],{description:h(600,"Controls what happens when middle mouse button is clicked in the editor.")})),multiCursorPaste:$(new yt(N.multiCursorPaste,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h(601,"Each cursor pastes a single line of the text."),h(602,"Each cursor pastes the full text.")],markdownDescription:h(603,"Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:$(new Je(N.multiCursorLimit,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h(604,"Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:$(new yt(N.occurrencesHighlight,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h(605,"Does not highlight occurrences."),h(606,"Highlights occurrences only in the current file."),h(607,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h(608,"Controls whether occurrences should be highlighted across open files.")})),occurrencesHighlightDelay:$(new Je(N.occurrencesHighlightDelay,"occurrencesHighlightDelay",0,0,2e3,{description:h(609,"Controls the delay in milliseconds after which occurrences are highlighted."),tags:["preview"]})),overtypeOnPaste:$(new Ce(N.overtypeOnPaste,"overtypeOnPaste",true,{description:h(610,"Controls whether pasting should overtype.")})),overviewRulerBorder:$(new Ce(N.overviewRulerBorder,"overviewRulerBorder",true,{description:h(611,"Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:$(new Je(N.overviewRulerLanes,"overviewRulerLanes",3,0,3)),padding:$(new M6),pasteAs:$(new e9),parameterHints:$(new O6),peekWidgetDefaultFocus:$(new yt(N.peekWidgetDefaultFocus,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h(612,"Focus the tree when opening peek"),h(613,"Focus the editor when opening peek")],description:h(614,"Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:$(new U6),definitionLinkOpensInPeek:$(new Ce(N.definitionLinkOpensInPeek,"definitionLinkOpensInPeek",false,{description:h(615,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:$(new $6),quickSuggestionsDelay:$(new Je(N.quickSuggestionsDelay,"quickSuggestionsDelay",10,0,Ni.MAX_SAFE_SMALL_INTEGER,{description:h(616,"Controls the delay in milliseconds after which quick suggestions will show up."),experiment:{mode:"auto"}})),readOnly:$(new Ce(N.readOnly,"readOnly",false)),readOnlyMessage:$(new W6),renameOnType:$(new Ce(N.renameOnType,"renameOnType",false,{description:h(617,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:h(618,"Deprecated, use `#editor.linkedEditing#` instead.")})),renderControlCharacters:$(new Ce(N.renderControlCharacters,"renderControlCharacters",true,{description:h(619,"Controls whether the editor should render control characters."),restricted:true})),renderFinalNewline:$(new yt(N.renderFinalNewline,"renderFinalNewline",Fo?"dimmed":"on",["off","on","dimmed"],{description:h(620,"Render last line number when the file ends with a newline.")})),renderLineHighlight:$(new yt(N.renderLineHighlight,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h(621,"Highlights both the gutter and the current line.")],description:h(622,"Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:$(new Ce(N.renderLineHighlightOnlyWhenFocus,"renderLineHighlightOnlyWhenFocus",false,{description:h(623,"Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:$(new yt(N.renderValidationDecorations,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:$(new yt(N.renderWhitespace,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h(624,"Render whitespace characters except for single spaces between words."),h(625,"Render whitespace characters only on selected text."),h(626,"Render only trailing whitespace characters."),""],description:h(627,"Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:$(new Je(N.revealHorizontalRightPadding,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:$(new Ce(N.roundedSelection,"roundedSelection",true,{description:h(628,"Controls whether selections should have rounded corners.")})),rulers:$(new B6),scrollbar:$(new V6),scrollBeyondLastColumn:$(new Je(N.scrollBeyondLastColumn,"scrollBeyondLastColumn",4,0,Ni.MAX_SAFE_SMALL_INTEGER,{description:h(629,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:$(new Ce(N.scrollBeyondLastLine,"scrollBeyondLastLine",true,{description:h(630,"Controls whether the editor will scroll beyond the last line.")})),scrollOnMiddleClick:$(new Ce(N.scrollOnMiddleClick,"scrollOnMiddleClick",false,{description:h(631,"Controls whether the editor will scroll when the middle button is pressed.")})),scrollPredominantAxis:$(new Ce(N.scrollPredominantAxis,"scrollPredominantAxis",true,{description:h(632,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:$(new Ce(N.selectionClipboard,"selectionClipboard",true,{description:h(633,"Controls whether the Linux primary clipboard should be supported."),included:Fo})),selectionHighlight:$(new Ce(N.selectionHighlight,"selectionHighlight",true,{description:h(634,"Controls whether the editor should highlight matches similar to the selection.")})),selectionHighlightMaxLength:$(new Je(N.selectionHighlightMaxLength,"selectionHighlightMaxLength",200,0,Ni.MAX_SAFE_SMALL_INTEGER,{description:h(635,"Controls how many characters can be in the selection before similiar matches are not highlighted. Set to zero for unlimited.")})),selectionHighlightMultiline:$(new Ce(N.selectionHighlightMultiline,"selectionHighlightMultiline",false,{description:h(636,"Controls whether the editor should highlight selection matches that span multiple lines.")})),selectOnLineNumbers:$(new Ce(N.selectOnLineNumbers,"selectOnLineNumbers",true)),showFoldingControls:$(new yt(N.showFoldingControls,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h(637,"Always show the folding controls."),h(638,"Never show the folding controls and reduce the gutter size."),h(639,"Only show the folding controls when the mouse is over the gutter.")],description:h(640,"Controls when the folding controls on the gutter are shown.")})),showUnused:$(new Ce(N.showUnused,"showUnused",true,{description:h(641,"Controls fading out of unused code.")})),showDeprecated:$(new Ce(N.showDeprecated,"showDeprecated",true,{description:h(642,"Controls strikethrough deprecated variables.")})),inlayHints:$(new P6),snippetSuggestions:$(new yt(N.snippetSuggestions,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h(643,"Show snippet suggestions on top of other suggestions."),h(644,"Show snippet suggestions below other suggestions."),h(645,"Show snippets suggestions with other suggestions."),h(646,"Do not show snippet suggestions.")],description:h(647,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:$(new Q6),smoothScrolling:$(new Ce(N.smoothScrolling,"smoothScrolling",false,{description:h(648,"Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:$(new Je(N.stopRenderingLineAfter,"stopRenderingLineAfter",1e4,-1,Ni.MAX_SAFE_SMALL_INTEGER)),suggest:$(new K6),inlineSuggest:$(new q6),inlineCompletionsAccessibilityVerbose:$(new Ce(N.inlineCompletionsAccessibilityVerbose,"inlineCompletionsAccessibilityVerbose",false,{description:h(649,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:$(new Je(N.suggestFontSize,"suggestFontSize",0,0,1e3,{markdownDescription:h(650,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:$(new Je(N.suggestLineHeight,"suggestLineHeight",0,0,1e3,{markdownDescription:h(651,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:$(new Ce(N.suggestOnTriggerCharacters,"suggestOnTriggerCharacters",true,{description:h(652,"Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:$(new yt(N.suggestSelection,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h(653,"Always select the first suggestion."),h(654,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h(655,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h(656,"Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:$(new yt(N.tabCompletion,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h(657,"Tab complete will insert the best matching suggestion when pressing tab."),h(658,"Disable tab completions."),h(659,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h(660,"Enables tab completions.")})),tabIndex:$(new Je(N.tabIndex,"tabIndex",0,-1,Ni.MAX_SAFE_SMALL_INTEGER)),trimWhitespaceOnDelete:$(new Ce(N.trimWhitespaceOnDelete,"trimWhitespaceOnDelete",false,{description:h(661,"Controls whether the editor will also delete the next line's indentation whitespace when deleting a newline.")})),unicodeHighlight:$(new z6),unusualLineTerminators:$(new yt(N.unusualLineTerminators,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h(662,"Unusual line terminators are automatically removed."),h(663,"Unusual line terminators are ignored."),h(664,"Unusual line terminators prompt to be removed.")],description:h(665,"Remove unusual line terminators that might cause problems.")})),useShadowDOM:$(new Ce(N.useShadowDOM,"useShadowDOM",true)),useTabStops:$(new Ce(N.useTabStops,"useTabStops",true,{description:h(666,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:$(new yt(N.wordBreak,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h(667,"Use the default line break rule."),h(668,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h(669,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:$(new J6),wordSeparators:$(new Fi(N.wordSeparators,"wordSeparators",nP,{description:h(670,"Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:$(new yt(N.wordWrap,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h(671,"Lines will never wrap."),h(672,"Lines will wrap at the viewport width."),h(673,"Lines will wrap at `#editor.wordWrapColumn#`."),h(674,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h(675,"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:$(new Fi(N.wordWrapBreakAfterCharacters,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),wordWrapBreakBeforeCharacters:$(new Fi(N.wordWrapBreakBeforeCharacters,"wordWrapBreakBeforeCharacters","([{+")),wordWrapColumn:$(new Je(N.wordWrapColumn,"wordWrapColumn",80,1,Ni.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(676,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:$(new yt(N.wordWrapOverride1,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:$(new yt(N.wordWrapOverride2,"wordWrapOverride2","inherit",["off","on","inherit"])),wrapOnEscapedLineFeeds:$(new Ce(N.wrapOnEscapedLineFeeds,"wrapOnEscapedLineFeeds",false,{markdownDescription:h(677,'Controls whether literal `\\n` shall trigger a wordWrap when `#editor.wordWrap#` is enabled.\n\nFor example:\n```c\nchar* str="hello\\nworld"\n```\nwill be displayed as\n```c\nchar* str="hello\\n\n           world"\n```')})),effectiveCursorStyle:$(new y6),editorClassName:$(new _6),defaultColorDecorators:$(new yt(N.defaultColorDecorators,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[h(678,"Show default color decorators only when no extension provides colors decorators."),h(679,"Always show default color decorators."),h(680,"Never show default color decorators.")],description:h(681,"Controls whether inline color decorations should be shown using the default document color provider.")})),pixelRatio:$(new F6),tabFocusMode:$(new Ce(N.tabFocusMode,"tabFocusMode",false,{markdownDescription:h(682,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:$(new _d),wrappingInfo:$(new X6),wrappingIndent:$(new Y6),wrappingStrategy:$(new D6),effectiveEditContextEnabled:$(new S6),effectiveAllowVariableFonts:$(new x6)});let $n=class aa{constructor(e,i){this.lineNumber=e;this.column=i}with(e=this.lineNumber,i=this.column){if(e===this.lineNumber&&i===this.column){return this}else{return new aa(e,i)}}delta(e=0,i=0){return this.with(Math.max(1,this.lineNumber+e),Math.max(1,this.column+i))}equals(e){return aa.equals(this,e)}static equals(e,i){if(!e&&!i){return true}return!!e&&!!i&&e.lineNumber===i.lineNumber&&e.column===i.column}isBefore(e){return aa.isBefore(this,e)}static isBefore(e,i){if(e.lineNumber<i.lineNumber){return true}if(i.lineNumber<e.lineNumber){return false}return e.column<i.column}isBeforeOrEqual(e){return aa.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,i){if(e.lineNumber<i.lineNumber){return true}if(i.lineNumber<e.lineNumber){return false}return e.column<=i.column}static compare(e,i){const n=e.lineNumber|0;const s=i.lineNumber|0;if(n===s){const r=e.column|0;const o=i.column|0;return r-o}return n-s}clone(){return new aa(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new aa(e.lineNumber,e.column)}static isIPosition(e){return!!e&&typeof e.lineNumber==="number"&&typeof e.column==="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};let _t=class di{constructor(e,i,n,s){if(e>n||e===n&&i>s){this.startLineNumber=n;this.startColumn=s;this.endLineNumber=e;this.endColumn=i}else{this.startLineNumber=e;this.startColumn=i;this.endLineNumber=n;this.endColumn=s}}isEmpty(){return di.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return di.containsPosition(this,e)}static containsPosition(e,i){if(i.lineNumber<e.startLineNumber||i.lineNumber>e.endLineNumber){return false}if(i.lineNumber===e.startLineNumber&&i.column<e.startColumn){return false}if(i.lineNumber===e.endLineNumber&&i.column>e.endColumn){return false}return true}static strictContainsPosition(e,i){if(i.lineNumber<e.startLineNumber||i.lineNumber>e.endLineNumber){return false}if(i.lineNumber===e.startLineNumber&&i.column<=e.startColumn){return false}if(i.lineNumber===e.endLineNumber&&i.column>=e.endColumn){return false}return true}containsRange(e){return di.containsRange(this,e)}static containsRange(e,i){if(i.startLineNumber<e.startLineNumber||i.endLineNumber<e.startLineNumber){return false}if(i.startLineNumber>e.endLineNumber||i.endLineNumber>e.endLineNumber){return false}if(i.startLineNumber===e.startLineNumber&&i.startColumn<e.startColumn){return false}if(i.endLineNumber===e.endLineNumber&&i.endColumn>e.endColumn){return false}return true}strictContainsRange(e){return di.strictContainsRange(this,e)}static strictContainsRange(e,i){if(i.startLineNumber<e.startLineNumber||i.endLineNumber<e.startLineNumber){return false}if(i.startLineNumber>e.endLineNumber||i.endLineNumber>e.endLineNumber){return false}if(i.startLineNumber===e.startLineNumber&&i.startColumn<=e.startColumn){return false}if(i.endLineNumber===e.endLineNumber&&i.endColumn>=e.endColumn){return false}return true}plusRange(e){return di.plusRange(this,e)}static plusRange(e,i){let n;let s;let r;let o;if(i.startLineNumber<e.startLineNumber){n=i.startLineNumber;s=i.startColumn}else if(i.startLineNumber===e.startLineNumber){n=i.startLineNumber;s=Math.min(i.startColumn,e.startColumn)}else{n=e.startLineNumber;s=e.startColumn}if(i.endLineNumber>e.endLineNumber){r=i.endLineNumber;o=i.endColumn}else if(i.endLineNumber===e.endLineNumber){r=i.endLineNumber;o=Math.max(i.endColumn,e.endColumn)}else{r=e.endLineNumber;o=e.endColumn}return new di(n,s,r,o)}intersectRanges(e){return di.intersectRanges(this,e)}static intersectRanges(e,i){let n=e.startLineNumber;let s=e.startColumn;let r=e.endLineNumber;let o=e.endColumn;const a=i.startLineNumber;const l=i.startColumn;const c=i.endLineNumber;const u=i.endColumn;if(n<a){n=a;s=l}else if(n===a){s=Math.max(s,l)}if(r>c){r=c;o=u}else if(r===c){o=Math.min(o,u)}if(n>r){return null}if(n===r&&s>o){return null}return new di(n,s,r,o)}equalsRange(e){return di.equalsRange(this,e)}static equalsRange(e,i){if(!e&&!i){return true}return!!e&&!!i&&e.startLineNumber===i.startLineNumber&&e.startColumn===i.startColumn&&e.endLineNumber===i.endLineNumber&&e.endColumn===i.endColumn}getEndPosition(){return di.getEndPosition(this)}static getEndPosition(e){return new $n(e.endLineNumber,e.endColumn)}getStartPosition(){return di.getStartPosition(this)}static getStartPosition(e){return new $n(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,i){return new di(this.startLineNumber,this.startColumn,e,i)}setStartPosition(e,i){return new di(e,i,this.endLineNumber,this.endColumn)}collapseToStart(){return di.collapseToStart(this)}static collapseToStart(e){return new di(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return di.collapseToEnd(this)}static collapseToEnd(e){return new di(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new di(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(e,i=e){return new di(e.lineNumber,e.column,i.lineNumber,i.column)}static lift(e){if(!e){return null}return new di(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)}static isIRange(e){return!!e&&typeof e.startLineNumber==="number"&&typeof e.startColumn==="number"&&typeof e.endLineNumber==="number"&&typeof e.endColumn==="number"}static areIntersectingOrTouching(e,i){if(e.endLineNumber<i.startLineNumber||e.endLineNumber===i.startLineNumber&&e.endColumn<i.startColumn){return false}if(i.endLineNumber<e.startLineNumber||i.endLineNumber===e.startLineNumber&&i.endColumn<e.startColumn){return false}return true}static areIntersecting(e,i){if(e.endLineNumber<i.startLineNumber||e.endLineNumber===i.startLineNumber&&e.endColumn<=i.startColumn){return false}if(i.endLineNumber<e.startLineNumber||i.endLineNumber===e.startLineNumber&&i.endColumn<=e.startColumn){return false}return true}static areOnlyIntersecting(e,i){if(e.endLineNumber<i.startLineNumber-1||e.endLineNumber===i.startLineNumber&&e.endColumn<i.startColumn-1){return false}if(i.endLineNumber<e.startLineNumber-1||i.endLineNumber===e.startLineNumber&&i.endColumn<e.startColumn-1){return false}return true}static compareRangesUsingStarts(e,i){if(e&&i){const r=e.startLineNumber|0;const o=i.startLineNumber|0;if(r===o){const a=e.startColumn|0;const l=i.startColumn|0;if(a===l){const c=e.endLineNumber|0;const u=i.endLineNumber|0;if(c===u){const d=e.endColumn|0;const f=i.endColumn|0;return d-f}return c-u}return a-l}return r-o}const n=e?1:0;const s=i?1:0;return n-s}static compareRangesUsingEnds(e,i){if(e.endLineNumber===i.endLineNumber){if(e.endColumn===i.endColumn){if(e.startLineNumber===i.startLineNumber){return e.startColumn-i.startColumn}return e.startLineNumber-i.startLineNumber}return e.endColumn-i.endColumn}return e.endLineNumber-i.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var d2;(function(t){t[t["Null"]=0]="Null";t[t["PlainText"]=1]="PlainText"})(d2||(d2={}));var h2;(function(t){t[t["NotSet"]=-1]="NotSet";t[t["None"]=0]="None";t[t["Italic"]=1]="Italic";t[t["Bold"]=2]="Bold";t[t["Underline"]=4]="Underline";t[t["Strikethrough"]=8]="Strikethrough"})(h2||(h2={}));var Xp;(function(t){t[t["None"]=0]="None";t[t["DefaultForeground"]=1]="DefaultForeground";t[t["DefaultBackground"]=2]="DefaultBackground"})(Xp||(Xp={}));var jl;(function(t){t[t["Other"]=0]="Other";t[t["Comment"]=1]="Comment";t[t["String"]=2]="String";t[t["RegEx"]=3]="RegEx"})(jl||(jl={}));var f2;(function(t){t[t["LANGUAGEID_MASK"]=255]="LANGUAGEID_MASK";t[t["TOKEN_TYPE_MASK"]=768]="TOKEN_TYPE_MASK";t[t["BALANCED_BRACKETS_MASK"]=1024]="BALANCED_BRACKETS_MASK";t[t["FONT_STYLE_MASK"]=30720]="FONT_STYLE_MASK";t[t["FOREGROUND_MASK"]=16744448]="FOREGROUND_MASK";t[t["BACKGROUND_MASK"]=4278190080]="BACKGROUND_MASK";t[t["ITALIC_MASK"]=2048]="ITALIC_MASK";t[t["BOLD_MASK"]=4096]="BOLD_MASK";t[t["UNDERLINE_MASK"]=8192]="UNDERLINE_MASK";t[t["STRIKETHROUGH_MASK"]=16384]="STRIKETHROUGH_MASK";t[t["SEMANTIC_USE_ITALIC"]=1]="SEMANTIC_USE_ITALIC";t[t["SEMANTIC_USE_BOLD"]=2]="SEMANTIC_USE_BOLD";t[t["SEMANTIC_USE_UNDERLINE"]=4]="SEMANTIC_USE_UNDERLINE";t[t["SEMANTIC_USE_STRIKETHROUGH"]=8]="SEMANTIC_USE_STRIKETHROUGH";t[t["SEMANTIC_USE_FOREGROUND"]=16]="SEMANTIC_USE_FOREGROUND";t[t["SEMANTIC_USE_BACKGROUND"]=32]="SEMANTIC_USE_BACKGROUND";t[t["LANGUAGEID_OFFSET"]=0]="LANGUAGEID_OFFSET";t[t["TOKEN_TYPE_OFFSET"]=8]="TOKEN_TYPE_OFFSET";t[t["BALANCED_BRACKETS_OFFSET"]=10]="BALANCED_BRACKETS_OFFSET";t[t["FONT_STYLE_OFFSET"]=11]="FONT_STYLE_OFFSET";t[t["FOREGROUND_OFFSET"]=15]="FOREGROUND_OFFSET";t[t["BACKGROUND_OFFSET"]=24]="BACKGROUND_OFFSET"})(f2||(f2={}));class i9{constructor(){this._tokenizationSupports=new Map;this._factories=new Map;this._onDidChange=new L;this.onDidChange=this._onDidChange.event;this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:false})}register(e,i){this._tokenizationSupports.set(e,i);this.handleChange([e]);return ye(()=>{if(this._tokenizationSupports.get(e)!==i){return}this._tokenizationSupports.delete(e);this.handleChange([e])})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,i){this._factories.get(e)?.dispose();const n=new n9(this,e,i);this._factories.set(e,n);return ye(()=>{const s=this._factories.get(e);if(!s||s!==n){return}this._factories.delete(e);s.dispose()})}async getOrCreate(e){const i=this.get(e);if(i){return i}const n=this._factories.get(e);if(!n||n.isResolved){return null}await n.resolve();return this.get(e)}isResolved(e){const i=this.get(e);if(i){return true}const n=this._factories.get(e);if(!n||n.isResolved){return true}return false}setColorMap(e){this._colorMap=e;this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:true})}getColorMap(){return this._colorMap}getDefaultBackground(){if(this._colorMap&&this._colorMap.length>Xp.DefaultBackground){return this._colorMap[Xp.DefaultBackground]}return null}}class n9 extends me{get isResolved(){return this._isResolved}constructor(e,i,n){super();this._registry=e;this._languageId=i;this._factory=n;this._isDisposed=false;this._resolvePromise=null;this._isResolved=false}dispose(){this._isDisposed=true;super.dispose()}async resolve(){if(!this._resolvePromise){this._resolvePromise=this._create()}return this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=true;if(e&&!this._isDisposed){this._register(this._registry.register(this._languageId,e))}}}var p2;(function(t){t[t["Increase"]=0]="Increase";t[t["Decrease"]=1]="Decrease"})(p2||(p2={}));var F;(function(t){t[t["Method"]=0]="Method";t[t["Function"]=1]="Function";t[t["Constructor"]=2]="Constructor";t[t["Field"]=3]="Field";t[t["Variable"]=4]="Variable";t[t["Class"]=5]="Class";t[t["Struct"]=6]="Struct";t[t["Interface"]=7]="Interface";t[t["Module"]=8]="Module";t[t["Property"]=9]="Property";t[t["Event"]=10]="Event";t[t["Operator"]=11]="Operator";t[t["Unit"]=12]="Unit";t[t["Value"]=13]="Value";t[t["Constant"]=14]="Constant";t[t["Enum"]=15]="Enum";t[t["EnumMember"]=16]="EnumMember";t[t["Keyword"]=17]="Keyword";t[t["Text"]=18]="Text";t[t["Color"]=19]="Color";t[t["File"]=20]="File";t[t["Reference"]=21]="Reference";t[t["Customcolor"]=22]="Customcolor";t[t["Folder"]=23]="Folder";t[t["TypeParameter"]=24]="TypeParameter";t[t["User"]=25]="User";t[t["Issue"]=26]="Issue";t[t["Tool"]=27]="Tool";t[t["Snippet"]=28]="Snippet"})(F||(F={}));var g2;(function(t){const e=new Map;e.set(F.Method,_e.symbolMethod);e.set(F.Function,_e.symbolFunction);e.set(F.Constructor,_e.symbolConstructor);e.set(F.Field,_e.symbolField);e.set(F.Variable,_e.symbolVariable);e.set(F.Class,_e.symbolClass);e.set(F.Struct,_e.symbolStruct);e.set(F.Interface,_e.symbolInterface);e.set(F.Module,_e.symbolModule);e.set(F.Property,_e.symbolProperty);e.set(F.Event,_e.symbolEvent);e.set(F.Operator,_e.symbolOperator);e.set(F.Unit,_e.symbolUnit);e.set(F.Value,_e.symbolValue);e.set(F.Enum,_e.symbolEnum);e.set(F.Constant,_e.symbolConstant);e.set(F.Enum,_e.symbolEnum);e.set(F.EnumMember,_e.symbolEnumMember);e.set(F.Keyword,_e.symbolKeyword);e.set(F.Snippet,_e.symbolSnippet);e.set(F.Text,_e.symbolText);e.set(F.Color,_e.symbolColor);e.set(F.File,_e.symbolFile);e.set(F.Reference,_e.symbolReference);e.set(F.Customcolor,_e.symbolCustomColor);e.set(F.Folder,_e.symbolFolder);e.set(F.TypeParameter,_e.symbolTypeParameter);e.set(F.User,_e.account);e.set(F.Issue,_e.issues);e.set(F.Tool,_e.tools);function i(o){let a=e.get(o);if(!a){console.info("No codicon found for CompletionItemKind "+o);a=_e.symbolProperty}return a}t.toIcon=i;function n(o){switch(o){case F.Method:return h(803,"Method");case F.Function:return h(804,"Function");case F.Constructor:return h(805,"Constructor");case F.Field:return h(806,"Field");case F.Variable:return h(807,"Variable");case F.Class:return h(808,"Class");case F.Struct:return h(809,"Struct");case F.Interface:return h(810,"Interface");case F.Module:return h(811,"Module");case F.Property:return h(812,"Property");case F.Event:return h(813,"Event");case F.Operator:return h(814,"Operator");case F.Unit:return h(815,"Unit");case F.Value:return h(816,"Value");case F.Constant:return h(817,"Constant");case F.Enum:return h(818,"Enum");case F.EnumMember:return h(819,"Enum Member");case F.Keyword:return h(820,"Keyword");case F.Text:return h(821,"Text");case F.Color:return h(822,"Color");case F.File:return h(823,"File");case F.Reference:return h(824,"Reference");case F.Customcolor:return h(825,"Custom Color");case F.Folder:return h(826,"Folder");case F.TypeParameter:return h(827,"Type Parameter");case F.User:return h(828,"User");case F.Issue:return h(829,"Issue");case F.Tool:return h(830,"Tool");case F.Snippet:return h(831,"Snippet");default:return""}}t.toLabel=n;const s=new Map;s.set("method",F.Method);s.set("function",F.Function);s.set("constructor",F.Constructor);s.set("field",F.Field);s.set("variable",F.Variable);s.set("class",F.Class);s.set("struct",F.Struct);s.set("interface",F.Interface);s.set("module",F.Module);s.set("property",F.Property);s.set("event",F.Event);s.set("operator",F.Operator);s.set("unit",F.Unit);s.set("value",F.Value);s.set("constant",F.Constant);s.set("enum",F.Enum);s.set("enum-member",F.EnumMember);s.set("enumMember",F.EnumMember);s.set("keyword",F.Keyword);s.set("snippet",F.Snippet);s.set("text",F.Text);s.set("color",F.Color);s.set("file",F.File);s.set("reference",F.Reference);s.set("customcolor",F.Customcolor);s.set("folder",F.Folder);s.set("type-parameter",F.TypeParameter);s.set("typeParameter",F.TypeParameter);s.set("account",F.User);s.set("issue",F.Issue);s.set("tool",F.Tool);function r(o,a){let l=s.get(o);if(typeof l==="undefined"&&!a){l=F.Property}return l}t.fromString=r})(g2||(g2={}));var Zp;(function(t){t[t["Deprecated"]=1]="Deprecated"})(Zp||(Zp={}));var qa;(function(t){t[t["None"]=0]="None";t[t["KeepWhitespace"]=1]="KeepWhitespace";t[t["InsertAsSnippet"]=4]="InsertAsSnippet"})(qa||(qa={}));var vd;(function(t){t[t["Word"]=0]="Word";t[t["Line"]=1]="Line";t[t["Suggest"]=2]="Suggest"})(vd||(vd={}));var wd;(function(t){t[t["Invoke"]=0]="Invoke";t[t["TriggerCharacter"]=1]="TriggerCharacter";t[t["TriggerForIncompleteCompletions"]=2]="TriggerForIncompleteCompletions"})(wd||(wd={}));var eg;(function(t){t[t["Automatic"]=0]="Automatic";t[t["Explicit"]=1]="Explicit"})(eg||(eg={}));var uc;(function(t){t[t["Code"]=1]="Code";t[t["Label"]=2]="Label"})(uc||(uc={}));var tg;(function(t){t[t["Accepted"]=0]="Accepted";t[t["Rejected"]=1]="Rejected";t[t["Ignored"]=2]="Ignored"})(tg||(tg={}));var ig;(function(t){t[t["Invoke"]=1]="Invoke";t[t["Auto"]=2]="Auto"})(ig||(ig={}));var m2;(function(t){t[t["Automatic"]=0]="Automatic";t[t["PasteAs"]=1]="PasteAs"})(m2||(m2={}));var _2;(function(t){t[t["Invoke"]=1]="Invoke";t[t["TriggerCharacter"]=2]="TriggerCharacter";t[t["ContentChange"]=3]="ContentChange"})(_2||(_2={}));var v2;(function(t){t[t["Text"]=0]="Text";t[t["Read"]=1]="Read";t[t["Write"]=2]="Write"})(v2||(v2={}));function s9(t){return!!t&&b.isUri(t.uri)&&_t.isIRange(t.range)&&(_t.isIRange(t.originSelectionRange)||_t.isIRange(t.targetSelectionRange))}function r9(t){return!!t&&b.isUri(t.uri)&&_t.isIRange(t.range)}var G;(function(t){t[t["File"]=0]="File";t[t["Module"]=1]="Module";t[t["Namespace"]=2]="Namespace";t[t["Package"]=3]="Package";t[t["Class"]=4]="Class";t[t["Method"]=5]="Method";t[t["Property"]=6]="Property";t[t["Field"]=7]="Field";t[t["Constructor"]=8]="Constructor";t[t["Enum"]=9]="Enum";t[t["Interface"]=10]="Interface";t[t["Function"]=11]="Function";t[t["Variable"]=12]="Variable";t[t["Constant"]=13]="Constant";t[t["String"]=14]="String";t[t["Number"]=15]="Number";t[t["Boolean"]=16]="Boolean";t[t["Array"]=17]="Array";t[t["Object"]=18]="Object";t[t["Key"]=19]="Key";t[t["Null"]=20]="Null";t[t["EnumMember"]=21]="EnumMember";t[t["Struct"]=22]="Struct";t[t["Event"]=23]="Event";t[t["Operator"]=24]="Operator";t[t["TypeParameter"]=25]="TypeParameter"})(G||(G={}));({[G.Array]:h(832,"array"),[G.Boolean]:h(833,"boolean"),[G.Class]:h(834,"class"),[G.Constant]:h(835,"constant"),[G.Constructor]:h(836,"constructor"),[G.Enum]:h(837,"enumeration"),[G.EnumMember]:h(838,"enumeration member"),[G.Event]:h(839,"event"),[G.Field]:h(840,"field"),[G.File]:h(841,"file"),[G.Function]:h(842,"function"),[G.Interface]:h(843,"interface"),[G.Key]:h(844,"key"),[G.Method]:h(845,"method"),[G.Module]:h(846,"module"),[G.Namespace]:h(847,"namespace"),[G.Null]:h(848,"null"),[G.Number]:h(849,"number"),[G.Object]:h(850,"object"),[G.Operator]:h(851,"operator"),[G.Package]:h(852,"package"),[G.Property]:h(853,"property"),[G.String]:h(854,"string"),[G.Struct]:h(855,"struct"),[G.TypeParameter]:h(856,"type parameter"),[G.Variable]:h(857,"variable")});var ng;(function(t){t[t["Deprecated"]=1]="Deprecated"})(ng||(ng={}));var G1;(function(t){const e=new Map;e.set(G.File,_e.symbolFile);e.set(G.Module,_e.symbolModule);e.set(G.Namespace,_e.symbolNamespace);e.set(G.Package,_e.symbolPackage);e.set(G.Class,_e.symbolClass);e.set(G.Method,_e.symbolMethod);e.set(G.Property,_e.symbolProperty);e.set(G.Field,_e.symbolField);e.set(G.Constructor,_e.symbolConstructor);e.set(G.Enum,_e.symbolEnum);e.set(G.Interface,_e.symbolInterface);e.set(G.Function,_e.symbolFunction);e.set(G.Variable,_e.symbolVariable);e.set(G.Constant,_e.symbolConstant);e.set(G.String,_e.symbolString);e.set(G.Number,_e.symbolNumber);e.set(G.Boolean,_e.symbolBoolean);e.set(G.Array,_e.symbolArray);e.set(G.Object,_e.symbolObject);e.set(G.Key,_e.symbolKey);e.set(G.Null,_e.symbolNull);e.set(G.EnumMember,_e.symbolEnumMember);e.set(G.Struct,_e.symbolStruct);e.set(G.Event,_e.symbolEvent);e.set(G.Operator,_e.symbolOperator);e.set(G.TypeParameter,_e.symbolTypeParameter);function i(r){let o=e.get(r);if(!o){console.info("No codicon found for SymbolKind "+r);o=_e.symbolProperty}return o}t.toIcon=i;const n=new Map;n.set(G.File,F.File);n.set(G.Module,F.Module);n.set(G.Namespace,F.Module);n.set(G.Package,F.Module);n.set(G.Class,F.Class);n.set(G.Method,F.Method);n.set(G.Property,F.Property);n.set(G.Field,F.Field);n.set(G.Constructor,F.Constructor);n.set(G.Enum,F.Enum);n.set(G.Interface,F.Interface);n.set(G.Function,F.Function);n.set(G.Variable,F.Variable);n.set(G.Constant,F.Constant);n.set(G.String,F.Text);n.set(G.Number,F.Value);n.set(G.Boolean,F.Value);n.set(G.Array,F.Value);n.set(G.Object,F.Value);n.set(G.Key,F.Keyword);n.set(G.Null,F.Value);n.set(G.EnumMember,F.EnumMember);n.set(G.Struct,F.Struct);n.set(G.Event,F.Event);n.set(G.Operator,F.Operator);n.set(G.TypeParameter,F.TypeParameter);function s(r){let o=n.get(r);if(o===void 0){console.info("No completion kind found for SymbolKind "+r);o=F.File}return o}t.toCompletionKind=s})(G1||(G1={}));let Al=class so{static{this.Comment=new so("comment")}static{this.Imports=new so("imports")}static{this.Region=new so("region")}static fromValue(e){switch(e){case"comment":return so.Comment;case"imports":return so.Imports;case"region":return so.Region}return new so(e)}constructor(e){this.value=e}};var w2;(function(t){t[t["AIGenerated"]=1]="AIGenerated"})(w2||(w2={}));var sg;(function(t){t[t["Invoke"]=0]="Invoke";t[t["Automatic"]=1]="Automatic"})(sg||(sg={}));var K1;(function(t){function e(i){if(!i||typeof i!=="object"){return false}return typeof i.id==="string"&&typeof i.title==="string"}t.is=e})(K1||(K1={}));var Gl;(function(t){t[t["Collapsed"]=0]="Collapsed";t[t["Expanded"]=1]="Expanded"})(Gl||(Gl={}));var bd;(function(t){t[t["Unresolved"]=0]="Unresolved";t[t["Resolved"]=1]="Resolved"})(bd||(bd={}));var yd;(function(t){t[t["Current"]=0]="Current";t[t["Outdated"]=1]="Outdated"})(yd||(yd={}));var b2;(function(t){t[t["Editing"]=0]="Editing";t[t["Preview"]=1]="Preview"})(b2||(b2={}));var y2;(function(t){t[t["Published"]=0]="Published";t[t["Draft"]=1]="Draft"})(y2||(y2={}));var S2;(function(t){t[t["Type"]=1]="Type";t[t["Parameter"]=2]="Parameter"})(S2||(S2={}));new i9;var x2;(function(t){t[t["None"]=0]="None";t[t["Option"]=1]="Option";t[t["Default"]=2]="Default";t[t["Preferred"]=3]="Preferred"})(x2||(x2={}));var Q1;(function(t){t[t["Left"]=1]="Left";t[t["Center"]=2]="Center";t[t["Right"]=4]="Right";t[t["Full"]=7]="Full"})(Q1||(Q1={}));var E2;(function(t){t[t["Left"]=1]="Left";t[t["Center"]=2]="Center";t[t["Right"]=3]="Right"})(E2||(E2={}));var C2;(function(t){t[t["Inline"]=1]="Inline";t[t["Gutter"]=2]="Gutter"})(C2||(C2={}));var k2;(function(t){t[t["Normal"]=1]="Normal";t[t["Underlined"]=2]="Underlined"})(k2||(k2={}));var D2;(function(t){t[t["LTR"]=0]="LTR";t[t["RTL"]=1]="RTL"})(D2||(D2={}));var I2;(function(t){t[t["Both"]=0]="Both";t[t["Right"]=1]="Right";t[t["Left"]=2]="Left";t[t["None"]=3]="None"})(I2||(I2={}));var Sr;(function(t){t[t["TextDefined"]=0]="TextDefined";t[t["LF"]=1]="LF";t[t["CRLF"]=2]="CRLF"})(Sr||(Sr={}));var Jd;(function(t){t[t["LF"]=1]="LF";t[t["CRLF"]=2]="CRLF"})(Jd||(Jd={}));var Kl;(function(t){t[t["LF"]=0]="LF";t[t["CRLF"]=1]="CRLF"})(Kl||(Kl={}));class J1{constructor(e,i){this._findMatchBrand=void 0;this.range=e;this.matches=i}}var Ql;(function(t){t[t["AlwaysGrowsWhenTypingAtEdges"]=0]="AlwaysGrowsWhenTypingAtEdges";t[t["NeverGrowsWhenTypingAtEdges"]=1]="NeverGrowsWhenTypingAtEdges";t[t["GrowsOnlyWhenTypingBefore"]=2]="GrowsOnlyWhenTypingBefore";t[t["GrowsOnlyWhenTypingAfter"]=3]="GrowsOnlyWhenTypingAfter"})(Ql||(Ql={}));var T2;(function(t){t[t["Left"]=0]="Left";t[t["Right"]=1]="Right";t[t["None"]=2]="None";t[t["LeftOfInjectedText"]=3]="LeftOfInjectedText";t[t["RightOfInjectedText"]=4]="RightOfInjectedText"})(T2||(T2={}));var rg;(function(t){t[t["FIRST_LINE_DETECTION_LENGTH_LIMIT"]=1e3]="FIRST_LINE_DETECTION_LENGTH_LIMIT"})(rg||(rg={}));class o9{constructor(e,i,n){this.regex=e;this.wordSeparators=i;this.simpleSearch=n}}class a9{constructor(e,i,n){this.reverseEdits=e;this.changes=i;this.trimAutoWhitespaceLineNumbers=n}}var Jl;(function(t){t[t["Unnecessary"]=1]="Unnecessary";t[t["Deprecated"]=2]="Deprecated"})(Jl||(Jl={}));var fn;(function(t){t[t["Hint"]=1]="Hint";t[t["Info"]=2]="Info";t[t["Warning"]=4]="Warning";t[t["Error"]=8]="Error"})(fn||(fn={}));(function(t){function e(l,c){return c-l}t.compare=e;const i=Object.create(null);i[t.Error]=h(1996,"Error");i[t.Warning]=h(1997,"Warning");i[t.Info]=h(1998,"Info");function n(l){return i[l]||""}t.toString=n;const s=Object.create(null);s[t.Error]=h(1999,"Errors");s[t.Warning]=h(2e3,"Warnings");s[t.Info]=h(2001,"Infos");function r(l){return s[l]||""}t.toStringPlural=r;function o(l){switch(l){case gt.Error:return t.Error;case gt.Warning:return t.Warning;case gt.Info:return t.Info;case gt.Ignore:return t.Hint}}t.fromSeverity=o;function a(l){switch(l){case t.Error:return gt.Error;case t.Warning:return gt.Warning;case t.Info:return gt.Info;case t.Hint:return gt.Ignore}}t.toSeverity=a})(fn||(fn={}));var P2;(function(t){const e="";function i(s){return n(s,true)}t.makeKey=i;function n(s,r){const o=[e];if(s.source){o.push(s.source.replace("","\\"))}else{o.push(e)}if(s.code){if(typeof s.code==="string"){o.push(s.code.replace("","\\"))}else{o.push(s.code.value.replace("","\\"))}}else{o.push(e)}if(s.severity!==void 0&&s.severity!==null){o.push(fn.toString(s.severity))}else{o.push(e)}if(s.message&&r){o.push(s.message.replace("","\\"))}else{o.push(e)}if(s.startLineNumber!==void 0&&s.startLineNumber!==null){o.push(s.startLineNumber.toString())}else{o.push(e)}if(s.startColumn!==void 0&&s.startColumn!==null){o.push(s.startColumn.toString())}else{o.push(e)}if(s.endLineNumber!==void 0&&s.endLineNumber!==null){o.push(s.endLineNumber.toString())}else{o.push(e)}if(s.endColumn!==void 0&&s.endColumn!==null){o.push(s.endColumn.toString())}else{o.push(e)}o.push(e);return o.join("")}t.makeKeyOptionalMessage=n})(P2||(P2={}));const l9=te("progressService");te("editorProgressService");var Sd;(function(t){t[t["Explorer"]=1]="Explorer";t[t["Scm"]=3]="Scm";t[t["Extensions"]=5]="Extensions";t[t["Window"]=10]="Window";t[t["Notification"]=15]="Notification";t[t["Dialog"]=20]="Dialog"})(Sd||(Sd={}));class BS{static{this.None=Object.freeze({report(){}})}get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e;this.callback(this._value)}}let A2=class IW extends me{constructor(e,i){super();this.deferred=new Bn;i.withProgress(e,n=>{this.reporter=n;if(this.lastStep){n.report(this.lastStep)}return this.deferred.p});this._register(ye(()=>this.deferred.complete()))}report(e){if(this.reporter){this.reporter.report(e)}else{this.lastStep=e}}};A2=W([P(1,l9)],A2);class c9{constructor(){this.data=new Map}add(e,i){tn(Xe(e));tn(Gt(i));tn(!this.data.has(e),"There is already an extension with this id");this.data.set(e,i)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}dispose(){this.data.forEach(e=>{if($T(e.dispose)){e.dispose()}});this.data.clear()}}const ei=new c9;function Hv(t,e){if(e&&(t.stack||t.stacktrace)){return h(110,"{0}: {1}",L2(t),R2(t.stack)||R2(t.stacktrace))}return L2(t)}function R2(t){if(Array.isArray(t)){return t.join("\n")}return t}function L2(t){if(t.code==="ERR_UNC_HOST_NOT_ALLOWED"){return`${t.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`}if(typeof t.code==="string"&&typeof t.errno==="number"&&typeof t.syscall==="string"){return h(111,"A system error occurred ({0})",t.message)}return t.message||h(112,"An unknown error occurred. Please consult the log for more details.")}function xu(t=null,e=false){if(!t){return h(112,"An unknown error occurred. Please consult the log for more details.")}if(Array.isArray(t)){const i=zt(t);const n=xu(i[0],e);if(i.length>1){return h(113,"{0} ({1} errors in total)",n,i.length)}return n}if(Xe(t)){return t}if(t.detail){const i=t.detail;if(i.error){return Hv(i.error,e)}if(i.exception){return Hv(i.exception,e)}}if(t.stack){return Hv(t,e)}if(t.message){return t.message}return h(112,"An unknown error occurred. Please consult the log for more details.")}class u9 extends me{get onDidChange(){return this._onDidChange.event}constructor(e,i="",n="",s=true,r){super();this._onDidChange=this._register(new L);this._enabled=true;this._id=e;this._label=i;this._cssClass=n;this._enabled=s;this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){if(this._label!==e){this._label=e;this._onDidChange.fire({label:e})}}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){if(this._tooltip!==e){this._tooltip=e;this._onDidChange.fire({tooltip:e})}}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){if(this._cssClass!==e){this._cssClass=e;this._onDidChange.fire({class:e})}}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){if(this._enabled!==e){this._enabled=e;this._onDidChange.fire({enabled:e})}}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){if(this._checked!==e){this._checked=e;this._onDidChange.fire({checked:e})}}async run(e,i){if(this._actionCallback){await this._actionCallback(e)}}}class cP extends u9{static{this.ID="vs.actions.empty"}constructor(){super(cP.ID,h(45,"(empty)"),void 0,false)}}const d9={EditorFactory:"workbench.contributions.editor.inputFactories"};const h9={id:"default",displayName:h(4058,"Text Editor"),providerDisplayName:h(4059,"Built-in")};const f9="workbench.editors.textDiffEditor";const p9="workbench.editors.binaryResourceDiffEditor";var N2;(function(t){t[t["PROGRAMMATIC"]=1]="PROGRAMMATIC";t[t["USER"]=2]="USER";t[t["EDIT"]=3]="EDIT";t[t["NAVIGATION"]=4]="NAVIGATION";t[t["JUMP"]=5]="JUMP"})(N2||(N2={}));var M2;(function(t){t[t["IDENTICAL"]=1]="IDENTICAL";t[t["SIMILAR"]=2]="SIMILAR";t[t["DIFFERENT"]=3]="DIFFERENT"})(M2||(M2={}));function Bv(t,e,i){for(const n of i.visibleEditorPanes){if(n.group.id===e&&t.matches(n.input)){return n.getViewState()}}return void 0}function g9(t){if(Ns(t)){return false}const e=t;return b.isUri(e?.resource)}function Lr(t){if(Ns(t)){return false}const e=t;return e?.original!==void 0&&e.modified!==void 0}function xd(t){if(Ns(t)){return false}const e=t;if(!e){return false}if(e.resources&&!Array.isArray(e.resources)){return false}return!!e.resources||!!e.multiDiffSource}function Da(t){if(Ns(t)){return false}if(Lr(t)){return false}const e=t;return e?.primary!==void 0&&e.secondary!==void 0}function Ia(t){if(Ns(t)){return false}const e=t;return b.isUri(e?.base?.resource)&&b.isUri(e?.input1?.resource)&&b.isUri(e?.input2?.resource)&&b.isUri(e?.result?.resource)}var ii;(function(t){t[t["SHORT"]=0]="SHORT";t[t["MEDIUM"]=1]="MEDIUM";t[t["LONG"]=2]="LONG"})(ii||(ii={}));var Yl;(function(t){t[t["EXPLICIT"]=1]="EXPLICIT";t[t["AUTO"]=2]="AUTO";t[t["FOCUS_CHANGE"]=3]="FOCUS_CHANGE";t[t["WINDOW_CHANGE"]=4]="WINDOW_CHANGE"})(Yl||(Yl={}));var Fn;(function(t){t[t["None"]=0]="None";t[t["Readonly"]=2]="Readonly";t[t["Untitled"]=4]="Untitled";t[t["Singleton"]=8]="Singleton";t[t["RequiresTrust"]=16]="RequiresTrust";t[t["CanSplitInGroup"]=32]="CanSplitInGroup";t[t["ForceDescription"]=64]="ForceDescription";t[t["CanDropIntoEditor"]=128]="CanDropIntoEditor";t[t["MultipleEditors"]=256]="MultipleEditors";t[t["Scratchpad"]=512]="Scratchpad"})(Fn||(Fn={}));class uP extends me{}function Ns(t){return t instanceof uP}function m9(t){const e=t;return b.isUri(e?.preferredResource)}function _9(t){const e=t;return Ns(e?.primary)&&Ns(e?.secondary)}function dP(t){const e=t;return Ns(e?.modified)&&Ns(e?.original)}var O2;(function(t){t[t["UNKNOWN"]=0]="UNKNOWN";t[t["REPLACE"]=1]="REPLACE";t[t["MOVE"]=2]="MOVE";t[t["UNPIN"]=3]="UNPIN"})(O2||(O2={}));var F2;(function(t){t[t["GROUP_ACTIVE"]=0]="GROUP_ACTIVE";t[t["GROUP_INDEX"]=1]="GROUP_INDEX";t[t["GROUP_LABEL"]=2]="GROUP_LABEL";t[t["GROUP_LOCKED"]=3]="GROUP_LOCKED";t[t["EDITORS_SELECTION"]=4]="EDITORS_SELECTION";t[t["EDITOR_OPEN"]=5]="EDITOR_OPEN";t[t["EDITOR_CLOSE"]=6]="EDITOR_CLOSE";t[t["EDITOR_MOVE"]=7]="EDITOR_MOVE";t[t["EDITOR_ACTIVE"]=8]="EDITOR_ACTIVE";t[t["EDITOR_LABEL"]=9]="EDITOR_LABEL";t[t["EDITOR_CAPABILITIES"]=10]="EDITOR_CAPABILITIES";t[t["EDITOR_PIN"]=11]="EDITOR_PIN";t[t["EDITOR_TRANSIENT"]=12]="EDITOR_TRANSIENT";t[t["EDITOR_STICKY"]=13]="EDITOR_STICKY";t[t["EDITOR_DIRTY"]=14]="EDITOR_DIRTY";t[t["EDITOR_WILL_DISPOSE"]=15]="EDITOR_WILL_DISPOSE"})(F2||(F2={}));var lo;(function(t){t[t["PRIMARY"]=1]="PRIMARY";t[t["SECONDARY"]=2]="SECONDARY";t[t["BOTH"]=3]="BOTH";t[t["ANY"]=4]="ANY"})(lo||(lo={}));class v9{getOriginalUri(e,i){if(!e){return void 0}if(Ia(e)){return Y1.getOriginalUri(e.result,i)}if(i?.supportSideBySide){const{primary:s,secondary:r}=this.getSideEditors(e);if(s&&r){if(i?.supportSideBySide===lo.BOTH){return{primary:this.getOriginalUri(s,{filterByScheme:i.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:i.filterByScheme})}}else if(i?.supportSideBySide===lo.ANY){return this.getOriginalUri(s,{filterByScheme:i.filterByScheme})??this.getOriginalUri(r,{filterByScheme:i.filterByScheme})}e=i.supportSideBySide===lo.PRIMARY?s:r}}if(Lr(e)||xd(e)||Da(e)||Ia(e)){return void 0}const n=m9(e)?e.preferredResource:e.resource;if(!n||!i?.filterByScheme){return n}return this.filterUri(n,i.filterByScheme)}getSideEditors(e){if(_9(e)||Da(e)){return{primary:e.primary,secondary:e.secondary}}if(dP(e)||Lr(e)){return{primary:e.modified,secondary:e.original}}return{primary:void 0,secondary:void 0}}getCanonicalUri(e,i){if(!e){return void 0}if(Ia(e)){return Y1.getCanonicalUri(e.result,i)}if(i?.supportSideBySide){const{primary:s,secondary:r}=this.getSideEditors(e);if(s&&r){if(i?.supportSideBySide===lo.BOTH){return{primary:this.getCanonicalUri(s,{filterByScheme:i.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:i.filterByScheme})}}else if(i?.supportSideBySide===lo.ANY){return this.getCanonicalUri(s,{filterByScheme:i.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:i.filterByScheme})}e=i.supportSideBySide===lo.PRIMARY?s:r}}if(Lr(e)||xd(e)||Da(e)||Ia(e)){return void 0}const n=e.resource;if(!n||!i?.filterByScheme){return n}return this.filterUri(n,i.filterByScheme)}filterUri(e,i){if(Array.isArray(i)){if(i.some(n=>e.scheme===n)){return e}}else{if(i===e.scheme){return e}}return void 0}}var U2;(function(t){t[t["UNKNOWN"]=0]="UNKNOWN";t[t["KEYBOARD"]=1]="KEYBOARD";t[t["MOUSE"]=2]="MOUSE"})(U2||(U2={}));const Y1=new v9;var $2;(function(t){t[t["LEFT"]=0]="LEFT";t[t["RIGHT"]=1]="RIGHT"})($2||($2={}));class w9{constructor(){this.editorSerializerConstructors=new Map;this.editorSerializerInstances=new Map}start(e){const i=this.instantiationService=e.get(yl);for(const[n,s]of this.editorSerializerConstructors){this.createEditorSerializer(n,s,i)}this.editorSerializerConstructors.clear()}createEditorSerializer(e,i,n){const s=n.createInstance(i);this.editorSerializerInstances.set(e,s)}registerFileEditorFactory(e){if(this.fileEditorFactory){throw new Error("Can only register one file editor factory.")}this.fileEditorFactory=e}getFileEditorFactory(){return Lc(this.fileEditorFactory)}registerEditorSerializer(e,i){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e)){throw new Error(`A editor serializer with type ID '${e}' was already registered.`)}if(!this.instantiationService){this.editorSerializerConstructors.set(e,i)}else{this.createEditorSerializer(e,i,this.instantiationService)}return ye(()=>{this.editorSerializerConstructors.delete(e);this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e==="string"?e:e.typeId)}}ei.add(d9.EditorFactory,new w9);var H2;(function(t){t[t["MOST_RECENTLY_ACTIVE"]=0]="MOST_RECENTLY_ACTIVE";t[t["SEQUENTIAL"]=1]="SEQUENTIAL"})(H2||(H2={}));var Ed;(function(t){t[t["Failed"]=0]="Failed";t[t["Completed"]=1]="Completed";t[t["InProgress"]=2]="InProgress";t[t["NeedsInput"]=3]="NeedsInput"})(Ed||(Ed={}));const B2="local";var Yd;(function(t){t.scheme=ne.vscodeLocalChatSession;function e(r){const o=vl(ae.wrap(new TextEncoder().encode(r)),false,true);return b.from({scheme:t.scheme,authority:B2,path:"/"+o})}t.forSession=e;function i(r){const o=s(r);return o?.chatSessionType===B2?o.sessionId:void 0}t.parseLocalSessionId=i;function n(r){return!!i(r)}t.isLocalSession=n;function s(r){if(r.scheme!==t.scheme){return void 0}if(!r.authority){return void 0}const o=r.path.split("/");if(o.length!==2){return void 0}const a=r.authority;const l=Oo(o[1]);return{chatSessionType:a,sessionId:new TextDecoder().decode(l.buffer)}}})(Yd||(Yd={}));var W2;(function(t){t[t["NotOmitted"]=0]="NotOmitted";t[t["Partial"]=1]="Partial";t[t["Full"]=2]="Full"})(W2||(W2={}));var X1;(function(t){t.icon=_e.error;function e(r){return{filterUri:r.resource,owner:r.owner,problemMessage:r.message,filterRange:{startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,startColumn:r.startColumn,endColumn:r.endColumn}}}t.fromMarker=e;function i(r){return{id:n(r),name:s(r),icon:t.icon,value:r,kind:"diagnostic",...r}}t.toEntry=i;function n(r){return[r.filterUri,r.owner,r.filterSeverity,r.filterRange?.startLineNumber,r.filterRange?.startColumn].join(":")}t.id=n;function s(r){let o;(function(l){l[l["MaxChars"]=30]="MaxChars";l[l["MaxSpaceLookback"]=10]="MaxSpaceLookback"})(o||(o={}));if(r.problemMessage){if(r.problemMessage.length<30){return r.problemMessage}const l=r.problemMessage.lastIndexOf(" ",30);if(l===-1||l+10<30){return r.problemMessage.substring(0,30)+""}return r.problemMessage.substring(0,l)+""}let a=h(6312,"All Problems");if(r.filterUri){a=h(6313,"Problems in {0}",ts(r.filterUri))}return a}t.label=s})(X1||(X1={}));var Z1;(function(t){function e(s){return b.isUri(s.value)?s.value:r9(s.value)?s.value.uri:void 0}t.toUri=e;function i(s){if(s.value instanceof Uint8Array){const r={...s};r.value={$base64:vl(ae.wrap(s.value))};return r}return s}t.toExport=i;function n(s){if(s&&"values"in s&&Array.isArray(s.values)){return{kind:"generic",id:s.id??"",name:s.name,value:s.values[0]?.value,range:s.range,modelDescription:s.modelDescription,references:s.references}}else{if(s.value&&typeof s.value==="object"&&"$base64"in s.value&&typeof s.value.$base64==="string"){const r={...s};r.value=Oo(s.value.$base64).buffer;return r}return s}}t.fromExport=n})(Z1||(Z1={}));function b9(t){return t.kind==="image"}function ew(t){return t.kind==="promptFile"}function y9(t){return t.kind==="promptText"}var ja;(function(t){t["Instruction"]="vscode.prompt.instructions.root";t["InstructionReference"]="vscode.prompt.instructions";t["PromptFile"]="vscode.prompt.file"})(ja||(ja={}));function Wv(t,e,i,n=false,s){return{id:`${e}__${t.toString()}`,name:`prompt:${ts(t)}`,value:t,kind:"promptFile",modelDescription:"Prompt instructions file",isRoot:e!==ja.InstructionReference,originLabel:i,toolReferences:s,automaticallyAdded:n}}function S9(t,e=false,i){return{id:`vscode.prompt.instructions.text`,name:`prompt:instructionsList`,value:t,kind:"promptText",modelDescription:"Prompt instructions list",automaticallyAdded:e,toolReferences:i}}function x9(t,e){return{kind:"tool",id:t.id,icon:Kt.isThemeIcon(t.icon)?t.icon:void 0,name:t.displayName,value:void 0,range:e}}class tw{constructor(e){this._ids=new Set;this._entries=[];if(e){this.add(...e)}}add(...e){for(const i of e){if(!this._ids.has(i.id)){this._ids.add(i.id);this._entries.push(i)}}}insertFirst(e){if(!this._ids.has(e.id)){this._ids.add(e.id);this._entries.unshift(e)}}remove(e){this._ids.delete(e.id);this._entries=this._entries.filter(i=>i.id!==e.id)}has(e){return this._ids.has(e.id)}asArray(){return this._entries.slice(0)}get length(){return this._entries.length}}te("chatSessionsService");var Xd;(function(t){t["AIDisabled"]="chat.disableAIFeatures";t["AgentEnabled"]="chat.agent.enabled";t["RequestQueueingEnabled"]="chat.requestQueuing.enabled";t["RequestQueueingDefaultAction"]="chat.requestQueuing.defaultAction";t["AgentStatusEnabled"]="chat.agentsControl.enabled";t["EditorAssociations"]="chat.editorAssociations";t["UnifiedAgentsBar"]="chat.unifiedAgentsBar.enabled";t["AgentSessionProjectionEnabled"]="chat.agentSessionProjection.enabled";t["EditModeHidden"]="chat.editMode.hidden";t["AlternativeToolAction"]="chat.alternativeToolAction.enabled";t["Edits2Enabled"]="chat.edits2.enabled";t["ExtensionToolsEnabled"]="chat.extensionTools.enabled";t["RepoInfoEnabled"]="chat.repoInfo.enabled";t["EditRequests"]="chat.editRequests";t["InlineReferencesStyle"]="chat.inlineReferences.style";t["GlobalAutoApprove"]="chat.tools.global.autoApprove";t["AutoApproveEdits"]="chat.tools.edits.autoApprove";t["AutoApprovedUrls"]="chat.tools.urls.autoApprove";t["EligibleForAutoApproval"]="chat.tools.eligibleForAutoApproval";t["EnableMath"]="chat.math.enabled";t["CheckpointsEnabled"]="chat.checkpoints.enabled";t["ThinkingStyle"]="chat.agent.thinkingStyle";t["ThinkingGenerateTitles"]="chat.agent.thinking.generateTitles";t["TerminalToolsInThinking"]="chat.agent.thinking.terminalTools";t["AutoExpandToolFailures"]="chat.tools.autoExpandFailures";t["TodosShowWidget"]="chat.tools.todos.showWidget";t["NotifyWindowOnResponseReceived"]="chat.notifyWindowOnResponseReceived";t["ChatViewSessionsEnabled"]="chat.viewSessions.enabled";t["ChatViewSessionsGrouping"]="chat.viewSessions.grouping";t["ChatViewSessionsOrientation"]="chat.viewSessions.orientation";t["ChatViewProgressBadgeEnabled"]="chat.viewProgressBadge.enabled";t["SubagentToolCustomAgents"]="chat.customAgentInSubagent.enabled";t["ShowCodeBlockProgressAnimation"]="chat.agent.codeBlockProgress";t["RestoreLastPanelSession"]="chat.restoreLastPanelSession";t["ExitAfterDelegation"]="chat.exitAfterDelegation";t["AgentsControlClickBehavior"]="chat.agentsControl.clickBehavior";t["ExplainChangesEnabled"]="chat.editing.explainChanges.enabled"})(Xd||(Xd={}));var Vr;(function(t){t["Ask"]="ask";t["Edit"]="edit";t["Agent"]="agent"})(Vr||(Vr={}));var V2;(function(t){t["Collapsed"]="collapsed";t["CollapsedPreview"]="collapsedPreview";t["FixedScrolling"]="fixedScrolling"})(V2||(V2={}));var z2;(function(t){t["Off"]="off";t["WithThinking"]="withThinking";t["Always"]="always"})(z2||(z2={}));var q2;(function(t){t["Default"]="default";t["Cycle"]="cycle";t["Focus"]="focus"})(q2||(q2={}));var ki;(function(t){t["Chat"]="panel";t["Terminal"]="terminal";t["Notebook"]="notebook";t["EditorInline"]="editor"})(ki||(ki={}));(function(t){function e(i){switch(i){case"panel":return t.Chat;case"terminal":return t.Terminal;case"notebook":return t.Notebook;case"editor":return t.EditorInline}return t.Chat}t.fromRaw=e})(ki||(ki={}));new Set([ne.vscodeChatEditor,ne.walkThrough,ne.vscodeLocalChatSession,ne.vscodeSettings,ne.webviewPanel,ne.vscodeUserData,ne.extension,"ccreq","openai-codex"]);new E("inModelsEditor",false);new E("inModelsSearch",false);function Hu(t,e=nn){if($L(t,e)){return t.charAt(0).toUpperCase()+t.slice(1)}return t}function E9(t,e){return t.replace(/^~($|\/|\\)/,`${e}$1`)}const j2="";const Bu="\\\\";const Wu="~";function C9(t,e=Yn){const i=new Array(t.length);let n=false;for(let s=0;s<t.length;s++){const r=t[s];if(r===""){i[s]=`.${e}`;continue}if(!r){i[s]=r;continue}n=true;let o="";let a=r;if(a.indexOf(Bu)===0){o=a.substr(0,a.indexOf(Bu)+Bu.length);a=a.substr(a.indexOf(Bu)+Bu.length)}else if(a.indexOf(e)===0){o=a.substr(0,a.indexOf(e)+e.length);a=a.substr(a.indexOf(e)+e.length)}else if(a.indexOf(Wu)===0){o=a.substr(0,a.indexOf(Wu)+Wu.length);a=a.substr(a.indexOf(Wu)+Wu.length)}const l=a.split(e);for(let c=1;n&&c<=l.length;c++){for(let u=l.length-c;n&&u>=0;u--){n=false;let d=l.slice(u,u+c).join(e);for(let f=0;!n&&f<t.length;f++){if(f!==s&&t[f]&&t[f].indexOf(d)>-1){const p=u+c===l.length;const m=u>0&&t[f].indexOf(e)>-1?e+d:d;const v=t[f].endsWith(m);n=!p||v}}if(!n){let f="";if(l[0].endsWith(":")||o!==""){if(u===1){u=0;c++;d=l[0]+e+d}if(u>0){f=l[0]+e}f=o+f}if(u>0){f=f+j2+e}f=f+d;if(u+c<l.length){f=f+e+j2}i[s]=f}}}if(n){i[s]=r}}return i}var G2;(function(t){t[t["TEXT"]=0]="TEXT";t[t["VARIABLE"]=1]="VARIABLE";t[t["SEPARATOR"]=2]="SEPARATOR"})(G2||(G2={}));var zs;(function(t){t["SessionStart"]="SessionStart";t["UserPromptSubmit"]="UserPromptSubmit";t["PreToolUse"]="PreToolUse";t["PostToolUse"]="PostToolUse";t["PreCompact"]="PreCompact";t["SubagentStart"]="SubagentStart";t["SubagentStop"]="SubagentStop";t["Stop"]="Stop"})(zs||(zs={}));[{id:zs.SessionStart,label:h(6375,"Session Start"),description:h(6376,"Executed when a new agent session begins.")},{id:zs.UserPromptSubmit,label:h(6377,"User Prompt Submit"),description:h(6378,"Executed when the user submits a prompt to the agent.")},{id:zs.PreToolUse,label:h(6379,"Pre-Tool Use"),description:h(6380,"Executed before the agent uses any tool.")},{id:zs.PostToolUse,label:h(6381,"Post-Tool Use"),description:h(6382,"Executed after a tool completes execution successfully.")},{id:zs.PreCompact,label:h(6383,"Pre-Compact"),description:h(6384,"Executed before the agent compacts the conversation context.")},{id:zs.SubagentStart,label:h(6385,"Subagent Start"),description:h(6386,"Executed when a subagent is started.")},{id:zs.SubagentStop,label:h(6387,"Subagent Stop"),description:h(6388,"Executed when a subagent stops.")},{id:zs.Stop,label:h(6389,"Stop"),description:h(6390,"Executed when the agent stops.")}];({errorMessage:h(6391,'At least one of "command", "windows", "linux", or "osx" must be specified.'),properties:{type:{description:h(6392,'Must be "command".')},command:{description:h(6393,"The command to execute. This is the default cross-platform command.")},windows:{description:h(6394,'Windows-specific command. If specified and running on Windows, this overrides the "command" field.')},linux:{description:h(6395,'Linux-specific command. If specified and running on Linux, this overrides the "command" field.')},osx:{description:h(6396,'macOS-specific command. If specified and running on macOS, this overrides the "command" field.')},cwd:{description:h(6397,"Working directory for the script (relative to repository root).")},env:{description:h(6398,"Additional environment variables that are merged with the existing environment.")},timeout:{description:h(6399,"Maximum execution time in seconds (default: 30).")}}});({description:h(6400,"GitHub Copilot hook configuration file. Hooks enable executing custom shell commands at strategic points in an agent's workflow."),properties:{hooks:{description:h(6401,"Hook definitions organized by type."),properties:{SessionStart:{description:h(6402,"Executed when a new agent session begins. Use to initialize environments, log session starts, validate project state, or set up temporary resources.")},UserPromptSubmit:{description:h(6403,"Executed when the user submits a prompt to the agent. Use to log user requests for auditing and usage analysis.")},PreToolUse:{description:h(6404,"Executed before the agent uses any tool. This is the most powerful hook as it can approve or deny tool executions. Use to block dangerous commands, enforce security policies, require approval for sensitive operations, or log tool usage.")},PostToolUse:{description:h(6405,"Executed after a tool completes execution successfully. Use to log execution results, track usage statistics, generate audit trails, or monitor performance.")},PreCompact:{description:h(6406,"Executed before the agent compacts the conversation context. Use to save conversation state, export important information, or prepare for context reduction.")},SubagentStart:{description:h(6407,"Executed when a subagent is started. Use to log subagent spawning, track nested agent usage, or initialize subagent-specific resources.")},SubagentStop:{description:h(6408,"Executed when a subagent stops. Use to log subagent completion, cleanup subagent resources, or aggregate subagent results.")},Stop:{description:h(6409,"Executed when the agent session stops. Use to cleanup resources, generate final reports, or send completion notifications.")}}}},defaultSnippets:[{label:h(6410,"Basic hook configuration"),description:h(6411,"A basic hook configuration with common hooks"),body:{hooks:{SessionStart:[{type:"command",command:'${1:echo "Session started" >> session.log}'}],PreToolUse:[{type:"command",command:"${2:./scripts/validate.sh}",timeout:15}]}}}]});function k9(t,e){if(e===Hn.Windows&&t.windows){return t.windows}else if(e===Hn.Macintosh&&t.osx){return t.osx}else if(e===Hn.Linux&&t.linux){return t.linux}return t.command}function Eu(t,e){return t===e}function D9(){return(t,e)=>t===e}function I9(t,e,i){return mn(t,e,i??Eu)}function T9(t){return(e,i)=>mn(e,i,t??Eu)}function Zd(t,e){if(t===e){return true}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length){return false}for(let i=0;i<t.length;i++){if(!Zd(t[i],e[i])){return false}}return true}if(t&&typeof t==="object"&&e&&typeof e==="object"){if(Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const i=t;const n=e;const s=Object.keys(i);const r=Object.keys(n);const o=new Set(r);if(s.length!==r.length){return false}for(const a of s){if(!o.has(a)){return false}if(!Zd(i[a],n[a])){return false}}return true}}return false}function P9(){return(t,e)=>Zd(t,e)}function A9(t,e){return JSON.stringify(t)===JSON.stringify(e)}function R9(){return(t,e)=>JSON.stringify(t)===JSON.stringify(e)}function L9(){return(t,e)=>t.equals(e)}function N9(t,e,i){if(t===void 0||t===null||e===void 0||e===null){return e===t}return i(t,e)}function M9(t){return(e,i)=>{if(e===void 0||e===null||i===void 0||i===null){return i===e}return t(e,i)}}var K2;(function(t){t.strict=Eu;t.strictC=D9;t.array=I9;t.arrayC=T9;t.structural=Zd;t.structuralC=P9;t.jsonStringify=A9;t.jsonStringifyC=R9;t.thisC=L9;t.ifDefined=N9;t.ifDefinedC=M9})(K2||(K2={}));let la;function hP(t){if(!la){la=t}else if(la instanceof Q2){la.loggers.push(t)}else{la=new Q2([la,t])}}function Ii(){return la}let iw=void 0;function O9(t){iw=t}function F9(t){if(iw){iw(t)}}class Q2{constructor(e){this.loggers=e}handleObservableCreated(e,i){for(const n of this.loggers){n.handleObservableCreated(e,i)}}handleOnListenerCountChanged(e,i){for(const n of this.loggers){n.handleOnListenerCountChanged(e,i)}}handleObservableUpdated(e,i){for(const n of this.loggers){n.handleObservableUpdated(e,i)}}handleAutorunCreated(e,i){for(const n of this.loggers){n.handleAutorunCreated(e,i)}}handleAutorunDisposed(e){for(const i of this.loggers){i.handleAutorunDisposed(e)}}handleAutorunDependencyChanged(e,i,n){for(const s of this.loggers){s.handleAutorunDependencyChanged(e,i,n)}}handleAutorunStarted(e){for(const i of this.loggers){i.handleAutorunStarted(e)}}handleAutorunFinished(e){for(const i of this.loggers){i.handleAutorunFinished(e)}}handleDerivedDependencyChanged(e,i,n){for(const s of this.loggers){s.handleDerivedDependencyChanged(e,i,n)}}handleDerivedCleared(e){for(const i of this.loggers){i.handleDerivedCleared(e)}}handleBeginTransaction(e){for(const i of this.loggers){i.handleBeginTransaction(e)}}handleEndTransaction(e){for(const i of this.loggers){i.handleEndTransaction(e)}}}var zr;(function(t){let e=false;function i(){e=true}t.enable=i;function n(){if(!e){return void 0}const s=Error;const r=s.stackTraceLimit;s.stackTraceLimit=3;const o=new Error().stack;s.stackTraceLimit=r;return WS.fromStack(o,2)}t.ofCaller=n})(zr||(zr={}));class WS{static fromStack(e,i){const n=e.split("\n");const s=U9(n[i+1]);if(s){return new WS(s.fileName,s.line,s.column,s.id)}else{return void 0}}constructor(e,i,n,s){this.fileName=e;this.line=i;this.column=n;this.id=s}}function U9(t){const e=t.match(/\((.*):(\d+):(\d+)\)/);if(e){return{fileName:e[1],line:parseInt(e[2]),column:parseInt(e[3]),id:t}}const i=t.match(/at ([^\(\)]*):(\d+):(\d+)/);if(i){return{fileName:i[1],line:parseInt(i[2]),column:parseInt(i[3]),id:t}}return void 0}class U_{constructor(e,i,n){this.owner=e;this.debugNameSource=i;this.referenceFn=n}getDebugName(e){return $9(e,this)}}const J2=new Map;const nw=new WeakMap;function $9(t,e){const i=nw.get(t);if(i){return i}const n=H9(t,e);if(n){let s=J2.get(n)??0;s++;J2.set(n,s);const r=s===1?n:`${n}#${s}`;nw.set(t,r);return r}return void 0}function H9(t,e){const i=nw.get(t);if(i){return i}const n=e.owner?W9(e.owner)+`.`:"";let s;const r=e.debugNameSource;if(r!==void 0){if(typeof r==="function"){s=r();if(s!==void 0){return n+s}}else{return n+r}}const o=e.referenceFn;if(o!==void 0){s=VS(o);if(s!==void 0){return n+s}}if(e.owner!==void 0){const a=B9(e.owner,t);if(a!==void 0){return n+a}}return void 0}function B9(t,e){for(const i in t){if(t[i]===e){return i}}return void 0}const Y2=new Map;const X2=new WeakMap;function W9(t){const e=X2.get(t);if(e){return e}const i=fP(t)??"Object";let n=Y2.get(i)??0;n++;Y2.set(i,n);const s=n===1?i:`${i}#${n}`;X2.set(t,s);return s}function fP(t){const e=t.constructor;if(e){if(e.name==="Object"){return void 0}return e.name}return void 0}function VS(t){const e=t.toString();const i=/\/\*\*\s*@description\s*([^*]*)\*\//;const n=i.exec(e);const s=n?n[1]:void 0;return s?.trim()}let sw;function V9(t){sw=t}let pP;function z9(t){pP=t}let gP;function q9(t){gP=t}let rw;function j9(t){rw=t}class G9{get TChange(){return null}reportChanges(){this.get()}read(e){if(e){return e.readObservable(this)}else{return this.get()}}map(e,i,n=zr.ofCaller()){const s=i===void 0?void 0:e;const r=i===void 0?e:i;return sw({owner:s,debugName:()=>{const o=VS(r);if(o!==void 0){return o}const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/;const l=a.exec(r.toString());if(l){return`${this.debugName}.${l[2]}`}if(!s){return`${this.debugName} (mapped)`}return void 0},debugReferenceFn:r},o=>r(this.read(o),o),n)}flatten(){return sw({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,i){e.add(pP(this,i));return this}keepObserved(e){e.add(gP(this));return this}get debugValue(){return this.get()}get debug(){return new K9(this)}}class K9{constructor(e){this.observable=e}getDependencyGraph(){return rw(this.observable,{type:"dependencies"})}getObserverGraph(){return rw(this.observable,{type:"observers"})}}class zS extends G9{constructor(e){super();this._observers=new Set;Ii()?.handleObservableCreated(this,e)}addObserver(e){const i=this._observers.size;this._observers.add(e);if(i===0){this.onFirstObserverAdded()}if(i!==this._observers.size){Ii()?.handleOnListenerCountChanged(this,this._observers.size)}}removeObserver(e){const i=this._observers.delete(e);if(i&&this._observers.size===0){this.onLastObserverRemoved()}if(i){Ii()?.handleOnListenerCountChanged(this,this._observers.size)}}onFirstObserverAdded(){}onLastObserverRemoved(){}log(){const e=!!Ii();F9(this);if(!e){Ii()?.handleObservableCreated(this,zr.ofCaller())}return this}debugGetObservers(){return this._observers}}var gi;(function(t){t[t["dependenciesMightHaveChanged"]=1]="dependenciesMightHaveChanged";t[t["stale"]=2]="stale";t[t["upToDate"]=3]="upToDate"})(gi||(gi={}));function Q9(t){switch(t){case gi.dependenciesMightHaveChanged:return"dependenciesMightHaveChanged";case gi.stale:return"stale";case gi.upToDate:return"upToDate";default:return"<unknown>"}}class og{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,i,n,s){this._debugNameData=e;this._runFn=i;this._changeTracker=n;this._state=gi.stale;this._updateCount=0;this._disposed=false;this._dependencies=new Set;this._dependenciesToBeRemoved=new Set;this._isRunning=false;this._iteration=0;this._store=void 0;this._delayedStore=void 0;this._changeSummary=this._changeTracker?.createChangeSummary(void 0);Ii()?.handleAutorunCreated(this,s);this._run()}dispose(){if(this._disposed){return}this._disposed=true;for(const e of this._dependencies){e.removeObserver(this)}this._dependencies.clear();if(this._store!==void 0){this._store.dispose()}if(this._delayedStore!==void 0){this._delayedStore.dispose()}Ii()?.handleAutorunDisposed(this)}_run(){const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies;this._dependencies=e;this._state=gi.upToDate;try{if(!this._disposed){Ii()?.handleAutorunStarted(this);const i=this._changeSummary;const n=this._delayedStore;if(n!==void 0){this._delayedStore=void 0}try{this._isRunning=true;if(this._changeTracker){this._changeTracker.beforeUpdate?.(this,i);this._changeSummary=this._changeTracker.createChangeSummary(i)}if(this._store!==void 0){this._store.dispose();this._store=void 0}this._runFn(this,i)}catch(s){od(s)}finally{this._isRunning=false;if(n!==void 0){n.dispose()}}}}finally{if(!this._disposed){Ii()?.handleAutorunFinished(this)}for(const i of this._dependenciesToBeRemoved){i.removeObserver(this)}this._dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){if(this._state===gi.upToDate){this._checkIterations();this._state=gi.dependenciesMightHaveChanged}this._updateCount++}endUpdate(e){try{if(this._updateCount===1){this._iteration=1;do{if(this._checkIterations()){return}if(this._state===gi.dependenciesMightHaveChanged){this._state=gi.upToDate;for(const i of this._dependencies){i.reportChanges();if(this._state===gi.stale){break}}}this._iteration++;if(this._state!==gi.upToDate){this._run()}}while(this._state!==gi.upToDate)}}finally{this._updateCount--}OT(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===gi.upToDate&&this._isDependency(e)){this._checkIterations();this._state=gi.dependenciesMightHaveChanged}}handleChange(e,i){if(this._isDependency(e)){Ii()?.handleAutorunDependencyChanged(this,e,i);try{const n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:i,didChange:s=>s===e},this._changeSummary):true;if(n){this._checkIterations();this._state=gi.stale}}catch(n){od(n)}}}_isDependency(e){return this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)}_ensureNoRunning(){if(!this._isRunning){throw new li("The reader object cannot be used outside its compute function!")}}readObservable(e){this._ensureNoRunning();if(this._disposed){return e.get()}e.addObserver(this);const i=e.get();this._dependencies.add(e);this._dependenciesToBeRemoved.delete(e);return i}get store(){this._ensureNoRunning();if(this._disposed){throw new li("Cannot access store after dispose")}if(this._store===void 0){this._store=new pe}return this._store}get delayedStore(){this._ensureNoRunning();if(this._disposed){throw new li("Cannot access store after dispose")}if(this._delayedStore===void 0){this._delayedStore=new pe}return this._delayedStore}debugGetState(){return{isRunning:this._isRunning,updateCount:this._updateCount,dependencies:this._dependencies,state:this._state,stateStr:Q9(this._state)}}debugRerun(){if(!this._isRunning){this._run()}else{this._state=gi.stale}}_checkIterations(){if(this._iteration>100){od(new li(`Autorun '${this.debugName}' is stuck in an infinite update loop.`));return true}return false}}var Nt;(function(t){t[t["initial"]=0]="initial";t[t["dependenciesMightHaveChanged"]=1]="dependenciesMightHaveChanged";t[t["stale"]=2]="stale";t[t["upToDate"]=3]="upToDate"})(Nt||(Nt={}));function J9(t){switch(t){case Nt.initial:return"initial";case Nt.dependenciesMightHaveChanged:return"dependenciesMightHaveChanged";case Nt.stale:return"stale";case Nt.upToDate:return"upToDate";default:return"<unknown>"}}class ms extends zS{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,i,n,s=void 0,r,o){super(o);this._debugNameData=e;this._computeFn=i;this._changeTracker=n;this._handleLastObserverRemoved=s;this._equalityComparator=r;this._state=Nt.initial;this._value=void 0;this._updateCount=0;this._dependencies=new Set;this._dependenciesToBeRemoved=new Set;this._changeSummary=void 0;this._isUpdating=false;this._isComputing=false;this._didReportChange=false;this._isInBeforeUpdate=false;this._isReaderValid=false;this._store=void 0;this._delayedStore=void 0;this._removedObserverToCallEndUpdateOn=null;this._changeSummary=this._changeTracker?.createChangeSummary(void 0)}onLastObserverRemoved(){this._state=Nt.initial;this._value=void 0;Ii()?.handleDerivedCleared(this);for(const e of this._dependencies){e.removeObserver(this)}this._dependencies.clear();if(this._store!==void 0){this._store.dispose();this._store=void 0}if(this._delayedStore!==void 0){this._delayedStore.dispose();this._delayedStore=void 0}this._handleLastObserverRemoved?.()}get(){if(this._observers.size===0){let e;try{this._isReaderValid=true;let i=void 0;if(this._changeTracker){i=this._changeTracker.createChangeSummary(void 0);this._changeTracker.beforeUpdate?.(this,i)}e=this._computeFn(this,i)}finally{this._isReaderValid=false}this.onLastObserverRemoved();return e}else{do{if(this._state===Nt.dependenciesMightHaveChanged){for(const e of this._dependencies){e.reportChanges();if(this._state===Nt.stale){break}}}if(this._state===Nt.dependenciesMightHaveChanged){this._state=Nt.upToDate}if(this._state!==Nt.upToDate){this._recompute()}}while(this._state!==Nt.upToDate);return this._value}}_recompute(){let e=false;this._isComputing=true;this._didReportChange=false;const i=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies;this._dependencies=i;try{const n=this._changeSummary;this._isReaderValid=true;if(this._changeTracker){this._isInBeforeUpdate=true;this._changeTracker.beforeUpdate?.(this,n);this._isInBeforeUpdate=false;this._changeSummary=this._changeTracker?.createChangeSummary(n)}const s=this._state!==Nt.initial;const r=this._value;this._state=Nt.upToDate;const o=this._delayedStore;if(o!==void 0){this._delayedStore=void 0}try{if(this._store!==void 0){this._store.dispose();this._store=void 0}this._value=this._computeFn(this,n)}finally{this._isReaderValid=false;for(const a of this._dependenciesToBeRemoved){a.removeObserver(this)}this._dependenciesToBeRemoved.clear();if(o!==void 0){o.dispose()}}e=this._didReportChange||s&&!this._equalityComparator(r,this._value);Ii()?.handleObservableUpdated(this,{oldValue:r,newValue:this._value,change:void 0,didChange:e,hadValue:s})}catch(n){od(n)}this._isComputing=false;if(!this._didReportChange&&e){for(const n of this._observers){n.handleChange(this,void 0)}}else{this._didReportChange=false}}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating){throw new li("Cyclic deriveds are not supported yet!")}this._updateCount++;this._isUpdating=true;try{const i=this._updateCount===1;if(this._state===Nt.upToDate){this._state=Nt.dependenciesMightHaveChanged;if(!i){for(const n of this._observers){n.handlePossibleChange(this)}}}if(i){for(const n of this._observers){n.beginUpdate(this)}}}finally{this._isUpdating=false}}endUpdate(e){this._updateCount--;if(this._updateCount===0){const i=[...this._observers];for(const n of i){n.endUpdate(this)}if(this._removedObserverToCallEndUpdateOn){const n=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(const s of n){s.endUpdate(this)}}}OT(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===Nt.upToDate&&this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){this._state=Nt.dependenciesMightHaveChanged;for(const i of this._observers){i.handlePossibleChange(this)}}}handleChange(e,i){if(this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)||this._isInBeforeUpdate){Ii()?.handleDerivedDependencyChanged(this,e,i);let n=false;try{n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:i,didChange:r=>r===e},this._changeSummary):true}catch(r){od(r)}const s=this._state===Nt.upToDate;if(n&&(this._state===Nt.dependenciesMightHaveChanged||s)){this._state=Nt.stale;if(s){for(const r of this._observers){r.handlePossibleChange(this)}}}}}_ensureReaderValid(){if(!this._isReaderValid){throw new li("The reader object cannot be used outside its compute function!")}}readObservable(e){this._ensureReaderValid();e.addObserver(this);const i=e.get();this._dependencies.add(e);this._dependenciesToBeRemoved.delete(e);return i}reportChange(e){this._ensureReaderValid();this._didReportChange=true;for(const i of this._observers){i.handleChange(this,e)}}get store(){this._ensureReaderValid();if(this._store===void 0){this._store=new pe}return this._store}get delayedStore(){this._ensureReaderValid();if(this._delayedStore===void 0){this._delayedStore=new pe}return this._delayedStore}addObserver(e){const i=!this._observers.has(e)&&this._updateCount>0;super.addObserver(e);if(i){if(!this._removedObserverToCallEndUpdateOn?.delete(e)){e.beginUpdate(this)}}}removeObserver(e){if(this._observers.has(e)&&this._updateCount>0){if(!this._removedObserverToCallEndUpdateOn){this._removedObserverToCallEndUpdateOn=new Set}this._removedObserverToCallEndUpdateOn.add(e)}super.removeObserver(e)}debugGetState(){return{state:this._state,stateStr:J9(this._state),updateCount:this._updateCount,isComputing:this._isComputing,dependencies:this._dependencies,value:this._value}}debugSetValue(e){this._value=e}debugRecompute(){this.beginUpdate(this);try{if(!this._isComputing){this._recompute()}else{this._state=Nt.stale}}finally{this.endUpdate(this)}}setValue(e,i,n){this._value=e;const s=this._observers;i.updateObserver(this,this);for(const r of s){r.handleChange(this,n)}}}function mP(t,e,i=zr.ofCaller()){return new ms(new U_(t.owner,t.debugName,t.debugReferenceFn),e,void 0,t.onLastObserverRemoved,t.equalsFn??Eu,i)}V9(mP);function ag(t,e=zr.ofCaller()){return new og(new U_(void 0,void 0,t),t,void 0,e)}function Z2(t){const e=new Error("BugIndicatingErrorRecovery: "+t);Ti(e);console.error("recovered from an error that indicates a bug",e)}function _P(t,e){const i=new vP(t,e);try{t(i)}finally{i.finish()}}function Y9(t,e,i){if(!t){_P(e,i)}else{e(t)}}class vP{constructor(e,i){this._fn=e;this._getDebugName=i;this._updatingObservers=[];Ii()?.handleBeginTransaction(this)}getDebugName(){if(this._getDebugName){return this._getDebugName()}return VS(this._fn)}updateObserver(e,i){if(!this._updatingObservers){Z2("Transaction already finished!");_P(n=>{n.updateObserver(e,i)});return}this._updatingObservers.push({observer:e,observable:i});e.beginUpdate(i)}finish(){const e=this._updatingObservers;if(!e){Z2("transaction.finish() has already been called!");return}for(let i=0;i<e.length;i++){const{observer:n,observable:s}=e[i];n.endUpdate(s)}this._updatingObservers=null;Ii()?.handleEndTransaction(this)}debugGetUpdatingObservers(){return this._updatingObservers}}function X9(t,e,i=zr.ofCaller()){let n;{n=new U_(void 0,t,void 0)}return new lg(n,e,Eu,i)}class lg extends zS{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,i,n,s){super(s);this._debugNameData=e;this._equalityComparator=n;this._value=i;Ii()?.handleObservableUpdated(this,{hadValue:false,newValue:i,change:void 0,didChange:true,oldValue:void 0})}get(){return this._value}set(e,i,n){if(n===void 0&&this._equalityComparator(this._value,e)){return}let s;if(!i){i=s=new vP(()=>{},()=>`Setting ${this.debugName}`)}try{const r=this._value;this._setValue(e);Ii()?.handleObservableUpdated(this,{oldValue:r,newValue:e,change:n,didChange:true,hadValue:true});for(const o of this._observers){i.updateObserver(o,this);o.handleChange(this,n)}}finally{if(s){s.finish()}}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}debugGetState(){return{value:this._value}}debugSetValue(e){this._value=e}}function Cd(...t){let e;let i;let n;let s;if(t.length===2){[i,n]=t}else{[e,i,n,s]=t}return new Eo(new U_(e,void 0,n),i,n,()=>Eo.globalTransaction,Eu,s??zr.ofCaller())}class Eo extends zS{constructor(e,i,n,s,r,o){super(o);this._debugNameData=e;this.event=i;this._getValue=n;this._getTransaction=s;this._equalityComparator=r;this._hasValue=false;this.handleEvent=a=>{const l=this._getValue(a);const c=this._value;const u=!this._hasValue||!this._equalityComparator(c,l);let d=false;if(u){this._value=l;if(this._hasValue){d=true;Y9(this._getTransaction(),f=>{Ii()?.handleObservableUpdated(this,{oldValue:c,newValue:l,change:void 0,didChange:u,hadValue:this._hasValue});for(const p of this._observers){f.updateObserver(p,this);p.handleChange(this,void 0)}},()=>{const f=this.getDebugName();return"Event fired"+(f?`: ${f}`:"")})}this._hasValue=true}if(!d){Ii()?.handleObservableUpdated(this,{oldValue:c,newValue:l,change:void 0,didChange:u,hadValue:this._hasValue})}}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this._subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this._subscription.dispose();this._subscription=void 0;this._hasValue=false;this._value=void 0}get(){if(this._subscription){if(!this._hasValue){this.handleEvent(void 0)}return this._value}else{const e=this._getValue(void 0);return e}}debugSetValue(e){this._value=e}debugGetState(){return{value:this._value,hasValue:this._hasValue}}}(function(t){t.Observer=Eo;function e(i,n){let s=false;if(Eo.globalTransaction===void 0){Eo.globalTransaction=i;s=true}try{n()}finally{if(s){Eo.globalTransaction=void 0}}}t.batchEventsGlobally=e})(Cd||(Cd={}));function Z9(t){const e=new wP(false,void 0);t.addObserver(e);return ye(()=>{t.removeObserver(e)})}q9(Z9);function e3(t,e){const i=new wP(true,e);t.addObserver(i);try{i.beginUpdate(t)}finally{i.endUpdate(t)}return ye(()=>{t.removeObserver(i)})}z9(e3);class wP{constructor(e,i){this._forceRecompute=e;this._handleValue=i;this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){if(this._counter===1&&this._forceRecompute){if(this._handleValue){this._handleValue(e.get())}else{e.reportChanges()}}this._counter--}handlePossibleChange(e){}handleChange(e,i){}}let Af;function t3(t){if(!Af){Af=new i3;hP(Af)}Af.addFilteredObj(t)}class i3{constructor(){this.indentation=0;this.changedObservablesSets=new WeakMap}addFilteredObj(e){if(!this._filteredObjects){this._filteredObjects=new Set}this._filteredObjects.add(e)}_isIncluded(e){return this._filteredObjects?.has(e)??true}textToConsoleArgs(e){return n3([Rl(o3("|  ",this.indentation)),e])}formatInfo(e){if(!e.hadValue){return[Rl(` `),Kn(ks(e.newValue,60),{color:"green"}),Rl(` (initial)`)]}return e.didChange?[Rl(` `),Kn(ks(e.oldValue,70),{color:"red",strikeThrough:true}),Rl(` `),Kn(ks(e.newValue,60),{color:"green"})]:[Rl(` (unchanged)`)]}handleObservableCreated(e){if(e instanceof ms){const i=e;this.changedObservablesSets.set(i,new Set)}}handleOnListenerCountChanged(e,i){}handleObservableUpdated(e,i){if(!this._isIncluded(e)){return}if(e instanceof ms){this._handleDerivedRecomputed(e,i);return}console.log(...this.textToConsoleArgs([Ll("observable value changed"),Kn(e.debugName,{color:"BlueViolet"}),...this.formatInfo(i)]))}formatChanges(e){if(e.size===0){return void 0}return Kn(" (changed deps: "+[...e].map(i=>i.debugName).join(", ")+")",{color:"gray"})}handleDerivedDependencyChanged(e,i,n){if(!this._isIncluded(e)){return}this.changedObservablesSets.get(e)?.add(i)}_handleDerivedRecomputed(e,i){if(!this._isIncluded(e)){return}const n=this.changedObservablesSets.get(e);if(!n){return}console.log(...this.textToConsoleArgs([Ll("derived recomputed"),Kn(e.debugName,{color:"BlueViolet"}),...this.formatInfo(i),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}]));n.clear()}handleDerivedCleared(e){if(!this._isIncluded(e)){return}console.log(...this.textToConsoleArgs([Ll("derived cleared"),Kn(e.debugName,{color:"BlueViolet"})]))}handleFromEventObservableTriggered(e,i){if(!this._isIncluded(e)){return}console.log(...this.textToConsoleArgs([Ll("observable from event triggered"),Kn(e.debugName,{color:"BlueViolet"}),...this.formatInfo(i),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){if(!this._isIncluded(e)){return}this.changedObservablesSets.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,i,n){if(!this._isIncluded(e)){return}this.changedObservablesSets.get(e).add(i)}handleAutorunStarted(e){const i=this.changedObservablesSets.get(e);if(!i){return}if(this._isIncluded(e)){console.log(...this.textToConsoleArgs([Ll("autorun"),Kn(e.debugName,{color:"BlueViolet"}),this.formatChanges(i),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}]))}i.clear();this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let i=e.getDebugName();if(i===void 0){i=""}if(this._isIncluded(e)){console.log(...this.textToConsoleArgs([Ll("transaction"),Kn(i,{color:"BlueViolet"}),{data:[{fn:e._fn}]}]))}this.indentation++}handleEndTransaction(){this.indentation--}}function n3(t){const e=new Array;const i=[];let n="";function s(o){if("length"in o){for(const a of o){if(a){s(a)}}}else if("text"in o){n+=`%c${o.text}`;e.push(o.style);if(o.data){i.push(...o.data)}}else if("data"in o){i.push(...o.data)}}s(t);const r=[n,...e];r.push(...i);return r}function Rl(t){return Kn(t,{color:"black"})}function Ll(t){return Kn(a3(`${t}: `,10),{color:"black",bold:true})}function Kn(t,e={color:"black"}){function i(s){return Object.entries(s).reduce((r,[o,a])=>{return`${r}${o}:${a};`},"")}const n={color:e.color};if(e.strikeThrough){n["text-decoration"]="line-through"}if(e.bold){n["font-weight"]="bold"}return{text:t,style:i(n)}}function ks(t,e){switch(typeof t){case"number":return""+t;case"string":if(t.length+2<=e){return`"${t}"`}return`"${t.substr(0,e-7)}"+...`;case"boolean":return t?"true":"false";case"undefined":return"undefined";case"object":if(t===null){return"null"}if(Array.isArray(t)){return s3(t,e)}return r3(t,e);case"symbol":return t.toString();case"function":return`[[Function${t.name?" "+t.name:""}]]`;default:return""+t}}function s3(t,e){let i="[ ";let n=true;for(const s of t){if(!n){i+=", "}if(i.length-5>e){i+="...";break}n=false;i+=`${ks(s,e-i.length)}`}i+=" ]";return i}function r3(t,e){if(typeof t.toString==="function"&&t.toString!==Object.prototype.toString){const r=t.toString();if(r.length<=e){return r}return r.substring(0,e-3)+"..."}const i=fP(t);let n=i?i+"(":"{ ";let s=true;for(const[r,o]of Object.entries(t)){if(!s){n+=", "}if(n.length-5>e){n+="...";break}s=false;n+=`${r}: ${ks(o,e-n.length)}`}n+=i?")":" }";return n}function o3(t,e){let i="";for(let n=1;n<=e;n++){i+=t}return i}function a3(t,e){while(t.length<e){t+=" "}return t}class cg{static createHost(e,i){return new cg(e,i)}static createClient(e,i){return new cg(e,i)}constructor(e,i){this._channelFactory=e;this._getHandler=i;this._channel=this._channelFactory({handleNotification:r=>{const o=r;const a=this._getHandler().notifications[o[0]];if(!a){throw new Error(`Unknown notification "${o[0]}"!`)}a(...o[1])},handleRequest:r=>{const o=r;try{const a=this._getHandler().requests[o[0]](...o[1]);return{type:"result",value:a}}catch(a){return{type:"error",value:a}}}});const n=new Proxy({},{get:(r,o)=>{return async(...a)=>{const l=await this._channel.sendRequest([o,a]);if(l.type==="error"){throw l.value}else{return l.value}}}});const s=new Proxy({},{get:(r,o)=>{return(...a)=>{this._channel.sendNotification([o,a])}}});this.api={notifications:s,requests:n}}}function l3(t,e){const i=globalThis;let n=[];let s=void 0;const{channel:r,handler:o}=c3({sendNotification:l=>{if(s){s.sendNotification(l)}else{n.push(l)}}});let a=void 0;(i.$$debugValueEditor_debugChannels??(i.$$debugValueEditor_debugChannels={}))[t]=l=>{a=e();s=l;for(const c of n){l.sendNotification(c)}n=[];return o};return cg.createClient(r,()=>{if(!a){throw new Error("Not supported")}return a})}function c3(t){let e;const i=n=>{e=n;return{sendNotification:s=>{t.sendNotification(s)},sendRequest:s=>{throw new Error("not supported")}}};return{channel:i,handler:{handleRequest:n=>{if(n.type==="notification"){return e?.handleNotification(n.data)}else{return e?.handleRequest(n.data)}}}}}class u3{constructor(){this._timeout=void 0}throttle(e,i){if(this._timeout===void 0){this._timeout=setTimeout(()=>{this._timeout=void 0;e()},i)}}dispose(){if(this._timeout!==void 0){clearTimeout(this._timeout)}}}function bP(t,e){for(const i in e){if(!!t[i]&&typeof t[i]==="object"&&!!e[i]&&typeof e[i]==="object"){bP(t[i],e[i])}else{t[i]=e[i]}}}function yP(t,e){for(const i in e){if(e[i]===null){delete t[i]}else if(!!t[i]&&typeof t[i]==="object"&&!!e[i]&&typeof e[i]==="object"){yP(t[i],e[i])}else{t[i]=e[i]}}}class Xl{static{this._instance=void 0}static getInstance(){if(Xl._instance===void 0){Xl._instance=new Xl}return Xl._instance}getTransactionState(){const e=[];const i=[...this._activeTransactions];if(i.length===0){return void 0}const n=i.flatMap(r=>r.debugGetUpdatingObservers()??[]).map(r=>r.observer);const s=new Set;while(n.length>0){const r=n.shift();if(s.has(r)){continue}s.add(r);const o=this._getInfo(r,a=>{if(!s.has(a)){n.push(a)}});if(o){e.push(o)}}return{names:i.map(r=>r.getDebugName()??"tx"),affected:e}}_getObservableInfo(e){const i=this._instanceInfos.get(e);if(!i){Ti(new li("No info found"));return void 0}return i}_getAutorunInfo(e){const i=this._instanceInfos.get(e);if(!i){Ti(new li("No info found"));return void 0}return i}_getInfo(e,i){if(e instanceof ms){const n=[...e.debugGetObservers()];for(const l of n){i(l)}const s=this._getObservableInfo(e);if(!s){return}const r=e.debugGetState();const o={name:e.debugName,instanceId:s.instanceId,updateCount:r.updateCount};const a=[...s.changedObservables].map(l=>this._instanceInfos.get(l)?.instanceId).filter(Un);if(r.isComputing){return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:false}}switch(r.state){case Nt.initial:return{...o,type:"observable/derived",state:"noValue"};case Nt.upToDate:return{...o,type:"observable/derived",state:"upToDate"};case Nt.stale:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case Nt.dependenciesMightHaveChanged:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(e instanceof og){const n=this._getAutorunInfo(e);if(!n){return void 0}const s={name:e.debugName,instanceId:n.instanceId,updateCount:n.updateCount};const r=[...n.changedObservables].map(o=>this._instanceInfos.get(o).instanceId);if(e.debugGetState().isRunning){return{...s,type:"autorun",state:"updating",changedDependencies:r}}switch(e.debugGetState().state){case gi.upToDate:return{...s,type:"autorun",state:"upToDate"};case gi.stale:return{...s,type:"autorun",state:"stale",changedDependencies:r};case gi.dependenciesMightHaveChanged:return{...s,type:"autorun",state:"possiblyStale"}}}return void 0}_formatObservable(e){const i=this._getObservableInfo(e);if(!i){return void 0}return{name:e.debugName,instanceId:i.instanceId}}_formatObserver(e){if(e instanceof ms){return{name:e.toString(),instanceId:this._getObservableInfo(e)?.instanceId}}const i=this._getAutorunInfo(e);if(i){return{name:e.toString(),instanceId:i.instanceId}}return void 0}constructor(){this._declarationId=0;this._instanceId=0;this._declarations=new Map;this._instanceInfos=new WeakMap;this._aliveInstances=new Map;this._activeTransactions=new Set;this._channel=l3("observableDevTools",()=>{return{notifications:{setDeclarationIdFilter:e=>{},logObservableValue:e=>{console.log("logObservableValue",e)},flushUpdates:()=>{this._flushUpdates()},resetUpdates:()=>{this._pendingChanges=null;this._channel.api.notifications.handleChange(this._fullState,true)}},requests:{getDeclarations:()=>{const e={};for(const i of this._declarations.values()){e[i.id]=i}return{decls:e}},getSummarizedInstances:()=>{return null},getObservableValueInfo:e=>{const i=this._aliveInstances.get(e);return{observers:[...i.debugGetObservers()].map(n=>this._formatObserver(n)).filter(Un)}},getDerivedInfo:e=>{const i=this._aliveInstances.get(e);return{dependencies:[...i.debugGetState().dependencies].map(n=>this._formatObservable(n)).filter(Un),observers:[...i.debugGetObservers()].map(n=>this._formatObserver(n)).filter(Un)}},getAutorunInfo:e=>{const i=this._aliveInstances.get(e);return{dependencies:[...i.debugGetState().dependencies].map(n=>this._formatObservable(n)).filter(Un)}},getTransactionState:()=>{return this.getTransactionState()},setValue:(e,i)=>{const n=this._aliveInstances.get(e);if(n instanceof ms){n.debugSetValue(i)}else if(n instanceof lg){n.debugSetValue(i)}else if(n instanceof Eo){n.debugSetValue(i)}else{throw new li("Observable is not supported")}const s=[...n.debugGetObservers()];for(const r of s){r.beginUpdate(n)}for(const r of s){r.handleChange(n,void 0)}for(const r of s){r.endUpdate(n)}},getValue:e=>{const i=this._aliveInstances.get(e);if(i instanceof ms){return ks(i.debugGetState().value,200)}else if(i instanceof lg){return ks(i.debugGetState().value,200)}return void 0},logValue:e=>{const i=this._aliveInstances.get(e);if(i&&"get"in i){console.log("Logged Value:",i.get())}else{throw new li("Observable is not supported")}},rerun:e=>{const i=this._aliveInstances.get(e);if(i instanceof ms){i.debugRecompute()}else if(i instanceof og){i.debugRerun()}else{throw new li("Observable is not supported")}}}}});this._pendingChanges=null;this._changeThrottler=new u3;this._fullState={};this._flushUpdates=()=>{if(this._pendingChanges!==null){this._channel.api.notifications.handleChange(this._pendingChanges,false);this._pendingChanges=null}};zr.enable()}_handleChange(e){yP(this._fullState,e);if(this._pendingChanges===null){this._pendingChanges=e}else{bP(this._pendingChanges,e)}this._changeThrottler.throttle(this._flushUpdates,10)}_getDeclarationId(e,i){if(!i){return-1}let n=this._declarations.get(i.id);if(n===void 0){n={id:this._declarationId++,type:e,url:i.fileName,line:i.line,column:i.column};this._declarations.set(i.id,n);this._handleChange({decls:{[n.id]:n}})}return n.id}handleObservableCreated(e,i){const n=this._getDeclarationId("observable/value",i);const s={declarationId:n,instanceId:this._instanceId++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,s)}handleOnListenerCountChanged(e,i){const n=this._getObservableInfo(e);if(!n){return}if(n.listenerCount===0&&i>0){const s=e instanceof ms?"observable/derived":"observable/value";this._aliveInstances.set(n.instanceId,e);this._handleChange({instances:{[n.instanceId]:{instanceId:n.instanceId,declarationId:n.declarationId,formattedValue:n.lastValue,type:s,name:e.debugName}}})}else if(n.listenerCount>0&&i===0){this._handleChange({instances:{[n.instanceId]:null}});this._aliveInstances.delete(n.instanceId)}n.listenerCount=i}handleObservableUpdated(e,i){if(e instanceof ms){this._handleDerivedRecomputed(e,i);return}const n=this._getObservableInfo(e);if(n){if(i.didChange){n.lastValue=ks(i.newValue,30);if(n.listenerCount>0){this._handleChange({instances:{[n.instanceId]:{formattedValue:n.lastValue}}})}}}}handleAutorunCreated(e,i){const n=this._getDeclarationId("autorun",i);const s={declarationId:n,instanceId:this._instanceId++,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,s);this._aliveInstances.set(s.instanceId,e);if(s){this._handleChange({instances:{[s.instanceId]:{instanceId:s.instanceId,declarationId:s.declarationId,runCount:0,type:"autorun",name:e.debugName}}})}}handleAutorunDisposed(e){const i=this._getAutorunInfo(e);if(!i){return}this._handleChange({instances:{[i.instanceId]:null}});this._instanceInfos.delete(e);this._aliveInstances.delete(i.instanceId)}handleAutorunDependencyChanged(e,i,n){const s=this._getAutorunInfo(e);if(!s){return}s.changedObservables.add(i)}handleAutorunStarted(e){}handleAutorunFinished(e){const i=this._getAutorunInfo(e);if(!i){return}i.changedObservables.clear();i.updateCount++;this._handleChange({instances:{[i.instanceId]:{runCount:i.updateCount}}})}handleDerivedDependencyChanged(e,i,n){const s=this._getObservableInfo(e);if(s){s.changedObservables.add(i)}}_handleDerivedRecomputed(e,i){const n=this._getObservableInfo(e);if(!n){return}const s=ks(i.newValue,30);n.updateCount++;n.changedObservables.clear();n.lastValue=s;if(n.listenerCount>0){this._handleChange({instances:{[n.instanceId]:{formattedValue:s,recomputationCount:n.updateCount}}})}}handleDerivedCleared(e){const i=this._getObservableInfo(e);if(!i){return}i.lastValue=void 0;i.changedObservables.clear();if(i.listenerCount>0){this._handleChange({instances:{[i.instanceId]:{formattedValue:void 0}}})}}handleBeginTransaction(e){this._activeTransactions.add(e)}handleEndTransaction(e){this._activeTransactions.delete(e)}}function d3(t,e){const i=e?.debugNamePostProcessor??(r=>r);const n=ys.from(t,i);if(!n){return""}const s=new Set;if(e.type==="observers"){return xP(n,0,s,e).trim()}else{return SP(n,0,s,e).trim()}}function SP(t,e,i,n){const s="		".repeat(e);const r=[];const o=i.has(t.sourceObj);if(o){r.push(`${s}* ${t.type} ${t.name} (already listed)`);return r.join("\n")}i.add(t.sourceObj);r.push(`${s}* ${t.type} ${t.name}:`);r.push(`${s}  value: ${ks(t.value,50)}`);r.push(`${s}  state: ${t.state}`);if(t.dependencies.length>0){r.push(`${s}  dependencies:`);for(const a of t.dependencies){const l=ys.from(a,n.debugNamePostProcessor??(c=>c))??ys.unknown(a);r.push(SP(l,e+1,i,n))}}return r.join("\n")}function xP(t,e,i,n){const s="		".repeat(e);const r=[];const o=i.has(t.sourceObj);if(o){r.push(`${s}* ${t.type} ${t.name} (already listed)`);return r.join("\n")}i.add(t.sourceObj);r.push(`${s}* ${t.type} ${t.name}:`);r.push(`${s}  value: ${ks(t.value,50)}`);r.push(`${s}  state: ${t.state}`);if(t.observers.length>0){r.push(`${s}  observers:`);for(const a of t.observers){const l=ys.from(a,n.debugNamePostProcessor??(c=>c))??ys.unknown(a);r.push(xP(l,e+1,i,n))}}return r.join("\n")}class ys{static from(e,i){if(e instanceof og){const n=e.debugGetState();return new ys(e,i(e.debugName),"autorun",void 0,n.stateStr,Array.from(n.dependencies),[])}else if(e instanceof ms){const n=e.debugGetState();return new ys(e,i(e.debugName),"derived",n.value,n.stateStr,Array.from(n.dependencies),Array.from(e.debugGetObservers()))}else if(e instanceof lg){const n=e.debugGetState();return new ys(e,i(e.debugName),"observableValue",n.value,"upToDate",[],Array.from(e.debugGetObservers()))}else if(e instanceof Eo){const n=e.debugGetState();return new ys(e,i(e.debugName),"fromEvent",n.value,n.hasValue?"upToDate":"initial",[],Array.from(e.debugGetObservers()))}return void 0}static unknown(e){return new ys(e,"(unknown)","unknown",void 0,"unknown",[],[])}constructor(e,i,n,s,r,o,a){this.sourceObj=e;this.name=i;this.type=n;this.value=s;this.state=r;this.dependencies=o;this.observers=a}}j9(d3);O9(t3);if(jd&&jd["VSCODE_DEV_DEBUG_OBSERVABLES"]){hP(Xl.getInstance())}var Bo;(function(t){t.Internal={type:"internal",label:"Built-In"};t.External={type:"external",label:"External"};function e(s){switch(s.type){case"extension":return`extension:${s.extensionId.value}`;case"mcp":return`mcp:${s.collectionId}:${s.definitionId}`;case"user":return`user:${s.file.toString()}`;case"internal":return"internal";case"external":return"external"}}t.toKey=e;function i(s,r){return e(s)===e(r)}t.equals=i;function n(s){if(s.type==="internal"){return{ordinal:1,label:h(6612,"Built-In")}}else if(s.type==="mcp"){return{ordinal:2,label:s.label}}else if(s.type==="user"){return{ordinal:0,label:h(6613,"User Defined")}}else{return{ordinal:3,label:s.label}}}t.classify=n})(Bo||(Bo={}));function h3(t){return typeof t==="object"&&typeof t.sessionId==="string"&&b.isUri(t.sessionResource)}var Bc;(function(t){t["Hidden"]="hidden";t["HiddenAfterComplete"]="hiddenAfterComplete"})(Bc||(Bc={}));function f3(t){return!!t&&t.getTools!==void 0}var eC;(function(t){t.execute="execute";t.edit="edit";t.search="search";t.agent="agent";t.read="read";t.web="web";t.todo="todo"})(eC||(eC={}));var ug;(function(t){t.runSubagent="runSubagent";t.vscode="vscode"})(ug||(ug={}));function Wc(t){return qS(t,0)}function qS(t,e){switch(typeof t){case"object":if(t===null){return Nr(349,e)}else if(Array.isArray(t)){return g3(t,e)}return m3(t,e);case"string":return jS(t,e);case"boolean":return p3(t,e);case"number":return Nr(t,e);case"undefined":return Nr(937,e);default:return Nr(617,e)}}function Nr(t,e){return(e<<5)-e+t|0}function p3(t,e){return Nr(t?433:863,e)}function jS(t,e){e=Nr(149417,e);for(let i=0,n=t.length;i<n;i++){e=Nr(t.charCodeAt(i),e)}return e}function g3(t,e){e=Nr(104579,e);return t.reduce((i,n)=>qS(n,i),e)}function m3(t,e){e=Nr(181387,e);return Object.keys(t).sort().reduce((i,n)=>{i=jS(n,i);return qS(t[n],i)},e)}var tC;(function(t){t[t["BLOCK_SIZE"]=64]="BLOCK_SIZE";t[t["UNICODE_REPLACEMENT"]=65533]="UNICODE_REPLACEMENT"})(tC||(tC={}));const Cu=te("contextKeyService");var ow;(function(t){t[t["Blur"]=1]="Blur";t[t["Gesture"]=2]="Gesture";t[t["Other"]=3]="Other"})(ow||(ow={}));var iC;(function(t){t["QuickPick"]="quickPick";t["InputBox"]="inputBox";t["QuickWidget"]="quickWidget";t["QuickTree"]="quickTree"})(iC||(iC={}));var nC;(function(t){t[t["NONE"]=0]="NONE";t[t["FIRST"]=1]="FIRST";t[t["SECOND"]=2]="SECOND";t[t["LAST"]=3]="LAST"})(nC||(nC={}));var sC;(function(t){t[t["First"]=1]="First";t[t["Second"]=2]="Second";t[t["Last"]=3]="Last";t[t["Next"]=4]="Next";t[t["Previous"]=5]="Previous";t[t["NextPage"]=6]="NextPage";t[t["PreviousPage"]=7]="PreviousPage";t[t["NextSeparator"]=8]="NextSeparator";t[t["PreviousSeparator"]=9]="PreviousSeparator"})(sC||(sC={}));var rC;(function(t){t[t["Title"]=1]="Title";t[t["Inline"]=2]="Inline";t[t["Input"]=3]="Input"})(rC||(rC={}));const _3=te("quickInputService");const v3=te("secretStorageService");var kd;(function(t){t[t["STORAGE_DOES_NOT_EXIST"]=0]="STORAGE_DOES_NOT_EXIST";t[t["STORAGE_IN_MEMORY"]=1]="STORAGE_IN_MEMORY"})(kd||(kd={}));var ls;(function(t){t[t["None"]=0]="None";t[t["Initialized"]=1]="Initialized";t[t["Closed"]=2]="Closed"})(ls||(ls={}));class EP extends me{static{this.DEFAULT_FLUSH_DELAY=100}constructor(e,i=Object.create(null)){super();this.database=e;this.options=i;this._onDidChangeStorage=this._register(new Np);this.onDidChangeStorage=this._onDidChangeStorage.event;this.state=ls.None;this.cache=new Map;this.flushDelayer=this._register(new y4(EP.DEFAULT_FLUSH_DELAY));this.pendingDeletes=new Set;this.pendingInserts=new Map;this.pendingClose=void 0;this.whenFlushedCallbacks=[];this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){this._onDidChangeStorage.pause();try{e.changed?.forEach((i,n)=>this.acceptExternal(n,i));e.deleted?.forEach(i=>this.acceptExternal(i,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,i){if(this.state===ls.Closed){return}let n=false;if(ai(i)){n=this.cache.delete(e)}else{const s=this.cache.get(e);if(s!==i){this.cache.set(e,i);n=true}}if(n){this._onDidChangeStorage.fire({key:e,external:true})}}get items(){return this.cache}get size(){return this.cache.size}async init(){if(this.state!==ls.None){return}this.state=ls.Initialized;if(this.options.hint===kd.STORAGE_DOES_NOT_EXIST){return}this.cache=await this.database.getItems()}get(e,i){const n=this.cache.get(e);if(ai(n)){return i}return n}getBoolean(e,i){const n=this.get(e);if(ai(n)){return i}return n==="true"}getNumber(e,i){const n=this.get(e);if(ai(n)){return i}return parseInt(n,10)}getObject(e,i){const n=this.get(e);if(ai(n)){return i}return X4(n)}async set(e,i,n=false){if(this.state===ls.Closed){return}if(ai(i)){return this.delete(e,n)}const s=Gt(i)||Array.isArray(i)?U7(i):String(i);const r=this.cache.get(e);if(r===s){return}this.cache.set(e,s);this.pendingInserts.set(e,s);this.pendingDeletes.delete(e);this._onDidChangeStorage.fire({key:e,external:n});return this.doFlush()}async delete(e,i=false){if(this.state===ls.Closed){return}const n=this.cache.delete(e);if(!n){return}if(!this.pendingDeletes.has(e)){this.pendingDeletes.add(e)}this.pendingInserts.delete(e);this._onDidChangeStorage.fire({key:e,external:i});return this.doFlush()}async optimize(){if(this.state===ls.Closed){return}await this.flush(0);return this.database.optimize()}async close(){if(!this.pendingClose){this.pendingClose=this.doClose()}return this.pendingClose}async doClose(){this.state=ls.Closed;try{await this.doFlush(0)}catch{}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending){return}const e={insert:this.pendingInserts,delete:this.pendingDeletes};this.pendingDeletes=new Set;this.pendingInserts=new Map;return this.database.updateItems(e).finally(()=>{if(!this.hasPending){while(this.whenFlushedCallbacks.length){this.whenFlushedCallbacks.pop()?.()}}})}async flush(e){if(this.state===ls.Closed||this.pendingClose){return}return this.doFlush(e)}async doFlush(e){if(this.options.hint===kd.STORAGE_IN_MEMORY){return this.flushPending()}return this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(!this.hasPending){return}return new Promise(e=>this.whenFlushedCallbacks.push(e))}isInMemory(){return this.options.hint===kd.STORAGE_IN_MEMORY}}const CP=te("environmentService");const $_=te("fileService");const kP=te("IUriIdentityService");var oC;(function(t){t["Settings"]="settings";t["Keybindings"]="keybindings";t["Snippets"]="snippets";t["Prompts"]="prompts";t["Tasks"]="tasks";t["Extensions"]="extensions";t["GlobalState"]="globalState";t["Mcp"]="mcp"})(oC||(oC={}));function w3(t){const e=t;return!!(e&&typeof e==="object"&&typeof e.id==="string"&&typeof e.isDefault==="boolean"&&typeof e.name==="string"&&b.isUri(e.location)&&b.isUri(e.globalStorageHome)&&b.isUri(e.settingsResource)&&b.isUri(e.keybindingsResource)&&b.isUri(e.tasksResource)&&b.isUri(e.snippetsHome)&&b.isUri(e.promptsHome)&&b.isUri(e.extensionsResource)&&b.isUri(e.mcpResource))}function Rf(t,e,i,n,s,r){return{id:t,name:e,location:i,isDefault:false,icon:s?.icon,globalStorageHome:r&&s?.useDefaultFlags?.globalState?r.globalStorageHome:Mi(i,"globalStorage"),settingsResource:r&&s?.useDefaultFlags?.settings?r.settingsResource:Mi(i,"settings.json"),keybindingsResource:r&&s?.useDefaultFlags?.keybindings?r.keybindingsResource:Mi(i,"keybindings.json"),tasksResource:r&&s?.useDefaultFlags?.tasks?r.tasksResource:Mi(i,"tasks.json"),snippetsHome:r&&s?.useDefaultFlags?.snippets?r.snippetsHome:Mi(i,"snippets"),promptsHome:r&&s?.useDefaultFlags?.prompts?r.promptsHome:Mi(i,"prompts"),extensionsResource:r&&s?.useDefaultFlags?.extensions?r.extensionsResource:Mi(i,"extensions.json"),mcpResource:r&&s?.useDefaultFlags?.mcp?r.mcpResource:Mi(i,"mcp.json"),cacheHome:Mi(n,t),useDefaultFlags:s?.useDefaultFlags,isTransient:s?.transient,workspaces:s?.workspaces}}let aC=class TW extends me{static{this.PROFILES_KEY="userDataProfiles"}static{this.PROFILE_ASSOCIATIONS_KEY="profileAssociations"}get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}constructor(e,i,n,s){super();this.environmentService=e;this.fileService=i;this.uriIdentityService=n;this.logService=s;this._onDidChangeProfiles=this._register(new L);this.onDidChangeProfiles=this._onDidChangeProfiles.event;this._onWillCreateProfile=this._register(new L);this.onWillCreateProfile=this._onWillCreateProfile.event;this._onWillRemoveProfile=this._register(new L);this.onWillRemoveProfile=this._onWillRemoveProfile.event;this._onDidResetWorkspaces=this._register(new L);this.onDidResetWorkspaces=this._onDidResetWorkspaces.event;this.profileCreationPromises=new Map;this.transientProfilesObject={profiles:[],emptyWindows:new Map};this.profilesHome=Mi(this.environmentService.userRoamingDataHome,"profiles");this.profilesCacheHome=Mi(this.environmentService.cacheHome,"CachedProfilesData")}init(){this._profilesObject=void 0}get profilesObject(){if(!this._profilesObject){const e=this.createDefaultProfile();const i=[e];try{for(const s of this.getStoredProfiles()){if(this.isInvalidProfile(s)){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}const r=ts(s.location);i.push(Rf(r,s.name,s.location,this.profilesCacheHome,{icon:s.icon,useDefaultFlags:s.useDefaultFlags},e))}}catch(s){this.logService.error(s)}const n=new Map;if(i.length){try{const s=this.getStoredProfileAssociations();if(s.workspaces){for(const[r,o]of Object.entries(s.workspaces)){const a=b.parse(r);const l=i.find(c=>c.id===o);if(l){const c=l.workspaces?l.workspaces.slice(0):[];c.push(a);l.workspaces=c}}}if(s.emptyWindows){for(const[r,o]of Object.entries(s.emptyWindows)){const a=i.find(l=>l.id===o);if(a){n.set(r,a)}}}}catch(s){this.logService.error(s)}}this._profilesObject={profiles:i,emptyWindows:n}}return this._profilesObject}isInvalidProfile(e){if(!e.name){return true}if(!Xe(e.name)){return true}if(!e.location){return true}if(e.isSystem){return true}if(this.uriIdentityService.extUri.basename(this.uriIdentityService.extUri.dirname(e.location))==="builtin"){return true}return false}createDefaultProfile(){const e=Rf("__default__profile__",h(2456,"Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...e,extensionsResource:this.getDefaultProfileExtensionsLocation()??e.extensionsResource,isDefault:true}}async createTransientProfile(e){const i=`Temp`;const n=new RegExp(`${sl(i)}\\s(\\d+)`);let s=0;for(const o of this.profiles){const a=n.exec(o.name);const l=a?parseInt(a[1]):0;s=l>s?l:s}const r=`${i} ${s+1}`;return this.createProfile(Wc(Pi()).toString(16),r,{transient:true},e)}async createNamedProfile(e,i,n){return this.createProfile(Wc(Pi()).toString(16),e,i,n)}async createProfile(e,i,n,s){const r=await this.doCreateProfile(e,i,n,s);return r}async doCreateProfile(e,i,n,s){if(!Xe(i)||!i){throw new Error("Name of the profile is mandatory and must be of type `string`")}let r=this.profileCreationPromises.get(i);if(!r){r=(async()=>{try{const o=this.profiles.find(u=>u.id===e||!u.isTransient&&!n?.transient&&u.name===i);if(o){throw new Error(`Profile with ${i} name already exists`)}const a=s?this.getWorkspace(s):void 0;if(b.isUri(a)){n={...n,workspaces:[a]}}const l=Rf(e,i,this.uriIdentityService.extUri.joinPath(this.profilesHome,e),this.profilesCacheHome,n,this.defaultProfile);await this.fileService.createFolder(l.location);const c=[];this._onWillCreateProfile.fire({profile:l,join(u){c.push(u)}});await Uc.settled(c);if(a&&!b.isUri(a)){this.updateEmptyWindowAssociation(a,l,!!l.isTransient)}this.updateProfiles([l],[],[]);return l}finally{this.profileCreationPromises.delete(i)}})();this.profileCreationPromises.set(i,r)}return r}async updateProfile(e,i){const n=[];for(const r of this.profiles){let o;if(e.id===r.id){if(!r.isDefault){o=Rf(r.id,i.name??r.name,r.location,this.profilesCacheHome,{icon:i.icon===null?void 0:i.icon??r.icon,transient:i.transient??r.isTransient,useDefaultFlags:i.useDefaultFlags??r.useDefaultFlags,workspaces:i.workspaces??r.workspaces},this.defaultProfile)}else if(i.workspaces){o=r;o.workspaces=i.workspaces}}else if(i.workspaces){const a=r.workspaces?.filter(l=>!i.workspaces?.some(c=>this.uriIdentityService.extUri.isEqual(l,c)));if(r.workspaces?.length!==a?.length){o=r;o.workspaces=a}}if(o){n.push(o)}}if(!n.length){if(e.isDefault){throw new Error("Cannot update default profile")}throw new Error(`Profile '${e.name}' does not exist`)}this.updateProfiles([],[],n);const s=this.profiles.find(r=>r.id===e.id);if(!s){throw new Error(`Profile '${e.name}' was not updated`)}return s}async removeProfile(e){if(e.isDefault){throw new Error("Cannot remove default profile")}const i=this.profiles.find(s=>s.id===e.id);if(!i){throw new Error(`Profile '${e.name}' does not exist`)}const n=[];this._onWillRemoveProfile.fire({profile:i,join(s){n.push(s)}});try{await Promise.allSettled(n)}catch(s){this.logService.error(s)}this.updateProfiles([],[i],[]);try{await this.fileService.del(i.cacheHome,{recursive:true})}catch(s){if(R8(s)!==Mn.FILE_NOT_FOUND){this.logService.error(s)}}}async setProfileForWorkspace(e,i){const n=this.profiles.find(r=>r.id===i.id);if(!n){throw new Error(`Profile '${i.name}' does not exist`)}const s=this.getWorkspace(e);if(b.isUri(s)){const r=n.workspaces?[...n.workspaces]:[];if(!r.some(o=>this.uriIdentityService.extUri.isEqual(o,s))){r.push(s);await this.updateProfile(n,{workspaces:r})}}else{this.updateEmptyWindowAssociation(s,n,false);this.updateStoredProfiles(this.profiles)}}unsetWorkspace(e,i=false){const n=this.getWorkspace(e);if(b.isUri(n)){const s=this.getProfileForWorkspace(e);if(s){this.updateProfile(s,{workspaces:s.workspaces?.filter(r=>!this.uriIdentityService.extUri.isEqual(r,n))})}}else{this.updateEmptyWindowAssociation(n,void 0,i);this.updateStoredProfiles(this.profiles)}}async resetWorkspaces(){this.transientProfilesObject.emptyWindows.clear();this.profilesObject.emptyWindows.clear();for(const e of this.profiles){e.workspaces=void 0}this.updateProfiles([],[],this.profiles);this._onDidResetWorkspaces.fire()}async cleanUp(){try{if(await this.fileService.exists(this.profilesHome)){const e=this.uriIdentityService.extUri.joinPath(this.profilesHome,"builtin");if(await this.fileService.exists(e)){try{await this.fileService.del(e,{recursive:true})}catch(n){this.logService.error(n)}}const i=await this.fileService.resolve(this.profilesHome);await Promise.all((i.children||[]).filter(n=>n.isDirectory&&this.profiles.every(s=>!this.uriIdentityService.extUri.isEqual(s.location,n.resource))).map(n=>this.fileService.del(n.resource,{recursive:true})))}}catch(e){this.logService.error("Error deleting redundant profile folders",e)}try{const e=this.getStoredProfiles();const i=[];for(const n of this.getStoredProfiles()){if(this.isInvalidProfile(n)){this.logService.warn(`Invalid user data profile found: ${n.name}`)}else{i.push(n)}}if(e.length!==i.length){this.saveStoredProfiles(i)}}catch(e){this.logService.error("Error removing invalid stored profiles",e)}}async cleanUpTransientProfiles(){const e=this.transientProfilesObject.profiles.filter(i=>!this.isProfileAssociatedToWorkspace(i));await Promise.allSettled(e.map(i=>this.removeProfile(i)))}getProfileForWorkspace(e){const i=this.getWorkspace(e);return b.isUri(i)?this.profiles.find(n=>n.workspaces?.some(s=>this.uriIdentityService.extUri.isEqual(s,i))):this.profilesObject.emptyWindows.get(i)??this.transientProfilesObject.emptyWindows.get(i)}getWorkspace(e){if(N8(e)){return e.uri}if(M8(e)){return e.configPath}return e.id}isProfileAssociatedToWorkspace(e){if(e.workspaces?.length){return true}if([...this.profilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))){return true}if([...this.transientProfilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))){return true}return false}updateProfiles(e,i,n,s=false){const r=[...this.profiles,...e];const o=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];const a=[];for(let l of r){if(i.some(c=>l.id===c.id)){for(const c of[...this.profilesObject.emptyWindows.keys()]){if(l.id===this.profilesObject.emptyWindows.get(c)?.id){this.profilesObject.emptyWindows.delete(c)}}continue}if(!l.isDefault){l=n.find(u=>l.id===u.id)??l;const c=o.find(u=>l.id===u.id);if(l.isTransient){this.transientProfilesObject.profiles.push(l)}else{if(c){for(const[u,d]of this.transientProfilesObject.emptyWindows.entries()){if(l.id===d.id){this.transientProfilesObject.emptyWindows.delete(u);this.profilesObject.emptyWindows.set(u,l);break}}}}}if(l.workspaces?.length===0){l.workspaces=void 0}a.push(l)}this.updateStoredProfiles(a);if(!s){this.triggerProfilesChanges(e,i,n)}}triggerProfilesChanges(e,i,n){this._onDidChangeProfiles.fire({added:e,removed:i,updated:n,all:this.profiles})}updateEmptyWindowAssociation(e,i,n){n=i?.isTransient?true:n;if(n){if(i){this.transientProfilesObject.emptyWindows.set(e,i)}else{this.transientProfilesObject.emptyWindows.delete(e)}}else{this.transientProfilesObject.emptyWindows.delete(e);if(i){this.profilesObject.emptyWindows.set(e,i)}else{this.profilesObject.emptyWindows.delete(e)}}}updateStoredProfiles(e){const i=[];const n={};const s={};for(const r of e){if(r.isTransient){continue}if(!r.isDefault){i.push({location:r.location,name:r.name,icon:r.icon,useDefaultFlags:r.useDefaultFlags})}if(r.workspaces){for(const o of r.workspaces){n[o.toString()]=r.id}}}for(const[r,o]of this.profilesObject.emptyWindows.entries()){s[r.toString()]=o.id}this.saveStoredProfileAssociations({workspaces:n,emptyWindows:s});this.saveStoredProfiles(i);this._profilesObject=void 0}getStoredProfiles(){return[]}saveStoredProfiles(e){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(e){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){return void 0}};aC=W([P(0,CP),P(1,$_),P(2,kP),P(3,et)],aC);const b3="__$__isNewStorageMarker";const op="__$__targetStorageMarker";var Zl;(function(t){t[t["NONE"]=0]="NONE";t[t["SHUTDOWN"]=1]="SHUTDOWN"})(Zl||(Zl={}));var jt;(function(t){t[t["APPLICATION"]=-1]="APPLICATION";t[t["PROFILE"]=0]="PROFILE";t[t["WORKSPACE"]=1]="WORKSPACE"})(jt||(jt={}));var dg;(function(t){t[t["USER"]=0]="USER";t[t["MACHINE"]=1]="MACHINE"})(dg||(dg={}));function y3(t){const e=t.get(op);if(e){try{return JSON.parse(e)}catch(i){}}return Object.create(null)}class DP extends me{static{this.DEFAULT_FLUSH_INTERVAL=60*1e3}constructor(e={flushInterval:DP.DEFAULT_FLUSH_INTERVAL}){super();this._onDidChangeValue=this._register(new Np);this._onDidChangeTarget=this._register(new Np);this.onDidChangeTarget=this._onDidChangeTarget.event;this._onWillSaveState=this._register(new L);this.onWillSaveState=this._onWillSaveState.event;this.runFlushWhenIdle=this._register(new $r);this._workspaceKeyTargets=void 0;this._profileKeyTargets=void 0;this._applicationKeyTargets=void 0;this.flushWhenIdleScheduler=this._register(new wl(()=>this.doFlushWhenIdle(),e.flushInterval))}onDidChangeValue(e,i,n){return wt.filter(this._onDidChangeValue.event,s=>s.scope===e&&(i===void 0||s.key===i),n)}doFlushWhenIdle(){this.runFlushWhenIdle.value=S4(()=>{if(this.shouldFlushWhenIdle()){this.flush()}this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return true}stopFlushWhenIdle(){Jn([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){if(!this.initializationPromise){this.initializationPromise=(async()=>{pn("code/willInitStorage");try{await this.doInitialize()}finally{pn("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()}return this.initializationPromise}emitDidChangeValue(e,i){const{key:n,external:s}=i;if(n===op){switch(e){case jt.APPLICATION:this._applicationKeyTargets=void 0;break;case jt.PROFILE:this._profileKeyTargets=void 0;break;case jt.WORKSPACE:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else{this._onDidChangeValue.fire({scope:e,key:n,target:this.getKeyTargets(e)[n],external:s})}}emitWillSaveState(e){this._onWillSaveState.fire({reason:e})}get(e,i,n){return this.getStorage(i)?.get(e,n)}getBoolean(e,i,n){return this.getStorage(i)?.getBoolean(e,n)}getNumber(e,i,n){return this.getStorage(i)?.getNumber(e,n)}getObject(e,i,n){return this.getStorage(i)?.getObject(e,n)}storeAll(e,i){this.withPausedEmitters(()=>{for(const n of e){this.store(n.key,n.value,n.scope,n.target,i)}})}store(e,i,n,s,r=false){if(ai(i)){this.remove(e,n,r);return}this.withPausedEmitters(()=>{this.updateKeyTarget(e,n,s);this.getStorage(n)?.set(e,i,r)})}remove(e,i,n=false){this.withPausedEmitters(()=>{this.updateKeyTarget(e,i,void 0);this.getStorage(i)?.delete(e,n)})}withPausedEmitters(e){this._onDidChangeValue.pause();this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume();this._onDidChangeTarget.resume()}}keys(e,i){const n=[];const s=this.getKeyTargets(e);for(const r of Object.keys(s)){const o=s[r];if(o===i){n.push(r)}}return n}updateKeyTarget(e,i,n,s=false){const r=this.getKeyTargets(i);if(typeof n==="number"){if(r[e]!==n){r[e]=n;this.getStorage(i)?.set(op,JSON.stringify(r),s)}}else{if(typeof r[e]==="number"){delete r[e];this.getStorage(i)?.set(op,JSON.stringify(r),s)}}}get workspaceKeyTargets(){if(!this._workspaceKeyTargets){this._workspaceKeyTargets=this.loadKeyTargets(jt.WORKSPACE)}return this._workspaceKeyTargets}get profileKeyTargets(){if(!this._profileKeyTargets){this._profileKeyTargets=this.loadKeyTargets(jt.PROFILE)}return this._profileKeyTargets}get applicationKeyTargets(){if(!this._applicationKeyTargets){this._applicationKeyTargets=this.loadKeyTargets(jt.APPLICATION)}return this._applicationKeyTargets}getKeyTargets(e){switch(e){case jt.APPLICATION:return this.applicationKeyTargets;case jt.PROFILE:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const i=this.getStorage(e);return i?y3(i):Object.create(null)}isNew(e){return this.getBoolean(b3,e)===true}async flush(e=Zl.NONE){this._onWillSaveState.fire({reason:e});const i=this.getStorage(jt.APPLICATION);const n=this.getStorage(jt.PROFILE);const s=this.getStorage(jt.WORKSPACE);switch(e){case Zl.NONE:await Uc.settled([i?.whenFlushed()??Promise.resolve(),n?.whenFlushed()??Promise.resolve(),s?.whenFlushed()??Promise.resolve()]);break;case Zl.SHUTDOWN:await Uc.settled([i?.flush(0)??Promise.resolve(),n?.flush(0)??Promise.resolve(),s?.flush(0)??Promise.resolve()]);break}}async log(){const e=this.getStorage(jt.APPLICATION)?.items??new Map;const i=this.getStorage(jt.PROFILE)?.items??new Map;const n=this.getStorage(jt.WORKSPACE)?.items??new Map;return S3(e,i,n,this.getLogDetails(jt.APPLICATION)??"",this.getLogDetails(jt.PROFILE)??"",this.getLogDetails(jt.WORKSPACE)??"")}async optimize(e){await this.flush();return this.getStorage(e)?.optimize()}async switch(e,i){this.emitWillSaveState(Zl.NONE);if(w3(e)){return this.switchToProfile(e,i)}return this.switchToWorkspace(e,i)}canSwitchProfile(e,i){if(e.id===i.id){return false}if(lC(i)&&lC(e)){return false}return true}switchData(e,i,n){this.withPausedEmitters(()=>{const s=new Set;for(const[r,o]of e){s.add(r);const a=i.get(r);if(a!==o){this.emitDidChangeValue(n,{key:r,external:true})}}for(const[r]of i.items){if(!s.has(r)){this.emitDidChangeValue(n,{key:r,external:true})}}})}}function lC(t){return t.isDefault||!!t.useDefaultFlags?.globalState}async function S3(t,e,i,n,s,r){const o=v=>{try{return JSON.parse(v)}catch(y){return v}};const a=new Map;const l=new Map;t.forEach((v,y)=>{a.set(y,v);l.set(y,o(v))});const c=new Map;const u=new Map;e.forEach((v,y)=>{c.set(y,v);u.set(y,o(v))});const d=new Map;const f=new Map;i.forEach((v,y)=>{d.set(y,v);f.set(y,o(v))});if(n!==s){console.group(`Storage: Application (path: ${n})`)}else{console.group(`Storage: Application & Profile (path: ${n}, default profile)`)}const p=[];a.forEach((v,y)=>{p.push({key:y,value:v})});console.table(p);console.groupEnd();console.log(l);if(n!==s){console.group(`Storage: Profile (path: ${s}, profile specific)`);const v=[];c.forEach((y,k)=>{v.push({key:k,value:y})});console.table(v);console.groupEnd();console.log(u)}console.group(`Storage: Workspace (path: ${r})`);const m=[];d.forEach((v,y)=>{m.push({key:y,value:v})});console.table(m);console.groupEnd();console.log(f)}const IP=te("storageService");const x3=te("extensionService");var aw;(function(t){t["Extensions"]="Extensions";t["IntegratedTerminal"]="IntegratedTerminal";t["InteractiveSession"]="InteractiveSession";t["Telemetry"]="Telemetry";t["Update"]="Update"})(aw||(aw={}));var ri;(function(t){t[t["APPLICATION"]=1]="APPLICATION";t[t["USER"]=2]="USER";t[t["USER_LOCAL"]=3]="USER_LOCAL";t[t["USER_REMOTE"]=4]="USER_REMOTE";t[t["WORKSPACE"]=5]="WORKSPACE";t[t["WORKSPACE_FOLDER"]=6]="WORKSPACE_FOLDER";t[t["DEFAULT"]=7]="DEFAULT";t[t["MEMORY"]=8]="MEMORY"})(ri||(ri={}));function lw(t,e){const i=Object.create(null);for(const n in t){TP(i,n,t[n],e)}return i}function TP(t,e,i,n){const s=e.split(".");const r=s.pop();let o=t;for(let a=0;a<s.length;a++){const l=s[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":if(c===null){n(`Ignoring ${e} as ${s.slice(0,a+1).join(".")} is null`);return}break;default:n(`Ignoring ${e} as ${s.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o==="object"&&o!==null){try{o[r]=i}catch(a){n(`Ignoring ${e} as ${s.join(".")} is ${JSON.stringify(o)}`)}}else{n(`Ignoring ${e} as ${s.join(".")} is ${JSON.stringify(o)}`)}}function E3(t,e){const i=e.split(".");PP(t,i)}function PP(t,e){if(!t){return}const i=t;const n=e.shift();if(e.length===0){delete i[n];return}if(Object.keys(i).indexOf(n)!==-1){const s=i[n];if(typeof s==="object"&&!Array.isArray(s)){PP(s,e);if(Object.keys(s).length===0){delete i[n]}}}}function hg(t,e,i){function n(o,a){let l=o;for(const c of a){if(typeof l!=="object"||l===null){return void 0}l=l[c]}return l}const s=e.split(".");const r=n(t,s);return typeof r==="undefined"?i:r}function C3(t){return t.replace(/^\[/,"").replace(/]$/g,"").replace(/\]\[/g,", ")}function k3(t){let e=false;const i=new Map;const n=new Map;const s=u=>{if(t===u){return true}const d=JSON.stringify(u);if(d.length<30){return true}const f=i.get(d);if(!f){const p={schemas:[u]};i.set(d,p);n.set(u,p);return true}f.schemas.push(u);n.set(u,f);e=true;return false};D3(t,s);i.clear();if(!e){return JSON.stringify(t)}let r="$defs";while(t.hasOwnProperty(r)){r+="_"}const o=[];function a(u){return JSON.stringify(u,(d,f)=>{if(f!==u){const p=n.get(f);if(p&&p.schemas.length>1){if(!p.id){p.id=`_${o.length}`;o.push(p.schemas[0])}return{$ref:`#/${r}/${p.id}`}}}return f})}const l=a(t);const c=[];for(let u=0;u<o.length;u++){c.push(`"_${u}":${a(o[u])}`)}if(c.length){return`${l.substring(0,l.length-1)},"${r}":{${c.join(",")}}}`}return l}function Nl(t){return typeof t==="object"&&t!==null}function D3(t,e){if(!t||typeof t!=="object"){return}const i=(...l)=>{for(const c of l){if(Nl(c)){o.push(c)}}};const n=(...l)=>{for(const c of l){if(Nl(c)){for(const u in c){const d=c[u];if(Nl(d)){o.push(d)}}}}};const s=(...l)=>{for(const c of l){if(Array.isArray(c)){for(const u of c){if(Nl(u)){o.push(u)}}}}};const r=l=>{if(Array.isArray(l)){for(const c of l){if(Nl(c)){o.push(c)}}}else if(Nl(l)){o.push(l)}};const o=[t];let a=o.pop();while(a){const l=e(a);if(l){i(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties);n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas);s(a.anyOf,a.allOf,a.oneOf,a.prefixItems);r(a.items)}a=o.pop()}}const H_={JSONContribution:"base.contributions.json"};function cC(t){if(t.length>0&&t.charAt(t.length-1)==="#"){return t.substring(0,t.length-1)}return t}class I3 extends me{constructor(){super(...arguments);this.schemasById={};this.schemaAssociations={};this._onDidChangeSchema=this._register(new L);this.onDidChangeSchema=this._onDidChangeSchema.event;this._onDidChangeSchemaAssociations=this._register(new L);this.onDidChangeSchemaAssociations=this._onDidChangeSchemaAssociations.event}registerSchema(e,i,n){const s=cC(e);this.schemasById[s]=i;this._onDidChangeSchema.fire(e);if(n){n.add(ye(()=>{delete this.schemasById[s];this._onDidChangeSchema.fire(e)}))}}registerSchemaAssociation(e,i){const n=cC(e);if(!this.schemaAssociations[n]){this.schemaAssociations[n]=[]}if(!this.schemaAssociations[n].includes(i)){this.schemaAssociations[n].push(i);this._onDidChangeSchemaAssociations.fire()}return ye(()=>{const s=this.schemaAssociations[n];if(s){const r=s.indexOf(i);if(r!==-1){s.splice(r,1);if(s.length===0){delete this.schemaAssociations[n]}this._onDidChangeSchemaAssociations.fire()}}})}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){const i=this.schemasById[e];return i?k3(i):void 0}hasSchemaContent(e){return!!this.schemasById[e]}getSchemaAssociations(){return this.schemaAssociations}}const T3=new I3;ei.add(H_.JSONContribution,T3);var P3={nameShort:"Code - OSS",nameLong:"Code - OSS",applicationName:"code-oss",dataFolderName:".vscode-oss",win32MutexName:"vscodeoss",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverGreeting:[],serverLicense:[],serverLicensePrompt:"",serverApplicationName:"code-server-oss",serverDataFolderName:".vscode-server-oss",tunnelApplicationName:"code-tunnel-oss",win32DirName:"Microsoft Code OSS",win32NameVersion:"Microsoft Code OSS",win32RegValueName:"CodeOSS",win32x64AppId:"{{D77B7E06-80BA-4137-BCF4-654B95CCEBC5}",win32arm64AppId:"{{D1ACE434-89C5-48D1-88D3-E2991DF85475}",win32x64UserAppId:"{{CC6B787D-37A0-49E8-AE24-8559A032BE0C}",win32arm64UserAppId:"{{3AEBF0C8-F733-4AD4-BADE-FDB816D53D7B}",win32AppUserModelId:"Microsoft.CodeOSS",win32ShellNameShort:"C&ode - OSS",win32TunnelServiceMutex:"vscodeoss-tunnelservice",win32TunnelMutex:"vscodeoss-tunnel",darwinBundleIdentifier:"com.visualstudio.code.oss",darwinProfileUUID:"47827DD9-4734-49A0-AF80-7E19B11495CC",darwinProfilePayloadUUID:"CF808BE7-53F3-46C6-A7E2-7EDB98A5E959",linuxIconName:"code-oss",licenseFileName:"LICENSE.txt",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",nodejsRepository:"https://nodejs.org",urlProtocol:"code-oss",webviewContentExternalBaseUrlTemplate:"https://{{uuid}}.vscode-cdn.net/insider/ef65ac1ba57f57f2a3961bfe94aa20481caca4c6/out/vs/workbench/contrib/webview/browser/pre/",builtInExtensions:[{name:"ms-vscode.js-debug-companion",version:"1.1.3",sha256:"7380a890787452f14b2db7835dfa94de538caf358ebc263f9d46dd68ac52de93",repo:"https://github.com/microsoft/vscode-js-debug-companion",metadata:{id:"99cb0b7f-7354-4278-b8da-6cc79972169d",publisherId:{publisherId:"5f5636e7-69ed-4afe-b5d6-8d231fb3d3ee",publisherName:"ms-vscode",displayName:"Microsoft",flags:"verified"},publisherDisplayName:"Microsoft"}},{name:"ms-vscode.js-debug",version:"1.105.0",sha256:"0c45b90342e8aafd4ff2963b4006de64208ca58c2fd01fea7a710fe61dcfd12a",repo:"https://github.com/microsoft/vscode-js-debug",metadata:{id:"25629058-ddac-4e17-abba-74678e126c5d",publisherId:{publisherId:"5f5636e7-69ed-4afe-b5d6-8d231fb3d3ee",publisherName:"ms-vscode",displayName:"Microsoft",flags:"verified"},publisherDisplayName:"Microsoft"}},{name:"ms-vscode.vscode-js-profile-table",version:"1.0.10",sha256:"7361748ddf9fd09d8a2ed1f2a2d7376a2cf9aae708692820b799708385c38e08",repo:"https://github.com/microsoft/vscode-js-profile-visualizer",metadata:{id:"7e52b41b-71ad-457b-ab7e-0620f1fc4feb",publisherId:{publisherId:"5f5636e7-69ed-4afe-b5d6-8d231fb3d3ee",publisherName:"ms-vscode",displayName:"Microsoft",flags:"verified"},publisherDisplayName:"Microsoft"}}],defaultChatAgent:{extensionId:"GitHub.copilot",chatExtensionId:"GitHub.copilot-chat",chatExtensionOutputId:"GitHub.copilot-chat.GitHub Copilot Chat.log",documentationUrl:"https://aka.ms/github-copilot-overview",termsStatementUrl:"https://aka.ms/github-copilot-terms-statement",privacyStatementUrl:"https://aka.ms/github-copilot-privacy-statement",skusDocumentationUrl:"https://aka.ms/github-copilot-plans",publicCodeMatchesUrl:"https://aka.ms/github-copilot-match-public-code",manageSettingsUrl:"https://aka.ms/github-copilot-settings",managePlanUrl:"https://aka.ms/github-copilot-manage-plan",manageOverageUrl:"https://aka.ms/github-copilot-manage-overage",upgradePlanUrl:"https://aka.ms/github-copilot-upgrade-plan",signUpUrl:"https://aka.ms/github-sign-up",provider:{"default":{id:"github",name:"GitHub"},enterprise:{id:"github-enterprise",name:"GHE.com"},google:{id:"google",name:"Google"},apple:{id:"apple",name:"Apple"}},providerUriSetting:"github-enterprise.uri",providerScopes:[["read:user","user:email","repo","workflow"],["user:email"],["read:user"]],entitlementUrl:"https://api.github.com/copilot_internal/user",entitlementSignupLimitedUrl:"https://api.github.com/copilot_internal/subscribe_limited_user",chatQuotaExceededContext:"github.copilot.chat.quotaExceeded",completionsQuotaExceededContext:"github.copilot.completions.quotaExceeded",walkthroughCommand:"github.copilot.open.walkthrough",completionsMenuCommand:"github.copilot.toggleStatusMenu",completionsRefreshTokenCommand:"github.copilot.signIn",chatRefreshTokenCommand:"github.copilot.refreshToken",generateCommitMessageCommand:"github.copilot.git.generateCommitMessage",resolveMergeConflictsCommand:"github.copilot.git.resolveMergeConflicts",completionsAdvancedSetting:"github.copilot.advanced",completionsEnablementSetting:"github.copilot.enable",nextEditSuggestionsSetting:"github.copilot.nextEditSuggestions.enabled",tokenEntitlementUrl:"https://api.github.com/copilot_internal/v2/token",mcpRegistryDataUrl:"https://api.github.com/copilot/mcp_registry"},trustedExtensionAuthAccess:{github:["GitHub.copilot-chat"],"github-enterprise":["GitHub.copilot-chat"]}};var Mr={...P3,version:"1.109.3",...globalThis._VSCODE_PRODUCT_JSON??{}};var uC;(function(t){t["Multiline"]="multilineText";t["Singleline"]="singlelineText"})(uC||(uC={}));const Yo={Configuration:"base.contributions.configuration"};var At;(function(t){t[t["APPLICATION"]=1]="APPLICATION";t[t["MACHINE"]=2]="MACHINE";t[t["APPLICATION_MACHINE"]=3]="APPLICATION_MACHINE";t[t["WINDOW"]=4]="WINDOW";t[t["RESOURCE"]=5]="RESOURCE";t[t["LANGUAGE_OVERRIDABLE"]=6]="LANGUAGE_OVERRIDABLE";t[t["MACHINE_OVERRIDABLE"]=7]="MACHINE_OVERRIDABLE"})(At||(At={}));const Ml="vscode://schemas/settings/resourceLanguage";const Lf=ei.as(H_.JSONContribution);class A3 extends me{constructor(){super();this.registeredConfigurationDefaults=[];this.overrideIdentifiers=new Set;this._onDidSchemaChange=this._register(new L);this.onDidSchemaChange=this._onDidSchemaChange.event;this._onDidUpdateConfiguration=this._register(new L);this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;this.configurationDefaultsOverrides=new Map;this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h(1767,"Default Language Configuration Overrides"),properties:{}};this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode];this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:true,allowTrailingCommas:true,allowComments:true};this.configurationProperties={};this.policyConfigurations=new Map;this.excludedConfigurationProperties={};Lf.registerSchema(Ml,this.resourceLanguageSettingsSchema);this.registerOverridePropertyPatternKey()}registerConfiguration(e,i=true){this.registerConfigurations([e],i);return e}registerConfigurations(e,i=true){const n=new Set;this.doRegisterConfigurations(e,i,n);Lf.registerSchema(Ml,this.resourceLanguageSettingsSchema);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){const i=new Set;this.doDeregisterConfigurations(e,i);Lf.registerSchema(Ml,this.resourceLanguageSettingsSchema);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:i})}updateConfigurations({add:e,remove:i}){const n=new Set;this.doDeregisterConfigurations(i,n);this.doRegisterConfigurations(e,false,n);Lf.registerSchema(Ml,this.resourceLanguageSettingsSchema);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){const i=new Set;this.doRegisterDefaultConfigurations(e,i);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:true})}doRegisterDefaultConfigurations(e,i){this.registeredConfigurationDefaults.push(...e);const n=[];for(const{overrides:s,source:r}of e){for(const o in s){i.add(o);const a=this.configurationDefaultsOverrides.get(o)??this.configurationDefaultsOverrides.set(o,{configurationDefaultOverrides:[]}).get(o);const l=s[o];a.configurationDefaultOverrides.push({value:l,source:r});if(sr.test(o)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(o,l,r,a.configurationDefaultOverrideValue);if(!c){continue}a.configurationDefaultOverrideValue=c;this.updateDefaultOverrideProperty(o,c,r);n.push(...eh(o))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(o,l,r,a.configurationDefaultOverrideValue);if(!c){continue}a.configurationDefaultOverrideValue=c;const u=this.configurationProperties[o];if(u){this.updatePropertyDefaultValue(o,u);this.updateSchema(o,u)}}}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){const i=new Set;this.doDeregisterDefaultConfigurations(e,i);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:true})}doDeregisterDefaultConfigurations(e,i){for(const n of e){const s=this.registeredConfigurationDefaults.indexOf(n);if(s!==-1){this.registeredConfigurationDefaults.splice(s,1)}}for(const{overrides:n,source:s}of e){for(const r in n){const o=this.configurationDefaultsOverrides.get(r);if(!o){continue}const a=o.configurationDefaultOverrides.findIndex(l=>s?l.source?.id===s.id:l.value===n[r]);if(a===-1){continue}o.configurationDefaultOverrides.splice(a,1);if(o.configurationDefaultOverrides.length===0){this.configurationDefaultsOverrides.delete(r)}if(sr.test(r)){let l;for(const c of o.configurationDefaultOverrides){l=this.mergeDefaultConfigurationsForOverrideIdentifier(r,c.value,c.source,l)}if(l&&!UT(l.value)){o.configurationDefaultOverrideValue=l;this.updateDefaultOverrideProperty(r,l,s)}else{this.configurationDefaultsOverrides.delete(r);delete this.configurationProperties[r];delete this.defaultLanguageConfigurationOverridesNode.properties[r]}}else{let l;for(const u of o.configurationDefaultOverrides){l=this.mergeDefaultConfigurationsForConfigurationProperty(r,u.value,u.source,l)}o.configurationDefaultOverrideValue=l;const c=this.configurationProperties[r];if(c){this.updatePropertyDefaultValue(r,c);this.updateSchema(r,c)}}i.add(r)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,i,n){const s={section:{id:this.defaultLanguageConfigurationOverridesNode.id,title:this.defaultLanguageConfigurationOverridesNode.title,order:this.defaultLanguageConfigurationOverridesNode.order,extensionInfo:this.defaultLanguageConfigurationOverridesNode.extensionInfo},type:"object",default:i.value,description:h(1768,"Configure settings to be overridden for {0}.",C3(e)),$ref:Ml,defaultDefaultValue:i.value,source:n,defaultValueSource:n};this.configurationProperties[e]=s;this.defaultLanguageConfigurationOverridesNode.properties[e]=s}mergeDefaultConfigurationsForOverrideIdentifier(e,i,n,s){const r=s?.value||{};const o=s?.source??new Map;if(!(o instanceof Map)){console.error("objectConfigurationSources is not a Map");return void 0}for(const a of Object.keys(i)){const l=i[a];const c=Gt(l)&&(Yu(r[a])||Gt(r[a]));if(c){r[a]={...r[a]??{},...l};if(n){for(const u in l){o.set(`${a}.${u}`,n)}}}else{r[a]=l;if(n){o.set(a,n)}else{o.delete(a)}}}return{value:r,source:o}}mergeDefaultConfigurationsForConfigurationProperty(e,i,n,s){const r=this.configurationProperties[e];const o=s?.value??r?.defaultDefaultValue;let a=n;const l=Gt(i)&&(r!==void 0&&r.type==="object"||r===void 0&&(Yu(o)||Gt(o)));if(l){a=s?.source??new Map;if(!(a instanceof Map)){console.error("defaultValueSource is not a Map");return void 0}for(const c in i){if(n){a.set(`${e}.${c}`,n)}}i={...Gt(o)?o:{},...i}}return{value:i,source:a}}deltaConfiguration(e){let i=false;const n=new Set;if(e.removedDefaults){this.doDeregisterDefaultConfigurations(e.removedDefaults,n);i=true}if(e.addedDefaults){this.doRegisterDefaultConfigurations(e.addedDefaults,n);i=true}if(e.removedConfigurations){this.doDeregisterConfigurations(e.removedConfigurations,n)}if(e.addedConfigurations){this.doRegisterConfigurations(e.addedConfigurations,false,n)}this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:i})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e);this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const i of e){this.overrideIdentifiers.add(i)}this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,i,n){e.forEach(s=>{this.validateAndRegisterProperties(s,i,s.extensionInfo,s.restrictedProperties,void 0,n);this.configurationContributors.push(s);this.registerJSONConfiguration(s)})}doDeregisterConfigurations(e,i){const n=s=>{if(s.properties){for(const r in s.properties){i.add(r);const o=this.configurationProperties[r];if(o?.policy?.name){this.policyConfigurations.delete(o.policy.name)}delete this.configurationProperties[r];this.removeFromSchema(r,s.properties[r])}}s.allOf?.forEach(r=>n(r))};for(const s of e){n(s);const r=this.configurationContributors.indexOf(s);if(r!==-1){this.configurationContributors.splice(r,1)}}}validateAndRegisterProperties(e,i=true,n,s,r=At.WINDOW,o){r=ai(e.scope)?r:e.scope;const a=e.properties;if(a){for(const c in a){const u=a[c];u.section={id:e.id,title:e.title,order:e.order,extensionInfo:e.extensionInfo};if(i&&N3(c,u,n?.id)){delete a[c];continue}u.source=n;u.defaultDefaultValue=a[c].default;this.updatePropertyDefaultValue(c,u);if(sr.test(c)){u.scope=void 0}else{u.scope=ai(u.scope)?r:u.scope;u.restricted=ai(u.restricted)?!!s?.includes(c):u.restricted}if(u.experiment){if(!u.tags?.some(p=>p.toLowerCase()==="onexp")){u.tags=u.tags??[];u.tags.push("onExP")}}else if(u.tags?.some(p=>p.toLowerCase()==="onexp")){console.error(`Invalid tag 'onExP' found for property '${c}'. Please use 'experiment' property instead.`);u.experiment={mode:"startup"}}const d=a[c].hasOwnProperty("included")&&!a[c].included;const f=a[c].policy?.name;if(d){this.excludedConfigurationProperties[c]=a[c];if(f){this.policyConfigurations.set(f,c);o.add(c)}delete a[c]}else{o.add(c);if(f){this.policyConfigurations.set(f,c)}this.configurationProperties[c]=a[c];if(!a[c].deprecationMessage&&a[c].markdownDeprecationMessage){a[c].deprecationMessage=a[c].markdownDeprecationMessage}}}}const l=e.allOf;if(l){for(const c of l){this.validateAndRegisterProperties(c,i,n,s,r,o)}}}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){const e=new Map;for(const[i,n]of this.configurationDefaultsOverrides){if(n.configurationDefaultOverrideValue){e.set(i,n.configurationDefaultOverrideValue)}}return e}registerJSONConfiguration(e){const i=n=>{const s=n.properties;if(s){for(const o in s){this.updateSchema(o,s[o])}}const r=n.allOf;r?.forEach(i)};i(e)}updateSchema(e,i){switch(i.scope){case At.APPLICATION:break;case At.MACHINE:break;case At.APPLICATION_MACHINE:break;case At.MACHINE_OVERRIDABLE:break;case At.WINDOW:break;case At.RESOURCE:break;case At.LANGUAGE_OVERRIDABLE:this.resourceLanguageSettingsSchema.properties[e]=i;break}}removeFromSchema(e,i){switch(i.scope){case At.APPLICATION:break;case At.MACHINE:break;case At.APPLICATION_MACHINE:break;case At.MACHINE_OVERRIDABLE:break;case At.WINDOW:break;case At.RESOURCE:case At.LANGUAGE_OVERRIDABLE:delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const i=`[${e}]`;const n={type:"object",description:h(1769,"Configure editor settings to be overridden for a language."),errorMessage:h(1770,"This setting does not support per-language configuration."),$ref:Ml};this.updatePropertyDefaultValue(i,n)}}registerOverridePropertyPatternKey(){({description:h(1769,"Configure editor settings to be overridden for a language."),errorMessage:h(1770,"This setting does not support per-language configuration.")});this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,i){const n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue;let s=void 0;let r=void 0;if(n&&(!i.disallowConfigurationDefault||!n.source)){s=n.value;r=n.source}if(Yu(s)){s=i.defaultDefaultValue;r=void 0}if(Yu(s)){s=L3(i.type)}i.default=s;i.defaultValueSource=r}}const AP=`\\[([^\\]]+)\\]`;const dC=new RegExp(AP,"g");const R3=`^(${AP})+$`;const sr=new RegExp(R3);function eh(t){const e=[];if(sr.test(t)){let i=dC.exec(t);while(i?.length){const n=i[1].trim();if(n){e.push(n)}i=dC.exec(t)}}return Ea(e)}function L3(t){const e=Array.isArray(t)?t[0]:t;switch(e){case"boolean":return false;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const ap=new A3;ei.add(Yo.Configuration,ap);function N3(t,e,i){if(!t.trim()){return h(1771,"Cannot register an empty property")}if(sr.test(t)){return h(1772,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",t)}if(ap.getConfigurationProperties()[t]!==void 0&&(!i||!M3.has(i.toLowerCase()))){return h(1773,"Cannot register '{0}'. This property is already registered.",t)}if(e.policy?.name&&ap.getPolicyConfigurations().get(e.policy?.name)!==void 0){return h(1774,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",t,e.policy?.name,ap.getPolicyConfigurations().get(e.policy?.name))}return null}const M3=new Set(Mr.defaultChatAgent?[Mr.defaultChatAgent.extensionId,Mr.defaultChatAgent.chatExtensionId].map(t=>t.toLowerCase()):[]);const Vv="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$";var hC;(function(t){t["COMMAND"]="command";t["SETTINGS_SYNC"]="settingsSync"})(hC||(hC={}));var cw;(function(t){t["NoneOrRelevance"]="NoneOrRelevance";t["LastUpdatedDate"]="LastUpdatedDate";t["Title"]="Title";t["PublisherName"]="PublisherName";t["InstallCount"]="InstallCount";t["PublishedDate"]="PublishedDate";t["AverageRating"]="AverageRating";t["WeightedRating"]="WeightedRating"})(cw||(cw={}));var fC;(function(t){t[t["Default"]=0]="Default";t[t["Ascending"]=1]="Ascending";t[t["Descending"]=2]="Descending"})(fC||(fC={}));var pC;(function(t){t["Category"]="Category";t["ExtensionId"]="ExtensionId";t["ExtensionName"]="ExtensionName";t["ExcludeWithFlags"]="ExcludeWithFlags";t["Featured"]="Featured";t["SearchText"]="SearchText";t["Tag"]="Tag";t["Target"]="Target"})(pC||(pC={}));var gC;(function(t){t["Install"]="install";t["Uninstall"]="uninstall"})(gC||(gC={}));var mC;(function(t){t[t["None"]=1]="None";t[t["Install"]=2]="Install";t[t["Update"]=3]="Update";t[t["Migrate"]=4]="Migrate"})(mC||(mC={}));var _C;(function(t){t["Timeout"]="Timeout";t["Cancelled"]="Cancelled";t["ClientError"]="ClientError";t["ServerError"]="ServerError";t["Failed"]="Failed";t["DownloadFailedWriting"]="DownloadFailedWriting";t["Offline"]="Offline"})(_C||(_C={}));var vC;(function(t){t["NotFound"]="NotFound";t["Unsupported"]="Unsupported";t["Deprecated"]="Deprecated";t["Malicious"]="Malicious";t["Incompatible"]="Incompatible";t["IncompatibleApi"]="IncompatibleApi";t["IncompatibleTargetPlatform"]="IncompatibleTargetPlatform";t["ReleaseVersionNotFound"]="ReleaseVersionNotFound";t["Invalid"]="Invalid";t["Download"]="Download";t["DownloadSignature"]="DownloadSignature";t["DownloadFailedWriting"]="DownloadFailedWriting";t["UpdateMetadata"]="UpdateMetadata";t["Extract"]="Extract";t["Scanning"]="Scanning";t["ScanningExtension"]="ScanningExtension";t["ReadRemoved"]="ReadRemoved";t["UnsetRemoved"]="UnsetRemoved";t["Delete"]="Delete";t["Rename"]="Rename";t["IntializeDefaultProfile"]="IntializeDefaultProfile";t["AddToProfile"]="AddToProfile";t["InstalledExtensionNotFound"]="InstalledExtensionNotFound";t["PostInstall"]="PostInstall";t["CorruptZip"]="CorruptZip";t["IncompleteZip"]="IncompleteZip";t["PackageNotSigned"]="PackageNotSigned";t["SignatureVerificationInternal"]="SignatureVerificationInternal";t["SignatureVerificationFailed"]="SignatureVerificationFailed";t["NotAllowed"]="NotAllowed";t["Gallery"]="Gallery";t["Cancelled"]="Cancelled";t["Unknown"]="Unknown";t["Internal"]="Internal"})(vC||(vC={}));var wC;(function(t){t["NotSigned"]="NotSigned";t["Success"]="Success";t["RequiredArgumentMissing"]="RequiredArgumentMissing";t["InvalidArgument"]="InvalidArgument";t["PackageIsUnreadable"]="PackageIsUnreadable";t["UnhandledException"]="UnhandledException";t["SignatureManifestIsMissing"]="SignatureManifestIsMissing";t["SignatureManifestIsUnreadable"]="SignatureManifestIsUnreadable";t["SignatureIsMissing"]="SignatureIsMissing";t["SignatureIsUnreadable"]="SignatureIsUnreadable";t["CertificateIsUnreadable"]="CertificateIsUnreadable";t["SignatureArchiveIsUnreadable"]="SignatureArchiveIsUnreadable";t["FileAlreadyExists"]="FileAlreadyExists";t["SignatureArchiveIsInvalidZip"]="SignatureArchiveIsInvalidZip";t["SignatureArchiveHasSameSignatureFile"]="SignatureArchiveHasSameSignatureFile";t["PackageIntegrityCheckFailed"]="PackageIntegrityCheckFailed";t["SignatureIsInvalid"]="SignatureIsInvalid";t["SignatureManifestIsInvalid"]="SignatureManifestIsInvalid";t["SignatureIntegrityCheckFailed"]="SignatureIntegrityCheckFailed";t["EntryIsMissing"]="EntryIsMissing";t["EntryIsTampered"]="EntryIsTampered";t["Untrusted"]="Untrusted";t["CertificateRevoked"]="CertificateRevoked";t["SignatureIsNotValid"]="SignatureIsNotValid";t["UnknownError"]="UnknownError";t["PackageIsInvalidZip"]="PackageIsInvalidZip";t["SignatureArchiveHasTooManyEntries"]="SignatureArchiveHasTooManyEntries"})(wC||(wC={}));I_(1828,"Extensions");I_(1829,"Preferences");const O3="extensions.allowed";ei.as(Yo.Configuration).registerConfiguration({id:"extensions",order:30,title:h(1830,"Extensions"),type:"object",properties:{[O3]:{type:"object",markdownDescription:h(1831,"Specify a list of extensions that are allowed to use. This helps maintain a secure and consistent development environment by restricting the use of unauthorized extensions. For more information on how to configure this setting, please visit the [Configure Allowed Extensions](https://aka.ms/vscode/enterprise/extensions/allowed) section."),default:"*",defaultSnippets:[{body:{},description:h(1832,"No extensions are allowed.")},{body:{"*":true},description:h(1833,"All extensions are allowed.")}],scope:At.APPLICATION,policy:{name:"AllowedExtensions",category:aw.Extensions,minimumVersion:"1.96",localization:{description:{key:"extensions.allowed.policy",value:h(1834,"Specify a list of extensions that are allowed to use. This helps maintain a secure and consistent development environment by restricting the use of unauthorized extensions. More information: https://aka.ms/vscode/enterprise/extensions/allowed")}}},additionalProperties:false,patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{anyOf:[{type:["boolean","string"],enum:[true,false,"stable"],description:h(1835,"Allow or disallow the extension."),enumDescriptions:[h(1836,"Extension is allowed."),h(1837,"Extension is not allowed."),h(1838,"Allow only stable versions of the extension.")]},{type:"array",items:{type:"string"},description:h(1839,"Allow or disallow specific versions of the extension. To specifcy a platform specific version, use the format `platform@1.2.3`, e.g. `win32-x64@1.2.3`. Supported platforms are `win32-x64`, `win32-arm64`, `linux-x64`, `linux-arm64`, `linux-armhf`, `alpine-x64`, `alpine-arm64`, `darwin-x64`, `darwin-arm64`")}]},"([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:["boolean","string"],enum:[true,false,"stable"],description:h(1840,"Allow or disallow all extensions from the publisher."),enumDescriptions:[h(1841,"All extensions from the publisher are allowed."),h(1842,"All extensions from the publisher are not allowed."),h(1843,"Allow only stable versions of the extensions from the publisher.")]},"\\*":{type:"boolean",enum:[true,false],description:h(1844,"Allow or disallow all extensions."),enumDescriptions:[h(1845,"Allow all extensions."),h(1846,"Disallow all extensions.")]}}}}});const F3="vscode://schemas/vscode-product";class U3{constructor(){this._generators=new Map;this._cache=new WeakMap}register(e,i){this._generators.set(e,i)}readActivationEvents(e){if(!this._cache.has(e)){this._cache.set(e,this._readActivationEvents(e))}return this._cache.get(e)}createActivationEventsMap(e){const i=Object.create(null);for(const n of e){const s=this.readActivationEvents(n);if(s.length>0){i[ht.toKey(n.identifier)]=s}}return i}_readActivationEvents(e){if(typeof e.main==="undefined"&&typeof e.browser==="undefined"){return[]}const i=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let n=0;n<i.length;n++){if(i[n]==="onUri"){i[n]=`onUri:${ht.toKey(e.identifier)}`}}if(!e.contributes){return i}for(const n in e.contributes){const s=this._generators.get(n);if(!s){continue}const r=e.contributes[n];const o=Array.isArray(r)?r:[r];try{i.push(...s(o))}catch(a){Ti(a)}}return i}}const $3=new U3;const H3={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},agentSessionsWorkspace:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.agentSessionsWorkspace.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiSettingsSearch:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiSettingsSearch.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",version:2},authIssuers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authIssuers.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authProviderSpecific:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authProviderSpecific.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},authenticationChallenges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authenticationChallenges.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatContextProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatContextProvider.d.ts"},chatHooks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatHooks.d.ts",version:6},chatOutputRenderer:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatOutputRenderer.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:13},chatPromptFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatPromptFiles.d.ts",version:1},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts",version:4},chatReferenceBinaryData:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceBinaryData.d.ts"},chatReferenceDiagnostic:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceDiagnostic.d.ts"},chatSessionsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatSessionsProvider.d.ts",version:3},chatStatusItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatStatusItem.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribChatEditorInlineGutterMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribChatEditorInlineGutterMenu.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribLanguageModelToolSets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLanguageModelToolSets.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlArtifactGroupMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlArtifactGroupMenu.d.ts"},contribSourceControlArtifactMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlArtifactMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},css:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.css.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},dataChannels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.dataChannels.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",version:4},devDeviceId:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.devDeviceId.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},envIsAppPortable:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.envIsAppPortable.d.ts"},extensionAffinity:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionAffinity.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider2.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",version:2},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles2.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelCapabilities:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelCapabilities.d.ts"},languageModelProxy:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelProxy.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageModelThinkingPart:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelThinkingPart.d.ts",version:1},languageModelToolResultAudience:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelToolResultAudience.d.ts"},languageModelToolSupportsModel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelToolSupportsModel.d.ts",version:1},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},markdownAlertSyntax:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.markdownAlertSyntax.d.ts"},mcpServerDefinitions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpServerDefinitions.d.ts"},mcpToolDefinitions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpToolDefinitions.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},nativeWindowHandle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.nativeWindowHandle.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},remoteCodingAgents:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.remoteCodingAgents.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmArtifactProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmArtifactProvider.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmProviderOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmProviderOptions.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},statusBarItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.statusBarItemTooltip.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskExecutionTerminal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskExecutionTerminal.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},taskProblemMatcherStatus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskProblemMatcherStatus.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalCompletionProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalCompletionProvider.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},terminalShellEnv:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellEnv.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textDocumentChangeReason:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textDocumentChangeReason.d.ts"},textEditorDiffInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textEditorDiffInformation.d.ts"},textSearchComplete2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchComplete2.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider2.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},toolProgress:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.toolProgress.d.ts"},treeItemMarkdownLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeItemMarkdownLabel.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},valueSelectionInQuickPick:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.valueSelectionInQuickPick.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}};const fg=Object.freeze(H3);const GS=ei.as(H_.JSONContribution);class Dd{static _toSet(e){const i=new bl;for(let n=0,s=e.length;n<s;n++){i.add(e[n].description.identifier)}return i}static compute(e,i){if(!e||!e.length){return new Dd(i,[])}if(!i||!i.length){return new Dd([],e)}const n=this._toSet(e);const s=this._toSet(i);const r=i.filter(a=>!n.has(a.description.identifier));const o=e.filter(a=>!s.has(a.description.identifier));return new Dd(r,o)}constructor(e,i){this.added=e;this.removed=i}}class B3{constructor(e,i,n){this.name=e;this.defaultExtensionKind=i;this.canHandleResolver=n;this._handler=null;this._users=null;this._delta=null}setHandler(e){if(this._handler!==null){throw new Error("Handler already set!")}this._handler=e;this._handle();return{dispose:()=>{this._handler=null}}}acceptUsers(e){this._delta=Dd.compute(this._users,e);this._users=e;this._handle()}_handle(){if(this._handler===null||this._users===null||this._delta===null){return}try{this._handler(this._users,this._delta)}catch(e){Ti(e)}}}const W3={type:"string",enum:["ui","workspace"],enumDescriptions:[h(14587,"UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),h(14588,"Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]};const RP="vscode://schemas/vscode-extensions";const uw={properties:{engines:{type:"object",description:h(14589,"Engine compatibility."),properties:{"vscode":{type:"string",description:h(14590,"For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:h(14591,"The publisher of the VS Code extension."),type:"string"},displayName:{description:h(14592,"The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:h(14593,"The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:true,items:{oneOf:[{type:"string",enum:b8},{type:"string",const:"Languages",deprecationMessage:h(14594,"Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:h(14595,"Banner used in the VS Code marketplace."),properties:{color:{description:h(14596,"The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:h(14597,"The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:h(14598,"All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h(14599,"Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:h(14600,"Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:h(14601,"Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:true,items:{type:"string",enum:Object.keys(fg).map(t=>t),markdownEnumDescriptions:Object.values(fg).map(t=>t.proposal)}},api:{markdownDescription:h(14602,"Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[h(14603,"Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:h(14604,"Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h(14605,"An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h(14606,"An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h(14607,"An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h(14608,"An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h(14609,'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h(14610,'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h(14611,"An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h(14612,"An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h(14613,"An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h(14614,"An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:h(14615,"An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h(14616,"An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h(14617,"An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h(14618,"An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h(14619,"An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:h(14620,"An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h(14621,"An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h(14622,"An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:h(14623,"An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h(14624,"An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:h(14625,"An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h(14626,"An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h(14627,"An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h(14628,"An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h(14629,"An activation event emitted when the issue reporter is opened.")},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:h(14630,"An activation event emitted when the specified chat participant is invoked.")},{label:"onChatContextProvider",body:"onChatContextProvider:${1:contextProviderId}",description:h(14631,"An activation event emitted when the specified chat context provider is invoked.")},{label:"onLanguageModelChatProvider",body:"onLanguageModelChatProvider:${1:vendor}",description:h(14632,"An activation event emitted when a chat model provider for the given vendor is requested.")},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:h(14633,"An activation event emitted when the specified language model tool is invoked.")},{label:"onTerminal",body:"onTerminal:{1:shellType}",description:h(14634,"An activation event emitted when a terminal of the given shell type is opened.")},{label:"onTerminalShellIntegration",body:"onTerminalShellIntegration:${1:shellType}",description:h(14635,"An activation event emitted when terminal shell integration is activated for the given shell type.")},{label:"onMcpCollection",description:h(14636,"An activation event emitted whenver a tool from the MCP server is requested."),body:"onMcpCollection:${2:collectionId}"},{label:"*",description:h(14637,"An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:h(14638,"Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h(14639,"Badge image URL.")},href:{type:"string",description:h(14640,"Badge link.")},description:{type:"string",description:h(14641,"Badge description.")}}}},markdown:{type:"string",description:h(14642,"Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h(14643,"Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",false]},{type:"string"}]},extensionDependencies:{description:h(14644,"Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:true,items:{type:"string",pattern:Vv}},extensionAffinity:{description:h(14645,"Extensions that this extension should be colocated with in the same extension host process if possible. The identifier of an extension is always ${publisher}.${name}. For example: vscode.git."),type:"array",uniqueItems:true,items:{type:"string",pattern:Vv}},extensionPack:{description:h(14646,"A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:true,items:{type:"string",pattern:Vv}},extensionKind:{description:h(14647,"Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:W3,default:["workspace"],defaultSnippets:[{body:["ui"],description:h(14648,"Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:h(14649,"Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:h(14650,"Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:h(14651,"Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:h(14652,"Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:h(14653,"Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:h(14654,"Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:false,description:"${2}"}}],default:true.valueOf,properties:{supported:{markdownDescription:h(14655,"Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",true,false],enumDescriptions:[h(14656,"The extension will be enabled in virtual workspaces with some functionality disabled."),h(14657,"The extension will be enabled in virtual workspaces with all functionality enabled."),h(14658,"The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:h(14659,"A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:h(14660,"Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h(14661,"Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",true,false],enumDescriptions:[h(14662,"The extension will be enabled in untrusted workspaces with some functionality disabled."),h(14663,"The extension will be enabled in untrusted workspaces with all functionality enabled."),h(14664,"The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:h(14665,"A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h(14666,"A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:h(14667,"Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{"url":{description:h(14668,"URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h(14669,"Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:h(14670,"Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:h(14671,"The path to a 128x128 pixel icon.")},l10n:{type:"string",description:h(14672,"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:h(14673,"The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}};class V3{constructor(){this._extensionPoints=new Map}registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint)){throw new Error("Duplicate extension point: "+e.extensionPoint)}const i=new B3(e.extensionPoint,e.defaultExtensionKind,e.canHandleResolver);this._extensionPoints.set(e.extensionPoint,i);if(e.activationEventsGenerator){$3.register(e.extensionPoint,e.activationEventsGenerator)}uw.properties["contributes"].properties[e.extensionPoint]=e.jsonSchema;GS.registerSchema(RP,uw);return i}getExtensionPoints(){return Array.from(this._extensionPoints.values())}}const LP={ExtensionsRegistry:"ExtensionsRegistry"};ei.add(LP.ExtensionsRegistry,new V3);const NP=ei.as(LP.ExtensionsRegistry);GS.registerSchema(RP,uw);GS.registerSchema(F3,{properties:{extensionEnabledApiProposals:{description:h(14674,"API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:true,items:{type:"string",enum:Object.keys(fg),markdownEnumDescriptions:Object.values(fg).map(t=>t.proposal)}}]}}}});new E("isMac",vn,h(1787,"Whether the operating system is macOS"));new E("isLinux",Fo,h(1788,"Whether the operating system is Linux"));new E("isWindows",nn,h(1789,"Whether the operating system is Windows"));const z3=new E("isWeb",_u,h(1790,"Whether the platform is a web browser"));new E("isMacNative",vn&&!_u,h(1791,"Whether the operating system is macOS on a non-browser platform"));new E("isIOS",GR,h(1792,"Whether the operating system is iOS"));new E("isMobile",KR,h(1793,"Whether the platform is a mobile web browser"));new E("isDevelopment",false,true);new E("productQualityType","",h(1794,"Quality type of VS Code"));const q3="inputFocus";new E(q3,false,h(1795,"Whether keyboard focus is inside an input box"));const KS=te("languageService");const QS=te("modelService");class bC extends uP{constructor(){super(...arguments);this._onDidChangeDirty=this._register(new L);this._onDidChangeLabel=this._register(new L);this._onDidChangeCapabilities=this._register(new L);this._onWillDispose=this._register(new L);this.onDidChangeDirty=this._onDidChangeDirty.event;this.onDidChangeLabel=this._onDidChangeLabel.event;this.onDidChangeCapabilities=this._onDidChangeCapabilities.event;this.onWillDispose=this._onWillDispose.event}get editorId(){return void 0}get capabilities(){return Fn.Readonly}hasCapability(e){if(e===Fn.None){return this.capabilities===Fn.None}return(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(Fn.Readonly)}getName(){return`Editor ${this.typeId}`}getDescription(e){return void 0}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(ii.SHORT)}getIcon(){return void 0}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return false}isModified(){return this.isDirty()}isSaving(){return false}async resolve(){return null}async save(e,i){return this}async saveAs(e,i){return this}async revert(e,i){}async rename(e,i){return void 0}copy(){return this}canMove(e,i){return true}canReopen(){return true}matches(e){if(Ns(e)){return this===e}const i=e.options?.override;if(this.editorId!==i&&i!==void 0&&this.editorId!==void 0){return false}return Fc(this.resource,Y1.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){return void 0}isDisposed(){return this._store.isDisposed}dispose(){if(!this.isDisposed()){this._onWillDispose.fire()}super.dispose()}}const MP=te("editorService");var Wl;let dw=class PW extends bC{static{Wl=this}static{this.ID="workbench.editorinputs.sidebysideEditorInput"}get typeId(){return Wl.ID}get capabilities(){let e=this.primary.capabilities;e&=~Fn.CanSplitInGroup;if(this.secondary.hasCapability(Fn.RequiresTrust)){e|=Fn.RequiresTrust}if(this.secondary.hasCapability(Fn.Singleton)){e|=Fn.Singleton}e|=Fn.MultipleEditors;return e}get resource(){if(this.hasIdenticalSides){return this.primary.resource}return void 0}constructor(e,i,n,s,r){super();this.preferredName=e;this.preferredDescription=i;this.secondary=n;this.primary=s;this.editorService=r;this.hasIdenticalSides=this.primary.matches(this.secondary);this.registerListeners()}registerListeners(){this._register(wt.once(wt.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{if(!this.isDisposed()){this.dispose()}}));this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire()));this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire()));this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire()));this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()));this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){const e=this.getPreferredName();if(e){return e}if(this.hasIdenticalSides){return this.primary.getName()}return h(4063,"{0} - {1}",this.secondary.getName(),this.primary.getName())}getPreferredName(){return this.preferredName}getDescription(e){const i=this.getPreferredDescription();if(i){return i}if(this.hasIdenticalSides){return this.primary.getDescription(e)}return super.getDescription(e)}getPreferredDescription(){return this.preferredDescription}getTitle(e){let i;if(this.hasIdenticalSides){i=this.primary.getTitle(e)??this.getName()}else{i=super.getTitle(e)}const n=this.getPreferredTitle();if(n){i=`${n} (${i})`}return i}getPreferredTitle(){if(this.preferredName&&this.preferredDescription){return`${this.preferredName} ${this.preferredDescription}`}if(this.preferredName||this.preferredDescription){return this.preferredName??this.preferredDescription}return void 0}getLabelExtraClasses(){if(this.hasIdenticalSides){return this.primary.getLabelExtraClasses()}return super.getLabelExtraClasses()}getAriaLabel(){if(this.hasIdenticalSides){return this.primary.getAriaLabel()}return super.getAriaLabel()}getTelemetryDescriptor(){const e=this.primary.getTelemetryDescriptor();return{...e,...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(e,i){const n=await this.primary.save(e,i);return this.saveResultToEditor(n)}async saveAs(e,i){const n=await this.primary.saveAs(e,i);return this.saveResultToEditor(n)}saveResultToEditor(e){if(!e||!this.hasIdenticalSides){return e}if(this.primary.matches(e)){return this}if(e instanceof bC){return new Wl(this.preferredName,this.preferredDescription,e,e,this.editorService)}if(!Lr(e)&&!xd(e)&&!Da(e)&&!Ia(e)){return{primary:e,secondary:e,label:this.preferredName,description:this.preferredDescription}}return void 0}revert(e,i){return this.primary.revert(e,i)}async rename(e,i){if(!this.hasIdenticalSides){return}const n=await this.primary.rename(e,i);if(!n){return void 0}if(Ns(n.editor)){return{editor:new Wl(this.preferredName,this.preferredDescription,n.editor,n.editor,this.editorService),options:{...n.options,viewState:Bv(this,e,this.editorService)}}}if(g9(n.editor)){return{editor:{label:this.preferredName,description:this.preferredDescription,primary:n.editor,secondary:n.editor,options:{...n.options,viewState:Bv(this,e,this.editorService)}}}}return void 0}isReadonly(){return this.primary.isReadonly()}toUntyped(e){const i=this.primary.toUntyped(e);const n=this.secondary.toUntyped(e);if(i&&n&&!Lr(i)&&!Lr(n)&&!xd(i)&&!xd(n)&&!Da(i)&&!Da(n)&&!Ia(i)&&!Ia(n)){const s={label:this.preferredName,description:this.preferredDescription,primary:i,secondary:n};if(typeof e?.preserveViewState==="number"){s.options={viewState:Bv(this,e.preserveViewState,this.editorService)}}return s}return void 0}matches(e){if(this===e){return true}if(dP(e)||Lr(e)){return false}if(e instanceof Wl){return this.primary.matches(e.primary)&&this.secondary.matches(e.secondary)}if(Da(e)){return this.primary.matches(e.primary)&&this.secondary.matches(e.secondary)}return false}};dw=Wl=W([P(4,MP)],dw);class OP extends me{constructor(){super(...arguments);this._onWillDispose=this._register(new L);this.onWillDispose=this._onWillDispose.event;this.resolved=false}async resolve(){this.resolved=true}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire();super.dispose()}}const j3={ModesRegistry:"editor.modesRegistry"};class G3 extends me{constructor(){super();this._onDidChangeLanguages=this._register(new L);this.onDidChangeLanguages=this._onDidChangeLanguages.event;this._languages=[]}registerLanguage(e){this._languages.push(e);this._onDidChangeLanguages.fire(void 0);return{dispose:()=>{for(let i=0,n=this._languages.length;i<n;i++){if(this._languages[i]===e){this._languages.splice(i,1);return}}}}}getLanguages(){return this._languages}}const FP=new G3;ei.add(j3.ModesRegistry,FP);const lp="plaintext";const K3=".txt";FP.registerLanguage({id:lp,extensions:[K3],aliases:[h(859,"Plain Text"),"text"],mimetypes:[Ps.text]});ei.as(Yo.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":false,"editor.unicodeHighlight.invisibleCharacters":false},"[go]":{"editor.insertSpaces":false},"[makefile]":{"editor.insertSpaces":false},"[shellscript]":{"files.eol":"\n"},"[yaml]":{"editor.insertSpaces":true,"editor.tabSize":2}}}]);const yC="languageDetection";const Q3=te("ILanguageDetectionService");const J3=te("accessibilityService");var hw;let pg=class AW extends OP{static{hw=this}static{this.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600}constructor(e,i,n,s,r){super();this.modelService=e;this.languageService=i;this.languageDetectionService=n;this.accessibilityService=s;this.textEditorModelHandle=void 0;this.modelDisposeListener=this._register(new $r);this.autoDetectLanguageThrottler=this._register(new y4(hw.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));this._blockLanguageChangeListener=false;this._languageChangeSource=void 0;if(r){this.handleExistingModel(r)}}handleExistingModel(e){const i=this.modelService.getModel(e);if(!i){throw new Error(`Document with resource ${e.toString(true)} does not exist`)}this.textEditorModelHandle=e;this.registerModelDisposeListener(i)}registerModelDisposeListener(e){this.modelDisposeListener.value=e.onWillDispose(()=>{this.textEditorModelHandle=void 0;this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return true}get languageChangeSource(){return this._languageChangeSource}get hasLanguageSetExplicitly(){return typeof this._languageChangeSource==="string"}setLanguageId(e,i){this._languageChangeSource="user";this.setLanguageIdInternal(e,i)}setLanguageIdInternal(e,i){if(!this.isResolved()){return}if(!e||e===this.textEditorModel.getLanguageId()){return}this._blockLanguageChangeListener=true;try{this.textEditorModel.setLanguage(this.languageService.createById(e),i)}finally{this._blockLanguageChangeListener=false}}installModelListeners(e){const i=this._register(e.onDidChangeLanguage(n=>{if(n.source===yC||this._blockLanguageChangeListener){return}this._languageChangeSource="api";i.dispose()}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??lp)){return}const e=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle);const i=this.getLanguageId();if(e&&e!==i&&!this.isDisposed()){this.setLanguageIdInternal(e,yC);const n=this.languageService.getLanguageName(e);this.accessibilityService.alert(h(4064,"Language {0} was automatically detected and set as the language mode.",n??e))}}createTextEditorModel(e,i,n){const s=this.getFirstLineText(e);const r=this.getOrCreateLanguage(i,this.languageService,n,s);return this.doCreateTextEditorModel(e,r,i)}doCreateTextEditorModel(e,i,n){let s=n&&this.modelService.getModel(n);if(!s){s=this.modelService.createModel(e,i,n);this.createdEditorModel=true;this.registerModelDisposeListener(s)}else{this.updateTextEditorModel(e,i.languageId)}this.textEditorModelHandle=s.uri;return s}getFirstLineText(e){const i=e;if(typeof i.getFirstLineText==="function"){return i.getFirstLineText(rg.FIRST_LINE_DETECTION_LENGTH_LIMIT)}const n=e;return n.getLineContent(1).substr(0,rg.FIRST_LINE_DETECTION_LENGTH_LIMIT)}getOrCreateLanguage(e,i,n,s){if(!n||n===lp){return i.createByFilepathOrFirstLine(e??null,s)}return i.createById(n)}updateTextEditorModel(e,i,n){if(!this.isResolved()){return}if(e){this.modelService.updateModel(this.textEditorModel,e,n)}if(i&&i!==lp&&this.textEditorModel.getLanguageId()!==i){this.textEditorModel.setLanguage(this.languageService.createById(i))}}createSnapshot(){if(!this.textEditorModel){return null}return this.textEditorModel.createSnapshot(true)}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose();if(this.textEditorModelHandle&&this.createdEditorModel){this.modelService.destroyModel(this.textEditorModelHandle)}this.textEditorModelHandle=void 0;this.createdEditorModel=false;super.dispose()}};pg=hw=W([P(0,QS),P(1,KS),P(2,Q3),P(3,J3)],pg);class UP extends OP{get originalModel(){return this._originalModel}get modifiedModel(){return this._modifiedModel}constructor(e,i){super();this._originalModel=e;this._modifiedModel=i}async resolve(){await Promise.all([this._originalModel?.resolve(),this._modifiedModel?.resolve()])}isResolved(){return!!(this._originalModel?.isResolved()&&this._modifiedModel?.isResolved())}dispose(){super.dispose()}}class Y3 extends UP{get originalModel(){return this._originalModel}get modifiedModel(){return this._modifiedModel}get textDiffEditorModel(){return this._textDiffEditorModel}constructor(e,i){super(e,i);this._textDiffEditorModel=void 0;this._originalModel=e;this._modifiedModel=i;this.updateTextDiffEditorModel()}async resolve(){await super.resolve();this.updateTextDiffEditorModel()}updateTextDiffEditorModel(){if(this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()){if(!this._textDiffEditorModel){this._textDiffEditorModel={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel}}else{this._textDiffEditorModel.original=this.originalModel.textEditorModel;this._textDiffEditorModel.modified=this.modifiedModel.textEditorModel}}}isResolved(){return!!this._textDiffEditorModel}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this._textDiffEditorModel=void 0;super.dispose()}}function SC(t){const e=t;return typeof e?.resolve==="function"&&typeof e?.isResolved==="function"}var xC;(function(t){t[t["ACTIVATE"]=1]="ACTIVATE";t[t["RESTORE"]=2]="RESTORE";t[t["PRESERVE"]=3]="PRESERVE"})(xC||(xC={}));var EC;(function(t){t[t["PICK"]=0]="PICK";t[t["EXCLUSIVE_ONLY"]=1]="EXCLUSIVE_ONLY"})(EC||(EC={}));var CC;(function(t){t[t["API"]=0]="API";t[t["USER"]=1]="USER"})(CC||(CC={}));var kC;(function(t){t[t["Center"]=0]="Center";t[t["CenterIfOutsideViewport"]=1]="CenterIfOutsideViewport";t[t["NearTop"]=2]="NearTop";t[t["NearTopIfOutsideViewport"]=3]="NearTopIfOutsideViewport"})(kC||(kC={}));var Id;(function(t){t["PROGRAMMATIC"]="api";t["NAVIGATION"]="code.navigation";t["JUMP"]="code.jump"})(Id||(Id={}));var cp;let DC=class RW extends dw{static{cp=this}static{this.ID="workbench.editors.diffEditorInput"}get typeId(){return cp.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let e=super.capabilities;if(this.labels.forceDescription){e|=Fn.ForceDescription}return e}constructor(e,i,n,s,r,o){super(e,i,n,s,o);this.original=n;this.modified=s;this.forceOpenAsBinary=r;this.cachedModel=void 0;this.labels=this.computeLabels()}computeLabels(){let e;let i=false;if(this.preferredName){e=this.preferredName}else{const u=this.original.getName();const d=this.modified.getName();e=h(4062,"{0}  {1}",u,d);i=u===d}let n;let s;let r;if(this.preferredDescription){n=this.preferredDescription;s=this.preferredDescription;r=this.preferredDescription}else{n=this.computeLabel(this.original.getDescription(ii.SHORT),this.modified.getDescription(ii.SHORT));r=this.computeLabel(this.original.getDescription(ii.LONG),this.modified.getDescription(ii.LONG));const u=this.original.getDescription(ii.MEDIUM);const d=this.modified.getDescription(ii.MEDIUM);if(typeof u==="string"&&typeof d==="string"&&(u||d)){const[f,p]=C9([u,d]);s=this.computeLabel(f,p)}}let o=this.computeLabel(this.original.getTitle(ii.SHORT)??this.original.getName(),this.modified.getTitle(ii.SHORT)??this.modified.getName(),"  ");let a=this.computeLabel(this.original.getTitle(ii.MEDIUM)??this.original.getName(),this.modified.getTitle(ii.MEDIUM)??this.modified.getName(),"  ");let l=this.computeLabel(this.original.getTitle(ii.LONG)??this.original.getName(),this.modified.getTitle(ii.LONG)??this.modified.getName(),"  ");const c=this.getPreferredTitle();if(c){o=`${c} (${o})`;a=`${c} (${a})`;l=`${c} (${l})`}return{name:e,shortDescription:n,mediumDescription:s,longDescription:r,forceDescription:i,shortTitle:o,mediumTitle:a,longTitle:l}}computeLabel(e,i,n=" - "){if(!e||!i){return void 0}if(e===i){return i}return`${e}${n}${i}`}getName(){return this.labels.name}getDescription(e=ii.MEDIUM){switch(e){case ii.SHORT:return this.labels.shortDescription;case ii.LONG:return this.labels.longDescription;case ii.MEDIUM:default:return this.labels.mediumDescription}}getTitle(e){switch(e){case ii.SHORT:return this.labels.shortTitle;case ii.LONG:return this.labels.longTitle;default:case ii.MEDIUM:return this.labels.mediumTitle}}async resolve(){const e=await this.createModel();this.cachedModel?.dispose();this.cachedModel=e;return this.cachedModel}prefersEditorPane(e){if(this.forceOpenAsBinary){return e.find(i=>i.typeId===p9)}return e.find(i=>i.typeId===f9)}async createModel(){const[e,i]=await Promise.all([this.original.resolve(),this.modified.resolve()]);if(i instanceof pg&&e instanceof pg){return new Y3(e,i)}return new UP(SC(e)?e:void 0,SC(i)?i:void 0)}toUntyped(e){const i=super.toUntyped(e);if(i){return{...i,modified:i.primary,original:i.secondary}}return void 0}matches(e){if(this===e){return true}if(e instanceof cp){return this.modified.matches(e.modified)&&this.original.matches(e.original)&&e.forceOpenAsBinary===this.forceOpenAsBinary}if(Lr(e)){return this.modified.matches(e.modified)&&this.original.matches(e.original)}return false}dispose(){if(this.cachedModel){this.cachedModel.dispose();this.cachedModel=void 0}super.dispose()}};DC=cp=W([P(5,MP)],DC);var rs;new E("workbenchState",void 0,{type:"string",description:h(3983,"The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")});new E("workspaceFolderCount",0,h(3984,"The number of root folders in the workspace"));new E("openFolderWorkspaceSupport",true,true);new E("enterMultiRootWorkspaceSupport",true,true);new E("emptyWorkspaceSupport",true,true);new E("dirtyWorkingCopies",false,h(3985,"Whether there are any working copies with unsaved changes"));const X3=new E("remoteName","",h(3986,"The name of the remote the window is connected to or an empty string if not connected to any remote"));new E("virtualWorkspace","",h(3987,"The scheme of the current workspace is from a virtual file system or an empty string."));new E("temporaryWorkspace",false,h(3988,"The scheme of the current workspace is from a temporary file system."));new E("isAgentSessionsWorkspace",false,h(3989,"Whether the current workspace is the agent sessions workspace."));new E("workbenchMode","",h(3990,"The current workbench mode."));new E("hasWebFileSystemAccess",false,true);new E("embedderIdentifier",void 0,h(3991,"The identifier of the embedder according to the product service, if one is defined"));new E("inAutomation",false,h(3992,"Whether VS Code is running under automation/smoke test"));new E("isSandboxWorkspace",false,true);new E("isFullscreen",false,h(3993,"Whether the main window is in fullscreen mode"));new E("isAuxiliaryWindowFocusedContext",false,h(3994,"Whether an auxiliary window is focused"));new E("isAuxiliaryWindow",false,h(3995,"Window is an auxiliary window"));new E("activeEditorIsDirty",false,h(3996,"Whether the active editor has unsaved changes"));new E("activeEditorIsNotPreview",false,h(3997,"Whether the active editor is not in preview mode"));new E("activeEditorIsFirstInGroup",false,h(3998,"Whether the active editor is the first one in its group"));new E("activeEditorIsLastInGroup",false,h(3999,"Whether the active editor is the last one in its group"));new E("activeEditorIsPinned",false,h(4e3,"Whether the active editor is pinned"));new E("activeEditorIsReadonly",false,h(4001,"Whether the active editor is read-only"));new E("activeCompareEditorCanSwap",false,h(4002,"Whether the active compare editor can swap sides"));new E("activeEditorCanToggleReadonly",true,h(4003,"Whether the active editor can toggle between being read-only or writeable"));new E("activeEditorCanRevert",false,h(4004,"Whether the active editor can revert"));new E("activeEditorCanSplitInGroup",true);new E("activeEditor",null,{type:"string",description:h(4005,"The identifier of the active editor")});new E("activeEditorAvailableEditorIds","",h(4006,"The available editor identifiers that are usable for the active editor"));new E("textCompareEditorVisible",false,h(4007,"Whether a text compare editor is visible"));new E("textCompareEditorActive",false,h(4008,"Whether a text compare editor is active"));new E("sideBySideEditorActive",false,h(4009,"Whether a side by side editor is active"));new E("groupEditorsCount",0,h(4010,"The number of opened editor groups"));new E("activeEditorGroupEmpty",false,h(4011,"Whether the active editor group is empty"));new E("activeEditorGroupIndex",0,h(4012,"The index of the active editor group"));new E("activeEditorGroupLast",false,h(4013,"Whether the active editor group is the last group"));new E("activeEditorGroupLocked",false,h(4014,"Whether the active editor group is locked"));new E("multipleEditorGroups",false,h(4015,"Whether there are multiple editor groups opened"));new E("multipleEditorsSelectedInGroup",false,h(4016,"Whether multiple editors have been selected in an editor group"));new E("twoEditorsSelectedInGroup",false,h(4017,"Whether exactly two editors have been selected in an editor group"));new E("SelectedEditorsInGroupFileOrUntitledResourceContextKey",true,h(4018,"Whether all selected editors in a group have a file or untitled resource associated"));new E("editorPartMultipleEditorGroups",false,h(4019,"Whether there are multiple editor groups opened in an editor part"));new E("editorPartMaximizedEditorGroup",false,h(4020,"Editor Part has a maximized group"));new E("editorIsOpen",false,h(4021,"Whether an editor is open"));new E("inZenMode",false,h(4022,"Whether Zen mode is enabled"));new E("isCenteredLayout",false,h(4023,"Whether centered layout is enabled for the main editor"));new E("splitEditorsVertically",false,h(4024,"Whether editors split vertically"));new E("mainEditorAreaVisible",true,h(4025,"Whether the editor area in the main window is visible"));new E("editorTabsVisible",true,h(4026,"Whether editor tabs are visible"));new E("sideBarVisible",false,h(4027,"Whether the sidebar is visible"));new E("sideBarFocus",false,h(4028,"Whether the sidebar has keyboard focus"));new E("activeViewlet","",h(4029,"The identifier of the active viewlet"));new E("statusBarFocused",false,h(4030,"Whether the status bar has keyboard focus"));new E("titleBarStyle","custom",h(4031,"Style of the window title bar"));new E("titleBarVisible",false,h(4032,"Whether the title bar is visible"));new E("isCompactTitleBar",false,h(4033,"Title bar is in compact mode"));new E("bannerFocused",false,h(4034,"Whether the banner has keyboard focus"));new E("notificationFocus",true,h(4035,"Whether a notification has keyboard focus"));new E("notificationCenterVisible",false,h(4036,"Whether the notifications center is visible"));new E("notificationToastsVisible",false,h(4037,"Whether a notification toast is visible"));new E("activeAuxiliary","",h(4038,"The identifier of the active auxiliary panel"));new E("auxiliaryBarFocus",false,h(4039,"Whether the auxiliary bar has keyboard focus"));new E("auxiliaryBarVisible",false,h(4040,"Whether the auxiliary bar is visible"));new E("auxiliaryBarMaximized",false,h(4041,"Whether the auxiliary bar is maximized"));new E("activePanel","",h(4042,"The identifier of the active panel"));new E("panelFocus",false,h(4043,"Whether the panel has keyboard focus"));new E("panelPosition","bottom",h(4044,"The position of the panel, always 'bottom'"));new E("panelAlignment","center",h(4045,"The alignment of the panel, either 'center', 'left', 'right' or 'justify'"));new E("panelVisible",false,h(4046,"Whether the panel is visible"));new E("panelMaximized",false,h(4047,"Whether the panel is maximized"));new E("focusedView","",h(4048,"The identifier of the view that has keyboard focus"));let fw=class LW{static{rs=this}static{this.Scheme=new E("resourceScheme",void 0,{type:"string",description:h(4049,"The scheme of the resource")})}static{this.Filename=new E("resourceFilename",void 0,{type:"string",description:h(4050,"The file name of the resource")})}static{this.Dirname=new E("resourceDirname",void 0,{type:"string",description:h(4051,"The folder name the resource is contained in")})}static{this.Path=new E("resourcePath",void 0,{type:"string",description:h(4052,"The full path of the resource")})}static{this.LangId=new E("resourceLangId",void 0,{type:"string",description:h(4053,"The language identifier of the resource")})}static{this.Resource=new E("resource",void 0,{type:"URI",description:h(4054,"The full value of the resource including scheme and path")})}static{this.Extension=new E("resourceExtname",void 0,{type:"string",description:h(4055,"The extension name of the resource")})}static{this.HasResource=new E("resourceSet",void 0,{type:"boolean",description:h(4056,"Whether a resource is present or not")})}static{this.IsFileSystemResource=new E("isFileSystemResource",void 0,{type:"boolean",description:h(4057,"Whether the resource is backed by a file system provider")})}constructor(e,i,n,s){this._contextKeyService=e;this._fileService=i;this._languageService=n;this._modelService=s;this._schemeKey=rs.Scheme.bindTo(this._contextKeyService);this._filenameKey=rs.Filename.bindTo(this._contextKeyService);this._dirnameKey=rs.Dirname.bindTo(this._contextKeyService);this._pathKey=rs.Path.bindTo(this._contextKeyService);this._langIdKey=rs.LangId.bindTo(this._contextKeyService);this._resourceKey=rs.Resource.bindTo(this._contextKeyService);this._extensionKey=rs.Extension.bindTo(this._contextKeyService);this._hasResource=rs.HasResource.bindTo(this._contextKeyService);this._isFileSystemResource=rs.IsFileSystemResource.bindTo(this._contextKeyService)}_setLangId(){const e=this.get();if(!e){this._langIdKey.set(null);return}const i=this._modelService.getModel(e)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(e);this._langIdKey.set(i)}set(e){e=e??void 0;if(Fc(this._value,e)){return}this._value=e;this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(e?e.toString():null);this._schemeKey.set(e?e.scheme:null);this._filenameKey.set(e?ts(e):null);this._dirnameKey.set(e?this.uriToPath(lf(e)):null);this._pathKey.set(e?this.uriToPath(e):null);this._setLangId();this._extensionKey.set(e?KL(e):null);this._hasResource.set(Boolean(e));this._isFileSystemResource.set(e?this._fileService.hasProvider(e):false)})}uriToPath(e){if(e.scheme===ne.file){return e.fsPath}return e.path}reset(){this._value=void 0;this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset();this._schemeKey.reset();this._filenameKey.reset();this._dirnameKey.reset();this._pathKey.reset();this._langIdKey.reset();this._extensionKey.reset();this._hasResource.reset();this._isFileSystemResource.reset()})}get(){return this._value}};fw=rs=W([P(0,Cu),P(1,$_),P(2,KS),P(3,QS)],fw);let IC=class NW extends fw{constructor(e,i,n,s){super(e,i,n,s);this._disposables=new pe;this._disposables.add(i.onDidChangeFileSystemProviderRegistrations(()=>{const r=this.get();this._isFileSystemResource.set(Boolean(r&&i.hasProvider(r)))}));this._disposables.add(s.onModelAdded(r=>{if(Fc(r.uri,this.get())){this._setLangId()}}));this._disposables.add(s.onModelLanguageChanged(r=>{if(Fc(r.model.uri,this.get())){this._setLangId()}}))}dispose(){this._disposables.dispose()}};IC=W([P(0,Cu),P(1,$_),P(2,KS),P(3,QS)],IC);const Xo=te("configurationService");const Z3=te("dialogService");te("fileDialogService");const eN=te("productService");function tN(t){return t.res.statusCode===204}async function TC(t){if(tN(t)){return null}const e=await yR(t.stream);return e.toString()}const iN=false;let zv=[];let PC=void 0;let AC=void 0;function nN(t=true,e=true){if(PC===t&&AC===e){return}PC=t;AC=e;const i=ei.as(Yo.Configuration);const n=zv;zv=[{id:"http",order:15,title:h(2046,"HTTP"),type:"object",scope:At.MACHINE,properties:{"http.useLocalProxyConfiguration":{type:"boolean",default:e,markdownDescription:h(2047,"Controls whether in the remote extension host the local proxy configuration should be used. This setting only applies as a remote setting during [remote development](https://aka.ms/vscode-remote)."),restricted:true}}},{id:"http",order:15,title:h(2046,"HTTP"),type:"object",scope:At.APPLICATION,properties:{"http.electronFetch":{type:"boolean",default:false,description:h(2048,"Controls whether use of Electron's fetch implementation instead of Node.js' should be enabled. All local extensions will get Electron's fetch implementation for the global fetch API."),restricted:true}}},{id:"http",order:15,title:h(2046,"HTTP"),type:"object",scope:t?At.APPLICATION:At.MACHINE,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:h(2049,"The proxy setting to use. If not set, will be inherited from the `http_proxy` and `https_proxy` environment variables. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.proxyStrictSSL":{type:"boolean",default:true,markdownDescription:h(2050,"Controls whether the proxy server certificate should be verified against the list of supplied CAs. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:h(2051,"Overrides the principal service name for Kerberos authentication with the HTTP proxy. A default based on the proxy hostname is used when this is not set. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:h(2052,"Specifies domain names for which proxy settings should be ignored for HTTP/HTTPS requests. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:h(2053,"The value to send as the `Proxy-Authorization` header for every network request. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[h(2054,"Disable proxy support for extensions."),h(2055,"Enable proxy support for extensions."),h(2056,"Enable proxy support for extensions, fall back to request options, when no proxy found."),h(2057,"Enable proxy support for extensions, override request options.")],default:"override",markdownDescription:h(2058,"Use the proxy support for extensions. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.systemCertificates":{type:"boolean",default:true,markdownDescription:h(2059,"Controls whether CA certificates should be loaded from the OS. On Windows and macOS, a reload of the window is required after turning this off. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.systemCertificatesNode":{type:"boolean",tags:["experimental"],default:iN,markdownDescription:h(2060,"Controls whether system certificates should be loaded using Node.js built-in support. Reload the window after changing this setting. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true,experiment:{mode:"auto"}},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:false,markdownDescription:h(2061,"Controls whether experimental loading of CA certificates from the OS should be enabled. This uses a more general approach than the default implementation. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.fetchAdditionalSupport":{type:"boolean",default:true,markdownDescription:h(2062,"Controls whether Node.js' fetch implementation should be extended with additional support. Currently proxy support ({1}) and system certificates ({2}) are added when the corresponding settings are enabled. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`","`#http.proxySupport#`","`#http.systemCertificates#`"),restricted:true},"http.experimental.networkInterfaceCheckInterval":{type:"number",default:300,minimum:-1,tags:["experimental"],markdownDescription:h(2063,"Controls the interval in seconds for checking network interface changes to invalidate the proxy cache. Set to -1 to disable. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true,experiment:{mode:"auto"}}}}];i.updateConfigurations({add:zv,remove:n})}nN();const sN=te("requestService");var Pr;(function(t){t[t["NONE"]=0]="NONE";t[t["CRASH"]=1]="CRASH";t[t["ERROR"]=2]="ERROR";t[t["USAGE"]=3]="USAGE"})(Pr||(Pr={}));var RC;(function(t){t["OFF"]="off";t["CRASH"]="crash";t["ERROR"]="error";t["ON"]="all"})(RC||(RC={}));const mf=te("telemetryService");te("customEndpointTelemetryService");const rN=te("IAuthenticationService");te("IAuthenticationExtensionsService");const oN=te("openerService");const aN=S8(CP);const lN=te("lifecycleService");const cN=te("defaultAccountService");var Vl;var Ae;(function(t){t.Setup={hidden:new E("chatSetupHidden",false,true),installed:new E("chatSetupInstalled",false,true),disabled:new E("chatSetupDisabled",false,true),untrusted:new E("chatSetupUntrusted",false,true),later:new E("chatSetupLater",false,true),registered:new E("chatSetupRegistered",false,true)};t.Entitlement={signedOut:new E("chatEntitlementSignedOut",false,true),canSignUp:new E("chatPlanCanSignUp",false,true),planFree:new E("chatPlanFree",false,true),planPro:new E("chatPlanPro",false,true),planProPlus:new E("chatPlanProPlus",false,true),planBusiness:new E("chatPlanBusiness",false,true),planEnterprise:new E("chatPlanEnterprise",false,true),organisations:new E("chatEntitlementOrganisations",void 0,true),internal:new E("chatEntitlementInternal",false,true),sku:new E("chatEntitlementSku",void 0,true)};t.chatQuotaExceeded=new E("chatQuotaExceeded",false,true);t.completionsQuotaExceeded=new E("completionsQuotaExceeded",false,true);t.chatAnonymous=new E("chatAnonymous",false,true)})(Ae||(Ae={}));var rt;(function(t){t[t["Unknown"]=1]="Unknown";t[t["Unresolved"]=2]="Unresolved";t[t["Available"]=3]="Available";t[t["Unavailable"]=4]="Unavailable";t[t["Free"]=5]="Free";t[t["Pro"]=6]="Pro";t[t["ProPlus"]=7]="ProPlus";t[t["Business"]=8]="Business";t[t["Enterprise"]=9]="Enterprise"})(rt||(rt={}));function uN(t){return t===rt.Pro||t===rt.ProPlus||t===rt.Business||t===rt.Enterprise}const gg={upgradePlanUrl:Mr.defaultChatAgent?.upgradePlanUrl??"",entitlementSignupLimitedUrl:Mr.defaultChatAgent?.entitlementSignupLimitedUrl??"",chatQuotaExceededContext:Mr.defaultChatAgent?.chatQuotaExceededContext??"",completionsQuotaExceededContext:Mr.defaultChatAgent?.completionsQuotaExceededContext??""};const $P="chat.allowAnonymousAccess";function JS(t,e,i){if(t.getValue($P)!==true){return false}if(e!==rt.Unknown){return false}if(i.hidden||i.disabled){return false}return true}function HP(t,e,i){i.publicLog2("chatEntitlements",{chatHidden:Boolean(t.hidden),chatDisabled:Boolean(t.disabled),chatEntitlement:t.entitlement,chatRegistered:Boolean(t.registered),chatAnonymous:JS(e,t.entitlement,t)})}let LC=class MW extends me{constructor(e,i,n,s,r,o){super();this.contextKeyService=s;this.configurationService=r;this.telemetryService=o;this._onDidChangeQuotaExceeded=this._register(new L);this.onDidChangeQuotaExceeded=this._onDidChangeQuotaExceeded.event;this._onDidChangeQuotaRemaining=this._register(new L);this.onDidChangeQuotaRemaining=this._onDidChangeQuotaRemaining.event;this._quotas={};this.ExtensionQuotaContextKeys={chatQuotaExceeded:gg.chatQuotaExceededContext,completionsQuotaExceeded:gg.completionsQuotaExceededContext};this._onDidChangeAnonymous=this._register(new L);this.onDidChangeAnonymous=this._onDidChangeAnonymous.event;this.anonymousObs=Cd(this.onDidChangeAnonymous,()=>this.anonymous);this.chatQuotaExceededContextKey=Ae.chatQuotaExceeded.bindTo(this.contextKeyService);this.completionsQuotaExceededContextKey=Ae.completionsQuotaExceeded.bindTo(this.contextKeyService);this.anonymousContextKey=Ae.chatAnonymous.bindTo(this.contextKeyService);this.anonymousContextKey.set(this.anonymous);this.onDidChangeEntitlement=wt.map(wt.filter(this.contextKeyService.onDidChangeContext,l=>l.affectsSome(new Set([Ae.Entitlement.planPro.key,Ae.Entitlement.planBusiness.key,Ae.Entitlement.planEnterprise.key,Ae.Entitlement.planProPlus.key,Ae.Entitlement.planFree.key,Ae.Entitlement.canSignUp.key,Ae.Entitlement.signedOut.key,Ae.Entitlement.organisations.key,Ae.Entitlement.internal.key,Ae.Entitlement.sku.key])),this._store),()=>{},this._store);this.entitlementObs=Cd(this.onDidChangeEntitlement,()=>this.entitlement);this.onDidChangeSentiment=wt.map(wt.filter(this.contextKeyService.onDidChangeContext,l=>l.affectsSome(new Set([Ae.Setup.hidden.key,Ae.Setup.disabled.key,Ae.Setup.untrusted.key,Ae.Setup.installed.key,Ae.Setup.later.key,Ae.Setup.registered.key])),this._store),()=>{},this._store);this.sentimentObs=Cd(this.onDidChangeSentiment,()=>this.sentiment);if(_u&&!n.remoteAuthority){Ae.Setup.hidden.bindTo(this.contextKeyService).set(true);return}if(!i.defaultChatAgent){return}const a=this.context=new $i(()=>this._register(e.createInstance(gw)));this.requests=new $i(()=>this._register(e.createInstance(pw,a.value,{clearQuotas:()=>this.clearQuotas(),acceptQuotas:l=>this.acceptQuotas(l)})));this.registerListeners()}get entitlement(){if(this.contextKeyService.getContextKeyValue(Ae.Entitlement.planPro.key)===true){return rt.Pro}else if(this.contextKeyService.getContextKeyValue(Ae.Entitlement.planBusiness.key)===true){return rt.Business}else if(this.contextKeyService.getContextKeyValue(Ae.Entitlement.planEnterprise.key)===true){return rt.Enterprise}else if(this.contextKeyService.getContextKeyValue(Ae.Entitlement.planProPlus.key)===true){return rt.ProPlus}else if(this.contextKeyService.getContextKeyValue(Ae.Entitlement.planFree.key)===true){return rt.Free}else if(this.contextKeyService.getContextKeyValue(Ae.Entitlement.canSignUp.key)===true){return rt.Available}else if(this.contextKeyService.getContextKeyValue(Ae.Entitlement.signedOut.key)===true){return rt.Unknown}return rt.Unresolved}get isInternal(){return this.contextKeyService.getContextKeyValue(Ae.Entitlement.internal.key)===true}get organisations(){return this.contextKeyService.getContextKeyValue(Ae.Entitlement.organisations.key)}get sku(){return this.contextKeyService.getContextKeyValue(Ae.Entitlement.sku.key)}get quotas(){return this._quotas}registerListeners(){const e=new Set([this.ExtensionQuotaContextKeys.chatQuotaExceeded,this.ExtensionQuotaContextKeys.completionsQuotaExceeded]);const i=this._register(new $r);this._register(this.contextKeyService.onDidChangeContext(r=>{if(r.affectsSome(e)){if(i.value){i.value.cancel()}i.value=new Tt;this.update(i.value.token)}}));let n=this.anonymous;const s=()=>{const r=this.anonymous;if(r!==n){n=r;this.anonymousContextKey.set(r);if(this.context?.hasValue){HP(this.context.value.state,this.configurationService,this.telemetryService)}this._onDidChangeAnonymous.fire()}};this._register(this.configurationService.onDidChangeConfiguration(r=>{if(r.affectsConfiguration($P)){s()}}));this._register(this.onDidChangeEntitlement(()=>s()));this._register(this.onDidChangeSentiment(()=>s()))}acceptQuotas(e){const i=this._quotas;this._quotas=e;this.updateContextKeys();const{changed:n}=this.compareQuotas(i.chat,e.chat);const{changed:s}=this.compareQuotas(i.completions,e.completions);const{changed:r}=this.compareQuotas(i.premiumChat,e.premiumChat);if(n.exceeded||s.exceeded||r.exceeded){this._onDidChangeQuotaExceeded.fire()}if(n.remaining||s.remaining||r.remaining){this._onDidChangeQuotaRemaining.fire()}}compareQuotas(e,i){return{changed:{exceeded:e?.percentRemaining===0!==(i?.percentRemaining===0),remaining:e?.percentRemaining!==i?.percentRemaining}}}clearQuotas(){this.acceptQuotas({})}updateContextKeys(){this.chatQuotaExceededContextKey.set(this._quotas.chat?.percentRemaining===0);this.completionsQuotaExceededContextKey.set(this._quotas.completions?.percentRemaining===0)}get sentiment(){return{installed:this.contextKeyService.getContextKeyValue(Ae.Setup.installed.key)===true,hidden:this.contextKeyService.getContextKeyValue(Ae.Setup.hidden.key)===true,disabled:this.contextKeyService.getContextKeyValue(Ae.Setup.disabled.key)===true,untrusted:this.contextKeyService.getContextKeyValue(Ae.Setup.untrusted.key)===true,later:this.contextKeyService.getContextKeyValue(Ae.Setup.later.key)===true,registered:this.contextKeyService.getContextKeyValue(Ae.Setup.registered.key)===true}}get anonymous(){return JS(this.configurationService,this.entitlement,this.sentiment)}async update(e){await this.requests?.value.forceResolveEntitlement(e)}};LC=W([P(0,yl),P(1,eN),P(2,aN),P(3,Cu),P(4,Xo),P(5,mf)],LC);let pw=class OW extends me{constructor(e,i,n,s,r,o,a,l,c,u){super();this.context=e;this.chatQuotasAccessor=i;this.telemetryService=n;this.logService=s;this.requestService=r;this.dialogService=o;this.openerService=a;this.lifecycleService=l;this.defaultAccountService=c;this.authenticationService=u;this.pendingResolveCts=new Tt;this.state={entitlement:this.context.state.entitlement};this.registerListeners();this.resolve()}registerListeners(){this._register(this.defaultAccountService.onDidChangeDefaultAccount(()=>this.resolve()));this._register(this.context.onDidChange(()=>{if(!this.context.state.installed||this.context.state.disabled||this.context.state.entitlement===rt.Unknown){this.state={entitlement:this.state.entitlement,quotas:void 0};this.chatQuotasAccessor.clearQuotas()}}))}async resolve(){this.pendingResolveCts.dispose(true);const e=this.pendingResolveCts=new Tt;const i=await this.defaultAccountService.getDefaultAccount();if(e.token.isCancellationRequested){return}let n=void 0;if(i){if(this.state.entitlement===rt.Unknown){n={entitlement:rt.Unresolved}}}else{n={entitlement:rt.Unknown}}if(n){this.update(n)}if(i){await this.resolveEntitlement(i,e.token)}}async resolveEntitlement(e,i){const n=await this.doResolveEntitlement(e,i);if(typeof n?.entitlement==="number"&&!i.isCancellationRequested){this.update(n)}return n}async doResolveEntitlement(e,i){if(i.isCancellationRequested){return void 0}const n=e.entitlementsData;if(!n){this.logService.trace("[chat entitlement]: no entitlements data available on default account");return{entitlement:n===null?rt.Unknown:rt.Unresolved}}let s;if(n.access_type_sku==="free_limited_copilot"){s=rt.Free}else if(n.can_signup_for_limited){s=rt.Available}else if(n.copilot_plan==="individual"){s=rt.Pro}else if(n.copilot_plan==="individual_pro"){s=rt.ProPlus}else if(n.copilot_plan==="business"){s=rt.Business}else if(n.copilot_plan==="enterprise"){s=rt.Enterprise}else{s=rt.Unavailable}const r={entitlement:s,organisations:n.organization_login_list,quotas:this.toQuotas(n),sku:n.access_type_sku};this.logService.trace(`[chat entitlement]: resolved to ${r.entitlement}, quotas: ${JSON.stringify(r.quotas)}`);this.telemetryService.publicLog2("chatInstallEntitlement",{entitlement:r.entitlement,tid:n.analytics_tracking_id,sku:r.sku,quotaChat:r.quotas?.chat?.remaining,quotaPremiumChat:r.quotas?.premiumChat?.remaining,quotaCompletions:r.quotas?.completions?.remaining,quotaResetDate:r.quotas?.resetDate});return r}toQuotas(e){const i={resetDate:e.quota_reset_date_utc??e.quota_reset_date??e.limited_user_reset_date,resetDateHasTime:typeof e.quota_reset_date_utc==="string"};if(e.monthly_quotas?.chat&&typeof e.limited_user_quotas?.chat==="number"){i.chat={total:e.monthly_quotas.chat,remaining:e.limited_user_quotas.chat,percentRemaining:Math.min(100,Math.max(0,e.limited_user_quotas.chat/e.monthly_quotas.chat*100)),overageEnabled:false,overageCount:0,unlimited:false}}if(e.monthly_quotas?.completions&&typeof e.limited_user_quotas?.completions==="number"){i.completions={total:e.monthly_quotas.completions,remaining:e.limited_user_quotas.completions,percentRemaining:Math.min(100,Math.max(0,e.limited_user_quotas.completions/e.monthly_quotas.completions*100)),overageEnabled:false,overageCount:0,unlimited:false}}if(e.quota_snapshots){for(const n of["chat","completions","premium_interactions"]){const s=e.quota_snapshots[n];if(!s){continue}const r={total:s.entitlement,remaining:s.remaining,percentRemaining:Math.min(100,Math.max(0,s.percent_remaining)),overageEnabled:s.overage_permitted,overageCount:s.overage_count,unlimited:s.unlimited};switch(n){case"chat":i.chat=r;break;case"completions":i.completions=r;break;case"premium_interactions":i.premiumChat=r;break}}}return i}async request(e,i,n,s,r){let o;for(const a of s){if(r.isCancellationRequested){return o}try{const l=await this.requestService.request({type:i,url:e,data:i==="POST"?JSON.stringify(n):void 0,disableCache:true,headers:{"Authorization":`Bearer ${a.accessToken}`}},r);const c=l.res.statusCode;if(c&&c!==200){o=l;continue}return l}catch(l){if(!r.isCancellationRequested){this.logService.error(`[chat entitlement] request: error ${l}`)}}}return o}update(e){this.state=e;this.context.update({entitlement:this.state.entitlement,organisations:this.state.organisations,sku:this.state.sku});if(e.quotas){this.chatQuotasAccessor.acceptQuotas(e.quotas)}}async forceResolveEntitlement(e=Ze.None){const i=await this.defaultAccountService.refresh();if(!i){return void 0}return this.resolveEntitlement(i,e)}async signUpFree(){const e=await this.getSessions();if(e.length===0){return void 0}return this.doSignUpFree(e)}async doSignUpFree(e){const i={restricted_telemetry:this.telemetryService.telemetryLevel===Pr.NONE?"disabled":"enabled",public_code_suggestions:"enabled"};const n=await this.request(gg.entitlementSignupLimitedUrl,"POST",i,e,Ze.None);if(!n){const o=await this.onUnknownSignUpError(h(14325,"No response received."),"[chat entitlement] sign-up: no response");return o?this.doSignUpFree(e):{errorCode:1}}if(n.res.statusCode&&n.res.statusCode!==200){if(n.res.statusCode===422){try{const a=await TC(n);if(a){const l=JSON.parse(a);if(typeof l.message==="string"&&l.message){this.onUnprocessableSignUpError(`[chat entitlement] sign-up: unprocessable entity (${l.message})`,l.message);return{errorCode:n.res.statusCode}}}}catch(a){}}const o=await this.onUnknownSignUpError(h(14326,"Unexpected status code {0}.",n.res.statusCode),`[chat entitlement] sign-up: unexpected status code ${n.res.statusCode}`);return o?this.doSignUpFree(e):{errorCode:n.res.statusCode}}let s=null;try{s=await TC(n)}catch(o){}if(!s){const o=await this.onUnknownSignUpError(h(14327,"Response has no contents."),"[chat entitlement] sign-up: response has no content");return o?this.doSignUpFree(e):{errorCode:2}}let r=void 0;try{r=JSON.parse(s);this.logService.trace(`[chat entitlement] sign-up: response is ${s}`)}catch(o){const a=await this.onUnknownSignUpError(h(14328,"Invalid response contents."),`[chat entitlement] sign-up: error parsing response (${o})`);return a?this.doSignUpFree(e):{errorCode:3}}this.update({entitlement:rt.Free});return Boolean(r?.subscribed)}async getSessions(){const e=await this.defaultAccountService.getDefaultAccount();if(e){const i=await this.authenticationService.getSessions(e.authenticationProvider.id);const n=i.filter(s=>s.id===e.sessionId);if(n.length){return n}}return[...await this.authenticationService.getSessions(this.defaultAccountService.getDefaultAccountAuthenticationProvider().id)]}async onUnknownSignUpError(e,i){this.logService.error(i);if(!this.lifecycleService.willShutdown){const{confirmed:n}=await this.dialogService.confirm({type:gt.Error,message:h(14329,"An error occurred while signing up for the GitHub Copilot Free plan. Would you like to try again?"),detail:e,primaryButton:h(14330,"Retry")});return n}return false}onUnprocessableSignUpError(e,i){this.logService.error(e);if(!this.lifecycleService.willShutdown){this.dialogService.prompt({type:gt.Error,message:h(14331,"An error occurred while signing up for the GitHub Copilot Free plan."),detail:i,buttons:[{label:h(14332,"OK"),run:()=>{}},{label:h(14333,"Learn More"),run:()=>this.openerService.open(b.parse(gg.upgradePlanUrl))}]})}}async signIn(e){const i=await this.defaultAccountService.signIn({additionalScopes:e?.additionalScopes,extraAuthorizeParameters:{get_started_with:"copilot-vscode"},provider:e?.useSocialProvider});if(!i){return{}}const n=await this.doResolveEntitlement(i,Ze.None);return{defaultAccount:i,entitlements:n}}dispose(){this.pendingResolveCts.dispose(true);super.dispose()}};pw=W([P(2,mf),P(3,et),P(4,sN),P(5,Z3),P(6,oN),P(7,lN),P(8,cN),P(9,rN)],pw);let gw=class FW extends me{static{Vl=this}static{this.CHAT_ENTITLEMENT_CONTEXT_STORAGE_KEY="chat.setupContext"}static{this.CHAT_DISABLED_CONFIGURATION_KEY="chat.disableAIFeatures"}get state(){return this.withConfiguration(this.suspendedState??this._state)}constructor(e,i,n,s,r){super();this.storageService=i;this.logService=n;this.configurationService=s;this.telemetryService=r;this.suspendedState=void 0;this._onDidChange=this._register(new L);this.onDidChange=this._onDidChange.event;this.updateBarrier=void 0;this.canSignUpContextKey=Ae.Entitlement.canSignUp.bindTo(e);this.signedOutContextKey=Ae.Entitlement.signedOut.bindTo(e);this.freeContextKey=Ae.Entitlement.planFree.bindTo(e);this.proContextKey=Ae.Entitlement.planPro.bindTo(e);this.proPlusContextKey=Ae.Entitlement.planProPlus.bindTo(e);this.businessContextKey=Ae.Entitlement.planBusiness.bindTo(e);this.enterpriseContextKey=Ae.Entitlement.planEnterprise.bindTo(e);this.organisationsContextKey=Ae.Entitlement.organisations.bindTo(e);this.isInternalContextKey=Ae.Entitlement.internal.bindTo(e);this.skuContextKey=Ae.Entitlement.sku.bindTo(e);this.hiddenContext=Ae.Setup.hidden.bindTo(e);this.laterContext=Ae.Setup.later.bindTo(e);this.installedContext=Ae.Setup.installed.bindTo(e);this.disabledContext=Ae.Setup.disabled.bindTo(e);this.untrustedContext=Ae.Setup.untrusted.bindTo(e);this.registeredContext=Ae.Setup.registered.bindTo(e);this._state=this.storageService.getObject(Vl.CHAT_ENTITLEMENT_CONTEXT_STORAGE_KEY,jt.PROFILE)??{entitlement:rt.Unknown,organisations:void 0,sku:void 0};this.updateContextSync();this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{if(e.affectsConfiguration(Vl.CHAT_DISABLED_CONFIGURATION_KEY)){this.updateContext()}}))}withConfiguration(e){if(this.configurationService.getValue(Vl.CHAT_DISABLED_CONFIGURATION_KEY)===true){return{...e,hidden:true}}return e}async update(e){this.logService.trace(`[chat entitlement context] update(): ${JSON.stringify(e)}`);const i=JSON.stringify(this._state);if(typeof e.installed==="boolean"&&typeof e.disabled==="boolean"&&typeof e.untrusted==="boolean"){this._state.installed=e.installed;this._state.disabled=e.disabled;this._state.untrusted=e.untrusted;if(e.installed&&!e.disabled){e.hidden=false}}if(typeof e.hidden==="boolean"){this._state.hidden=e.hidden}if(typeof e.later==="boolean"){this._state.later=e.later}if(typeof e.entitlement==="number"){this._state.entitlement=e.entitlement;this._state.organisations=e.organisations;this._state.sku=e.sku;if(this._state.entitlement===rt.Free||uN(this._state.entitlement)){this._state.registered=true}else if(this._state.entitlement===rt.Available){this._state.registered=false}}if(JS(this.configurationService,this._state.entitlement,this._state)){this._state.sku="no_auth_limited_copilot"}if(i===JSON.stringify(this._state)){return}this.storageService.store(Vl.CHAT_ENTITLEMENT_CONTEXT_STORAGE_KEY,{...this._state,later:void 0},jt.PROFILE,dg.MACHINE);return this.updateContext()}async updateContext(){await this.updateBarrier?.wait();this.updateContextSync()}updateContextSync(){const e=this.withConfiguration(this._state);this.signedOutContextKey.set(e.entitlement===rt.Unknown);this.canSignUpContextKey.set(e.entitlement===rt.Available);this.freeContextKey.set(e.entitlement===rt.Free);this.proContextKey.set(e.entitlement===rt.Pro);this.proPlusContextKey.set(e.entitlement===rt.ProPlus);this.businessContextKey.set(e.entitlement===rt.Business);this.enterpriseContextKey.set(e.entitlement===rt.Enterprise);this.organisationsContextKey.set(e.organisations);this.isInternalContextKey.set(Boolean(e.organisations?.some(i=>i==="github"||i==="microsoft"||i==="ms-copilot"||i==="MicrosoftCopilot")));this.skuContextKey.set(e.sku);this.hiddenContext.set(!!e.hidden);this.laterContext.set(!!e.later);this.installedContext.set(!!e.installed);this.disabledContext.set(!!e.disabled);this.untrustedContext.set(!!e.untrusted);this.registeredContext.set(!!e.registered);this.logService.trace(`[chat entitlement context] updateContext(): ${JSON.stringify(e)}`);HP(e,this.configurationService,this.telemetryService);this._onDidChange.fire()}suspend(){this.suspendedState={...this._state};this.updateBarrier=new Es}resume(){this.suspendedState=void 0;this.updateBarrier?.open();this.updateBarrier=void 0}};gw=Vl=W([P(0,Cu),P(1,IP),P(2,et),P(3,Xo),P(4,mf)],gw);var Ta;(function(t){t.responseVote=new E("chatSessionResponseVote","",{type:"string",description:h(6247,"When the response has been voted up, is set to 'up'. When voted down, is set to 'down'. Otherwise an empty string.")});t.responseDetectedAgentCommand=new E("chatSessionResponseDetectedAgentOrCommand",false,{type:"boolean",description:h(6248,"When the agent or command was automatically detected")});t.responseSupportsIssueReporting=new E("chatResponseSupportsIssueReporting",false,{type:"boolean",description:h(6249,"True when the current chat response supports issue reporting.")});t.responseIsFiltered=new E("chatSessionResponseFiltered",false,{type:"boolean",description:h(6250,"True when the chat response was filtered out by the server.")});t.responseHasError=new E("chatSessionResponseError",false,{type:"boolean",description:h(6251,"True when the chat response resulted in an error.")});t.requestInProgress=new E("chatSessionRequestInProgress",false,{type:"boolean",description:h(6252,"True when the current request is still in progress.")});t.currentlyEditing=new E("chatSessionCurrentlyEditing",false,{type:"boolean",description:h(6253,"True when the current request is being edited.")});t.currentlyEditingInput=new E("chatSessionCurrentlyEditingInput",false,{type:"boolean",description:h(6254,"True when the current request input at the bottom is being edited.")});(function(e){e["Sent"]="s";e["QueueOrSteer"]="qs"})(t.EditingRequestType||(t.EditingRequestType={}));t.editingRequestType=new E("chatEditingSentRequest",void 0,{type:"string",description:h(6255,"The type of the current editing request.")});t.isResponse=new E("chatResponse",false,{type:"boolean",description:h(6256,"The chat item is a response.")});t.isRequest=new E("chatRequest",false,{type:"boolean",description:h(6257,"The chat item is a request")});t.isPendingRequest=new E("chatRequestIsPending",false,{type:"boolean",description:h(6258,"True when the chat request item is pending in the queue.")});t.itemId=new E("chatItemId","",{type:"string",description:h(6259,"The id of the chat item.")});t.lastItemId=new E("chatLastItemId",[],{type:"string",description:h(6260,"The id of the last chat item.")});t.editApplied=new E("chatEditApplied",false,{type:"boolean",description:h(6261,"True when the chat text edits have been applied.")});t.inputHasText=new E("chatInputHasText",false,{type:"boolean",description:h(6262,"True when the chat input has text.")});t.inputHasFocus=new E("chatInputHasFocus",false,{type:"boolean",description:h(6263,"True when the chat input has focus.")});t.inChatInput=new E("inChatInput",false,{type:"boolean",description:h(6264,"True when focus is in the chat input, false otherwise.")});t.inChatSession=new E("inChat",false,{type:"boolean",description:h(6265,"True when focus is in the chat widget, false otherwise.")});t.inChatEditor=new E("inChatEditor",false,{type:"boolean",description:h(6266,"Whether focus is in a chat editor.")});t.inChatTerminalToolOutput=new E("inChatTerminalToolOutput",false,{type:"boolean",description:h(6267,"True when focus is in the chat terminal output region.")});t.chatModeKind=new E("chatAgentKind",Vr.Ask,{type:"string",description:h(6268,"The 'kind' of the current agent.")});t.chatModeName=new E("chatModeName","",{type:"string",description:h(6269,"The name of the current chat mode (e.g. 'Plan' for custom modes).")});t.supported=ni.or(z3.negate(),X3.notEqualsTo(""),ni.has("config.chat.experimental.serverlessWebEnabled"));t.enabled=new E("chatIsEnabled",false,{type:"boolean",description:h(6270,"True when chat is enabled because a default chat participant is activated with an implementation.")});t.lockedToCodingAgent=new E("lockedToCodingAgent",false,{type:"boolean",description:h(6271,"True when the chat widget is locked to the coding agent session.")});t.chatSessionHasCustomAgentTarget=new E("chatSessionHasCustomAgentTarget",false,{type:"boolean",description:h(6272,"True when the chat session has a customAgentTarget defined to filter modes.")});t.agentSupportsAttachments=new E("agentSupportsAttachments",false,{type:"boolean",description:h(6273,"True when the chat agent supports attachments.")});t.withinEditSessionDiff=new E("withinEditSessionDiff",false,{type:"boolean",description:h(6274,"True when the chat widget dispatches to the edit session chat.")});t.filePartOfEditSession=new E("filePartOfEditSession",false,{type:"boolean",description:h(6275,"True when the chat widget is within a file with an edit session.")});t.extensionParticipantRegistered=new E("chatPanelExtensionParticipantRegistered",false,{type:"boolean",description:h(6276,"True when a default chat participant is registered for the panel from an extension.")});t.panelParticipantRegistered=new E("chatPanelParticipantRegistered",false,{type:"boolean",description:h(6277,"True when a default chat participant is registered for the panel.")});t.chatEditingCanUndo=new E("chatEditingCanUndo",false,{type:"boolean",description:h(6278,"True when it is possible to undo an interaction in the editing panel.")});t.chatEditingCanRedo=new E("chatEditingCanRedo",false,{type:"boolean",description:h(6279,"True when it is possible to redo an interaction in the editing panel.")});t.languageModelsAreUserSelectable=new E("chatModelsAreUserSelectable",false,{type:"boolean",description:h(6280,"True when the chat model can be selected manually by the user.")});t.chatSessionHasModels=new E("chatSessionHasModels",false,{type:"boolean",description:h(6281,"True when the chat is in a contributed chat session that has available 'models' to display.")});t.chatSessionOptionsValid=new E("chatSessionOptionsValid",true,{type:"boolean",description:h(6282,"True when all selected session options exist in their respective option group items.")});t.extensionInvalid=new E("chatExtensionInvalid",false,{type:"boolean",description:h(6283,"True when the installed chat extension is invalid and needs to be updated.")});t.inputCursorAtTop=new E("chatCursorAtTop",false);t.inputHasAgent=new E("chatInputHasAgent",false);t.location=new E("chatLocation",void 0);t.inQuickChat=new E("quickChatHasFocus",false,{type:"boolean",description:h(6284,"True when the quick chat UI has focus, false otherwise.")});t.inAgentSessionsWelcome=new E("inAgentSessionsWelcome",false,{type:"boolean",description:h(6285,"True when the chat input is within the agent sessions welcome page.")});t.chatSessionType=new E("chatSessionType","",{type:"string",description:h(6286,"The type of the current chat session.")});t.hasFileAttachments=new E("chatHasFileAttachments",false,{type:"boolean",description:h(6287,"True when the chat has file attachments.")});t.chatSessionIsEmpty=new E("chatSessionIsEmpty",true,{type:"boolean",description:h(6288,"True when the current chat session has no requests.")});t.hasPendingRequests=new E("chatHasPendingRequests",false,{type:"boolean",description:h(6289,"True when there are pending requests in the queue.")});t.remoteJobCreating=new E("chatRemoteJobCreating",false,{type:"boolean",description:h(6290,"True when a remote coding agent job is being created.")});t.hasRemoteCodingAgent=new E("hasRemoteCodingAgent",false,h(6291,"Whether any remote coding agent is available"));t.hasCanDelegateProviders=new E("chatHasCanDelegateProviders",false,{type:"boolean",description:h(6292,"True when there are chat session providers with delegation support available.")});t.enableRemoteCodingAgentPromptFileOverlay=new E("enableRemoteCodingAgentPromptFileOverlay",false,h(6293,"Whether the remote coding agent prompt file overlay feature is enabled"));t.skipChatRequestInProgressMessage=new E("chatSkipRequestInProgressMessage",false,{type:"boolean",description:h(6294,"True when the chat request in progress message should be skipped.")});t.Setup=Ae.Setup;t.Entitlement=Ae.Entitlement;t.chatQuotaExceeded=Ae.chatQuotaExceeded;t.completionsQuotaExceeded=Ae.completionsQuotaExceeded;t.Editing={hasToolConfirmation:new E("chatHasToolConfirmation",false,{type:"boolean",description:h(6295,"True when a tool confirmation is present.")}),hasElicitationRequest:new E("chatHasElicitationRequest",false,{type:"boolean",description:h(6296,"True when a chat elicitation request is pending.")})};t.Tools={toolsCount:new E("toolsCount",0,{type:"number",description:h(6297,"The count of tools available in the chat.")})};t.Modes={hasCustomChatModes:new E("chatHasCustomAgents",false,{type:"boolean",description:h(6298,"True when the chat has custom agents available.")}),agentModeDisabledByPolicy:new E("chatAgentModeDisabledByPolicy",false,{type:"boolean",description:h(6299,"True when agent mode is disabled by organization policy.")})};t.panelLocation=new E("chatPanelLocation",void 0,{type:"number",description:h(6300,"The location of the chat panel.")});t.agentSessionsViewerFocused=new E("agentSessionsViewerFocused",true,{type:"boolean",description:h(6301,"If the agent sessions view in the chat view is focused.")});t.agentSessionsViewerOrientation=new E("agentSessionsViewerOrientation",void 0,{type:"number",description:h(6302,"Orientation of the agent sessions view in the chat view.")});t.agentSessionsViewerPosition=new E("agentSessionsViewerPosition",void 0,{type:"number",description:h(6303,"Position of the agent sessions view in the chat view.")});t.agentSessionsViewerVisible=new E("agentSessionsViewerVisible",void 0,{type:"boolean",description:h(6304,"Visibility of the agent sessions view in the chat view.")});t.agentSessionType=new E("chatSessionType","",{type:"string",description:h(6305,"The type of the current agent session item.")});t.agentSessionSection=new E("agentSessionSection","",{type:"string",description:h(6306,"The section of the current agent session section item.")});t.isArchivedAgentSession=new E("agentSessionIsArchived",false,{type:"boolean",description:h(6307,"True when the agent session item is archived.")});t.isReadAgentSession=new E("agentSessionIsRead",false,{type:"boolean",description:h(6308,"True when the agent session item is read.")});t.hasMultipleAgentSessionsSelected=new E("agentSessionHasMultipleSelected",false,{type:"boolean",description:h(6309,"True when multiple agent sessions are selected.")});t.hasAgentSessionChanges=new E("agentSessionHasChanges",false,{type:"boolean",description:h(6310,"True when the current agent session item has changes.")});t.isKatexMathElement=new E("chatIsKatexMathElement",false,{type:"boolean",description:h(6311,"True when focusing a KaTeX math element.")})})(Ta||(Ta={}));var NC;(function(t){t.inEditingMode=ni.or(Ta.chatModeKind.isEqualTo(Vr.Edit),Ta.chatModeKind.isEqualTo(Vr.Agent));t.chatSetupTriggerContext=ni.or(Ta.Setup.installed.negate(),Ta.Entitlement.canSignUp)})(NC||(NC={}));const dN=te("ILanguageModelsConfigurationService");var up;var xr;(function(t){t[t["System"]=0]="System";t[t["User"]=1]="User";t[t["Assistant"]=2]="Assistant"})(xr||(xr={}));var MC;(function(t){t[t["Assistant"]=0]="Assistant";t[t["User"]=1]="User";t[t["Extension"]=2]="Extension"})(MC||(MC={}));var OC;(function(t){t["PNG"]="image/png";t["JPEG"]="image/jpeg";t["GIF"]="image/gif";t["WEBP"]="image/webp";t["BMP"]="image/bmp"})(OC||(OC={}));var FC;(function(t){t["Low"]="low";t["High"]="high"})(FC||(FC={}));var mw;(function(t){function e(s){const r=typeof s.capabilities?.agentMode==="undefined"||s.capabilities.agentMode;return r&&!!s.capabilities?.toolCalling}t.suitableForAgentMode=e;function i(s){return`${s.name} (${s.vendor})`}t.asQualifiedName=i;function n(s,r){if(r.vendor==="copilot"&&s===r.name){return true}return s===i(r)}t.matchesQualifiedName=n})(mw||(mw={}));const UC={type:"object",required:["vendor","displayName"],properties:{vendor:{type:"string",description:h(6324,"A globally unique vendor of language model chat provider.")},displayName:{type:"string",description:h(6325,"The display name of the language model chat provider.")},configuration:{type:"object",description:h(6326,"Configuration options for the language model chat provider."),anyOf:[{$ref:"http://json-schema.org/draft-07/schema#"},{properties:{properties:{type:"object",additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#",properties:{secret:{type:"boolean",description:h(6327,"Whether the property is a secret.")}}}},additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#",properties:{secret:{type:"boolean",description:h(6327,"Whether the property is a secret.")}}}}}]},managementCommand:{type:"string",description:h(6328,"A command to manage the language model chat provider, e.g. 'Manage Copilot models'. This is used in the chat model picker. If not provided, a gear icon is not rendered during vendor selection."),deprecated:true,deprecationMessage:h(6329,"The managementCommand property is deprecated and will be removed in a future release. Use the new configuration property instead.")},when:{type:"string",description:h(6330,"Condition which must be true to show this language model chat provider in the Manage Models list.")}}};const hN=NP.registerExtensionPoint({extensionPoint:"languageModelChatProviders",jsonSchema:{description:h(6331,"Contribute language model chat providers of a specific vendor."),oneOf:[UC,{type:"array",items:UC}]},activationEventsGenerator:function*(t){for(const e of t){yield`onLanguageModelChatProvider:${e.vendor}`}}});const qv="chatModelPickerPreferences";let $C=class UW{static{up=this}static{this.SECRET_KEY_PREFIX="chat.lm.secret."}static{this.SECRET_INPUT="${input:{0}}"}constructor(e,i,n,s,r,o,a){this._extensionService=e;this._logService=i;this._storageService=n;this._contextKeyService=s;this._languageModelsConfigurationService=r;this._quickInputService=o;this._secretStorageService=a;this._store=new pe;this._providers=new Map;this._vendors=new Map;this._onDidChangeLanguageModelVendors=this._store.add(new L);this.onDidChangeLanguageModelVendors=this._onDidChangeLanguageModelVendors.event;this._modelsGroups=new Map;this._modelCache=new Map;this._resolveLMSequencer=new b4;this._modelPickerUserPreferences={};this._onLanguageModelChange=this._store.add(new L);this.onDidChangeLanguageModels=this._onLanguageModelChange.event;this._hasUserSelectableModels=Ta.languageModelsAreUserSelectable.bindTo(s);this._modelPickerUserPreferences=this._readModelPickerPreferences();this._store.add(this._storageService.onDidChangeValue(jt.PROFILE,qv,this._store)(()=>this._onDidChangeModelPickerPreferences()));this._store.add(this.onDidChangeLanguageModels(()=>this._hasUserSelectableModels.set(this._modelCache.size>0&&Array.from(this._modelCache.values()).some(l=>l.isUserSelectable))));this._store.add(this._languageModelsConfigurationService.onDidChangeLanguageModelGroups(l=>this._onDidChangeLanguageModelGroups(l)));this._store.add(hN.setHandler((l,{added:c,removed:u})=>{const d=[];const f=[];for(const p of c){for(const m of qi.wrap(p.value)){if(this._vendors.has(m.vendor)){p.collector.error(h(6332,"The vendor '{0}' is already registered and cannot be registered twice",m.vendor));continue}if(Oc(m.vendor)){p.collector.error(h(6333,"The vendor field cannot be empty."));continue}if(m.vendor.trim()!==m.vendor){p.collector.error(h(6334,"The vendor field cannot start or end with whitespace."));continue}d.push(m)}}for(const p of u){for(const m of qi.wrap(p.value)){f.push(m)}}this.deltaLanguageModelChatProviderDescriptors(d,f)}))}deltaLanguageModelChatProviderDescriptors(e,i){const n=[];const s=[];for(const r of e){if(this._vendors.has(r.vendor)){this._logService.error(`The vendor '${r.vendor}' is already registered and cannot be registered twice`);continue}if(Oc(r.vendor)){this._logService.error("The vendor field cannot be empty.");continue}if(r.vendor.trim()!==r.vendor){this._logService.error("The vendor field cannot start or end with whitespace.");continue}const o={vendor:r.vendor,displayName:r.displayName,configuration:r.configuration,managementCommand:r.managementCommand,when:r.when,isDefault:r.vendor==="copilot"};this._vendors.set(r.vendor,o);n.push(r.vendor);if(this._hasStoredModelForVendor(r.vendor)){this._extensionService.activateByEvent(`onLanguageModelChatProvider:${r.vendor}`)}}for(const r of i){this._vendors.delete(r.vendor);this._providers.delete(r.vendor);this._clearModelCache(r.vendor);s.push(r.vendor)}for(const[r,o]of this._providers){if(!this._vendors.has(r)){this._providers.delete(r)}}if(n.length>0||s.length>0){this._onDidChangeLanguageModelVendors.fire([...n,...s]);if(s.length>0){for(const r of s){this._onLanguageModelChange.fire(r)}}}}async _onDidChangeLanguageModelGroups(e){const i=new Set(e.map(n=>n.vendor));await Promise.all(Array.from(i).map(n=>this._resolveAllLanguageModels(n,true)))}_readModelPickerPreferences(){return this._storageService.getObject(qv,jt.PROFILE,{})}_onDidChangeModelPickerPreferences(){const e=this._readModelPickerPreferences();const i=this._modelPickerUserPreferences;const n=new Set;let s=false;for(const r in e){if(i[r]!==e[r]){s=true;const o=this._modelCache.get(r);if(o){n.add(o.vendor)}}}for(const r in i){if(!e.hasOwnProperty(r)){s=true;const o=this._modelCache.get(r);if(o){n.add(o.vendor)}}}if(s){this._logService.trace("[LM] Updated model picker preferences from storage");this._modelPickerUserPreferences=e;for(const r of n){this._onLanguageModelChange.fire(r)}}}_hasStoredModelForVendor(e){return Object.keys(this._modelPickerUserPreferences).some(i=>{return i.startsWith(e)})}_saveModelPickerPreferences(){this._storageService.store(qv,this._modelPickerUserPreferences,jt.PROFILE,dg.USER)}updateModelPickerPreference(e,i){const n=this._modelCache.get(e);if(!n){this._logService.warn(`[LM] Cannot update model picker preference for unknown model ${e}`);return}this._modelPickerUserPreferences[e]=i;if(i===n.isUserSelectable){delete this._modelPickerUserPreferences[e];this._saveModelPickerPreferences()}else if(n.isUserSelectable!==i){this._saveModelPickerPreferences()}this._onLanguageModelChange.fire(n.vendor);this._logService.trace(`[LM] Updated model picker preference for ${e} to ${i}`)}getVendors(){return Array.from(this._vendors.values()).filter(e=>{if(!e.when){return true}const i=ni.deserialize(e.when);return i?this._contextKeyService.contextMatchesRules(i):false})}getLanguageModelIds(){return Array.from(this._modelCache.keys())}lookupLanguageModel(e){const i=this._modelCache.get(e);if(i&&this._modelPickerUserPreferences[e]!==void 0){return{...i,isUserSelectable:this._modelPickerUserPreferences[e]}}return i}lookupLanguageModelByQualifiedName(e){for(const i of this._modelCache.values()){if(mw.matchesQualifiedName(e,i)){return i}}return void 0}async _resolveAllLanguageModels(e,i){const n=this._vendors.get(e);if(!n){return}await this._extensionService.activateByEvent(`onLanguageModelChatProvider:${e}`);const s=this._providers.get(e);if(!s){this._logService.warn(`[LM] No provider registered for vendor ${e}`);return}return this._resolveLMSequencer.queue(e,async()=>{const r=[];const o=[];try{const u=await s.provideLanguageModelChatInfo({silent:i},Ze.None);if(u.length){r.push(...u);const d=[];for(const f of u){if(n.isDefault){if(f.metadata.isUserSelectable||this._modelPickerUserPreferences[f.identifier]===true){d.push(f.identifier)}else{this._logService.trace(`[LM] Skipping model ${f.identifier} from model picker as it is not user selectable.`)}}else{d.push(f.identifier)}}o.push({modelIdentifiers:d})}}catch(u){o.push({modelIdentifiers:[],status:{message:iE(u),severity:gt.Error}})}const a=this._languageModelsConfigurationService.getLanguageModelsProviderGroups();for(const u of a){if(u.vendor!==e){continue}const d=await this._resolveConfiguration(u,n.configuration);try{const f=await s.provideLanguageModelChatInfo({group:u.name,silent:i,configuration:d},Ze.None);if(f.length){r.push(...f);o.push({group:u,modelIdentifiers:f.map(p=>p.identifier)})}}catch(f){o.push({group:u,modelIdentifiers:[],status:{message:iE(f),severity:gt.Error}})}}this._modelsGroups.set(e,o);const l=this._clearModelCache(e);let c=false;for(const u of r){if(this._modelCache.has(u.identifier)){this._logService.warn(`[LM] Model ${u.identifier} is already registered. Skipping.`);continue}this._modelCache.set(u.identifier,u.metadata);c=c||!Gi(l.get(u.identifier),u.metadata);l.delete(u.identifier)}this._logService.trace(`[LM] Resolved language models for vendor ${e}`,r);c=c||l.size>0;if(c){this._onLanguageModelChange.fire(e)}else{this._logService.trace(`[LM] No changes in language models for vendor ${e}`)}})}getLanguageModelGroups(e){return this._modelsGroups.get(e)??[]}async selectLanguageModels(e){if(e.vendor){await this._resolveAllLanguageModels(e.vendor,true)}else{const n=Array.from(this._vendors.keys());await Promise.all(n.map(s=>this._resolveAllLanguageModels(s,true)))}const i=[];for(const[n,s]of this._modelCache){if((e.vendor===void 0||s.vendor===e.vendor)&&(e.family===void 0||s.family===e.family)&&(e.version===void 0||s.version===e.version)&&(e.id===void 0||s.id===e.id)){i.push(n)}}this._logService.trace("[LM] selected language models",e,i);return i}registerLanguageModelProvider(e,i){this._logService.trace("[LM] registering language model provider",e,i);if(!this._vendors.has(e)){throw new Error(`Chat model provider uses UNKNOWN vendor ${e}.`)}if(this._providers.has(e)){throw new Error(`Chat model provider for vendor ${e} is already registered.`)}this._providers.set(e,i);if(this._hasStoredModelForVendor(e)){this._resolveAllLanguageModels(e,true)}const n=i.onDidChange(()=>{this._resolveAllLanguageModels(e,true)});return ye(()=>{this._logService.trace("[LM] UNregistered language model provider",e);this._clearModelCache(e);this._providers.delete(e);n.dispose()})}async sendChatRequest(e,i,n,s,r){const o=this._providers.get(this._modelCache.get(e)?.vendor||"");if(!o){throw new Error(`Chat provider for model ${e} is not registered.`)}return o.sendChatRequest(e,n,i,s,r)}computeTokenLength(e,i,n){const s=this._modelCache.get(e);if(!s){throw new Error(`Chat model ${e} could not be found.`)}const r=this._providers.get(s.vendor);if(!r){throw new Error(`Chat provider for model ${e} is not registered.`)}return r.provideTokenCount(e,i,n)}async configureLanguageModelsProviderGroup(e,i){const n=this.getVendors().find(({vendor:l})=>l===e);if(!n){throw new Error(`Vendor ${e} not found.`)}if(n.managementCommand){await this._resolveAllLanguageModels(n.vendor,false);return}const s=this._languageModelsConfigurationService.getLanguageModelsProviderGroups();const r=s.find(l=>l.vendor===e&&l.name===i);const o=await this.promptForName(s,n,r);if(!o){return}const a=r?await this._resolveConfiguration(r,n.configuration):void 0;try{const l=n.configuration?await this.promptForConfiguration(o,n.configuration,a):void 0;if(n.configuration&&!l){return}const c=await this._resolveLanguageModelProviderGroup(o,e,l,n.configuration);const u=r?await this._languageModelsConfigurationService.updateLanguageModelsProviderGroup(r,c):await this._languageModelsConfigurationService.addLanguageModelsProviderGroup(c);if(n.configuration&&this.requireConfiguring(n.configuration)){const d=this.getSnippetForFirstUnconfiguredProperty(l??{},n.configuration);await this._languageModelsConfigurationService.configureLanguageModels({group:u,snippet:d})}}catch(l){if(Ls(l)){return}throw l}}async addLanguageModelsProviderGroup(e,i,n){const s=this.getVendors().find(({vendor:o})=>o===i);if(!s){throw new Error(`Vendor ${i} not found.`)}const r=await this._resolveLanguageModelProviderGroup(e,i,n,s.configuration);await this._languageModelsConfigurationService.addLanguageModelsProviderGroup(r)}async removeLanguageModelsProviderGroup(e,i){const n=this.getVendors().find(({vendor:o})=>o===e);if(!n){throw new Error(`Vendor ${e} not found.`)}const s=this._languageModelsConfigurationService.getLanguageModelsProviderGroups();const r=s.find(o=>o.vendor===e&&o.name===i);if(!r){throw new Error(`Language model provider group ${i} for vendor ${e} not found.`)}await this._deleteSecretsInConfiguration(r,n.configuration);await this._languageModelsConfigurationService.removeLanguageModelsProviderGroup(r)}requireConfiguring(e){if(e.additionalProperties){return true}if(!e.properties){return false}for(const i of Object.keys(e.properties)){if(!this.canPromptForProperty(e.properties[i])){return true}}return false}getSnippetForFirstUnconfiguredProperty(e,i){if(!i.properties){return void 0}for(const n of Object.keys(i.properties)){if(e[n]===void 0){const s=i.properties[n];if(s&&typeof s!=="boolean"&&s.defaultSnippets?.[0]){const r=s.defaultSnippets[0];let o=r.bodyText??JSON.stringify(r.body,null,"	");o=o.replace(/"(\^[^"]*)"/g,(a,l)=>l.substring(1));return`"${n}": ${o}`}}}return void 0}async promptForName(e,i,n){let s=n?.name;if(!s){s=i.displayName;let a=1;while(e.some(l=>l.vendor===i.vendor&&l.name===s)){a++;s=`${i.displayName} ${a}`}}let r;const o=new pe;try{await new Promise(a=>{const l=o.add(this._quickInputService.createInputBox());l.title=h(6335,"Group Name");l.placeholder=h(6336,"Enter a name for the group");l.value=s;l.ignoreFocusOut=true;o.add(l.onDidChangeValue(c=>{if(!c){l.validationMessage=h(6337,"Please enter a name");l.severity=gt.Error;return}if(!n&&e.some(u=>u.name===c)){l.validationMessage=h(6338,"A language models group with this name already exists");l.severity=gt.Error;return}l.validationMessage=void 0;l.severity=gt.Ignore}));o.add(l.onDidAccept(async()=>{r=l.value;l.hide()}));o.add(l.onDidHide(()=>a()));l.show()})}finally{o.dispose()}return r}async promptForConfiguration(e,i,n){if(!i.properties){return}const s=n?{...n}:{};for(const r of Object.keys(i.properties)){const o=i.properties[r];const a=!!i.required?.includes(r);const l=await this.promptForValue(e,r,o,a,n);if(l!==void 0){s[r]=l}}return s}async promptForValue(e,i,n,s,r){if(!n){return void 0}if(!this.canPromptForProperty(n)){return void 0}if(n.type==="array"&&n.items&&!Array.isArray(n.items)&&n.items.enum){const a=await this.promptForArray(e,i,n);if(a===void 0){return void 0}return a}const o=await this.promptForInput(e,i,n,s,r);if(o===void 0){return void 0}return o}canPromptForProperty(e){if(!e||typeof e==="boolean"){return false}if(e.type==="array"&&e.items&&!Array.isArray(e.items)&&e.items.enum){return true}if(e.type==="string"||e.type==="number"||e.type==="integer"||e.type==="boolean"){return true}return false}async promptForArray(e,i,n){if(!n.items||Array.isArray(n.items)||!n.items.enum){return void 0}const s=n.items.enum;const r=new pe;try{return await new Promise(o=>{const a=r.add(this._quickInputService.createQuickPick());a.title=`${e}: ${n.title??i}`;a.items=s.map(l=>({label:l}));a.placeholder=n.description??h(6339,"Select value for {0}",i);a.canSelectMany=true;a.ignoreFocusOut=true;r.add(a.onDidAccept(()=>{o(a.selectedItems.map(l=>l.label));a.hide()}));r.add(a.onDidHide(()=>{o(void 0)}));a.show()})}finally{r.dispose()}}async promptForInput(e,i,n,s,r){const o=new pe;try{const a=await new Promise((l,c)=>{const u=o.add(this._quickInputService.createInputBox());u.title=`${e}: ${n.title??i}`;u.placeholder=h(6340,"Enter value for {0}",i);u.password=!!n.secret;u.ignoreFocusOut=true;if(r?.[i]){u.value=String(r?.[i])}else if(n.default){u.value=String(n.default)}if(n.description){u.prompt=n.description}o.add(u.onDidChangeValue(d=>{if(!d&&s){u.validationMessage=h(6341,"Value is required");u.severity=gt.Error;return}if(n.type==="number"||n.type==="integer"){if(isNaN(Number(d))){u.validationMessage=h(6342,"Please enter a number");u.severity=gt.Error;return}}if(n.type==="boolean"){if(d!=="true"&&d!=="false"){u.validationMessage=h(6343,"Please enter true or false");u.severity=gt.Error;return}}u.validationMessage=void 0;u.severity=gt.Ignore}));o.add(u.onDidAccept(()=>{if(!u.value&&s){u.validationMessage=h(6341,"Value is required");u.severity=gt.Error;return}l(u.value);u.hide()}));o.add(u.onDidHide(d=>{if(d.reason===ow.Gesture){c(new Vi)}else{l(void 0)}}));u.show()});if(!a){return void 0}if(n.type==="number"||n.type==="integer"){return Number(a)}else if(n.type==="boolean"){return a==="true"}else{return a}}finally{o.dispose()}}encodeSecretKey(e){return wL(up.SECRET_INPUT,e)}decodeSecretKey(e){if(!Xe(e)){return void 0}return e.substring(e.indexOf(":")+1,e.length-1)}_clearModelCache(e){const i=new Map;for(const[n,s]of this._modelCache.entries()){if(s.vendor===e){i.set(n,s);this._modelCache.delete(n)}}return i}async _resolveConfiguration(e,i){if(!i){return{}}const n={};for(const s in e){if(s==="vendor"||s==="name"||s==="range"){continue}let r=e[s];if(i.properties?.[s]?.secret){const o=this.decodeSecretKey(r);r=o?await this._secretStorageService.get(o):void 0}n[s]=r}return n}async _resolveLanguageModelProviderGroup(e,i,n,s){if(!s){return{name:e,vendor:i}}const r={};for(const o in n){let a=n[o];if(s.properties?.[o]?.secret&&Xe(a)){const l=`${up.SECRET_KEY_PREFIX}${Wc(Pi()).toString(16)}`;await this._secretStorageService.set(l,a);a=this.encodeSecretKey(l)}r[o]=a}return{name:e,vendor:i,...r}}async _deleteSecretsInConfiguration(e,i){if(!i){return}const{vendor:n,name:s,range:r,...o}=e;for(const a in o){const l=e[a];if(i.properties?.[a]?.secret){const c=this.decodeSecretKey(l);if(c){await this._secretStorageService.delete(c)}}}}async migrateLanguageModelsProviderGroup(e){const{vendor:i,name:n,...s}=e;if(!this._vendors.get(i)){throw new Error(`Vendor ${i} not found.`)}await this._extensionService.activateByEvent(`onLanguageModelChatProvider:${i}`);const r=this._providers.get(i);if(!r){throw new Error(`Chat model provider for vendor ${i} is not registered.`)}const o=await r.provideLanguageModelChatInfo({group:n,silent:false,configuration:s},Ze.None);for(const a of o){const l=`${i}/${a.metadata.id}`;if(this._modelPickerUserPreferences[l]===true){this._modelPickerUserPreferences[a.identifier]=true}delete this._modelPickerUserPreferences[l]}this._saveModelPickerPreferences();await this.addLanguageModelsProviderGroup(n,i,s)}dispose(){this._store.dispose();this._providers.clear()}};$C=up=W([P(0,x3),P(1,et),P(2,IP),P(3,Cu),P(4,dN),P(5,_3),P(6,v3)],$C);new E("debugType",void 0,{type:"string",description:h(7539,"Debug type of the active debug session. For example 'python'.")});new E("debugConfigurationType",void 0,{type:"string",description:h(7540,"Debug type of the selected launch configuration. For example 'python'.")});new E("debugState","inactive",{type:"string",description:h(7541,"State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.")});const fN="debugUx";new E(fN,"default",{type:"string",description:h(7542,"Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.")});new E("hasDebugged",false,{type:"boolean",description:h(7543,"True when a debug session has been started at least once, false otherwise.")});new E("inDebugMode",false,{type:"boolean",description:h(7544,"True when debugging, false otherwise.")});new E("inDebugRepl",false,{type:"boolean",description:h(7545,"True when focus is in the debug console, false otherwise.")});new E("breakpointWidgetVisible",false,{type:"boolean",description:h(7546,"True when breakpoint editor zone widget is visible, false otherwise.")});new E("inBreakpointWidget",false,{type:"boolean",description:h(7547,"True when focus is in the breakpoint editor zone widget, false otherwise.")});new E("breakpointsFocused",true,{type:"boolean",description:h(7548,"True when the BREAKPOINTS view is focused, false otherwise.")});new E("watchExpressionsFocused",true,{type:"boolean",description:h(7549,"True when the WATCH view is focused, false otherwise.")});new E("watchExpressionsExist",false,{type:"boolean",description:h(7550,"True when at least one watch expression exists, false otherwise.")});new E("variablesFocused",true,{type:"boolean",description:h(7551,"True when the VARIABLES views is focused, false otherwise")});new E("expressionSelected",false,{type:"boolean",description:h(7552,"True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.")});new E("breakpointInputFocused",false,{type:"boolean",description:h(7553,"True when the input box has focus in the BREAKPOINTS view.")});new E("callStackItemType",void 0,{type:"string",description:h(7554,"Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'")});new E("callStackSessionIsAttach",false,{type:"boolean",description:h(7555,"True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.")});new E("callStackItemStopped",false,{type:"boolean",description:h(7556,"True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.")});new E("callStackSessionHasOneThread",false,{type:"boolean",description:h(7557,"True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.")});new E("callStackFocused",true,{type:"boolean",description:h(7558,"True when the CALLSTACK view is focused, false otherwise.")});new E("watchItemType",void 0,{type:"string",description:h(7559,"Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'")});new E("canViewMemory",void 0,{type:"boolean",description:h(7560,"Indicates whether the item in the view has an associated memory refrence.")});new E("breakpointItemType",void 0,{type:"string",description:h(7561,"Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'")});new E("breakpointItemBytes",void 0,{type:"boolean",description:h(7562,"Whether the breakpoint item is a data breakpoint on a byte range.")});new E("breakpointHasModes",false,{type:"boolean",description:h(7563,"Whether the breakpoint has multiple modes it can switch to.")});new E("breakpointSupportsCondition",false,{type:"boolean",description:h(7564,"True when the focused breakpoint supports conditions.")});new E("loadedScriptsSupported",false,{type:"boolean",description:h(7565,"True when the focused sessions supports the LOADED SCRIPTS view")});new E("loadedScriptsItemType",void 0,{type:"string",description:h(7566,"Represents the item type of the focused element in the LOADED SCRIPTS view.")});new E("focusedSessionIsAttach",false,{type:"boolean",description:h(7567,"True when the focused session is 'attach'.")});new E("focusedSessionIsNoDebug",false,{type:"boolean",description:h(7568,"True when the focused session is run without debugging.")});new E("stepBackSupported",false,{type:"boolean",description:h(7569,"True when the focused session supports 'stepBack' requests.")});new E("restartFrameSupported",false,{type:"boolean",description:h(7570,"True when the focused session supports 'restartFrame' requests.")});new E("stackFrameSupportsRestart",false,{type:"boolean",description:h(7571,"True when the focused stack frame supports 'restartFrame'.")});new E("jumpToCursorSupported",false,{type:"boolean",description:h(7572,"True when the focused session supports 'jumpToCursor' request.")});new E("stepIntoTargetsSupported",false,{type:"boolean",description:h(7573,"True when the focused session supports 'stepIntoTargets' request.")});new E("breakpointsExist",false,{type:"boolean",description:h(7574,"True when at least one breakpoint exists.")});new E("debuggersAvailable",false,{type:"boolean",description:h(7575,"True when there is at least one debug extensions active.")});new E("debugExtensionAvailable",true,{type:"boolean",description:h(7576,"True when there is at least one debug extension installed and enabled.")});new E("debugProtocolVariableMenuContext",void 0,{type:"string",description:h(7577,"Represents the context the debug adapter sets on the focused variable in the VARIABLES view.")});new E("debugSetVariableSupported",false,{type:"boolean",description:h(7578,"True when the focused session supports 'setVariable' request.")});new E("debugSetDataBreakpointAddressSupported",false,{type:"boolean",description:h(7579,"True when the focused session supports 'getBreakpointInfo' request on an address.")});new E("debugSetExpressionSupported",false,{type:"boolean",description:h(7580,"True when the focused session supports 'setExpression' request.")});new E("breakWhenValueChangesSupported",false,{type:"boolean",description:h(7581,"True when the focused session supports to break when value changes.")});new E("breakWhenValueIsAccessedSupported",false,{type:"boolean",description:h(7582,"True when the focused breakpoint supports to break when value is accessed.")});new E("breakWhenValueIsReadSupported",false,{type:"boolean",description:h(7583,"True when the focused breakpoint supports to break when value is read.")});new E("terminateDebuggeeSupported",false,{type:"boolean",description:h(7584,"True when the focused session supports the terminate debuggee capability.")});new E("suspendDebuggeeSupported",false,{type:"boolean",description:h(7585,"True when the focused session supports the suspend debuggee capability.")});new E("terminateThreadsSupported",false,{type:"boolean",description:h(7586,"True when the focused session supports the terminate threads capability.")});new E("variableEvaluateNamePresent",false,{type:"boolean",description:h(7587,"True when the focused variable has an 'evalauteName' field set.")});new E("variableIsReadonly",false,{type:"boolean",description:h(7588,"True when the focused variable is read-only.")});new E("variableValue",false,{type:"string",description:h(7589,"Value of the variable, present for debug visualization clauses.")});new E("variableType",false,{type:"string",description:h(7590,"Type of the variable, present for debug visualization clauses.")});new E("variableInterfaces",false,{type:"array",description:h(7591,"Any interfaces or contracts that the variable satisfies, present for debug visualization clauses.")});new E("variableName",false,{type:"string",description:h(7592,"Name of the variable, present for debug visualization clauses.")});new E("variableLanguage",false,{type:"string",description:h(7593,"Language of the variable source, present for debug visualization clauses.")});new E("variableExtensionId",false,{type:"string",description:h(7594,"Extension ID of the variable source, present for debug visualization clauses.")});new E("exceptionWidgetVisible",false,{type:"boolean",description:h(7595,"True when the exception widget is visible.")});new E("multiSessionRepl",false,{type:"boolean",description:h(7596,"True when there is more than 1 debug console.")});new E("multiSessionDebug",false,{type:"boolean",description:h(7597,"True when there is more than 1 active debug session.")});new E("disassembleRequestSupported",false,{type:"boolean",description:h(7598,"True when the focused sessions supports disassemble request.")});new E("disassemblyViewFocus",false,{type:"boolean",description:h(7599,"True when the Disassembly View is focused.")});new E("languageSupportsDisassembleRequest",false,{type:"boolean",description:h(7600,"True when the language in the current editor supports disassemble request.")});new E("focusedStackFrameHasInstructionReference",false,{type:"boolean",description:h(7601,"True when the focused stack frame has instruction pointer reference.")});({description:h(7603,"Controls when the internal Debug Console should open.")});var HC;(function(t){t[t["Inactive"]=0]="Inactive";t[t["Initializing"]=1]="Initializing";t[t["Stopped"]=2]="Stopped";t[t["Running"]=3]="Running"})(HC||(HC={}));var BC;(function(t){t[t["Valid"]=0]="Valid";t[t["Unreadable"]=1]="Unreadable";t[t["Error"]=2]="Error"})(BC||(BC={}));var WC;(function(t){t[t["Variable"]=0]="Variable";t[t["Address"]=1]="Address"})(WC||(WC={}));var mg;(function(t){t[t["Initial"]=1]="Initial";t[t["Dynamic"]=2]="Dynamic"})(mg||(mg={}));var VC;(function(t){t["UnverifiedBreakpoints"]="unverifiedBreakpoints"})(VC||(VC={}));var zC;(function(t){t[t["CONDITION"]=0]="CONDITION";t[t["HIT_COUNT"]=1]="HIT_COUNT";t[t["LOG_MESSAGE"]=2]="LOG_MESSAGE";t[t["TRIGGER_POINT"]=3]="TRIGGER_POINT"})(zC||(zC={}));var _g;(function(t){t[t["Command"]=0]="Command";t[t["Tree"]=1]="Tree"})(_g||(_g={}));var _w;(function(t){t[t["None"]=0]="None";t[t["Collapsed"]=1]="Collapsed";t[t["Expanded"]=2]="Expanded"})(_w||(_w={}));var qC;(function(t){t.deserialize=e=>e;t.serialize=e=>e})(qC||(qC={}));var jC;(function(t){t.deserialize=e=>({id:e.id,name:e.name,iconPath:e.iconPath&&{light:b.revive(e.iconPath.light),dark:b.revive(e.iconPath.dark)},iconClass:e.iconClass,visualization:e.visualization});t.serialize=e=>e})(jC||(jC={}));var GC;(function(t){t["McpServersQueryService"]="McpServersQueryService";t["McpServerWebUri"]="McpServerWebUriTemplate";t["McpServerVersionUri"]="McpServerVersionUriTemplate";t["McpServerIdUri"]="McpServerIdUriTemplate";t["McpServerLatestVersionUri"]="McpServerLatestVersionUriTemplate";t["McpServerNamedResourceUri"]="McpServerNamedResourceUriTemplate";t["PublisherUriTemplate"]="PublisherUriTemplate";t["ContactSupportUri"]="ContactSupportUri";t["PrivacyPolicyUri"]="PrivacyPolicyUri";t["TermsOfServiceUri"]="TermsOfServiceUri";t["ReportUri"]="ReportUri"})(GC||(GC={}));var vw;(function(t){t["Available"]="available";t["Unavailable"]="unavailable"})(vw||(vw={}));te("IMcpService");const pN=te("IMcpWorkbenchService");te("IMcpServerSampling");te("IMcpElicitationService");var ww;(function(t){t.LATEST_PROTOCOL_VERSION="2025-11-25";t.JSONRPC_VERSION="2.0";t.PARSE_ERROR=-32700;t.INVALID_REQUEST=-32600;t.METHOD_NOT_FOUND=-32601;t.INVALID_PARAMS=-32602;t.INTERNAL_ERROR=-32603;t.URL_ELICITATION_REQUIRED=-32042})(ww||(ww={}));function gN(t,e){return ht.toKey(t)+"/"+e}var KC;(function(t){t[t["WorkspaceFolder"]=0]="WorkspaceFolder";t[t["Workspace"]=100]="Workspace";t[t["User"]=200]="User";t[t["Extension"]=300]="Extension";t[t["Filesystem"]=400]="Filesystem";t[t["RemoteBoost"]=-50]="RemoteBoost"})(KC||(KC={}));var QC;(function(t){function e(i,n){return i.id===n.id&&i.remoteAuthority===n.remoteAuthority&&i.label===n.label&&i.trustBehavior===n.trustBehavior}t.equals=e})(QC||(QC={}));var vg;(function(t){t[t["Initial"]=0]="Initial";t[t["Dynamic"]=1]="Dynamic"})(vg||(vg={}));var JC;(function(t){function e(s){return s}t.toSerialized=e;function i(s){return{id:s.id,label:s.label,cacheNonce:s.cacheNonce,staticMetadata:s.staticMetadata,launch:Vc.fromSerialized(s.launch),variableReplacement:s.variableReplacement?bw.fromSerialized(s.variableReplacement):void 0}}t.fromSerialized=i;function n(s,r){return s.id===r.id&&s.label===r.label&&s.cacheNonce===r.cacheNonce&&mn(s.roots,r.roots,(o,a)=>o.toString()===a.toString())&&Gi(s.launch,r.launch)&&Gi(s.presentation,r.presentation)&&Gi(s.variableReplacement,r.variableReplacement)&&Gi(s.devMode,r.devMode)}t.equals=n})(JC||(JC={}));var bw;(function(t){function e(n){return n}t.toSerialized=e;function i(n){return{section:n.section,folder:n.folder?{...n.folder,uri:b.revive(n.folder.uri)}:void 0,target:n.target}}t.fromSerialized=i})(bw||(bw={}));var YC;(function(t){t.Empty={working:false,starting:[],serversRequiringInteraction:[]}})(YC||(YC={}));var XC;(function(t){t[t["HasUnknown"]=0]="HasUnknown";t[t["LoadingUnknown"]=1]="LoadingUnknown";t[t["AllKnown"]=2]="AllKnown"})(XC||(XC={}));var ZC;(function(t){(function(e){e[e["Trusted"]=0]="Trusted";e[e["TrustedOnNonce"]=1]="TrustedOnNonce";e[e["Untrusted"]=2]="Untrusted";e[e["Unknown"]=3]="Unknown"})(t.Kind||(t.Kind={}))})(ZC||(ZC={}));var ek;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Cached"]=1]="Cached";t[t["Outdated"]=2]="Outdated";t[t["RefreshingFromUnknown"]=3]="RefreshingFromUnknown";t[t["RefreshingFromCached"]=4]="RefreshingFromCached";t[t["Live"]=5]="Live"})(ek||(ek={}));var tk;(function(t){t[t["Model"]=1]="Model";t[t["App"]=2]="App"})(tk||(tk={}));var Ro;(function(t){t[t["Stdio"]=1]="Stdio";t[t["HTTP"]=2]="HTTP"})(Ro||(Ro={}));var Vc;(function(t){function e(s){return s}t.toSerialized=e;function i(s){switch(s.type){case Ro.HTTP:return{type:s.type,uri:b.revive(s.uri),headers:s.headers,authentication:s.authentication};case Ro.Stdio:return{type:s.type,cwd:s.cwd,command:s.command,args:s.args,env:s.env,envFile:s.envFile}}}t.fromSerialized=i;async function n(s){const r=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(JSON.stringify(s)));return qT(ae.wrap(new Uint8Array(r)))}t.hash=n})(Vc||(Vc={}));var cs;(function(t){let e;(function(i){i[i["Stopped"]=0]="Stopped";i[i["Starting"]=1]="Starting";i[i["Running"]=2]="Running";i[i["Error"]=3]="Error"})(e=t.Kind||(t.Kind={}));t.toString=i=>{switch(i.state){case e.Stopped:return h(9574,"Stopped");case e.Starting:return h(9575,"Starting");case e.Running:return h(9576,"Running");case e.Error:return h(9577,"Error {0}",i.message);default:k1()}};t.toKindString=i=>{switch(i){case e.Stopped:return"stopped";case e.Starting:return"starting";case e.Running:return"running";case e.Error:return"error";default:k1()}};t.canBeStarted=i=>i===e.Error||i===e.Stopped;t.isRunning=i=>!t.canBeStarted(i.state)})(cs||(cs={}));class wg extends Error{static{this.prefix="User interaction required: "}static is(e){return e.message.startsWith(this.prefix)}constructor(e){super(`${wg.prefix}${e}`);this.reason=e}}var ik;(function(t){t[t["Disabled"]=0]="Disabled";t[t["DisabledByAccess"]=1]="DisabledByAccess";t[t["Enabled"]=2]="Enabled"})(ik||(ik={}));var nk;(function(t){t[t["Installing"]=0]="Installing";t[t["Installed"]=1]="Installed";t[t["Uninstalling"]=2]="Uninstalling";t[t["Uninstalled"]=3]="Uninstalled"})(nk||(nk={}));var sk;(function(t){t["Readme"]="readme";t["Manifest"]="manifest";t["Configuration"]="configuration"})(sk||(sk={}));let rk=class $W extends me{constructor(e,i){super();this.containers=e;this._register(i.onChange(this.update,this))}set mcpServer(e){this.containers.forEach(i=>i.mcpServer=e)}update(e){for(const i of this.containers){if(e&&i.mcpServer){if(e.id===i.mcpServer.id){i.mcpServer=e}}else{i.update()}}}};rk=W([P(1,pN)],rk);new E("mcpServersGalleryStatus",vw.Unavailable);new E("hasInstalledMcpServers",true);var ok;(function(t){t.scheme="mcp-resource";const e="dylo78gyp";function i(s,r){if(typeof r==="string"){r=b.parse(r)}return r.with({scheme:t.scheme,authority:qT(ae.fromString(s.id)),path:["",r.scheme,r.authority||e].join("/")+r.path})}t.fromServer=i;function n(s){if(typeof s==="string"){s=b.parse(s)}if(s.scheme!==t.scheme){throw new Error(`Invalid MCP resource URI: ${s.toString()}`)}const r=s.path.split("/");if(r.length<3){throw new Error(`Invalid MCP resource URI: ${s.toString()}`)}const[,o,a,...l]=r;const c=new URL(`${o}://${a.toLowerCase()===e?"":a}`);c.pathname=l.length?"/"+l.join("/"):"";c.search=s.query;c.hash=s.fragment;return{definitionId:CR(s.authority).toString(),resourceURL:c}}t.toServer=n})(ok||(ok={}));var ak;(function(t){t[t["Logging"]=1]="Logging";t[t["Completions"]=2]="Completions";t[t["Prompts"]=4]="Prompts";t[t["PromptsListChanged"]=8]="PromptsListChanged";t[t["Resources"]=16]="Resources";t[t["ResourcesSubscribe"]=32]="ResourcesSubscribe";t[t["ResourcesListChanged"]=64]="ResourcesListChanged";t[t["Tools"]=128]="Tools";t[t["ToolsListChanged"]=256]="ToolsListChanged"})(ak||(ak={}));var lk;(function(t){t["Prefix"]="mcp_";t[t["MaxPrefixLen"]=18]="MaxPrefixLen";t[t["MaxLength"]=64]="MaxLength"})(lk||(lk={}));var ck;(function(t){t[t["Form"]=0]="Form";t[t["URL"]=1]="URL"})(ck||(ck={}));const Pa="**";const yw="/";const dp="[/\\\\]";const hp="[^/\\\\]";const mN=/\//g;function uk(t,e){switch(t){case 0:return"";case 1:return`${hp}*?`;default:return`(?:${dp}|${hp}+${dp}${e?`|${dp}${hp}+`:""})*?`}}function bg(t,e){if(!t){return[]}const i=[];let n=false;let s=false;let r="";for(const o of t){switch(o){case e:if(!n&&!s){i.push(r);r="";continue}break;case"{":n=true;break;case"}":n=false;break;case"[":s=true;break;case"]":s=false;break}r+=o}if(r){i.push(r)}return i}function BP(t){if(!t){return""}let e="";const i=bg(t,yw);if(i.every(n=>n===Pa)){e=".*"}else{let n=false;i.forEach((s,r)=>{if(s===Pa){if(n){return}e+=uk(2,r===i.length-1)}else{let o=false;let a="";let l=false;let c="";for(const u of s){if(u!=="}"&&o){a+=u;continue}if(l&&(u!=="]"||!c)){let d;if(u==="-"){d=u}else if((u==="^"||u==="!")&&!c){d="^"}else if(u===yw){d=""}else{d=sl(u)}c+=d;continue}switch(u){case"{":o=true;continue;case"[":l=true;continue;case"}":{const d=bg(a,",");const f=`(?:${d.map(p=>BP(p)).join("|")})`;e+=f;o=false;a="";break}case"]":{e+="["+c+"]";l=false;c="";break}case"?":e+=hp;continue;case"*":e+=uk(1);continue;default:e+=sl(u)}}if(r<i.length-1&&(i[r+1]!==Pa||r+2<i.length)){e+=dp}}n=s===Pa})}return e}const _N=/^\*\*\/\*\.[\w\.-]+$/;const vN=/^\*\*\/([\w\.-]+)\/?$/;const wN=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/;const bN=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/;const yN=/^\*\*((\/[\w\.-]+)+)\/?$/;const SN=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/;const dk=new of(1e4);const hk=function(){return false};const rr=function(){return null};function YS(t,e){if(!t){return rr}let i;if(typeof t!=="string"){i=t.pattern}else{i=t}i=i.trim();const n=e.ignoreCase??false;const s={...e,equals:n?Rr:(l,c)=>l===c,endsWith:n?CL:(l,c)=>l.endsWith(c),isEqualOrParent:(l,c)=>Bp(l,c,!Fo||n)};const r=`${n?i.toLowerCase():i}_${!!e.trimForExclusions}_${n}`;let o=dk.get(r);if(o){return fk(o,t,s)}let a;if(_N.test(i)){o=xN(i.substring(4),i,s)}else if(a=vN.exec(jv(i,s))){o=EN(a[1],i,s)}else if((e.trimForExclusions?bN:wN).test(i)){o=CN(i,s)}else if(a=yN.exec(jv(i,s))){o=pk(a[1].substring(1),i,true,s)}else if(a=SN.exec(jv(i,s))){o=pk(a[1],i,false,s)}else{o=kN(i,s)}dk.set(r,o);return fk(o,t,s)}function fk(t,e,i){if(typeof e==="string"){return t}const n=function(s,r){if(!i.isEqualOrParent(s,e.base)){return null}return t(SL(s.substring(e.base.length),Yn),r)};n.allBasenames=t.allBasenames;n.allPaths=t.allPaths;n.basenames=t.basenames;n.patterns=t.patterns;return n}function jv(t,e){return e.trimForExclusions&&t.endsWith("/**")?t.substring(0,t.length-2):t}function xN(t,e,i){return function(n,s){return typeof n==="string"&&i.endsWith(n,t)?e:null}}function EN(t,e,i){const n=`/${t}`;const s=`\\${t}`;const r=function(a,l){if(typeof a!=="string"){return null}if(l){return i.equals(l,t)?e:null}return i.equals(a,t)||i.endsWith(a,n)||i.endsWith(a,s)?e:null};const o=[t];r.basenames=o;r.patterns=[e];r.allBasenames=o;return r}function CN(t,e){const i=WP(t.slice(1,-1).split(",").map(a=>YS(a,e)).filter(a=>a!==rr),t);const n=i.length;if(!n){return rr}if(n===1){return i[0]}const s=function(a,l){for(let c=0,u=i.length;c<u;c++){if(i[c](a,l)){return t}}return null};const r=i.find(a=>!!a.allBasenames);if(r){s.allBasenames=r.allBasenames}const o=i.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);if(o.length){s.allPaths=o}return s}function pk(t,e,i,n){const s=Yn===mt.sep;const r=s?t:t.replace(mN,Yn);const o=Yn+r;const a=mt.sep+t;let l;if(i){l=function(c,u){return typeof c==="string"&&(n.equals(c,r)||n.endsWith(c,o)||!s&&(n.equals(c,t)||n.endsWith(c,a)))?e:null}}else{l=function(c,u){return typeof c==="string"&&(n.equals(c,r)||!s&&n.equals(c,t))?e:null}}l.allPaths=[(i?"*/":"./")+t];return l}function kN(t,e){try{const i=new RegExp(`^${BP(t)}$`,e.ignoreCase?"i":void 0);return function(n){i.lastIndex=0;return typeof n==="string"&&i.test(n)?t:null}}catch{return rr}}function dc(t,e,i){if(!t||typeof e!=="string"){return false}return zc(t,i)(e)}function zc(t,e={}){if(!t){return hk}if(typeof t==="string"||DN(t)){const i=YS(t,e);if(i===rr){return hk}const n=function(s,r){return!!i(s,r)};if(i.allBasenames){n.allBasenames=i.allBasenames}if(i.allPaths){n.allPaths=i.allPaths}return n}return IN(t,e)}function DN(t){const e=t;if(!e){return false}return typeof e.base==="string"&&typeof e.pattern==="string"}function IN(t,e){const i=WP(Object.getOwnPropertyNames(t).map(a=>TN(a,t[a],e)).filter(a=>a!==rr));const n=i.length;if(!n){return rr}if(!i.some(a=>!!a.requiresSiblings)){if(n===1){return i[0]}const a=function(u,d){let f=void 0;for(let p=0,m=i.length;p<m;p++){const v=i[p](u,d);if(typeof v==="string"){return v}if(Uo(v)){if(!f){f=[]}f.push(v)}}if(f){return(async()=>{for(const p of f){const m=await p;if(typeof m==="string"){return m}}return null})()}return null};const l=i.find(u=>!!u.allBasenames);if(l){a.allBasenames=l.allBasenames}const c=i.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);if(c.length){a.allPaths=c}return a}const s=function(a,l,c){let u=void 0;let d=void 0;for(let f=0,p=i.length;f<p;f++){const m=i[f];if(m.requiresSiblings&&c){if(!l){l=kn(a)}if(!u){u=l.substring(0,l.length-Up(a).length)}}const v=m(a,l,u,c);if(typeof v==="string"){return v}if(Uo(v)){if(!d){d=[]}d.push(v)}}if(d){return(async()=>{for(const f of d){const p=await f;if(typeof p==="string"){return p}}return null})()}return null};const r=i.find(a=>!!a.allBasenames);if(r){s.allBasenames=r.allBasenames}const o=i.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);if(o.length){s.allPaths=o}return s}function TN(t,e,i){if(e===false){return rr}const n=YS(t,i);if(n===rr){return rr}if(typeof e==="boolean"){return n}if(e){const s=e.when;if(typeof s==="string"){const r=(o,a,l,c)=>{if(!c||!n(o,a)){return null}const u=s.replace("$(basename)",()=>l);const d=c(u);return Uo(d)?d.then(f=>f?t:null):d?t:null};r.requiresSiblings=true;return r}}return n}function WP(t,e){const i=t.filter(a=>!!a.basenames);if(i.length<2){return t}const n=i.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let s;if(e){s=[];for(let a=0,l=n.length;a<l;a++){s.push(e)}}else{s=i.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[])}const r=function(a,l){if(typeof a!=="string"){return null}if(!l){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===M.Slash||d===M.Backslash){break}}l=a.substring(u)}const c=n.indexOf(l);return c!==-1?s[c]:null};r.basenames=n;r.patterns=s;r.allBasenames=n;const o=t.filter(a=>!a.basenames);o.push(r);return o}const Sw=["W","X","Y","Z","a","b","c","d","e","f"];const PN=new RegExp(`^[${Sw.join("")}]+`);const VP=7;function zP(t){if(t.scheme!==ne.vscodeNotebookCell){return void 0}const e=t.fragment.indexOf("s");if(e<0){return void 0}const i=parseInt(t.fragment.substring(0,e).replace(PN,""),VP);const n=Oo(t.fragment.substring(e+1)).toString();if(isNaN(i)){return void 0}return{handle:i,notebook:t.with({scheme:n,fragment:null})}}function AN(t,e){const i=e.toString(VP);const n=i.length<Sw.length?Sw[i.length-1]:"z";const s=`${n}${i}s${vl(ae.fromString(t.scheme),true,true)}`;return t.with({scheme:ne.vscodeNotebookCell,fragment:s})}function RN(t){if(t.scheme!==ne.vscodeNotebookMetadata){return void 0}const e=Oo(t.fragment).toString();return t.with({scheme:e,fragment:null})}function LN(t){const e=`${vl(ae.fromString(t.scheme),true,true)}`;return t.with({scheme:ne.vscodeNotebookMetadata,fragment:e})}function NN(t){if(t.scheme!==ne.vscodeNotebookCellOutput){return}const e=new URLSearchParams(t.query);const i=e.get("openIn");if(!i){return}const n=e.get("outputId")??void 0;const s=zP(t.with({scheme:ne.vscodeNotebookCell,query:null}));const r=e.get("outputIndex")?parseInt(e.get("outputIndex")||"",10):void 0;const o=s?s.notebook:t.with({scheme:e.get("notebookScheme")||ne.file,fragment:null,query:null});const a=e.get("cellIndex")?parseInt(e.get("cellIndex")||"",10):void 0;return{notebook:o,openIn:i,outputId:n,outputIndex:r,cellHandle:s?.handle,cellFragment:t.fragment,cellIndex:a}}var ec;(function(t){t[t["Markup"]=1]="Markup";t[t["Code"]=2]="Code"})(ec||(ec={}));["application/json","application/javascript","text/html","image/svg+xml",Ps.latex,Ps.markdown,"image/png","image/jpeg",Ps.text];[Ps.latex,Ps.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",Ps.text];var gk;(function(t){t[t["Running"]=1]="Running";t[t["Idle"]=2]="Idle"})(gk||(gk={}));var mk;(function(t){t[t["Unconfirmed"]=1]="Unconfirmed";t[t["Pending"]=2]="Pending";t[t["Executing"]=3]="Executing"})(mk||(mk={}));var _k;(function(t){t[t["Unconfirmed"]=1]="Unconfirmed";t[t["Pending"]=2]="Pending";t[t["Executing"]=3]="Executing"})(_k||(_k={}));var vk;(function(t){t[t["WithHardKernelDependency"]=0]="WithHardKernelDependency";t[t["WithOptionalKernelDependency"]=1]="WithOptionalKernelDependency";t[t["Pure"]=2]="Pure";t[t["Never"]=3]="Never"})(vk||(vk={}));var wk;(function(t){t["Always"]="always";t["Never"]="never";t["Optional"]="optional"})(wk||(wk={}));var us;(function(t){t[t["ModelChange"]=1]="ModelChange";t[t["Move"]=2]="Move";t[t["ChangeCellLanguage"]=5]="ChangeCellLanguage";t[t["Initialize"]=6]="Initialize";t[t["ChangeCellMetadata"]=7]="ChangeCellMetadata";t[t["Output"]=8]="Output";t[t["OutputItem"]=9]="OutputItem";t[t["ChangeCellContent"]=10]="ChangeCellContent";t[t["ChangeDocumentMetadata"]=11]="ChangeDocumentMetadata";t[t["ChangeCellInternalMetadata"]=12]="ChangeCellInternalMetadata";t[t["ChangeCellMime"]=13]="ChangeCellMime";t[t["Unknown"]=100]="Unknown"})(us||(us={}));var bk;(function(t){t[t["Handle"]=0]="Handle";t[t["Index"]=1]="Index"})(bk||(bk={}));var Lo;(function(t){t[t["Replace"]=1]="Replace";t[t["Output"]=2]="Output";t[t["Metadata"]=3]="Metadata";t[t["CellLanguage"]=4]="CellLanguage";t[t["DocumentMetadata"]=5]="DocumentMetadata";t[t["Move"]=6]="Move";t[t["OutputItems"]=7]="OutputItems";t[t["PartialMetadata"]=8]="PartialMetadata";t[t["PartialInternalMetadata"]=9]="PartialInternalMetadata"})(Lo||(Lo={}));var yk;(function(t){t.scheme=ne.vscodeNotebookMetadata;function e(n){return LN(n)}t.generate=e;function i(n){return RN(n)}t.parse=i})(yk||(yk={}));var xw;(function(t){t.scheme=ne.vscodeNotebookCell;function e(c,u){return AN(c,u)}t.generate=e;function i(c){return zP(c)}t.parse=i;function n(c,u){return c.with({scheme:ne.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"editor",outputId:u??"",notebookScheme:c.scheme!==ne.file?c.scheme:""}).toString()})}t.generateCellOutputUriWithId=n;function s(c,u,d){return c.with({scheme:ne.vscodeNotebookCellOutput,fragment:u.fragment,query:new URLSearchParams({openIn:"notebook",outputIndex:String(d)}).toString()})}t.generateCellOutputUriWithIndex=s;function r(c,u,d,f,p){return c.with({scheme:ne.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"notebookOutputEditor",notebook:c.toString(),cellIndex:String(d),outputId:f,outputIndex:String(p)}).toString()})}t.generateOutputEditorUri=r;function o(c){return NN(c)}t.parseCellOutputUri=o;function a(c,u,d){return t.generate(c,u).with({scheme:d})}t.generateCellPropertyUri=a;function l(c,u){if(c.scheme!==u){return void 0}return t.parse(c.with({scheme:t.scheme}))}t.parseCellPropertyUri=l})(xw||(xw={}));new E("notebookEditorCursorAtBoundary","none");new E("notebookEditorCursorAtLineBoundary","none");var Sk;(function(t){t["default"]="default";t["option"]="option"})(Sk||(Sk={}));var xk;(function(t){t["Cells"]="cells";t["Text"]="text";t["None"]="none"})(xk||(xk={}));var yg;(function(t){t[t["Left"]=1]="Left";t[t["Right"]=2]="Right"})(yg||(yg={}));const MN=new TextDecoder;function ON(t){const e=[];let i=false;for(const o of t){if(e.length===0||i){e.push(o);i=true}}let n=UN(e);const s=ae.concat(e.map(o=>ae.wrap(o)));const r=VN(s);n=n||r.byteLength!==s.byteLength;return{data:r,didCompression:n}}const fp=`${String.fromCharCode(27)}[A`;const Gv=fp.split("").map(t=>t.charCodeAt(0));const FN=10;function UN(t){let e=false;t.forEach((i,n)=>{if(n===0||i.length<fp.length){return}const s=t[n-1];const r=i.subarray(0,fp.length);if(r[0]===Gv[0]&&r[1]===Gv[1]&&r[2]===Gv[2]){const o=s.lastIndexOf(FN);if(o===-1){return}e=true;t[n-1]=s.subarray(0,o);t[n]=i.subarray(fp.length)}});return e}function $N(t){let e=t;do{t=e;e=t.replace(/[^\n]\x08/gm,"")}while(e.length<t.length);return t}function HN(t){t=t.replace(/\r+\n/gm,"\n");while(t.search(/\r[^$]/g)>-1){const e=t.match(/^(.*)\r+/m)[1];let i=t.match(/\r+(.*)$/m)[1];i=i+e.slice(i.length,e.length);t=t.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,i)}return t}const BN="\b".charCodeAt(0);const WN="\r".charCodeAt(0);function VN(t){if(!t.buffer.includes(BN)&&!t.buffer.includes(WN)){return t}return ae.fromString(HN($N(MN.decode(t.buffer))))}var Ek;(function(t){t["List"]="list";t["Tree"]="tree"})(Ek||(Ek={}));var Td;(function(t){t[t["Error"]=0]="Error";t[t["Warning"]=1]="Warning";t[t["Information"]=2]="Information"})(Td||(Td={}));var Ck;(function(t){t[t["HistoryPrevious"]=0]="HistoryPrevious";t[t["HistoryNext"]=1]="HistoryNext"})(Ck||(Ck={}));var kk;(function(t){t["DiscoveryTime"]="discoveryTime";t["Name"]="name";t["Path"]="path"})(kk||(kk={}));var Dk;(function(t){t["Single"]="single";t["Multiple"]="multiple"})(Dk||(Dk={}));var Ln;(function(t){t["Delimiter"]="\0"})(Ln||(Ln={}));var hs;(function(t){t[t["IsSame"]=0]="IsSame";t[t["Disconnected"]=1]="Disconnected";t[t["IsChild"]=2]="IsChild";t[t["IsParent"]=3]="IsParent"})(hs||(hs={}));class Me{static fromExtHostTestItem(e,i,n=e.parent){if(e._isRoot){return new Me([i])}const s=[e.id];for(let r=n;r&&r.id!==i;r=r.parent){s.push(r.id)}s.push(i);return new Me(s.reverse())}static isRoot(e){return!e.includes(Ln.Delimiter)}static root(e){const i=e.indexOf(Ln.Delimiter);return i===-1?e:e.slice(0,i)}static fromString(e){return new Me(e.split(Ln.Delimiter))}static join(e,i){return new Me([...e.path,i])}static split(e){return e.split(Ln.Delimiter)}static joinToString(e,i){return e.toString()+Ln.Delimiter+i}static parentId(e){const i=e.lastIndexOf(Ln.Delimiter);return i===-1?void 0:e.slice(0,i)}static localId(e){const i=e.lastIndexOf(Ln.Delimiter);return i===-1?e:e.slice(i+Ln.Delimiter.length)}static isChild(e,i){return i[e.length]===Ln.Delimiter&&i.startsWith(e)}static compare(e,i){if(e===i){return hs.IsSame}if(Me.isChild(e,i)){return hs.IsChild}if(Me.isChild(i,e)){return hs.IsParent}return hs.Disconnected}static getLengthOfCommonPrefix(e,i){if(e===0){return 0}let n=0;while(n<e-1){for(let s=1;s<e;s++){const r=i(s-1);const o=i(s);if(r.path[n]!==o.path[n]){return n}}n++}return n}constructor(e,i=e.length){this.path=e;this.viewEnd=i;if(e.length===0||i<1){throw new Error("cannot create test with empty path")}}get rootId(){return new Me(this.path,1)}get parentId(){return this.viewEnd>1?new Me(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let e=1;e<=this.viewEnd;e++){yield new Me(this.path,e)}}*idsToRoot(){for(let e=this.viewEnd;e>0;e--){yield new Me(this.path,e)}}compare(e){if(typeof e==="string"){return Me.compare(this.toString(),e)}for(let i=0;i<e.viewEnd&&i<this.viewEnd;i++){if(e.path[i]!==this.path[i]){return hs.Disconnected}}if(e.viewEnd>this.viewEnd){return hs.IsChild}if(e.viewEnd<this.viewEnd){return hs.IsParent}return hs.IsSame}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++){this.stringifed+=Ln.Delimiter;this.stringifed+=this.path[e]}}return this.stringifed}}var oi;(function(t){t[t["Unset"]=0]="Unset";t[t["Queued"]=1]="Queued";t[t["Running"]=2]="Running";t[t["Passed"]=3]="Passed";t[t["Failed"]=4]="Failed";t[t["Skipped"]=5]="Skipped";t[t["Errored"]=6]="Errored"})(oi||(oi={}));({[oi.Unset]:"unset",[oi.Queued]:"queued",[oi.Running]:"running",[oi.Passed]:"passed",[oi.Failed]:"failed",[oi.Skipped]:"skipped",[oi.Errored]:"errored"});var Ik;(function(t){t[t["Run"]=1]="Run";t[t["Debug"]=2]="Debug";t[t["Coverage"]=3]="Coverage"})(Ik||(Ik={}));var Pd;(function(t){t[t["Refresh"]=2]="Refresh";t[t["CodeRelatedToTest"]=4]="CodeRelatedToTest";t[t["TestRelatedToCode"]=8]="TestRelatedToCode"})(Pd||(Pd={}));var Ui;(function(t){t[t["Run"]=2]="Run";t[t["Debug"]=4]="Debug";t[t["Coverage"]=8]="Coverage";t[t["HasNonDefaultProfile"]=16]="HasNonDefaultProfile";t[t["HasConfigurable"]=32]="HasConfigurable";t[t["SupportsContinuousRun"]=64]="SupportsContinuousRun"})(Ui||(Ui={}));({[Ui.Run]:h(13271,"Run"),[Ui.Debug]:h(13272,"Debug"),[Ui.Coverage]:h(13273,"Coverage")});[Ui.Run,Ui.Debug,Ui.Coverage,Ui.HasNonDefaultProfile,Ui.HasConfigurable,Ui.SupportsContinuousRun];const zN=t=>"runId"in t;var qc;(function(t){t.serialize=e=>({range:e.range.toJSON(),uri:e.uri.toJSON()});t.deserialize=(e,i)=>({range:_t.lift(i.range),uri:e.asCanonicalUri(b.revive(i.uri))})})(qc||(qc={}));var As;(function(t){t[t["Error"]=0]="Error";t[t["Output"]=1]="Output"})(As||(As={}));var Sg;(function(t){t.serialize=e=>({label:e.label,uri:e.uri?.toJSON(),position:e.position?.toJSON()});t.deserialize=(e,i)=>({label:i.label,uri:i.uri?e.asCanonicalUri(b.revive(i.uri)):void 0,position:i.position?$n.lift(i.position):void 0})})(Sg||(Sg={}));var xg;(function(t){t.serialize=e=>({message:e.message,type:As.Error,expected:e.expected,actual:e.actual,contextValue:e.contextValue,location:e.location&&qc.serialize(e.location),stackTrace:e.stackTrace?.map(Sg.serialize)});t.deserialize=(e,i)=>({message:i.message,type:As.Error,expected:i.expected,actual:i.actual,contextValue:i.contextValue,location:i.location&&qc.deserialize(e,i.location),stackTrace:i.stackTrace&&i.stackTrace.map(n=>Sg.deserialize(e,n))})})(xg||(xg={}));var Eg;(function(t){t.serialize=e=>({message:e.message,type:As.Output,offset:e.offset,length:e.length,location:e.location&&qc.serialize(e.location)});t.deserialize=(e,i)=>({message:i.message,type:As.Output,offset:i.offset,length:i.length,location:i.location&&qc.deserialize(e,i.location)})})(Eg||(Eg={}));var Cg;(function(t){t.serialize=e=>e.type===As.Error?xg.serialize(e):Eg.serialize(e);t.deserialize=(e,i)=>i.type===As.Error?xg.deserialize(e,i):Eg.deserialize(e,i);t.isDiffable=e=>e.type===As.Error&&e.actual!==void 0&&e.expected!==void 0})(Cg||(Cg={}));var Ad;(function(t){t.serializeWithoutMessages=e=>({state:e.state,duration:e.duration,messages:[]});t.serialize=e=>({state:e.state,duration:e.duration,messages:e.messages.map(Cg.serialize)});t.deserialize=(e,i)=>({state:i.state,duration:i.duration,messages:i.messages.map(n=>Cg.deserialize(e,n))})})(Ad||(Ad={}));const qP="\0";const pp=(t,e)=>t+qP+e;const jP=t=>{const e=t.indexOf(qP);return{ctrlId:t.slice(0,e),tagId:t.slice(e+1)}};var kg;(function(t){t.serialize=e=>({extId:e.extId,label:e.label,tags:e.tags,busy:e.busy,children:void 0,uri:e.uri?.toJSON(),range:e.range?.toJSON()||null,description:e.description,error:e.error,sortText:e.sortText});t.deserialize=(e,i)=>({extId:i.extId,label:i.label,tags:i.tags,busy:i.busy,children:void 0,uri:i.uri?e.asCanonicalUri(b.revive(i.uri)):void 0,range:i.range?_t.lift(i.range):null,description:i.description,error:i.error,sortText:i.sortText})})(kg||(kg={}));var Li;(function(t){t[t["NotExpandable"]=0]="NotExpandable";t[t["Expandable"]=1]="Expandable";t[t["BusyExpanding"]=2]="BusyExpanding";t[t["Expanded"]=3]="Expanded"})(Li||(Li={}));var No;(function(t){t.serialize=e=>({expand:e.expand,item:kg.serialize(e.item)});t.deserialize=(e,i)=>({controllerId:Me.root(i.item.extId),expand:i.expand,item:kg.deserialize(e,i.item)})})(No||(No={}));var th;(function(t){t.serialize=e=>{let i;if(e.item){i={};if(e.item.label!==void 0){i.label=e.item.label}if(e.item.tags!==void 0){i.tags=e.item.tags}if(e.item.busy!==void 0){i.busy=e.item.busy}if(e.item.uri!==void 0){i.uri=e.item.uri?.toJSON()}if(e.item.range!==void 0){i.range=e.item.range?.toJSON()}if(e.item.description!==void 0){i.description=e.item.description}if(e.item.error!==void 0){i.error=e.item.error}if(e.item.sortText!==void 0){i.sortText=e.item.sortText}}return{extId:e.extId,expand:e.expand,item:i}};t.deserialize=e=>{let i;if(e.item){i={};if(e.item.label!==void 0){i.label=e.item.label}if(e.item.tags!==void 0){i.tags=e.item.tags}if(e.item.busy!==void 0){i.busy=e.item.busy}if(e.item.range!==void 0){i.range=e.item.range?_t.lift(e.item.range):null}if(e.item.description!==void 0){i.description=e.item.description}if(e.item.error!==void 0){i.error=e.item.error}if(e.item.sortText!==void 0){i.sortText=e.item.sortText}}return{extId:e.extId,expand:e.expand,item:i}}})(th||(th={}));const Ew=(t,e)=>{if(e.expand!==void 0){t.expand=e.expand}if(e.item!==void 0){t.item=t.item?Object.assign(t.item,e.item):e.item}};var Tk;(function(t){t.serializeWithoutMessages=e=>({...No.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Ad.serializeWithoutMessages)});t.serialize=e=>({...No.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Ad.serialize)});t.deserialize=(e,i)=>({...No.deserialize(e,i),ownComputedState:i.ownComputedState,computedState:i.computedState,tasks:i.tasks.map(n=>Ad.deserialize(e,n)),retired:true})})(Tk||(Tk={}));var Cw;(function(t){t.empty=()=>({covered:0,total:0});t.sum=(e,i)=>{e.covered+=i.covered;e.total+=i.total}})(Cw||(Cw={}));var Pk;(function(t){t.serialize=e=>({id:e.id,statement:e.statement,branch:e.branch,declaration:e.declaration,testIds:e.testIds,uri:e.uri.toJSON()});t.deserialize=(e,i)=>({id:i.id,statement:i.statement,branch:i.branch,declaration:i.declaration,testIds:i.testIds,uri:e.asCanonicalUri(b.revive(i.uri))});t.empty=(e,i)=>({id:e,uri:i,statement:Cw.empty()})})(Pk||(Pk={}));function XS(t){return{...t,location:t.location?.toJSON()}}function ZS(t){t.location=t.location?$n.isIPosition(t.location)?$n.lift(t.location):_t.lift(t.location):void 0;return t}var Ga;(function(t){t[t["Declaration"]=0]="Declaration";t[t["Statement"]=1]="Statement";t[t["Branch"]=2]="Branch"})(Ga||(Ga={}));var Ak;(function(t){t.serialize=e=>e.type===Ga.Declaration?Ig.serialize(e):Tg.serialize(e);t.deserialize=e=>e.type===Ga.Declaration?Ig.deserialize(e):Tg.deserialize(e)})(Ak||(Ak={}));var Dg;(function(t){t.serialize=XS;t.deserialize=ZS})(Dg||(Dg={}));var Ig;(function(t){t.serialize=XS;t.deserialize=ZS})(Ig||(Ig={}));var Tg;(function(t){t.serialize=e=>({...XS(e),branches:e.branches?.map(Dg.serialize)});t.deserialize=e=>({...ZS(e),branches:e.branches?.map(Dg.deserialize)})})(Tg||(Tg={}));var Ot;(function(t){t[t["Add"]=0]="Add";t[t["Update"]=1]="Update";t[t["DocumentSynced"]=2]="DocumentSynced";t[t["Remove"]=3]="Remove";t[t["IncrementPendingExtHosts"]=4]="IncrementPendingExtHosts";t[t["Retire"]=5]="Retire";t[t["AddTag"]=6]="AddTag";t[t["RemoveTag"]=7]="RemoveTag"})(Ot||(Ot={}));var Pg;(function(t){t.deserialize=(e,i)=>{if(i.op===Ot.Add){return{op:i.op,item:No.deserialize(e,i.item)}}else if(i.op===Ot.Update){return{op:i.op,item:th.deserialize(i.item)}}else if(i.op===Ot.DocumentSynced){return{op:i.op,uri:e.asCanonicalUri(b.revive(i.uri)),docv:i.docv}}else{return i}};t.serialize=e=>{if(e.op===Ot.Add){return{op:e.op,item:No.serialize(e.item)}}else if(e.op===Ot.Update){return{op:e.op,item:th.serialize(e.item)}}else{return e}}})(Pg||(Pg={}));class qN{constructor(e){this.uriIdentity=e;this._tags=new Map;this.items=new Map;this.roots=new Set;this.busyControllerCount=0;this.pendingRootCount=0;this.tags=this._tags}apply(e){const i=this.createChangeCollector();for(const n of e){switch(n.op){case Ot.Add:this.add(No.deserialize(this.uriIdentity,n.item),i);break;case Ot.Update:this.update(th.deserialize(n.item),i);break;case Ot.Remove:this.remove(n.itemId,i);break;case Ot.Retire:this.retireTest(n.itemId);break;case Ot.IncrementPendingExtHosts:this.updatePendingRoots(n.amount);break;case Ot.AddTag:this._tags.set(n.tag.id,n.tag);break;case Ot.RemoveTag:this._tags.delete(n.id);break}}i.complete?.()}add(e,i){const n=Me.parentId(e.item.extId)?.toString();let s;if(!n){s=this.createItem(e);this.roots.add(s);this.items.set(e.item.extId,s)}else if(this.items.has(n)){const r=this.items.get(n);r.children.add(e.item.extId);s=this.createItem(e,r);this.items.set(e.item.extId,s)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}i.add?.(s);if(e.expand===Li.BusyExpanding){this.busyControllerCount++}return s}update(e,i){const n=this.items.get(e.extId);if(!n){return}if(e.expand!==void 0){if(n.expand===Li.BusyExpanding){this.busyControllerCount--}if(e.expand===Li.BusyExpanding){this.busyControllerCount++}}Ew(n,e);i.update?.(n);return n}remove(e,i){const n=this.items.get(e);if(!n){return}const s=Me.parentId(n.item.extId)?.toString();if(s){const o=this.items.get(s);o.children.delete(n.item.extId)}else{this.roots.delete(n)}const r=[[e]];while(r.length){for(const o of r.pop()){const a=this.items.get(o);if(a){r.push(a.children);this.items.delete(o);i.remove?.(a,a!==n);if(a.expand===Li.BusyExpanding){this.busyControllerCount--}}}}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}}var co;(function(t){t[t["EMBEDDED"]=1]="EMBEDDED";t[t["LLM_RANKED"]=2]="LLM_RANKED";t[t["CANCELED"]=3]="CANCELED"})(co||(co={}));var Rk;(function(t){t[t["UP"]=0]="UP";t[t["DOWN"]=1]="DOWN";t[t["LEFT"]=2]="LEFT";t[t["RIGHT"]=3]="RIGHT"})(Rk||(Rk={}));var Lk;(function(t){t[t["HORIZONTAL"]=0]="HORIZONTAL";t[t["VERTICAL"]=1]="VERTICAL"})(Lk||(Lk={}));var Nk;(function(t){t[t["FIRST"]=0]="FIRST";t[t["LAST"]=1]="LAST";t[t["NEXT"]=2]="NEXT";t[t["PREVIOUS"]=3]="PREVIOUS"})(Nk||(Nk={}));var Mk;(function(t){t[t["MAXIMIZE"]=0]="MAXIMIZE";t[t["EXPAND"]=1]="EXPAND";t[t["EVEN"]=2]="EVEN"})(Mk||(Mk={}));var Ok;(function(t){t[t["COPY_EDITORS"]=0]="COPY_EDITORS";t[t["MOVE_EDITORS"]=1]="MOVE_EDITORS"})(Ok||(Ok={}));var Fk;(function(t){t[t["CREATION_TIME"]=0]="CREATION_TIME";t[t["MOST_RECENTLY_ACTIVE"]=1]="MOST_RECENTLY_ACTIVE";t[t["GRID_APPEARANCE"]=2]="GRID_APPEARANCE"})(Fk||(Fk={}));var Uk;(function(t){t[t["NEW_EDITOR"]=1]="NEW_EDITOR";t[t["MOVE_EDITOR"]=2]="MOVE_EDITOR";t[t["COPY_EDITOR"]=3]="COPY_EDITOR"})(Uk||(Uk={}));const jN=-1;const GN=-2;class ex{constructor(e){this.value=e;this.isTrustedTelemetryValue=true}}class KN{constructor(){this.telemetryLevel=Pr.NONE;this.sessionId="someValue.sessionId";this.machineId="someValue.machineId";this.sqmId="someValue.sqmId";this.devDeviceId="someValue.devDeviceId";this.firstSessionDate="someValue.firstSessionDate";this.sendErrorTelemetry=false}publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}}new KN;const QN="telemetry";const JN={id:QN,name:h(2084,"Telemetry")};function YN(t,e){if(!t){return"none"}const i=k4(t);const n=e?.remoteExtensionTips;if(n&&Object.prototype.hasOwnProperty.call(n,i)){return i}const s=e?.virtualWorkspaceExtensionTips;if(s&&Object.prototype.hasOwnProperty.call(s,i)){return i}return"other"}function XN(t,e){if(!t||!t.includes("/")&&!t.includes("\\")){return t}let i=t;const n=[];for(const a of e){while(true){const l=a.exec(t);if(!l){break}n.push([l.index,a.lastIndex])}}const s=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/;const r=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;i="";while(true){const a=r.exec(t);if(!a){break}const l=n.some(([c,u])=>a.index<u&&c<r.lastIndex);if(!s.test(a[0])&&!l){i+=t.substring(o,a.index)+"<REDACTED: user-file-path>";o=r.lastIndex}}if(o<t.length){i+=t.substr(o)}return i}function ZN(t){if(!t){return t}const e=[{label:"URL",regex:/[a-zA-Z][a-zA-Z0-9+.-]*:\/\/[^\s]*/},{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"JWT",regex:/eyJ[0eXAiOiJKV1Qi|hbGci|a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Microsoft Entra ID",regex:/eyJ(?:0eXAiOiJKV1Qi|hbGci|[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.)/},{label:"Email",regex:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/}];for(const i of e){if(i.regex.test(t)){return`<REDACTED: ${i.label}>`}}return t}function $k(t,e){if(!t){return{}}return $c(t,i=>{if(i instanceof ex||Object.hasOwnProperty.call(i,"isTrustedTelemetryValue")){return i.value}if(typeof i==="string"){let n=i.replaceAll("%20"," ");n=XN(n,e);for(const s of e){n=n.replace(s,"")}n=ZN(n);return n}return void 0})}function eM(t,e){if(t.uuid&&e.uuid){return t.uuid===e.uuid}if(t.id===e.id){return true}return M1(t.id,e.id)===0}new ht("pprice.better-merge");const tM=Object.freeze({identifier:new ht("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:b.parse("void:location"),isBuiltin:false,targetPlatform:$1.UNDEFINED,isUserBuiltin:false,isUnderDevelopment:false,preRelease:false});class Hk{constructor(e){this.dependency=e}}var Bk;(function(t){t[t["EagerAutoStart"]=1]="EagerAutoStart";t[t["EagerManualStart"]=2]="EagerManualStart";t[t["LazyAutoStart"]=3]="LazyAutoStart"})(Bk||(Bk={}));function it(t,e){if(!t.enabledApiProposals){return false}return t.enabledApiProposals.includes(e)}function O(t,e){if(!it(t,e)){throw new Error(`Extension '${t.identifier.value}' CANNOT use API proposal: ${e}.
Its package.json#enabledApiProposals-property declares: ${t.enabledApiProposals?.join(", ")??"[]"} but NOT ${e}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${t.identifier.value}`)}}var kw;(function(t){t[t["Normal"]=0]="Normal";t[t["Immediate"]=1]="Immediate"})(kw||(kw={}));var Di;(function(t){t[t["Upsert"]=0]="Upsert";t[t["SetTags"]=1]="SetTags";t[t["UpdateCanResolveChildren"]=2]="UpdateCanResolveChildren";t[t["RemoveChild"]=3]="RemoveChild";t[t["SetProp"]=4]="SetProp";t[t["Bulk"]=5]="Bulk";t[t["DocumentSynced"]=6]="DocumentSynced"})(Di||(Di={}));const Vu=(t,e)=>t===e;const iM={range:(t,e)=>{if(t===e){return true}if(!t||!e){return false}return t.equalsRange(e)},busy:Vu,label:Vu,description:Vu,error:Vu,sortText:Vu,tags:(t,e)=>{if(t.length!==e.length){return false}if(t.some(i=>!e.includes(i))){return false}return true}};const nM=Object.entries(iM);const sM=(t,e)=>{let i;for(const[n,s]of nM){if(!s(t[n],e[n])){if(i){i[n]=e[n]}else{i={[n]:e[n]}}}}return i};class rM extends me{get root(){return this.options.root}constructor(e){super();this.options=e;this.debounceSendDiff=this._register(new wl(()=>this.flushDiff(),200));this.diffOpEmitter=this._register(new L);this.tree=new Map;this.tags=new Map;this.diff=[];this.onDidGenerateDiff=this.diffOpEmitter.event;this.root.canResolveChildren=true;this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const i of this.tree.values()){this.updateExpandability(i)}}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;this.diff=[];return e}pushDiff(e){switch(e.op){case Ot.DocumentSynced:{for(const i of this.diff){if(i.op===Ot.DocumentSynced&&i.uri===e.uri){i.docv=e.docv;return}}break}case Ot.Update:{const i=this.diff[this.diff.length-1];if(i){if(i.op===Ot.Update&&i.item.extId===e.item.extId){Ew(i.item,e.item);return}if(i.op===Ot.Add&&i.item.item.extId===e.item.extId){Ew(i.item,e.item);return}}break}}this.diff.push(e);if(!this.debounceSendDiff.isScheduled()){this.debounceSendDiff.schedule()}}expand(e,i){const n=this.tree.get(e);if(!n){return}if(n.expandLevels===void 0||i>n.expandLevels){n.expandLevels=i}if(n.expand===Li.Expandable){const s=this.resolveChildren(n);return!s.isOpen()?s.wait().then(()=>this.expandChildren(n,i-1)):this.expandChildren(n,i-1)}else if(n.expand===Li.Expanded){return n.resolveBarrier?.isOpen()===false?n.resolveBarrier.wait().then(()=>this.expandChildren(n,i-1)):this.expandChildren(n,i-1)}}dispose(){for(const e of this.tree.values()){this.options.getApiFor(e.actual).listener=void 0}this.tree.clear();this.diff=[];super.dispose()}onTestItemEvent(e,i){switch(i.op){case Di.RemoveChild:this.removeItem(Me.joinToString(e.fullId,i.id));break;case Di.Upsert:this.upsertItem(i.item,e);break;case Di.Bulk:for(const n of i.ops){this.onTestItemEvent(e,n)}break;case Di.SetTags:this.diffTagRefs(i.new,i.old,e.fullId.toString());break;case Di.UpdateCanResolveChildren:this.updateExpandability(e);break;case Di.SetProp:this.pushDiff({op:Ot.Update,item:{extId:e.fullId.toString(),item:i.update}});break;case Di.DocumentSynced:this.documentSynced(e.actual.uri);break;default:k1()}}documentSynced(e){if(e){this.pushDiff({op:Ot.DocumentSynced,uri:e,docv:this.options.getDocumentVersion(e)})}}upsertItem(e,i){const n=Me.fromExtHostTestItem(e,this.root.id,i?.actual);const s=this.options.getApiFor(e);if(s.parent&&s.parent!==i?.actual){this.options.getChildren(s.parent).delete(e.id)}let r=this.tree.get(n.toString());if(!r){r={fullId:n,actual:e,expandLevels:i?.expandLevels?i.expandLevels-1:void 0,expand:Li.NotExpandable};e.tags.forEach(this.incrementTagRefs,this);this.tree.set(r.fullId.toString(),r);this.setItemParent(e,i);this.pushDiff({op:Ot.Add,item:{controllerId:this.options.controllerId,expand:r.expand,item:this.options.toITestItem(e)}});this.connectItemAndChildren(e,r,i);return}if(r.actual===e){this.connectItem(e,r,i);return}if(r.actual.uri?.toString()!==e.uri?.toString()){this.removeItem(n.toString());return this.upsertItem(e,i)}const o=this.options.getChildren(r.actual);const a=r.actual;const l=sM(this.options.toITestItem(a),this.options.toITestItem(e));this.options.getApiFor(a).listener=void 0;r.actual=e;r.resolveBarrier=void 0;r.expand=Li.NotExpandable;if(l){if(l.hasOwnProperty("tags")){this.diffTagRefs(e.tags,a.tags,n.toString());delete l.tags}this.onTestItemEvent(r,{op:Di.SetProp,update:l})}this.connectItemAndChildren(e,r,i);for(const[u,d]of o){if(!this.options.getChildren(e).get(d.id)){this.removeItem(Me.joinToString(n,d.id))}}const c=r.expandLevels;if(c!==void 0){queueMicrotask(()=>{if(r.expand===Li.Expandable){r.expandLevels=void 0;this.expand(n.toString(),c)}})}this.documentSynced(r.actual.uri)}diffTagRefs(e,i,n){const s=new Set(i.map(r=>r.id));for(const r of e){if(!s.delete(r.id)){this.incrementTagRefs(r)}}this.pushDiff({op:Ot.Update,item:{extId:n,item:{tags:e.map(r=>pp(this.options.controllerId,r.id))}}});s.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const i=this.tags.get(e.id);if(i){i.refCount++}else{this.tags.set(e.id,{refCount:1});this.pushDiff({op:Ot.AddTag,tag:{id:pp(this.options.controllerId,e.id)}})}}decrementTagRefs(e){const i=this.tags.get(e);if(i&&!--i.refCount){this.tags.delete(e);this.pushDiff({op:Ot.RemoveTag,id:pp(this.options.controllerId,e)})}}setItemParent(e,i){this.options.getApiFor(e).parent=i&&i.actual!==this.root?i.actual:void 0}connectItem(e,i,n){this.setItemParent(e,n);const s=this.options.getApiFor(e);s.parent=n?.actual;s.listener=r=>this.onTestItemEvent(i,r);this.updateExpandability(i)}connectItemAndChildren(e,i,n){this.connectItem(e,i,n);for(const[s,r]of this.options.getChildren(e)){this.upsertItem(r,i)}}updateExpandability(e){let i;if(!this._resolveHandler){i=Li.NotExpandable}else if(e.resolveBarrier){i=e.resolveBarrier.isOpen()?Li.Expanded:Li.BusyExpanding}else{i=e.actual.canResolveChildren?Li.Expandable:Li.NotExpandable}if(i===e.expand){return}e.expand=i;this.pushDiff({op:Ot.Update,item:{extId:e.fullId.toString(),expand:i}});if(i===Li.Expandable&&e.expandLevels!==void 0){this.resolveChildren(e)}}expandChildren(e,i){if(i<0){return}const n=[];for(const[s,r]of this.options.getChildren(e.actual)){const o=this.expand(Me.joinToString(e.fullId,r.id),i);if(Uo(o)){n.push(o)}}if(n.length){return Promise.all(n).then(()=>{})}}resolveChildren(e){if(e.resolveBarrier){return e.resolveBarrier}if(!this._resolveHandler){const r=new Es;r.open();return r}e.expand=Li.BusyExpanding;this.pushExpandStateUpdate(e);const i=e.resolveBarrier=new Es;const n=r=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,r)};let s;try{s=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(r){n(r)}if(Uo(s)){s.catch(n).then(()=>{i.open();this.updateExpandability(e)})}else{i.open();this.updateExpandability(e)}return e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:Ot.Update,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const i=this.tree.get(e);if(!i){throw new Error("attempting to remove non-existent child")}this.pushDiff({op:Ot.Remove,itemId:e});const n=[i];while(n.length){const s=n.pop();if(!s){continue}this.options.getApiFor(s.actual).listener=void 0;for(const r of s.actual.tags){this.decrementTagRefs(r.id)}this.tree.delete(s.fullId.toString());for(const[r,o]of this.options.getChildren(s.actual)){n.push(this.tree.get(Me.joinToString(s.fullId,o.id)))}}}flushDiff(){const e=this.collectDiff();if(e.length){this.diffOpEmitter.fire(e)}}}class oM extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}}class Ag extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}}class aM extends Error{constructor(e,i,n){super(`TestItem with ID "${e}" is from controller "${i}" and cannot be added as a child of an item from controller "${n}".`)}}const lM=(t,e,i)=>{let n=new Map;return{get size(){return n.size},forEach(s,r){for(const o of n.values()){s.call(r,o,this)}},[Symbol.iterator](){return n.entries()},replace(s){const r=new Map;const o=new Set(n.keys());const a={op:Di.Bulk,ops:[]};for(const l of s){if(!(l instanceof i)){throw new Ag(l.id)}const c=e(l).controllerId;if(c!==t.controllerId){throw new aM(l.id,c,t.controllerId)}if(r.has(l.id)){throw new oM(l.id)}r.set(l.id,l);o.delete(l.id);a.ops.push({op:Di.Upsert,item:l})}for(const l of o.keys()){a.ops.push({op:Di.RemoveChild,id:l})}t.listener?.(a);n=r},add(s){if(!(s instanceof i)){throw new Ag(s.id)}n.set(s.id,s);t.listener?.({op:Di.Upsert,item:s})},delete(s){if(n.delete(s)){t.listener?.({op:Di.RemoveChild,id:s})}},get(s){return n.get(s)},toJSON(){return Array.from(n.values())}}};const GP=new WeakMap;const cM=(t,e)=>{const i={controllerId:e};GP.set(t,i);return i};const B_=t=>{const e=GP.get(t);if(!e){throw new Ag(t?.id||"<unknown>")}return e};var Rg;(function(t){t[t["WebSocket"]=0]="WebSocket";t[t["Managed"]=1]="Managed"})(Rg||(Rg={}));class uM{constructor(e){this.id=e;this.type=Rg.Managed}toString(){return`Managed(${this.id})`}}class dM{constructor(e,i){this.host=e;this.port=i;this.type=Rg.WebSocket}toString(){return`WebSocket(${this.host}:${this.port})`}}var Or;(function(t){t["Unknown"]="Unknown";t["NotAvailable"]="NotAvailable";t["TemporarilyNotAvailable"]="TemporarilyNotAvailable";t["NoResolverFound"]="NoResolverFound";t["InvalidAuthority"]="InvalidAuthority"})(Or||(Or={}));function Wk(t){const e=t.indexOf("+");if(e===-1){return t}return t.substring(0,e)}function be(t){const e={apply:function(...i){if(i.length===0){return Reflect.construct(t,[])}else{const n=i.length===1?[]:i[1];return Reflect.construct(t,n,i[0].constructor)}},call:function(...i){if(i.length===0){return Reflect.construct(t,[])}else{const[n,...s]=i;return Reflect.construct(t,s,n.constructor)}}};return Object.assign(t,e)}var Dw;let rn=Dw=class HW{#e;static isMarkdownString(e){if(e instanceof Dw){return true}if(!e||typeof e!=="object"){return false}return e.appendCodeblock&&e.appendMarkdown&&e.appendText&&e.value!==void 0}constructor(e,i=false){this.#e=new Ho(e,{supportThemeIcons:i})}get value(){return this.#e.value}set value(e){this.#e.value=e}get isTrusted(){return this.#e.isTrusted}set isTrusted(e){this.#e.isTrusted=e}get supportThemeIcons(){return this.#e.supportThemeIcons}set supportThemeIcons(e){this.#e.supportThemeIcons=e}get supportHtml(){return this.#e.supportHtml}set supportHtml(e){this.#e.supportHtml=e}get supportAlertSyntax(){return this.#e.supportAlertSyntax}set supportAlertSyntax(e){this.#e.supportAlertSyntax=e}get baseUri(){return this.#e.baseUri}set baseUri(e){this.#e.baseUri=e}appendText(e){this.#e.appendText(e);return this}appendMarkdown(e){this.#e.appendMarkdown(e);return this}appendCodeblock(e,i){this.#e.appendCodeblock(i??"",e);return this}};rn=Dw=W([be],rn);var ca;let je=ca=class BW{static Min(...e){if(e.length===0){throw new TypeError}let i=e[0];for(let n=1;n<e.length;n++){const s=e[n];if(s.isBefore(i)){i=s}}return i}static Max(...e){if(e.length===0){throw new TypeError}let i=e[0];for(let n=1;n<e.length;n++){const s=e[n];if(s.isAfter(i)){i=s}}return i}static isPosition(e){if(!e){return false}if(e instanceof ca){return true}const{line:i,character:n}=e;if(typeof i==="number"&&typeof n==="number"){return true}return false}static of(e){if(e instanceof ca){return e}else if(this.isPosition(e)){return new ca(e.line,e.character)}throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(e,i){if(e<0){throw Ge("line must be non-negative")}if(i<0){throw Ge("character must be non-negative")}this._line=e;this._character=i}isBefore(e){if(this._line<e._line){return true}if(e._line<this._line){return false}return this._character<e._character}isBeforeOrEqual(e){if(this._line<e._line){return true}if(e._line<this._line){return false}return this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){if(this._line<e._line){return-1}else if(this._line>e.line){return 1}else{if(this._character<e._character){return-1}else if(this._character>e._character){return 1}else{return 0}}}translate(e,i=0){if(e===null||i===null){throw Ge()}let n;if(typeof e==="undefined"){n=0}else if(typeof e==="number"){n=e}else{n=typeof e.lineDelta==="number"?e.lineDelta:0;i=typeof e.characterDelta==="number"?e.characterDelta:0}if(n===0&&i===0){return this}return new ca(this.line+n,this.character+i)}with(e,i=this.character){if(e===null||i===null){throw Ge()}let n;if(typeof e==="undefined"){n=this.line}else if(typeof e==="number"){n=e}else{n=typeof e.line==="number"?e.line:this.line;i=typeof e.character==="number"?e.character:this.character}if(n===this.line&&i===this.character){return this}return new ca(n,i)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}};je=ca=W([be],je);var _r;let Fe=_r=class WW{static isRange(e){if(e instanceof _r){return true}if(!e||typeof e!=="object"){return false}return je.isPosition(e.start)&&je.isPosition(e.end)}static of(e){if(e instanceof _r){return e}if(this.isRange(e)){return new _r(e.start,e.end)}throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(e,i,n,s){let r;let o;if(typeof e==="number"&&typeof i==="number"&&typeof n==="number"&&typeof s==="number"){r=new je(e,i);o=new je(n,s)}else if(je.isPosition(e)&&je.isPosition(i)){r=je.of(e);o=je.of(i)}if(!r||!o){throw new Error("Invalid arguments")}if(r.isBefore(o)){this._start=r;this._end=o}else{this._start=o;this._end=r}}contains(e){if(_r.isRange(e)){return this.contains(e.start)&&this.contains(e.end)}else if(je.isPosition(e)){if(je.of(e).isBefore(this._start)){return false}if(this._end.isBefore(e)){return false}return true}return false}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){const i=je.Max(e.start,this._start);const n=je.Min(e.end,this._end);if(i.isAfter(n)){return void 0}return new _r(i,n)}union(e){if(this.contains(e)){return this}else if(e.contains(this)){return e}const i=je.Min(e.start,this._start);const n=je.Max(e.end,this.end);return new _r(i,n)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,i=this.end){if(e===null||i===null){throw Ge()}let n;if(!e){n=this.start}else if(je.isPosition(e)){n=e}else{n=e.start||this.start;i=e.end||this.end}if(n.isEqual(this._start)&&i.isEqual(this.end)){return this}return new _r(n,i)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return KP(this)}};Fe=_r=W([be],Fe);function KP(t){return t.isEmpty?`[${t.start.line}:${t.start.character})`:`[${t.start.line}:${t.start.character} -> ${t.end.line}:${t.end.character})`}var ed;let $t=class VW{static{ed=this}static{this.sep="."}constructor(e){this.value=e}append(e){return new ed(this.value?this.value+ed.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+ed.sep)}};$t=ed=W([be],$t);$t.Empty=new $t("");$t.QuickFix=$t.Empty.append("quickfix");$t.Refactor=$t.Empty.append("refactor");$t.RefactorExtract=$t.Refactor.append("extract");$t.RefactorInline=$t.Refactor.append("inline");$t.RefactorMove=$t.Refactor.append("move");$t.RefactorRewrite=$t.Refactor.append("rewrite");$t.Source=$t.Empty.append("source");$t.SourceOrganizeImports=$t.Source.append("organizeImports");$t.SourceFixAll=$t.Source.append("fixAll");$t.Notebook=$t.Empty.append("notebook");var Aa;(function(t){t[t["Unnecessary"]=1]="Unnecessary";t[t["Deprecated"]=2]="Deprecated"})(Aa||(Aa={}));var Oi;(function(t){t[t["Hint"]=3]="Hint";t[t["Information"]=2]="Information";t[t["Warning"]=1]="Warning";t[t["Error"]=0]="Error"})(Oi||(Oi={}));let ih=class zW{static is(e){if(!e){return false}return typeof e.message==="string"&&e.location&&Fe.isRange(e.location.range)&&b.isUri(e.location.uri)}constructor(e,i){this.location=e;this.message=i}static isEqual(e,i){if(e===i){return true}if(!e||!i){return false}return e.message===i.message&&e.location.range.isEqual(i.location.range)&&e.location.uri.toString()===i.location.uri.toString()}};ih=W([be],ih);let Lg=class qW{constructor(e,i,n=Oi.Error){if(!Fe.isRange(e)){throw new TypeError("range must be set")}if(!i){throw new TypeError("message must be set")}this.range=e;this.message=i;this.severity=n}toJSON(){return{severity:Oi[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,i){if(e===i){return true}if(!e||!i){return false}return e.message===i.message&&e.severity===i.severity&&e.code===i.code&&e.severity===i.severity&&e.source===i.source&&e.range.isEqual(i.range)&&mn(e.tags,i.tags)&&mn(e.relatedInformation,i.relatedInformation,ih.isEqual)}};Lg=W([be],Lg);var Iw;let Tn=Iw=class jW{static isLocation(e){if(e instanceof Iw){return true}if(!e){return false}return Fe.isRange(e.range)&&b.isUri(e.uri)}constructor(e,i){this.uri=e;if(!i);else if(Fe.isRange(i)){this.range=Fe.of(i)}else if(je.isPosition(i)){this.range=new Fe(i,i)}else{throw new Error("Illegal argument")}}toJSON(){return{uri:this.uri,range:this.range}}};Tn=Iw=W([be],Tn);var ro;var Ra;(function(t){t[t["Markup"]=1]="Markup";t[t["Code"]=2]="Code"})(Ra||(Ra={}));let tr=class Tw{static isNotebookRange(e){if(e instanceof Tw){return true}if(!e){return false}return typeof e.start==="number"&&typeof e.end==="number"}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,i){if(e<0){throw Ge("start must be positive")}if(i<0){throw Ge("end must be positive")}if(e<=i){this._start=e;this._end=i}else{this._start=i;this._end=e}}with(e){let i=this._start;let n=this._end;if(e.start!==void 0){i=e.start}if(e.end!==void 0){n=e.end}if(i===this._start&&n===this._end){return this}return new Tw(i,n)}};let W_=class Pw{static validate(e){if(typeof e.kind!=="number"){throw new Error("NotebookCellData MUST have 'kind' property")}if(typeof e.value!=="string"){throw new Error("NotebookCellData MUST have 'value' property")}if(typeof e.languageId!=="string"){throw new Error("NotebookCellData MUST have 'languageId' property")}}static isNotebookCellDataArray(e){return Array.isArray(e)&&e.every(i=>Pw.isNotebookCellData(i))}static isNotebookCellData(e){return true}constructor(e,i,n,s,r,o,a){this.kind=e;this.value=i;this.languageId=n;this.mime=s;this.outputs=r??[];this.metadata=o;this.executionSummary=a;Pw.validate(this)}};let QP=class GW{constructor(e){this.cells=e}};let Ng=ro=class KW{static isNotebookCellEdit(e){if(e instanceof ro){return true}if(!e){return false}return tr.isNotebookRange(e)&&Array.isArray(e.newCells)}static replaceCells(e,i){return new ro(e,i)}static insertCells(e,i){return new ro(new tr(e,e),i)}static deleteCells(e){return new ro(e,[])}static updateCellMetadata(e,i){const n=new ro(new tr(e,e),[]);n.newCellMetadata=i;return n}static updateNotebookMetadata(e){const i=new ro(new tr(0,0),[]);i.newNotebookMetadata=e;return i}constructor(e,i){this.range=e;this.newCells=i}};Ng=ro=W([be],Ng);let JP=class vr{static isNotebookCellOutputItem(e){if(e instanceof vr){return true}if(!e){return false}return typeof e.mime==="string"&&e.data instanceof Uint8Array}static error(e){const i={name:e.name,message:e.message,stack:e.stack};return vr.json(i,"application/vnd.code.notebook.error")}static stdout(e){return vr.text(e,"application/vnd.code.notebook.stdout")}static stderr(e){return vr.text(e,"application/vnd.code.notebook.stderr")}static bytes(e,i="application/octet-stream"){return new vr(e,i)}static#e=new TextEncoder;static text(e,i=Ps.text){const n=vr.#e.encode(String(e));return new vr(n,i)}static json(e,i="text/x-json"){const n=JSON.stringify(e,void 0,"	");return vr.text(n,i)}constructor(e,i){this.data=e;this.mime=i;const n=Z4(i,true);if(!n){throw new Error(`INVALID mime type: ${i}. Must be in the format "type/subtype[;optionalparameter]"`)}this.mime=n}};let Mg=class Aw{static isNotebookCellOutput(e){if(e instanceof Aw){return true}if(!e||typeof e!=="object"){return false}return typeof e.id==="string"&&Array.isArray(e.items)}static ensureUniqueMimeTypes(e,i=false){const n=new Set;const s=new Set;for(let r=0;r<e.length;r++){const o=e[r];const a=Z4(o.mime);if(!n.has(a)||eP(a)){n.add(a);continue}s.add(r);if(i){console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}}if(s.size===0){return e}return e.filter((r,o)=>!s.has(o))}constructor(e,i,n){this.items=Aw.ensureUniqueMimeTypes(e,true);if(typeof i==="string"){this.id=i;this.metadata=n}else{this.id=Pi();this.metadata=i??n}}};var Rw;let or=Rw=class QW extends Fe{static isSelection(e){if(e instanceof Rw){return true}if(!e||typeof e!=="object"){return false}return Fe.isRange(e)&&je.isPosition(e.anchor)&&je.isPosition(e.active)&&typeof e.isReversed==="boolean"}get anchor(){return this._anchor}get active(){return this._active}constructor(e,i,n,s){let r;let o;if(typeof e==="number"&&typeof i==="number"&&typeof n==="number"&&typeof s==="number"){r=new je(e,i);o=new je(n,s)}else if(je.isPosition(e)&&je.isPosition(i)){r=je.of(e);o=je.of(i)}if(!r||!o){throw new Error("Invalid arguments")}super(r,o);this._anchor=r;this._active=o}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for("debug.description")](){return hM(this)}};or=Rw=W([be],or);function hM(t){let e=KP(t);if(!t.isEmpty){if(t.active.isEqual(t.start)){e=`|${e}`}else{e=`${e}|`}}return e}var ua;let ll=ua=class JW{static isSnippetString(e){if(e instanceof ua){return true}if(!e||typeof e!=="object"){return false}return typeof e.value==="string"}static _escape(e){return e.replace(/\$|}|\\/g,"\\$&")}constructor(e){this._tabstop=1;this.value=e||""}appendText(e){this.value+=ua._escape(e);return this}appendTabstop(e=this._tabstop++){this.value+="$";this.value+=e;return this}appendPlaceholder(e,i=this._tabstop++){if(typeof e==="function"){const n=new ua;n._tabstop=this._tabstop;e(n);this._tabstop=n._tabstop;e=n.value}else{e=ua._escape(e)}this.value+="${";this.value+=i;this.value+=":";this.value+=e;this.value+="}";return this}appendChoice(e,i=this._tabstop++){const n=e.map(s=>s.replaceAll(/[|\\,]/g,"\\$&")).join(",");this.value+="${";this.value+=i;this.value+="|";this.value+=n;this.value+="|}";return this}appendVariable(e,i){if(typeof i==="function"){const n=new ua;n._tabstop=this._tabstop;i(n);this._tabstop=n._tabstop;i=n.value}else if(typeof i==="string"){i=i.replace(/\$|}/g,"\\$&")}this.value+="${";this.value+=e;if(i){this.value+=":";this.value+=i}this.value+="}";return this}};ll=ua=W([be],ll);var Lw;var Dt;(function(t){t[t["File"]=0]="File";t[t["Module"]=1]="Module";t[t["Namespace"]=2]="Namespace";t[t["Package"]=3]="Package";t[t["Class"]=4]="Class";t[t["Method"]=5]="Method";t[t["Property"]=6]="Property";t[t["Field"]=7]="Field";t[t["Constructor"]=8]="Constructor";t[t["Enum"]=9]="Enum";t[t["Interface"]=10]="Interface";t[t["Function"]=11]="Function";t[t["Variable"]=12]="Variable";t[t["Constant"]=13]="Constant";t[t["String"]=14]="String";t[t["Number"]=15]="Number";t[t["Boolean"]=16]="Boolean";t[t["Array"]=17]="Array";t[t["Object"]=18]="Object";t[t["Key"]=19]="Key";t[t["Null"]=20]="Null";t[t["EnumMember"]=21]="EnumMember";t[t["Struct"]=22]="Struct";t[t["Event"]=23]="Event";t[t["Operator"]=24]="Operator";t[t["TypeParameter"]=25]="TypeParameter"})(Dt||(Dt={}));var nh;(function(t){t[t["Deprecated"]=1]="Deprecated"})(nh||(nh={}));let sh=Lw=class YW{static validate(e){if(!e.name){throw new Error("name must not be falsy")}}constructor(e,i,n,s,r){this.name=e;this.kind=i;this.containerName=r;if(typeof n==="string"){this.containerName=n}if(s instanceof Tn){this.location=s}else if(n instanceof Fe){this.location=new Tn(s,n)}Lw.validate(this)}toJSON(){return{name:this.name,kind:Dt[this.kind],location:this.location,containerName:this.containerName}}};sh=Lw=W([be],sh);var da;var Ds;(function(t){t[t["LF"]=1]="LF";t[t["CRLF"]=2]="CRLF"})(Ds||(Ds={}));let Wo=da=class XW{static isTextEdit(e){if(e instanceof da){return true}if(!e||typeof e!=="object"){return false}return Fe.isRange(e)&&typeof e.newText==="string"}static replace(e,i){return new da(e,i)}static insert(e,i){return da.replace(new Fe(e,e),i)}static delete(e){return da.replace(e,"")}static setEndOfLine(e){const i=new da(new Fe(new je(0,0),new je(0,0)),"");i.newEol=e;return i}get range(){return this._range}set range(e){if(e&&!Fe.isRange(e)){throw Ge("range")}this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&typeof e!=="string"){throw Ge("newText")}this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!=="number"){throw Ge("newEol")}this._newEol=e}constructor(e,i){this._range=e;this._newText=i}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};Wo=da=W([be],Wo);class Ka{static isSnippetTextEdit(e){if(e instanceof Ka){return true}if(!e){return false}return Fe.isRange(e.range)&&ll.isSnippetString(e.snippet)}static replace(e,i){return new Ka(e,i)}static insert(e,i){return Ka.replace(new Fe(e,e),i)}constructor(e,i){this.range=e;this.snippet=i}}var Xt;(function(t){t[t["File"]=1]="File";t[t["Text"]=2]="Text";t[t["Cell"]=3]="Cell";t[t["CellReplace"]=5]="CellReplace";t[t["Snippet"]=6]="Snippet"})(Xt||(Xt={}));let cl=class ZW{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,i,n,s){this._edits.push({_type:Xt.File,from:e,to:i,options:n,metadata:s})}createFile(e,i,n){this._edits.push({_type:Xt.File,from:void 0,to:e,options:i,metadata:n})}deleteFile(e,i,n){this._edits.push({_type:Xt.File,from:e,to:void 0,options:i,metadata:n})}replaceNotebookMetadata(e,i,n){this._edits.push({_type:Xt.Cell,metadata:n,uri:e,edit:{editType:Lo.DocumentMetadata,metadata:i}})}replaceNotebookCells(e,i,n,s){const r=i.start;const o=i.end;if(r!==o||n.length>0){this._edits.push({_type:Xt.CellReplace,uri:e,index:r,count:o-r,cells:n,metadata:s})}}replaceNotebookCellMetadata(e,i,n,s){this._edits.push({_type:Xt.Cell,metadata:s,uri:e,edit:{editType:Lo.Metadata,index:i,metadata:n}})}replace(e,i,n,s){this._edits.push({_type:Xt.Text,uri:e,edit:new Wo(i,n),metadata:s})}insert(e,i,n,s){this.replace(e,new Fe(i,i),n,s)}delete(e,i,n){this.replace(e,i,"",n)}has(e){return this._edits.some(i=>i._type===Xt.Text&&i.uri.toString()===e.toString())}set(e,i){if(!i){for(let n=0;n<this._edits.length;n++){const s=this._edits[n];switch(s._type){case Xt.Text:case Xt.Snippet:case Xt.Cell:case Xt.CellReplace:if(s.uri.toString()===e.toString()){this._edits[n]=void 0}break}}q5(this._edits)}else{for(const n of i){if(!n){continue}let s;let r;if(Array.isArray(n)){s=n[0];r=n[1]}else{s=n}if(Ng.isNotebookCellEdit(s)){if(s.newCellMetadata){this.replaceNotebookCellMetadata(e,s.range.start,s.newCellMetadata,r)}else if(s.newNotebookMetadata){this.replaceNotebookMetadata(e,s.newNotebookMetadata,r)}else{this.replaceNotebookCells(e,s.range,s.newCells,r)}}else if(Ka.isSnippetTextEdit(s)){this._edits.push({_type:Xt.Snippet,uri:e,range:s.range,edit:s.snippet,metadata:r,keepWhitespace:s.keepWhitespace})}else{this._edits.push({_type:Xt.Text,uri:e,edit:s,metadata:r})}}}}get(e){const i=[];for(const n of this._edits){if(n._type===Xt.Text&&n.uri.toString()===e.toString()){i.push(n.edit)}}return i}entries(){const e=new It;for(const i of this._edits){if(i._type===Xt.Text){let n=e.get(i.uri);if(!n){n=[i.uri,[]];e.set(i.uri,n)}n[1].push(i.edit)}}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};cl=W([be],cl);var Nw;var gp;var Hs;var Bs;var Mw;var un;var Ow;var Fw;(function(t){t[t["Top"]=0]="Top";t[t["Bottom"]=1]="Bottom"})(Fw||(Fw={}));var Vk;(function(t){t[t["TerminalCommand"]=0]="TerminalCommand";t[t["Opener"]=1]="Opener";t[t["Command"]=3]="Command"})(Vk||(Vk={}));let Ve=Nw=class eV{static from(...e){let i=e;return new Nw(function(){if(i){for(const n of i){if(n&&typeof n.dispose==="function"){n.dispose()}}i=void 0}})}#e;constructor(e){this.#e=e}dispose(){if(typeof this.#e==="function"){this.#e();this.#e=void 0}}};Ve=Nw=W([be],Ve);const YP=t=>{if(typeof t!=="string"||t.length===0||!/^[0-9A-Za-z_\-]+$/.test(t)){throw Ge("connectionToken")}};class fM{static isResolvedAuthority(e){return e&&typeof e==="object"&&typeof e.host==="string"&&typeof e.port==="number"&&(e.connectionToken===void 0||typeof e.connectionToken==="string")}constructor(e,i,n){if(typeof e!=="string"||e.length===0){throw Ge("host")}if(typeof i!=="number"||i===0||Math.round(i)!==i){throw Ge("port")}if(typeof n!=="undefined"){YP(n)}this.host=e;this.port=Math.round(i);this.connectionToken=n}}class mp{static isManagedResolvedAuthority(e){return e&&typeof e==="object"&&typeof e.makeConnection==="function"&&(e.connectionToken===void 0||typeof e.connectionToken==="string")}constructor(e,i){this.makeConnection=e;this.connectionToken=i;if(typeof i!=="undefined"){YP(i)}}}class Qs extends Error{static NotAvailable(e,i){return new Qs(e,Or.NotAvailable,i)}static TemporarilyNotAvailable(e){return new Qs(e,Or.TemporarilyNotAvailable)}constructor(e,i=Or.Unknown,n){super(e);this._message=e;this._code=i;this._detail=n;Object.setPrototypeOf(this,Qs.prototype)}}var hc;(function(t){t[t["Replace"]=1]="Replace";t[t["Append"]=2]="Append";t[t["Prepend"]=3]="Prepend"})(hc||(hc={}));let Og=class tV{constructor(e,i){if(!e){throw new Error("Illegal argument, contents must be defined")}if(Array.isArray(e)){this.contents=e}else{this.contents=[e]}this.range=i}};Og=W([be],Og);let Fg=class iV extends Og{constructor(e,i,n,s){super(e,i);this.canIncreaseVerbosity=n;this.canDecreaseVerbosity=s}};Fg=W([be],Fg);var Uw;(function(t){t[t["Increase"]=0]="Increase";t[t["Decrease"]=1]="Decrease"})(Uw||(Uw={}));var rh;(function(t){t[t["Text"]=0]="Text";t[t["Read"]=1]="Read";t[t["Write"]=2]="Write"})(rh||(rh={}));let Ug=class nV{constructor(e,i=rh.Text){this.range=e;this.kind=i}toJSON(){return{range:this.range,kind:rh[this.kind]}}};Ug=W([be],Ug);let $g=class sV{constructor(e,i){this.uri=e;this.highlights=i}toJSON(){return{uri:this.uri,highlights:this.highlights.map(e=>e.toJSON())}}};$g=W([be],$g);let oh=gp=class rV{static validate(e){if(!e.name){throw new Error("name must not be falsy")}if(!e.range.contains(e.selectionRange)){throw new Error("selectionRange must be contained in fullRange")}e.children?.forEach(gp.validate)}constructor(e,i,n,s,r){this.name=e;this.detail=i;this.kind=n;this.range=s;this.selectionRange=r;this.children=[];gp.validate(this)}};oh=gp=W([be],oh);var ah;(function(t){t[t["Invoke"]=1]="Invoke";t[t["Automatic"]=2]="Automatic"})(ah||(ah={}));let lh=class oV{constructor(e,i){this.title=e;this.kind=i}};lh=W([be],lh);let ch=class aV{constructor(e,i){this.range=e;this.parent=i;if(i&&!i.range.contains(this.range)){throw new Error("Invalid argument: parent must contain this range")}}};ch=W([be],ch);let tx=class lV{constructor(e,i,n,s,r,o){this.kind=e;this.name=i;this.detail=n;this.uri=s;this.range=r;this.selectionRange=o}};let XP=class cV{constructor(e,i){this.fromRanges=i;this.from=e}};let ZP=class uV{constructor(e,i){this.fromRanges=i;this.to=e}};var fc;(function(t){t[t["Information"]=0]="Information";t[t["Warning"]=1]="Warning";t[t["Error"]=2]="Error"})(fc||(fc={}));let Hg=class dV{constructor(e,i){this.range=e;this.command=i}get isResolved(){return!!this.command}};Hg=W([be],Hg);let $w=class hV{constructor(e,i){this.label=e;this.documentation=i}};$w=W([be],$w);let Hw=class fV{constructor(e,i){this.label=e;this.documentation=i;this.parameters=[]}};Hw=W([be],Hw);let Bw=class pV{constructor(){this.activeSignature=0;this.activeParameter=0;this.signatures=[]}};Bw=W([be],Bw);var Ww;(function(t){t[t["Invoke"]=1]="Invoke";t[t["TriggerCharacter"]=2]="TriggerCharacter";t[t["ContentChange"]=3]="ContentChange"})(Ww||(Ww={}));var Vw;(function(t){t[t["Type"]=1]="Type";t[t["Parameter"]=2]="Parameter"})(Vw||(Vw={}));let Bg=class gV{constructor(e){this.value=e}};Bg=W([be],Bg);let Wg=class mV{constructor(e,i,n){this.position=e;this.label=i;this.kind=n}};Wg=W([be],Wg);var pc;(function(t){t[t["Invoke"]=0]="Invoke";t[t["TriggerCharacter"]=1]="TriggerCharacter";t[t["TriggerForIncompleteCompletions"]=2]="TriggerForIncompleteCompletions"})(pc||(pc={}));var Te;(function(t){t[t["Text"]=0]="Text";t[t["Method"]=1]="Method";t[t["Function"]=2]="Function";t[t["Constructor"]=3]="Constructor";t[t["Field"]=4]="Field";t[t["Variable"]=5]="Variable";t[t["Class"]=6]="Class";t[t["Interface"]=7]="Interface";t[t["Module"]=8]="Module";t[t["Property"]=9]="Property";t[t["Unit"]=10]="Unit";t[t["Value"]=11]="Value";t[t["Enum"]=12]="Enum";t[t["Keyword"]=13]="Keyword";t[t["Snippet"]=14]="Snippet";t[t["Color"]=15]="Color";t[t["File"]=16]="File";t[t["Reference"]=17]="Reference";t[t["Folder"]=18]="Folder";t[t["EnumMember"]=19]="EnumMember";t[t["Constant"]=20]="Constant";t[t["Struct"]=21]="Struct";t[t["Event"]=22]="Event";t[t["Operator"]=23]="Operator";t[t["TypeParameter"]=24]="TypeParameter";t[t["User"]=25]="User";t[t["Issue"]=26]="Issue"})(Te||(Te={}));var uh;(function(t){t[t["Deprecated"]=1]="Deprecated"})(uh||(uh={}));let Vg=class _V{constructor(e,i){this.label=e;this.kind=i}toJSON(){return{label:this.label,kind:this.kind&&Te[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Vg=W([be],Vg);let jc=class vV{constructor(e=[],i=false){this.items=e;this.isIncomplete=i}};jc=W([be],jc);let zw=class wV{constructor(e,i,n){this.insertText=e;this.range=i;this.command=n}};zw=W([be],zw);let qw=class bV{constructor(e){this.commands=void 0;this.suppressSuggestions=void 0;this.items=e}};qw=W([be],qw);var La;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Word"]=1]="Word";t[t["Line"]=2]="Line";t[t["Suggest"]=3]="Suggest"})(La||(La={}));var gc;(function(t){t[t["Accepted"]=0]="Accepted";t[t["Rejected"]=1]="Rejected";t[t["Ignored"]=2]="Ignored"})(gc||(gc={}));var mc;(function(t){t[t["Code"]=1]="Code";t[t["Label"]=2]="Label"})(mc||(mc={}));var dh;(function(t){t[t["Active"]=-1]="Active";t[t["Beside"]=-2]="Beside";t[t["One"]=1]="One";t[t["Two"]=2]="Two";t[t["Three"]=3]="Three";t[t["Four"]=4]="Four";t[t["Five"]=5]="Five";t[t["Six"]=6]="Six";t[t["Seven"]=7]="Seven";t[t["Eight"]=8]="Eight";t[t["Nine"]=9]="Nine"})(dh||(dh={}));var Co;(function(t){t[t["Left"]=1]="Left";t[t["Right"]=2]="Right"})(Co||(Co={}));function pM(t,e){return`${ht.toKey(t)}.${e}`}var fs;(function(t){t[t["Off"]=0]="Off";t[t["On"]=1]="On";t[t["Relative"]=2]="Relative";t[t["Interval"]=3]="Interval"})(fs||(fs={}));var _c;(function(t){t[t["Manual"]=1]="Manual";t[t["AfterDelay"]=2]="AfterDelay";t[t["FocusOut"]=3]="FocusOut"})(_c||(_c={}));var zg;(function(t){t[t["Default"]=0]="Default";t[t["InCenter"]=1]="InCenter";t[t["InCenterIfOutsideViewport"]=2]="InCenterIfOutsideViewport";t[t["AtTop"]=3]="AtTop"})(zg||(zg={}));var Gc;(function(t){t[t["Keyboard"]=1]="Keyboard";t[t["Mouse"]=2]="Mouse";t[t["Command"]=3]="Command"})(Gc||(Gc={}));var vc;(function(t){t[t["Addition"]=1]="Addition";t[t["Deletion"]=2]="Deletion";t[t["Modification"]=3]="Modification"})(vc||(vc={}));var hh;(function(t){t[t["Undo"]=1]="Undo";t[t["Redo"]=2]="Redo"})(hh||(hh={}));var Na;(function(t){t[t["OpenOpen"]=0]="OpenOpen";t[t["ClosedClosed"]=1]="ClosedClosed";t[t["OpenClosed"]=2]="OpenClosed";t[t["ClosedOpen"]=3]="ClosedOpen"})(Na||(Na={}));(function(t){function e(i){switch(i){case"keyboard":return t.Keyboard;case"mouse":return t.Mouse;case Id.PROGRAMMATIC:case Id.JUMP:case Id.NAVIGATION:return t.Command}return void 0}t.fromValue=e})(Gc||(Gc={}));var Kc;(function(t){t[t["Other"]=0]="Other";t[t["Comment"]=1]="Comment";t[t["String"]=2]="String";t[t["RegEx"]=3]="RegEx"})(Kc||(Kc={}));(function(t){function e(i){switch(i){case t.Other:return"other";case t.Comment:return"comment";case t.String:return"string";case t.RegEx:return"regex"}return"other"}t.toString=e})(Kc||(Kc={}));let qg=class yV{constructor(e,i){if(i&&!b.isUri(i)){throw Ge("target")}if(!Fe.isRange(e)||e.isEmpty){throw Ge("range")}this.range=e;this.target=i}};qg=W([be],qg);let Qc=class SV{constructor(e,i,n,s){this.red=e;this.green=i;this.blue=n;this.alpha=s}};Qc=W([be],Qc);let jg=class xV{constructor(e,i){if(i&&!(i instanceof Qc)){throw Ge("color")}if(!Fe.isRange(e)||e.isEmpty){throw Ge("range")}this.range=e;this.color=i}};jg=W([be],jg);let Gg=class EV{constructor(e){if(!e||typeof e!=="string"){throw Ge("label")}this.label=e}};Gg=W([be],Gg);var zk;(function(t){t[t["RGB"]=0]="RGB";t[t["HEX"]=1]="HEX";t[t["HSL"]=2]="HSL"})(zk||(zk={}));var wc;(function(t){t[t["Error"]=0]="Error";t[t["Warning"]=1]="Warning";t[t["Information"]=2]="Information"})(wc||(wc={}));var jw;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Shutdown"]=1]="Shutdown";t[t["Process"]=2]="Process";t[t["User"]=3]="User";t[t["Extension"]=4]="Extension"})(jw||(jw={}));var fh;(function(t){t[t["Low"]=0]="Low";t[t["Medium"]=1]="Medium";t[t["High"]=2]="High"})(fh||(fh={}));var Gw;(function(t){t[t["Sh"]=1]="Sh";t[t["Bash"]=2]="Bash";t[t["Fish"]=3]="Fish";t[t["Csh"]=4]="Csh";t[t["Ksh"]=5]="Ksh";t[t["Zsh"]=6]="Zsh";t[t["CommandPrompt"]=7]="CommandPrompt";t[t["GitBash"]=8]="GitBash";t[t["PowerShell"]=9]="PowerShell";t[t["Python"]=10]="Python";t[t["Julia"]=11]="Julia";t[t["NuShell"]=12]="NuShell";t[t["Node"]=13]="Node";t[t["Xonsh"]=14]="Xonsh"})(Gw||(Gw={}));class gM{constructor(e,i,n){this.startIndex=e;this.length=i;this.tooltip=n;if(typeof e!=="number"||e<0){throw Ge("startIndex")}if(typeof i!=="number"||i<1){throw Ge("length")}if(n!==void 0&&typeof n!=="string"){throw Ge("tooltip")}}}class mM{constructor(e){this.uri=e}}class _M{constructor(e){this.terminalCommand=e}}var Kw;(function(t){t[t["Panel"]=1]="Panel";t[t["Editor"]=2]="Editor"})(Kw||(Kw={}));class vM{constructor(e){this.options=e;if(typeof e!=="object"){throw Ge("options")}}}var Qw;(function(t){t[t["File"]=0]="File";t[t["Folder"]=1]="Folder";t[t["Method"]=2]="Method";t[t["Alias"]=3]="Alias";t[t["Argument"]=4]="Argument";t[t["Option"]=5]="Option";t[t["OptionValue"]=6]="OptionValue";t[t["Flag"]=7]="Flag";t[t["SymbolicLinkFile"]=8]="SymbolicLinkFile";t[t["SymbolicLinkFolder"]=9]="SymbolicLinkFolder";t[t["ScmCommit"]=10]="ScmCommit";t[t["ScmBranch"]=11]="ScmBranch";t[t["ScmTag"]=12]="ScmTag";t[t["ScmStash"]=13]="ScmStash";t[t["ScmRemote"]=14]="ScmRemote";t[t["PullRequest"]=15]="PullRequest";t[t["PullRequestDone"]=16]="PullRequestDone"})(Qw||(Qw={}));class wM{constructor(e,i,n,s,r,o,a,l){this.label=e;this.replacementRange=i;this.kind=n;this.detail=s;this.documentation=r;this.isFile=o;this.isDirectory=a;this.isKeyword=l}}let bM=class CV{constructor(e,i){this.items=e??[];this.resourceOptions=i}};var Jw;(function(t){t[t["Always"]=1]="Always";t[t["Silent"]=2]="Silent";t[t["Never"]=3]="Never"})(Jw||(Jw={}));var Yw;(function(t){t["Changed"]="changed";t["ProcessStarted"]="processStarted";t["ProcessEnded"]="processEnded";t["Terminated"]="terminated";t["Start"]="start";t["AcquiredInput"]="acquiredInput";t["DependsOnStarted"]="dependsOnStarted";t["Active"]="active";t["Inactive"]="inactive";t["End"]="end";t["ProblemMatcherStarted"]="problemMatcherStarted";t["ProblemMatcherEnded"]="problemMatcherEnded";t["ProblemMatcherFoundErrors"]="problemMatcherFoundErrors"})(Yw||(Yw={}));var Xw;(function(t){t[t["Shared"]=1]="Shared";t[t["Dedicated"]=2]="Dedicated";t[t["New"]=3]="New"})(Xw||(Xw={}));let ph=class kV{static{Hs=this}static{this.Clean=new Hs("clean","Clean")}static{this.Build=new Hs("build","Build")}static{this.Rebuild=new Hs("rebuild","Rebuild")}static{this.Test=new Hs("test","Test")}static from(e){switch(e){case"clean":return Hs.Clean;case"build":return Hs.Build;case"rebuild":return Hs.Rebuild;case"test":return Hs.Test;default:return void 0}}constructor(e,i){this.label=i;if(typeof e!=="string"){throw Ge("name")}if(typeof i!=="string"){throw Ge("name")}this._id=e}get id(){return this._id}};ph=Hs=W([be],ph);function eA(t){let e="";for(let i=0;i<t.length;i++){e+=t[i].replace(/,/g,",,")+","}return e}let Jc=class DV{constructor(e,i,n){if(typeof e!=="string"){throw Ge("process")}this._args=[];this._process=e;if(i!==void 0){if(Array.isArray(i)){this._args=i;this._options=n}else{this._options=i}}}get process(){return this._process}set process(e){if(typeof e!=="string"){throw Ge("process")}this._process=e}get args(){return this._args}set args(e){if(!Array.isArray(e)){e=[]}this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];e.push("process");if(this._process!==void 0){e.push(this._process)}if(this._args&&this._args.length>0){for(const i of this._args){e.push(i)}}return eA(e)}};Jc=W([be],Jc);let ul=class IV{constructor(e,i,n){this._args=[];if(Array.isArray(i)){if(!e){throw Ge("command can't be undefined or null")}if(typeof e!=="string"&&typeof e.value!=="string"){throw Ge("command")}this._command=e;if(i){this._args=i}this._options=n}else{if(typeof e!=="string"){throw Ge("commandLine")}this._commandLine=e;this._options=i}}get commandLine(){return this._commandLine}set commandLine(e){if(typeof e!=="string"){throw Ge("commandLine")}this._commandLine=e}get command(){return this._command?this._command:""}set command(e){if(typeof e!=="string"&&typeof e.value!=="string"){throw Ge("command")}this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];e.push("shell");if(this._commandLine!==void 0){e.push(this._commandLine)}if(this._command!==void 0){e.push(typeof this._command==="string"?this._command:this._command.value)}if(this._args&&this._args.length>0){for(const i of this._args){e.push(typeof i==="string"?i:i.value)}}return eA(e)}};ul=W([be],ul);var Zw;(function(t){t[t["Escape"]=1]="Escape";t[t["Strong"]=2]="Strong";t[t["Weak"]=3]="Weak"})(Zw||(Zw={}));var Vo;(function(t){t[t["Global"]=1]="Global";t[t["Workspace"]=2]="Workspace"})(Vo||(Vo={}));class ix{constructor(e){this._callback=e}computeId(){return"customExecution"+Pi()}set callback(e){this._callback=e}get callback(){return this._callback}}let Kg=class TV{static{Bs=this}static{this.ExtensionCallbackType="customExecution"}static{this.ProcessType="process"}static{this.ShellType="shell"}static{this.EmptyType="$empty"}constructor(e,i,n,s,r,o){this.__deprecated=false;this._definition=this.definition=e;let a;if(typeof i==="string"){this._name=this.name=i;this._source=this.source=n;this.execution=s;a=r;this.__deprecated=true}else if(i===Vo.Global||i===Vo.Workspace){this.target=i;this._name=this.name=n;this._source=this.source=s;this.execution=r;a=o}else{this.target=i;this._name=this.name=n;this._source=this.source=s;this.execution=r;a=o}if(typeof a==="string"){this._problemMatchers=[a];this._hasDefinedMatchers=true}else if(Array.isArray(a)){this._problemMatchers=a;this._hasDefinedMatchers=true}else{this._problemMatchers=[];this._hasDefinedMatchers=false}this._isBackground=false;this._presentationOptions=Object.create(null);this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){if(this.__id===void 0){return}this.__id=void 0;this._scope=void 0;this.computeDefinitionBasedOnExecution()}computeDefinitionBasedOnExecution(){if(this._execution instanceof Jc){this._definition={type:Bs.ProcessType,id:this._execution.computeId()}}else if(this._execution instanceof ul){this._definition={type:Bs.ShellType,id:this._execution.computeId()}}else if(this._execution instanceof ix){this._definition={type:Bs.ExtensionCallbackType,id:this._execution.computeId()}}else{this._definition={type:Bs.EmptyType,id:Pi()}}}get definition(){return this._definition}set definition(e){if(e===void 0||e===null){throw Ge("Kind can't be undefined or null")}this.clear();this._definition=e}get scope(){return this._scope}set target(e){this.clear();this._scope=e}get name(){return this._name}set name(e){if(typeof e!=="string"){throw Ge("name")}this.clear();this._name=e}get execution(){return this._execution}set execution(e){if(e===null){e=void 0}this.clear();this._execution=e;const i=this._definition.type;if(Bs.EmptyType===i||Bs.ProcessType===i||Bs.ShellType===i||Bs.ExtensionCallbackType===i){this.computeDefinitionBasedOnExecution()}}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(!Array.isArray(e)){this.clear();this._problemMatchers=[];this._hasDefinedMatchers=false;return}else{this.clear();this._problemMatchers=e;this._hasDefinedMatchers=true}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){if(e!==true&&e!==false){e=false}this.clear();this._isBackground=e}get source(){return this._source}set source(e){if(typeof e!=="string"||e.length===0){throw Ge("source must be a string of length > 0")}this.clear();this._source=e}get group(){return this._group}set group(e){if(e===null){e=void 0}this.clear();this._group=e}get detail(){return this._detail}set detail(e){if(e===null){e=void 0}this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){if(e===null||e===void 0){e=Object.create(null)}this.clear();this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){if(e===null||e===void 0){e=Object.create(null)}this.clear();this._runOptions=e}};Kg=Bs=W([be],Kg);var Mo;(function(t){t[t["SourceControl"]=1]="SourceControl";t[t["Window"]=10]="Window";t[t["Notification"]=15]="Notification"})(Mo||(Mo={}));var eb;(function(t){function e(i){const n=i;if(!$a(n.value)){console.log("INVALID view badge, invalid value",n.value);return false}if(n.tooltip&&!Xe(n.tooltip)){console.log("INVALID view badge, invalid tooltip",n.tooltip);return false}return true}t.isViewBadge=e})(eb||(eb={}));let Qg=Mw=class PV{static isTreeItem(e,i){const n=e;if(n.checkboxState!==void 0){const s=$a(n.checkboxState)?n.checkboxState:Gt(n.checkboxState)&&$a(n.checkboxState.state)?n.checkboxState.state:void 0;const r=!$a(n.checkboxState)&&Gt(n.checkboxState)?n.checkboxState.tooltip:void 0;if(s===void 0||s!==Js.Checked&&s!==Js.Unchecked||r!==void 0&&!Xe(r)){console.log("INVALID tree item, invalid checkboxState",n.checkboxState);return false}}if(e instanceof Mw){return true}if(n.label!==void 0&&!Xe(n.label)&&!n.label?.label){console.log("INVALID tree item, invalid label",n.label);return false}if(n.id!==void 0&&!Xe(n.id)){console.log("INVALID tree item, invalid id",n.id);return false}if(n.iconPath!==void 0&&!Xe(n.iconPath)&&!b.isUri(n.iconPath)&&(!n.iconPath||!Xe(n.iconPath.id))){const s=n.iconPath;if(!s||!Xe(s.light)&&!b.isUri(s.light)&&!Xe(s.dark)&&!b.isUri(s.dark)){console.log("INVALID tree item, invalid iconPath",n.iconPath);return false}}if(n.description!==void 0&&!Xe(n.description)&&typeof n.description!=="boolean"){console.log("INVALID tree item, invalid description",n.description);return false}if(n.resourceUri!==void 0&&!b.isUri(n.resourceUri)){console.log("INVALID tree item, invalid resourceUri",n.resourceUri);return false}if(n.tooltip!==void 0&&!Xe(n.tooltip)&&!(n.tooltip instanceof rn)){console.log("INVALID tree item, invalid tooltip",n.tooltip);return false}if(n.command!==void 0&&!n.command.command){console.log("INVALID tree item, invalid command",n.command);return false}if(n.collapsibleState!==void 0&&n.collapsibleState<Qa.None&&n.collapsibleState>Qa.Expanded){console.log("INVALID tree item, invalid collapsibleState",n.collapsibleState);return false}if(n.contextValue!==void 0&&!Xe(n.contextValue)){console.log("INVALID tree item, invalid contextValue",n.contextValue);return false}if(n.accessibilityInformation!==void 0&&!n.accessibilityInformation?.label){console.log("INVALID tree item, invalid accessibilityInformation",n.accessibilityInformation);return false}return true}constructor(e,i=Qa.None){this.collapsibleState=i;if(b.isUri(e)){this.resourceUri=e}else{this.label=e}}};Qg=Mw=W([be],Qg);var Qa;(function(t){t[t["None"]=0]="None";t[t["Collapsed"]=1]="Collapsed";t[t["Expanded"]=2]="Expanded"})(Qa||(Qa={}));var Js;(function(t){t[t["Unchecked"]=0]="Unchecked";t[t["Checked"]=1]="Checked"})(Js||(Js={}));let Jg=class AV{async asString(){return typeof this.value==="string"?this.value:JSON.stringify(this.value)}asFile(){return void 0}constructor(e){this.value=e}};Jg=W([be],Jg);class Yg extends Jg{}class yM extends Yg{#e;constructor(e){super("");this.#e=e}asFile(){return this.#e}}class SM{constructor(e,i,n,s){this.name=e;this.uri=i;this._itemId=n;this._getData=s}data(){return this._getData()}}let Yc=class RV{#e=new Map;constructor(e){for(const[i,n]of e??[]){const s=this.#e.get(this.#t(i));if(s){s.push(n)}else{this.#e.set(this.#t(i),[n])}}}get(e){return this.#e.get(this.#t(e))?.[0]}set(e,i){this.#e.set(this.#t(e),[i])}forEach(e,i){for(const[n,s]of this.#e){for(const r of s){e.call(i,r,n,this)}}}*[Symbol.iterator](){for(const[e,i]of this.#e){for(const n of i){yield[e,n]}}}#t(e){return e.toLowerCase()}};Yc=W([be],Yc);let tb=class LV{constructor(e,i,n){this.insertText=e;this.title=i;this.kind=n}};tb=W([be],tb);var ib;(function(t){t[t["Automatic"]=0]="Automatic";t[t["PasteAs"]=1]="PasteAs"})(ib||(ib={}));class Xn{static{this.sep="."}constructor(e){this.value=e}append(...e){return new Xn((this.value?[this.value,...e]:e).join(Xn.sep))}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+Xn.sep)}}Xn.Empty=new Xn("");Xn.Text=new Xn("text");Xn.TextUpdateImports=Xn.Text.append("updateImports");class xM{constructor(e,i,n){this.title=i;this.insertText=e;this.kind=n}}let _n=class NV{constructor(e,i){this.id=e;this.color=i}static isThemeIcon(e){if(typeof e.id!=="string"){console.log("INVALID ThemeIcon, invalid id",e.id);return false}return true}};_n=W([be],_n);_n.File=new _n("file");_n.Folder=new _n("folder");let gh=class MV{constructor(e){this.id=e}};gh=W([be],gh);var bc;(function(t){t[t["Global"]=1]="Global";t[t["Workspace"]=2]="Workspace";t[t["WorkspaceFolder"]=3]="WorkspaceFolder"})(bc||(bc={}));let yc=class OV{get base(){return this._base}set base(e){this._base=e;this._baseUri=b.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e;this._base=e.fsPath}constructor(e,i){if(typeof e!=="string"){if(!e||!b.isUri(e)&&!b.isUri(e.uri)){throw Ge("base")}}if(typeof i!=="string"){throw Ge("pattern")}if(typeof e==="string"){this.baseUri=b.file(e)}else if(b.isUri(e)){this.baseUri=e}else{this.baseUri=e.uri}this.pattern=i}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};yc=W([be],yc);const tA=new WeakMap;function EM(t,e){tA.set(t,e)}let Xc=class FV{constructor(e,i,n,s,r){this.enabled=typeof e==="boolean"?e:true;if(typeof i==="string"){this.condition=i}if(typeof n==="string"){this.hitCondition=n}if(typeof s==="string"){this.logMessage=s}if(typeof r==="string"){this.mode=r}}get id(){if(!this._id){this._id=tA.get(this)??Pi()}return this._id}};Xc=W([be],Xc);let Ma=class UV extends Xc{constructor(e,i,n,s,r,o){super(i,n,s,r,o);if(e===null){throw Ge("location")}this.location=e}};Ma=W([be],Ma);let Oa=class $V extends Xc{constructor(e,i,n,s,r,o){super(i,n,s,r,o);this.functionName=e}};Oa=W([be],Oa);let Xg=class HV extends Xc{constructor(e,i,n,s,r,o,a,l){super(s,r,o,a,l);if(!i){throw Ge("dataId")}this.label=e;this.dataId=i;this.canPersist=n}};Xg=W([be],Xg);let Zg=class BV{constructor(e,i,n){this.command=e;this.args=i||[];this.options=n}};Zg=W([be],Zg);let mh=class WV{constructor(e,i){this.port=e;this.host=i}};mh=W([be],mh);let em=class VV{constructor(e){this.path=e}};em=W([be],em);let _h=class zV{constructor(e){this.implementation=e}};_h=W([be],_h);class iA{constructor(e,i,n){this.session=e;this.threadId=i;this.frameId=n}}class nA{constructor(e,i){this.session=e;this.threadId=i}}let tm=class qV{constructor(e,i){this.range=e;this.expression=i}};tm=W([be],tm);var vh;(function(t){t[t["Invoke"]=0]="Invoke";t[t["Automatic"]=1]="Automatic"})(vh||(vh={}));var kr;(function(t){t[t["Other"]=0]="Other";t[t["Empty"]=1]="Empty";t[t["TokenCancellation"]=2]="TokenCancellation";t[t["LostRace"]=3]="LostRace";t[t["NotTaken"]=4]="NotTaken"})(kr||(kr={}));let im=class jV{constructor(e,i){this.range=e;this.text=i}};im=W([be],im);let nm=class GV{constructor(e,i,n=true){this.range=e;this.variableName=i;this.caseSensitiveLookup=n}};nm=W([be],nm);let sm=class KV{constructor(e,i){this.range=e;this.expression=i}};sm=W([be],sm);let nb=class QV{constructor(e,i){this.frameId=e;this.stoppedLocation=i}};nb=W([be],nb);var sb;(function(t){t[t["AIGenerated"]=1]="AIGenerated"})(sb||(sb={}));var wh;(function(t){t[t["Invoke"]=0]="Invoke";t[t["Automatic"]=1]="Automatic"})(wh||(wh={}));class CM{constructor(e,i){this.newSymbolName=e;this.tags=i}}var Sc;(function(t){t[t["Changed"]=1]="Changed";t[t["Created"]=2]="Created";t[t["Deleted"]=3]="Deleted"})(Sc||(Sc={}));let fi=un=class JV extends Error{static FileExists(e){return new un(e,Oe.FileExists,un.FileExists)}static FileNotFound(e){return new un(e,Oe.FileNotFound,un.FileNotFound)}static FileNotADirectory(e){return new un(e,Oe.FileNotADirectory,un.FileNotADirectory)}static FileIsADirectory(e){return new un(e,Oe.FileIsADirectory,un.FileIsADirectory)}static NoPermissions(e){return new un(e,Oe.NoPermissions,un.NoPermissions)}static Unavailable(e){return new un(e,Oe.Unavailable,un.Unavailable)}constructor(e,i=Oe.Unknown,n){super(b.isUri(e)?e.toString(true):e);this.code=n?.name??"Unknown";R4(this,i);Object.setPrototypeOf(this,un.prototype);if(typeof Error.captureStackTrace==="function"&&typeof n==="function"){Error.captureStackTrace(this,n)}}};fi=un=W([be],fi);let rb=class YV{constructor(e,i,n){this.start=e;this.end=i;this.kind=n}};rb=W([be],rb);var Dr;(function(t){t[t["Comment"]=1]="Comment";t[t["Imports"]=2]="Imports";t[t["Region"]=3]="Region"})(Dr||(Dr={}));var bh;(function(t){t[t["Collapsed"]=0]="Collapsed";t[t["Expanded"]=1]="Expanded"})(bh||(bh={}));var ob;(function(t){t[t["Editing"]=0]="Editing";t[t["Preview"]=1]="Preview"})(ob||(ob={}));var ab;(function(t){t[t["Published"]=0]="Published";t[t["Draft"]=1]="Draft"})(ab||(ab={}));var yh;(function(t){t[t["Unresolved"]=0]="Unresolved";t[t["Resolved"]=1]="Resolved"})(yh||(yh={}));var Sh;(function(t){t[t["Current"]=0]="Current";t[t["Outdated"]=1]="Outdated"})(Sh||(Sh={}));var xh;(function(t){t[t["Reply"]=1]="Reply";t[t["Comment"]=2]="Comment"})(xh||(xh={}));class lb{constructor(e,i=[]){this.tokenTypes=e;this.tokenModifiers=i}}function kM(t){return typeof t==="undefined"||eR(t)}class nx{constructor(e){this._prevLine=0;this._prevChar=0;this._dataIsSortedAndDeltaEncoded=true;this._data=[];this._dataLen=0;this._tokenTypeStrToInt=new Map;this._tokenModifierStrToInt=new Map;this._hasLegend=false;if(e){this._hasLegend=true;for(let i=0,n=e.tokenTypes.length;i<n;i++){this._tokenTypeStrToInt.set(e.tokenTypes[i],i)}for(let i=0,n=e.tokenModifiers.length;i<n;i++){this._tokenModifierStrToInt.set(e.tokenModifiers[i],i)}}}push(e,i,n,s,r){if(typeof e==="number"&&typeof i==="number"&&typeof n==="number"&&typeof s==="number"&&(typeof r==="number"||typeof r==="undefined")){if(typeof r==="undefined"){r=0}return this._pushEncoded(e,i,n,s,r)}if(Fe.isRange(e)&&typeof i==="string"&&kM(n)){return this._push(e,i,n)}throw Ge()}_push(e,i,n){if(!this._hasLegend){throw new Error("Legend must be provided in constructor")}if(e.start.line!==e.end.line){throw new Error("`range` cannot span multiple lines")}if(!this._tokenTypeStrToInt.has(i)){throw new Error("`tokenType` is not in the provided legend")}const s=e.start.line;const r=e.start.character;const o=e.end.character-e.start.character;const a=this._tokenTypeStrToInt.get(i);let l=0;if(n){for(const c of n){if(!this._tokenModifierStrToInt.has(c)){throw new Error("`tokenModifier` is not in the provided legend")}const u=this._tokenModifierStrToInt.get(c);l|=1<<u>>>0}}this._pushEncoded(s,r,o,a,l)}_pushEncoded(e,i,n,s,r){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&i<this._prevChar)){this._dataIsSortedAndDeltaEncoded=false;const l=this._data.length/5|0;let c=0;let u=0;for(let d=0;d<l;d++){let f=this._data[5*d];let p=this._data[5*d+1];if(f===0){f=c;p+=u}else{f+=c}this._data[5*d]=f;this._data[5*d+1]=p;c=f;u=p}}let o=e;let a=i;if(this._dataIsSortedAndDeltaEncoded&&this._dataLen>0){o-=this._prevLine;if(o===0){a-=this._prevChar}}this._data[this._dataLen++]=o;this._data[this._dataLen++]=a;this._data[this._dataLen++]=n;this._data[this._dataLen++]=s;this._data[this._dataLen++]=r;this._prevLine=e;this._prevChar=i}static _sortAndDeltaEncode(e){const i=[];const n=e.length/5|0;for(let a=0;a<n;a++){i[a]=a}i.sort((a,l)=>{const c=e[5*a];const u=e[5*l];if(c===u){const d=e[5*a+1];const f=e[5*l+1];return d-f}return c-u});const s=new Uint32Array(e.length);let r=0;let o=0;for(let a=0;a<n;a++){const l=5*i[a];const c=e[l+0];const u=e[l+1];const d=e[l+2];const f=e[l+3];const p=e[l+4];const m=c-r;const v=m===0?u-o:u;const y=5*a;s[y+0]=m;s[y+1]=v;s[y+2]=d;s[y+3]=f;s[y+4]=p;r=c;o=u}return s}build(e){if(!this._dataIsSortedAndDeltaEncoded){return new Zc(nx._sortAndDeltaEncode(this._data),e)}return new Zc(new Uint32Array(this._data),e)}}class Zc{constructor(e,i){this.resultId=i;this.data=e}}class sA{constructor(e,i,n){this.start=e;this.deleteCount=i;this.data=n}}class _p{constructor(e,i){this.resultId=i;this.edits=e}}var rm;(function(t){t[t["Separate"]=0]="Separate";t[t["MergeWithParent"]=1]="MergeWithParent"})(rm||(rm={}));class DM{constructor(e){this.name=e}}var cb;(function(t){t[t["Title"]=1]="Title";t[t["Inline"]=2]="Inline";t[t["Input"]=3]="Input"})(cb||(cb={}));let Eh=class XV{static{this.Back={iconPath:new _n("arrow-left")}}constructor(){}};Eh=W([be],Eh);var Ch;(function(t){t[t["Separator"]=-1]="Separator";t[t["Default"]=0]="Default"})(Ch||(Ch={}));var xc;(function(t){t[t["Info"]=1]="Info";t[t["Warning"]=2]="Warning";t[t["Error"]=3]="Error"})(xc||(xc={}));var Ja;(function(t){t[t["UI"]=1]="UI";t[t["Workspace"]=2]="Workspace"})(Ja||(Ja={}));class ub{static validate(e){if(typeof e.badge==="string"){let i=IE(e.badge,0);if(i<e.badge.length){i+=IE(e.badge,i)}if(e.badge.length>i){throw new Error(`The 'badge'-property must be undefined or a short character`)}}else if(e.badge){if(!_n.isThemeIcon(e.badge)){throw new Error(`The 'badge'-property is not a valid ThemeIcon`)}}if(!e.color&&!e.badge&&!e.tooltip){throw new Error(`The decoration is empty`)}return true}constructor(e,i,n){this.badge=e;this.tooltip=i;this.color=n}}let om=class ZV{constructor(e){this.kind=e}};om=W([be],om);var yo;(function(t){t[t["Light"]=1]="Light";t[t["Dark"]=2]="Dark";t[t["HighContrast"]=3]="HighContrast";t[t["HighContrastLight"]=4]="HighContrastLight"})(yo||(yo={}));class IM{constructor(e,i,n){this.label=e;this.uri=i;this.position=n}}var db;(function(t){t[t["Idle"]=1]="Idle";t[t["Pending"]=2]="Pending";t[t["Executing"]=3]="Executing"})(db||(db={}));var am;(function(t){t[t["Left"]=1]="Left";t[t["Right"]=2]="Right"})(am||(am={}));var lm;(function(t){t[t["Default"]=0]="Default";t[t["InCenter"]=1]="InCenter";t[t["InCenterIfOutsideViewport"]=2]="InCenterIfOutsideViewport";t[t["AtTop"]=3]="AtTop"})(lm||(lm={}));class TM{constructor(e,i){this.text=e;this.alignment=i}}var hb;(function(t){t[t["Default"]=1]="Default";t[t["Preferred"]=2]="Preferred"})(hb||(hb={}));var cm;(function(t){t[t["Default"]=1]="Default";t[t["Preferred"]=2]="Preferred";t[t["Hidden"]=-1]="Hidden"})(cm||(cm={}));let rA=class ez{constructor(e,i=[]){this.uri=e;this.provides=Zn(i)}};let PM=class tz{constructor(e){this.label=e}};var kh;(function(t){t[t["Named"]=1]="Named";t[t["Indexed"]=2]="Indexed"})(kh||(kh={}));let fb=class iz{constructor(e,i){this.label=e;this.timestamp=i}};fb=W([be],fb);var Ec;(function(t){t[t["Production"]=1]="Production";t[t["Development"]=2]="Development";t[t["Test"]=3]="Test"})(Ec||(Ec={}));var um;(function(t){t[t["Node"]=1]="Node";t[t["Webworker"]=2]="Webworker"})(um||(um={}));var ko;(function(t){t[t["Other"]=0]="Other";t[t["Comment"]=1]="Comment";t[t["String"]=2]="String";t[t["RegEx"]=3]="RegEx"})(ko||(ko={}));class AM{constructor(e,i){this.ranges=e;this.wordPattern=i}}class RM{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}}var pb;(function(t){t[t["Queued"]=1]="Queued";t[t["Running"]=2]="Running";t[t["Passed"]=3]="Passed";t[t["Failed"]=4]="Failed";t[t["Skipped"]=5]="Skipped";t[t["Errored"]=6]="Errored"})(pb||(pb={}));var Cc;(function(t){t[t["Run"]=1]="Run";t[t["Debug"]=2]="Debug";t[t["Coverage"]=3]="Coverage"})(Cc||(Cc={}));class oA{constructor(e,i,n){this.controllerId=e;this.profileId=i;this.kind=n}}let dm=class nz{constructor(e=void 0,i=void 0,n=void 0,s=false,r=true){this.include=e;this.exclude=i;this.profile=n;this.continuous=s;this.preserveFocus=r}};dm=W([be],dm);let hm=Ow=class sz{static diff(e,i,n){const s=new Ow(e);s.expectedOutput=i;s.actualOutput=n;return s}constructor(e){this.message=e}};hm=Ow=W([be],hm);let Dh=class rz{constructor(e){this.id=e}};Dh=W([be],Dh);class LM{constructor(e,i,n){this.label=e;this.uri=i;this.position=n}}class vp{constructor(e,i){this.covered=e;this.total=i;wp(this)}}function wp(t){if(!t){return}if(t.covered>t.total){throw new Error(`The total number of covered items (${t.covered}) cannot be greater than the total (${t.total})`)}if(t.total<0){throw new Error(`The number of covered items (${t.total}) cannot be negative`)}}class eu{static fromDetails(e,i){const n=new vp(0,0);const s=new vp(0,0);const r=new vp(0,0);for(const a of i){if("branches"in a){n.total+=1;n.covered+=a.executed?1:0;for(const l of a.branches){s.total+=1;s.covered+=l.executed?1:0}}else{r.total+=1;r.covered+=a.executed?1:0}}const o=new eu(e,n,s.total>0?s:void 0,r.total>0?r:void 0);o.detailedCoverage=i;return o}constructor(e,i,n,s,r=[]){this.uri=e;this.statementCoverage=i;this.branchCoverage=n;this.declarationCoverage=s;this.includesTests=r}}class aA{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,i,n=[]){this.executed=e;this.location=i;this.branches=n}}class lA{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,i,n){this.executed=e;this.location=i;this.label=n}}class cA{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,i,n){this.name=e;this.executed=i;this.location=n}}var gb;(function(t){t[t["None"]=0]="None";t[t["Option"]=1]="Option";t[t["Default"]=2]="Default";t[t["Preferred"]=3]="Preferred"})(gb||(gb={}));var mb;(function(t){t[t["Untrusted"]=0]="Untrusted";t[t["Trusted"]=1]="Trusted";t[t["Unspecified"]=2]="Unspecified"})(mb||(mb={}));var _b;(function(t){t[t["Notify"]=1]="Notify";t[t["OpenBrowser"]=2]="OpenBrowser";t[t["OpenPreview"]=3]="OpenPreview";t[t["Silent"]=4]="Silent";t[t["Ignore"]=5]="Ignore";t[t["OpenBrowserOnce"]=6]="OpenBrowserOnce"})(_b||(_b={}));let sx=class oz{constructor(e,i,n,s,r,o){this.kind=e;this.name=i;this.detail=n;this.uri=s;this.range=r;this.selectionRange=o}};class rx{constructor(e){this.uri=e}}class fm{constructor(e,i){this.original=e;this.modified=i}}class uA{constructor(e,i,n,s){this.base=e;this.input1=i;this.input2=n;this.result=s}}class ox{constructor(e,i){this.uri=e;this.viewType=i}}class dA{constructor(e){this.viewType=e}}class ax{constructor(e,i){this.uri=e;this.notebookType=i}}class lx{constructor(e,i,n){this.original=e;this.modified=i;this.notebookType=n}}class hA{constructor(){}}class fA{constructor(e,i){this.uri=e;this.inputBoxUri=i}}class pA{constructor(){}}class gA{constructor(e){this.textDiffs=e}}var vb;(function(t){t[t["Down"]=0]="Down";t[t["Up"]=1]="Up"})(vb||(vb={}));var wb;(function(t){t[t["Action"]=1]="Action";t[t["Toolbar"]=2]="Toolbar"})(wb||(wb={}));var bb;(function(t){t[t["Short"]=1]="Short";t[t["Medium"]=2]="Medium";t[t["Full"]=3]="Full"})(bb||(bb={}));class NM{constructor(e,i,n){this.id=e;this.label=i;this.values=n}}var js;(function(t){t[t["Accepted"]=1]="Accepted";t[t["Rejected"]=2]="Rejected";t[t["Saved"]=3]="Saved"})(js||(js={}));var yb;(function(t){t[t["Keep"]=1]="Keep";t[t["Undo"]=2]="Undo";t[t["UserModification"]=3]="UserModification"})(yb||(yb={}));var Sb;(function(t){t[t["Unhelpful"]=0]="Unhelpful";t[t["Helpful"]=1]="Helpful";t[t["Undone"]=2]="Undone";t[t["Accepted"]=3]="Accepted";t[t["Bug"]=4]="Bug"})(Sb||(Sb={}));var Ih;(function(t){t[t["Unhelpful"]=0]="Unhelpful";t[t["Helpful"]=1]="Helpful"})(Ih||(Ih={}));let V_=class az{constructor(e){if(typeof e!=="string"&&e.isTrusted===true){throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.")}this.value=typeof e==="string"?new rn(e):e}};let Th=class lz{constructor(e,i){if(typeof e!=="string"&&e.isTrusted===true){throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.")}this.value=typeof e==="string"?new rn(e):e;this.vulnerabilities=i}};let pm=class cz{constructor(e,i,n,s){this.title=e;this.message=i;this.data=n;this.buttons=s}};class z_{constructor(e,i){this.value=e;this.baseUri=i}}let cx=class uz{constructor(e,i,n){this.value=e;this.title=i;this.readOnly=n}};class MM{constructor(e,i){this.data=e;this.mimeType=i}}class xb{constructor(e,i){this.uris=e;this.callback=i;this.applied=new Promise(n=>{this.didGetApplied=n})}}let Ph=class dz{constructor(e,i){this.value=e;this.value2=e;this.title=i}};let ux=class hz{constructor(e){this.value=e}};class bp{constructor(e,i){this.value=e;this.task=i}}let kc=class fz{constructor(e,i,n){this.value=e;this.id=i;this.metadata=n}};let q_=class pz{constructor(e,i,n,s){this.hookType=e;this.stopReason=i;this.systemMessage=n;this.metadata=s}};let Ah=class gz{constructor(e){if(typeof e!=="string"&&e.isTrusted===true){throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.")}this.value=typeof e==="string"?new rn(e):e}};let j_=class mz{constructor(e){this.value=e}};let Ya=class _z{constructor(e,i,n){this.value=e;this.iconPath=i;this.options=n}};let G_=class vz{constructor(e,i,n){this.value=e;this.isEdit=i;this.undoStopId=n}};let gm=class wz{constructor(e,i,n){this.value=e;this.license=i;this.snippet=n}};let K_=class bz{constructor(e,i){this.uri=e;this.range=i}};let dx=class yz{constructor(e){this.extensions=e}};let hx=class Sz{constructor(e,i,n,s,r){this.uri=e;this.title=i;this.description=n;this.author=s;this.linkTag=r}toJSON(){return{$mid:nt.ChatResponsePullRequestPart,uri:this.uri,title:this.title,description:this.description,author:this.author}}};var Gs;(function(t){t[t["Text"]=1]="Text";t[t["SingleSelect"]=2]="SingleSelect";t[t["MultiSelect"]=3]="MultiSelect"})(Gs||(Gs={}));class mA{constructor(e,i,n,s){this.id=e;this.type=i;this.title=n;this.message=s?.message;this.options=s?.options;this.defaultValue=s?.defaultValue;this.allowFreeformInput=s?.allowFreeformInput}}let Rh=class xz{constructor(e,i=true){this.questions=e;this.allowSkip=i}};let Lh=class Ez{constructor(e,i){this.uri=e;if(i===true){this.isDone=true;this.edits=[]}else{this.edits=Array.isArray(i)?i:[i]}}};let mm=class Cz{constructor(e,i){this.uri=e;if(i===true){this.isDone=true;this.edits=[]}else{this.edits=Array.isArray(i)?i:[i]}}};let fx=class kz{constructor(e){this.edits=e}};let px=class Dz{constructor(e,i,n){this.toolName=e;this.toolCallId=i;this.isError=n}};class _m{constructor(e,i,n,s,r,o,a){this.prompt=e;this.command=i;this.references=n;this.participant=s;this.toolReferences=r;this.editedFileEvents=o;this.id=a}}class _A{constructor(e,i,n,s){this.response=e;this.result=i;this.participant=n;this.command=s}}class OM{constructor(e,i,n,s){this.response=e;this.result=i;this.participant=n;this.command=s}}var ps;(function(t){t[t["Panel"]=1]="Panel";t[t["Terminal"]=2]="Terminal";t[t["Notebook"]=3]="Notebook";t[t["Editor"]=4]="Editor"})(ps||(ps={}));var Eb;(function(t){t[t["Failed"]=0]="Failed";t[t["Completed"]=1]="Completed";t[t["InProgress"]=2]="InProgress"})(Eb||(Eb={}));class FM{constructor(e,i,n,s){this.modifiedUri=e;this.insertions=i;this.deletions=n;this.originalUri=s}}class UM{constructor(e,i,n,s,r){this.uri=e;this.originalUri=i;this.modifiedUri=n;this.insertions=s;this.deletions=r}}var Cb;(function(t){t[t["Complete"]=1]="Complete";t[t["Partial"]=2]="Partial";t[t["Omitted"]=3]="Omitted"})(Cb||(Cb={}));var kb;(function(t){t[t["NoReason"]=0]="NoReason";t[t["FilteredContentRetry"]=1]="FilteredContentRetry";t[t["CopyrightContentRetry"]=2]="CopyrightContentRetry"})(kb||(kb={}));class vA{constructor(e,i,n,s){this.editor=e;this.document=i;this.selection=n;this.wholeRange=s}}class wA{constructor(e){this.cell=e}}class bA{constructor(e,i,n){this.mimeType=e;this.data=i;this.reference=n}}class gx{constructor(e){this.diagnostics=e}}var Dn;(function(t){t[t["User"]=1]="User";t[t["Assistant"]=2]="Assistant";t[t["System"]=3]="System"})(Dn||(Dn={}));class tu{constructor(e,i,n){this.callId=e;this.content=i;this.isError=n??false}}var Db;(function(t){t[t["Info"]=0]="Info";t[t["Warning"]=1]="Warning";t[t["Error"]=2]="Error"})(Db||(Db={}));let yA=class Ib{static User(e,i){return new Ib(Dn.User,e,i)}static Assistant(e,i){return new Ib(Dn.Assistant,e,i)}set content(e){if(typeof e==="string"){this._content=[new ci(e)]}else{this._content=e}}get content(){return this._content}constructor(e,i,n){this._content=[];this.role=e;this.content=i;this.name=n}};let SA=class Tb{static User(e,i){return new Tb(Dn.User,e,i)}static Assistant(e,i){return new Tb(Dn.Assistant,e,i)}set content(e){if(typeof e==="string"){this._content=[new ci(e)]}else{this._content=e}}get content(){return this._content}set content2(e){if(e){this.content=e.map(i=>{if(typeof i==="string"){return new ci(i)}return i})}}get content2(){return this.content.map(e=>{if(e instanceof ci){return e.value}return e})}constructor(e,i,n){this._content=[];this.role=e;this.content=i;this.name=n}};class dl{constructor(e,i,n){this.callId=e;this.name=i;this.input=n}}var vm;(function(t){t[t["Assistant"]=0]="Assistant";t[t["User"]=1]="User";t[t["Extension"]=2]="Extension"})(vm||(vm={}));class ci{constructor(e,i){this.value=e}toJSON(){return{$mid:nt.LanguageModelTextPart,value:this.value,audience:this.audience}}}class xi{constructor(e,i,n){this.mimeType=i;this.data=e;this.audience=n}static image(e,i){return new xi(e,i)}static json(e,i="text/x-json"){const n=JSON.stringify(e,void 0,"	");return new xi(ae.fromString(n).buffer,i)}static text(e,i=Ps.text){return new xi(ae.fromString(e).buffer,i)}toJSON(){return{$mid:nt.LanguageModelDataPart,mimeType:this.mimeType,data:this.data,audience:this.audience}}}var Pb;(function(t){t["PNG"]="image/png";t["JPEG"]="image/jpeg";t["GIF"]="image/gif";t["WEBP"]="image/webp";t["BMP"]="image/bmp"})(Pb||(Pb={}));class iu{constructor(e,i,n){this.value=e;this.id=i;this.metadata=n}toJSON(){return{$mid:nt.LanguageModelThinkingPart,value:this.value,id:this.id,metadata:this.metadata}}}class zo{constructor(e){this.value=e}toJSON(){return{$mid:nt.LanguageModelPromptTsxPart,value:this.value}}}class Ci extends Error{static#e="LanguageModelError";static NotFound(e){return new Ci(e,Ci.NotFound.name)}static NoPermissions(e){return new Ci(e,Ci.NoPermissions.name)}static Blocked(e){return new Ci(e,Ci.Blocked.name)}static tryDeserialize(e){if(e.name!==Ci.#e){return void 0}return new Ci(e.message,e.code,e.cause)}constructor(e,i,n){super(e,{cause:n});this.name=Ci.#e;this.code=i??""}}let Q_=class Iz{constructor(e){this.content=e}toJSON(){return{$mid:nt.LanguageModelToolResult,content:this.content}}};class $M{constructor(e){this.content=e}toJSON(){return{$mid:nt.LanguageModelToolResult,content:this.content}}}class HM extends Q_{}var wm;(function(t){t[t["Auto"]=1]="Auto";t[t["Required"]=2]="Required"})(wm||(wm={}));class xA{constructor(e,i){this.id=e;this.label=i}}class EA{constructor(e,i,n){this.label=e;this.name=i;this.instructions=n}}var Ab;(function(t){t[t["SymbolInformation"]=1]="SymbolInformation";t[t["CommandInformation"]=2]="CommandInformation";t[t["SearchInformation"]=3]="SearchInformation";t[t["SettingInformation"]=4]="SettingInformation"})(Ab||(Ab={}));var Rb;(function(t){t[t["EMBEDDED"]=1]="EMBEDDED";t[t["LLM_RANKED"]=2]="LLM_RANKED";t[t["CANCELED"]=3]="CANCELED"})(Rb||(Rb={}));var Lb;(function(t){t[t["Started"]=1]="Started";t[t["Recognizing"]=2]="Recognizing";t[t["Recognized"]=3]="Recognized";t[t["Stopped"]=4]="Stopped";t[t["Error"]=5]="Error"})(Lb||(Lb={}));var Nb;(function(t){t[t["Started"]=1]="Started";t[t["Stopped"]=2]="Stopped";t[t["Error"]=3]="Error"})(Nb||(Nb={}));var Mb;(function(t){t[t["Recognized"]=1]="Recognized";t[t["Stopped"]=2]="Stopped"})(Mb||(Mb={}));var bm;(function(t){t[t["Initial"]=0]="Initial";t[t["Dynamic"]=1]="Dynamic"})(bm||(bm={}));class Ob{constructor(e,i,n,s={},r,o){this.label=e;this.command=i;this.args=n;this.env=s;this.version=r;this.metadata=o}}class Fb{constructor(e,i,n={},s,r,o){this.label=e;this.uri=i;this.headers=n;this.version=s;this.metadata=r;this.authentication=o}}var Ms;(function(t){function e(n){const{selectionStartLineNumber:s,selectionStartColumn:r,positionLineNumber:o,positionColumn:a}=n;const l=new je(s-1,r-1);const c=new je(o-1,a-1);return new or(l,c)}t.to=e;function i(n){const{anchor:s,active:r}=n;return{selectionStartLineNumber:s.line+1,selectionStartColumn:s.character+1,positionLineNumber:r.line+1,positionColumn:r.character+1}}t.from=i})(Ms||(Ms={}));var V;(function(t){function e(n){if(!n){return void 0}const{start:s,end:r}=n;return{startLineNumber:s.line+1,startColumn:s.character+1,endLineNumber:r.line+1,endColumn:r.character+1}}t.from=e;function i(n){if(!n){return void 0}const{startLineNumber:s,startColumn:r,endLineNumber:o,endColumn:a}=n;return new Fe(s-1,r-1,o-1,a-1)}t.to=i})(V||(V={}));var Rs;(function(t){function e(n){return{uri:n.uri,range:V.from(n.range)}}t.from=e;function i(n){return new Tn(b.revive(n.uri),V.to(n.range))}t.to=i})(Rs||(Rs={}));var Ub;(function(t){function e(i){switch(i){case jl.Comment:return ko.Comment;case jl.Other:return ko.Other;case jl.RegEx:return ko.RegEx;case jl.String:return ko.String}}t.to=e})(Ub||(Ub={}));var ut;(function(t){function e(n){return new je(n.lineNumber-1,n.column-1)}t.to=e;function i(n){return{lineNumber:n.line+1,column:n.character+1}}t.from=i})(ut||(ut={}));var hl;(function(t){function e(s,r,o){return zt(Zn(s).map(a=>i(a,r,o)))}t.from=e;function i(s,r,o){if(typeof s==="string"){return{$serialized:true,language:s,isBuiltin:o?.isBuiltin}}if(s){return{$serialized:true,language:s.language,scheme:n(s.scheme,r),pattern:gn.from(s.pattern)??void 0,exclusive:s.exclusive,notebookType:s.notebookType,isBuiltin:o?.isBuiltin}}return void 0}function n(s,r){if(r&&typeof s==="string"){return r.transformOutgoingScheme(s)}return s}})(hl||(hl={}));var ym;(function(t){function e(n){switch(n){case Aa.Unnecessary:return Jl.Unnecessary;case Aa.Deprecated:return Jl.Deprecated}return void 0}t.from=e;function i(n){switch(n){case Jl.Unnecessary:return Aa.Unnecessary;case Jl.Deprecated:return Aa.Deprecated;default:return void 0}}t.to=i})(ym||(ym={}));var fl;(function(t){function e(n){let s;if(n.code){if(Xe(n.code)||$a(n.code)){s=String(n.code)}else{s={value:String(n.code.value),target:n.code.target}}}return{...V.from(n.range),message:n.message,source:n.source,code:s,severity:Nh.from(n.severity),relatedInformation:n.relatedInformation&&n.relatedInformation.map(Sm.from),tags:Array.isArray(n.tags)?zt(n.tags.map(ym.from)):void 0}}t.from=e;function i(n){const s=new Lg(V.to(n),n.message,Nh.to(n.severity));s.source=n.source;s.code=Xe(n.code)?n.code:n.code?.value;s.relatedInformation=n.relatedInformation&&n.relatedInformation.map(Sm.to);s.tags=n.tags&&zt(n.tags.map(ym.to));return s}t.to=i})(fl||(fl={}));var Sm;(function(t){function e(n){return{...V.from(n.location.range),message:n.message,resource:n.location.uri}}t.from=e;function i(n){return new ih(new Tn(n.resource,V.to(n)),n.message)}t.to=i})(Sm||(Sm={}));var Nh;(function(t){function e(n){switch(n){case Oi.Error:return fn.Error;case Oi.Warning:return fn.Warning;case Oi.Information:return fn.Info;case Oi.Hint:return fn.Hint}return fn.Error}t.from=e;function i(n){switch(n){case fn.Info:return Oi.Information;case fn.Warning:return Oi.Warning;case fn.Error:return Oi.Error;case fn.Hint:return Oi.Hint;default:return Oi.Error}}t.to=i})(Nh||(Nh={}));var _i;(function(t){function e(n){if(typeof n==="number"&&n>=dh.One){return n-1}if(n===dh.Beside){return GN}return jN}t.from=e;function i(n){if(typeof n==="number"&&n>=0){return n+1}throw new Error(`invalid 'EditorGroupColumn'`)}t.to=i})(_i||(_i={}));function BM(t){return typeof t.range!=="undefined"}function CA(t){if(t.length===0){return true}return BM(t[0])?true:false}var we;(function(t){function e(a){return a.map(t.from)}t.fromMany=e;function i(a){return a&&typeof a==="object"&&typeof a.language==="string"&&typeof a.value==="string"}function n(a){let l;if(i(a)){const{language:d,value:f}=a;l={value:"```"+d+"\n"+f+"\n```\n"}}else if(rn.isMarkdownString(a)){l={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,supportAlertSyntax:a.supportAlertSyntax,baseUri:a.baseUri}}else if(typeof a==="string"){l={value:a}}else{l={value:""}}const c=Object.create(null);l.uris=c;const u=({href:d})=>{try{let f=b.parse(d,true);f=f.with({query:s(f.query,c)});c[d]=f}catch(f){}return""};Rt.walkTokens(Rt.lexer(l.value),d=>{if(d.type==="link"){u({href:d.href})}else if(d.type==="image"){if(typeof d.href==="string"){u(s7(d.href))}}});return l}t.from=n;function s(a,l){if(!a){return a}let c;try{c=X4(a)}catch(d){}if(!c){return a}let u=false;c=$c(c,d=>{if(b.isUri(d)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;l[f]=d;u=true;return f}else{return void 0}});if(!u){return a}return JSON.stringify(c)}function r(a){const l=new rn(a.value,a.supportThemeIcons);l.isTrusted=a.isTrusted;l.supportHtml=a.supportHtml;l.supportAlertSyntax=a.supportAlertSyntax;l.baseUri=a.baseUri?b.from(a.baseUri):void 0;return l}t.to=r;function o(a){if(!a){return void 0}return typeof a==="string"?a:t.from(a)}t.fromStrict=o})(we||(we={}));function WM(t){if(CA(t)){return t.map(e=>{return{range:V.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?we.fromMany(e.hoverMessage):e.hoverMessage?we.from(e.hoverMessage):void 0,renderOptions:e.renderOptions}})}else{return t.map(e=>{return{range:V.from(e)}})}}function J_(t){if(typeof t==="undefined"){return t}if(typeof t==="string"){return b.file(t)}else{return t}}var nu;(function(t){function e(i){if(typeof i==="undefined"){return i}return{contentText:i.contentText,contentIconPath:i.contentIconPath?J_(i.contentIconPath):void 0,border:i.border,borderColor:i.borderColor,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,color:i.color,backgroundColor:i.backgroundColor,margin:i.margin,width:i.width,height:i.height}}t.from=e})(nu||(nu={}));var xm;(function(t){function e(i){if(typeof i==="undefined"){return i}return{backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?J_(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?nu.from(i.before):void 0,after:i.after?nu.from(i.after):void 0}}t.from=e})(xm||(xm={}));var $b;(function(t){function e(i){if(typeof i==="undefined"){return i}switch(i){case Na.OpenOpen:return Ql.AlwaysGrowsWhenTypingAtEdges;case Na.ClosedClosed:return Ql.NeverGrowsWhenTypingAtEdges;case Na.OpenClosed:return Ql.GrowsOnlyWhenTypingBefore;case Na.ClosedOpen:return Ql.GrowsOnlyWhenTypingAfter}}t.from=e})($b||($b={}));var Hb;(function(t){function e(i){return{isWholeLine:i.isWholeLine,rangeBehavior:i.rangeBehavior?$b.from(i.rangeBehavior):void 0,overviewRulerLane:i.overviewRulerLane,light:i.light?xm.from(i.light):void 0,dark:i.dark?xm.from(i.dark):void 0,backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?J_(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?nu.from(i.before):void 0,after:i.after?nu.from(i.after):void 0}}t.from=e})(Hb||(Hb={}));var vi;(function(t){function e(n){return{text:n.newText,eol:n.newEol&&ou.from(n.newEol),range:V.from(n.range)}}t.from=e;function i(n){const s=new Wo(V.to(n.range),n.text);s.newEol=typeof n.eol==="undefined"?void 0:ou.to(n.eol);return s}t.to=i})(vi||(vi={}));var Pn;(function(t){function e(n,s){const r={edits:[]};if(n instanceof cl){const o=new ad;for(const a of n._allEntries()){if(a._type===Xt.File&&b.isUri(a.to)&&a.from===void 0){o.add(a.to)}}for(const a of n._allEntries()){if(a._type===Xt.File){let l;if(a.options?.contents){if(ArrayBuffer.isView(a.options.contents)){l={type:"base64",value:vl(ae.wrap(a.options.contents))}}else{l={type:"dataTransferItem",id:a.options.contents._itemId}}}r.edits.push({oldResource:a.from,newResource:a.to,options:{...a.options,contents:l},metadata:a.metadata})}else if(a._type===Xt.Text){r.edits.push({resource:a.uri,textEdit:vi.from(a.edit),versionId:!o.has(a.uri)?s?.getTextDocumentVersion(a.uri):void 0,metadata:a.metadata})}else if(a._type===Xt.Snippet){r.edits.push({resource:a.uri,textEdit:{range:V.from(a.range),text:a.edit.value,insertAsSnippet:true,keepWhitespace:a.keepWhitespace},versionId:!o.has(a.uri)?s?.getTextDocumentVersion(a.uri):void 0,metadata:a.metadata})}else if(a._type===Xt.Cell){r.edits.push({metadata:a.metadata,resource:a.uri,cellEdit:a.edit,notebookVersionId:s?.getNotebookDocumentVersion(a.uri)})}else if(a._type===Xt.CellReplace){r.edits.push({metadata:a.metadata,resource:a.uri,notebookVersionId:s?.getNotebookDocumentVersion(a.uri),cellEdit:{editType:Lo.Replace,index:a.index,count:a.count,cells:a.cells.map(lu.from)}})}}}return r}t.from=e;function i(n){const s=new cl;const r=new It;for(const o of n.edits){if(o.textEdit){const a=o;const l=b.revive(a.resource);const c=V.to(a.textEdit.range);const u=a.textEdit.text;const d=a.textEdit.insertAsSnippet;let f;if(d){f=Ka.replace(c,new ll(u))}else{f=Wo.replace(c,u)}const p=r.get(l);if(!p){r.set(l,[f])}else{p.push(f)}}else{s.renameFile(b.revive(o.oldResource),b.revive(o.newResource),o.options)}}for(const[o,a]of r){s.set(o,a)}return s}t.to=i})(Pn||(Pn={}));var es;(function(t){const e=Object.create(null);e[Dt.File]=G.File;e[Dt.Module]=G.Module;e[Dt.Namespace]=G.Namespace;e[Dt.Package]=G.Package;e[Dt.Class]=G.Class;e[Dt.Method]=G.Method;e[Dt.Property]=G.Property;e[Dt.Field]=G.Field;e[Dt.Constructor]=G.Constructor;e[Dt.Enum]=G.Enum;e[Dt.Interface]=G.Interface;e[Dt.Function]=G.Function;e[Dt.Variable]=G.Variable;e[Dt.Constant]=G.Constant;e[Dt.String]=G.String;e[Dt.Number]=G.Number;e[Dt.Boolean]=G.Boolean;e[Dt.Array]=G.Array;e[Dt.Object]=G.Object;e[Dt.Key]=G.Key;e[Dt.Null]=G.Null;e[Dt.EnumMember]=G.EnumMember;e[Dt.Struct]=G.Struct;e[Dt.Event]=G.Event;e[Dt.Operator]=G.Operator;e[Dt.TypeParameter]=G.TypeParameter;function i(s){return typeof e[s]==="number"?e[s]:G.Property}t.from=i;function n(s){for(const r in e){if(e[r]===s){return Number(r)}}return Dt.Property}t.to=n})(es||(es={}));var qr;(function(t){function e(n){switch(n){case nh.Deprecated:return ng.Deprecated}}t.from=e;function i(n){switch(n){case ng.Deprecated:return nh.Deprecated}}t.to=i})(qr||(qr={}));var pl;(function(t){function e(n){return{name:n.name,kind:es.from(n.kind),tags:n.tags&&n.tags.map(qr.from),containerName:n.containerName,location:wn.from(n.location)}}t.from=e;function i(n){const s=new sh(n.name,es.to(n.kind),n.containerName,wn.to(n.location));s.tags=n.tags&&n.tags.map(qr.to);return s}t.to=i})(pl||(pl={}));var Bb;(function(t){function e(n){const s={name:n.name||"!!MISSING: name!!",detail:n.detail,range:V.from(n.range),selectionRange:V.from(n.selectionRange),kind:es.from(n.kind),tags:n.tags?.map(qr.from)??[]};if(n.children){s.children=n.children.map(e)}return s}t.from=e;function i(n){const s=new oh(n.name,n.detail,es.to(n.kind),V.to(n.range),V.to(n.selectionRange));if(rf(n.tags)){s.tags=n.tags.map(qr.to)}if(n.children){s.children=n.children.map(i)}return s}t.to=i})(Bb||(Bb={}));var gl;(function(t){function e(n){const s=new tx(es.to(n.kind),n.name,n.detail||"",b.revive(n.uri),V.to(n.range),V.to(n.selectionRange));s._sessionId=n._sessionId;s._itemId=n._itemId;return s}t.to=e;function i(n,s,r){s=s??n._sessionId;r=r??n._itemId;if(s===void 0||r===void 0){throw new Error("invalid item")}return{_sessionId:s,_itemId:r,name:n.name,detail:n.detail,kind:es.from(n.kind),uri:n.uri,range:V.from(n.range),selectionRange:V.from(n.selectionRange),tags:n.tags?.map(qr.from)}}t.from=i})(gl||(gl={}));var Wb;(function(t){function e(i){return new XP(gl.to(i.from),i.fromRanges.map(n=>V.to(n)))}t.to=e})(Wb||(Wb={}));var Vb;(function(t){function e(i){return new ZP(gl.to(i.to),i.fromRanges.map(n=>V.to(n)))}t.to=e})(Vb||(Vb={}));var wn;(function(t){function e(n){return{range:n.range&&V.from(n.range),uri:n.uri}}t.from=e;function i(n){return new Tn(b.revive(n.uri),V.to(n.range))}t.to=i})(wn||(wn={}));var Mh;(function(t){function e(n){const s=n;const r=n;return{originSelectionRange:s.originSelectionRange?V.from(s.originSelectionRange):void 0,uri:s.targetUri?s.targetUri:r.uri,range:V.from(s.targetRange?s.targetRange:r.range),targetSelectionRange:s.targetSelectionRange?V.from(s.targetSelectionRange):void 0}}t.from=e;function i(n){return{targetUri:b.revive(n.uri),targetRange:V.to(n.range),targetSelectionRange:n.targetSelectionRange?V.to(n.targetSelectionRange):void 0,originSelectionRange:n.originSelectionRange?V.to(n.originSelectionRange):void 0}}t.to=i})(Mh||(Mh={}));var Oh;(function(t){function e(n){const s={range:V.from(n.range),contents:we.fromMany(n.contents),canIncreaseVerbosity:n.canIncreaseVerbosity,canDecreaseVerbosity:n.canDecreaseVerbosity};return s}t.from=e;function i(n){const s=n.contents.map(we.to);const r=V.to(n.range);const o=n.canIncreaseVerbosity;const a=n.canDecreaseVerbosity;return new Fg(s,r,o,a)}t.to=i})(Oh||(Oh={}));var zb;(function(t){function e(n){return{range:V.from(n.range),expression:n.expression}}t.from=e;function i(n){return new tm(V.to(n.range),n.expression)}t.to=i})(zb||(zb={}));var Em;(function(t){function e(n){if(n instanceof im){return{type:"text",range:V.from(n.range),text:n.text}}else if(n instanceof nm){return{type:"variable",range:V.from(n.range),variableName:n.variableName,caseSensitiveLookup:n.caseSensitiveLookup}}else if(n instanceof sm){return{type:"expression",range:V.from(n.range),expression:n.expression}}else{throw new Error(`Unknown 'InlineValue' type`)}}t.from=e;function i(n){switch(n.type){case"text":return{range:V.to(n.range),text:n.text};case"variable":return{range:V.to(n.range),variableName:n.variableName,caseSensitiveLookup:n.caseSensitiveLookup};case"expression":return{range:V.to(n.range),expression:n.expression}}}t.to=i})(Em||(Em={}));var Cm;(function(t){function e(n){return{frameId:n.frameId,stoppedLocation:V.from(n.stoppedLocation)}}t.from=e;function i(n){return new nb(n.frameId,V.to(n.stoppedLocation))}t.to=i})(Cm||(Cm={}));var su;(function(t){function e(n){return{range:V.from(n.range),kind:n.kind}}t.from=e;function i(n){return new Ug(V.to(n.range),n.kind)}t.to=i})(su||(su={}));var qb;(function(t){function e(n){return{uri:n.uri,highlights:n.highlights.map(su.from)}}t.from=e;function i(n){return new $g(b.revive(n.uri),n.highlights.map(su.to))}t.to=i})(qb||(qb={}));var jb;(function(t){function e(i){switch(i){case wd.TriggerCharacter:return pc.TriggerCharacter;case wd.TriggerForIncompleteCompletions:return pc.TriggerForIncompleteCompletions;case wd.Invoke:default:return pc.Invoke}}t.to=e})(jb||(jb={}));var Gb;(function(t){function e(i){return{triggerKind:jb.to(i.triggerKind),triggerCharacter:i.triggerCharacter}}t.to=e})(Gb||(Gb={}));var km;(function(t){function e(n){switch(n){case uh.Deprecated:return Zp.Deprecated}}t.from=e;function i(n){switch(n){case Zp.Deprecated:return uh.Deprecated}}t.to=i})(km||(km={}));var Kb;(function(t){function e(i,n,s){if("icon"in i&&"command"in i){return{command:n.toInternal(i.command,s),icon:Fr.fromThemeIcon(i.icon)}}return{command:n.toInternal(i,s)}}t.from=e})(Kb||(Kb={}));var Dm;(function(t){const e=new Map([[Te.Method,F.Method],[Te.Function,F.Function],[Te.Constructor,F.Constructor],[Te.Field,F.Field],[Te.Variable,F.Variable],[Te.Class,F.Class],[Te.Interface,F.Interface],[Te.Struct,F.Struct],[Te.Module,F.Module],[Te.Property,F.Property],[Te.Unit,F.Unit],[Te.Value,F.Value],[Te.Constant,F.Constant],[Te.Enum,F.Enum],[Te.EnumMember,F.EnumMember],[Te.Keyword,F.Keyword],[Te.Snippet,F.Snippet],[Te.Text,F.Text],[Te.Color,F.Color],[Te.File,F.File],[Te.Reference,F.Reference],[Te.Folder,F.Folder],[Te.Event,F.Event],[Te.Operator,F.Operator],[Te.TypeParameter,F.TypeParameter],[Te.Issue,F.Issue],[Te.User,F.User]]);function i(r){return e.get(r)??F.Property}t.from=i;const n=new Map([[F.Method,Te.Method],[F.Function,Te.Function],[F.Constructor,Te.Constructor],[F.Field,Te.Field],[F.Variable,Te.Variable],[F.Class,Te.Class],[F.Interface,Te.Interface],[F.Struct,Te.Struct],[F.Module,Te.Module],[F.Property,Te.Property],[F.Unit,Te.Unit],[F.Value,Te.Value],[F.Constant,Te.Constant],[F.Enum,Te.Enum],[F.EnumMember,Te.EnumMember],[F.Keyword,Te.Keyword],[F.Snippet,Te.Snippet],[F.Text,Te.Text],[F.Color,Te.Color],[F.File,Te.File],[F.Reference,Te.Reference],[F.Folder,Te.Folder],[F.Event,Te.Event],[F.Operator,Te.Operator],[F.TypeParameter,Te.TypeParameter],[F.User,Te.User],[F.Issue,Te.Issue]]);function s(r){return n.get(r)??Te.Property}t.to=s})(Dm||(Dm={}));var Qb;(function(t){function e(i,n){const s=new Vg(i.label);s.insertText=i.insertText;s.kind=Dm.to(i.kind);s.tags=i.tags?.map(km.to);s.detail=i.detail;s.documentation=Qo(i.documentation)?we.to(i.documentation):i.documentation;s.sortText=i.sortText;s.filterText=i.filterText;s.preselect=i.preselect;s.commitCharacters=i.commitCharacters;if(_t.isIRange(i.range)){s.range=V.to(i.range)}else if(typeof i.range==="object"){s.range={inserting:V.to(i.range.insert),replacing:V.to(i.range.replace)}}s.keepWhitespace=typeof i.insertTextRules==="undefined"?false:Boolean(i.insertTextRules&qa.KeepWhitespace);if(typeof i.insertTextRules!=="undefined"&&i.insertTextRules&qa.InsertAsSnippet){s.insertText=new ll(i.insertText)}else{s.insertText=i.insertText;s.textEdit=s.range instanceof Fe?new Wo(s.range,s.insertText):void 0}if(i.additionalTextEdits&&i.additionalTextEdits.length>0){s.additionalTextEdits=i.additionalTextEdits.map(r=>vi.to(r))}s.command=n&&i.command?n.fromInternal(i.command):void 0;return s}t.to=e})(Qb||(Qb={}));var Im;(function(t){function e(n){if(typeof n.label!=="string"&&!Array.isArray(n.label)){throw new TypeError("Invalid label")}return{label:n.label,documentation:we.fromStrict(n.documentation)}}t.from=e;function i(n){return{label:n.label,documentation:Qo(n.documentation)?we.to(n.documentation):n.documentation}}t.to=i})(Im||(Im={}));var Tm;(function(t){function e(n){return{label:n.label,documentation:we.fromStrict(n.documentation),parameters:Array.isArray(n.parameters)?n.parameters.map(Im.from):[],activeParameter:n.activeParameter}}t.from=e;function i(n){return{label:n.label,documentation:Qo(n.documentation)?we.to(n.documentation):n.documentation,parameters:Array.isArray(n.parameters)?n.parameters.map(Im.to):[],activeParameter:n.activeParameter}}t.to=i})(Tm||(Tm={}));var Fh;(function(t){function e(n){return{activeSignature:n.activeSignature,activeParameter:n.activeParameter,signatures:Array.isArray(n.signatures)?n.signatures.map(Tm.from):[]}}t.from=e;function i(n){return{activeSignature:n.activeSignature,activeParameter:n.activeParameter,signatures:Array.isArray(n.signatures)?n.signatures.map(Tm.to):[]}}t.to=i})(Fh||(Fh={}));var Jb;(function(t){function e(i,n){const s=new Wg(ut.to(n.position),typeof n.label==="string"?n.label:n.label.map(Yb.to.bind(void 0,i)),n.kind&&Pm.to(n.kind));s.textEdits=n.textEdits&&n.textEdits.map(vi.to);s.tooltip=Qo(n.tooltip)?we.to(n.tooltip):n.tooltip;s.paddingLeft=n.paddingLeft;s.paddingRight=n.paddingRight;return s}t.to=e})(Jb||(Jb={}));var Yb;(function(t){function e(i,n){const s=new Bg(n.label);s.tooltip=Qo(n.tooltip)?we.to(n.tooltip):n.tooltip;if(K1.is(n.command)){s.command=i.fromInternal(n.command)}if(n.location){s.location=wn.to(n.location)}return s}t.to=e})(Yb||(Yb={}));var Pm;(function(t){function e(n){return n}t.from=e;function i(n){return n}t.to=i})(Pm||(Pm={}));var Xa;(function(t){function e(n){return{range:V.from(n.range),url:n.target,tooltip:n.tooltip}}t.from=e;function i(n){let s=void 0;if(n.url){try{s=typeof n.url==="string"?b.parse(n.url,true):b.revive(n.url)}catch(o){}}const r=new qg(V.to(n.range),s);r.tooltip=n.tooltip;return r}t.to=i})(Xa||(Xa={}));var Am;(function(t){function e(n){const s=new Gg(n.label);if(n.textEdit){s.textEdit=vi.to(n.textEdit)}if(n.additionalTextEdits){s.additionalTextEdits=n.additionalTextEdits.map(r=>vi.to(r))}return s}t.to=e;function i(n){return{label:n.label,textEdit:n.textEdit?vi.from(n.textEdit):void 0,additionalTextEdits:n.additionalTextEdits?n.additionalTextEdits.map(s=>vi.from(s)):void 0}}t.from=i})(Am||(Am={}));var ru;(function(t){function e(n){return new Qc(n[0],n[1],n[2],n[3])}t.to=e;function i(n){return[n.red,n.green,n.blue,n.alpha]}t.from=i})(ru||(ru={}));var Xb;(function(t){function e(n){return{range:V.from(n.range)}}t.from=e;function i(n){return new ch(V.to(n.range))}t.to=i})(Xb||(Xb={}));var Rm;(function(t){function e(i){switch(i){case Yl.AUTO:return _c.AfterDelay;case Yl.EXPLICIT:return _c.Manual;case Yl.FOCUS_CHANGE:case Yl.WINDOW_CHANGE:return _c.FocusOut}}t.to=e})(Rm||(Rm={}));var Dc;(function(t){function e(n){switch(n){case fs.Off:return zi.Off;case fs.Relative:return zi.Relative;case fs.Interval:return zi.Interval;case fs.On:default:return zi.On}}t.from=e;function i(n){switch(n){case zi.Off:return fs.Off;case zi.Relative:return fs.Relative;case zi.Interval:return fs.Interval;case zi.On:default:return fs.On}}t.to=i})(Dc||(Dc={}));var ou;(function(t){function e(n){if(n===Ds.CRLF){return Kl.CRLF}else if(n===Ds.LF){return Kl.LF}return void 0}t.from=e;function i(n){if(n===Kl.CRLF){return Ds.CRLF}else if(n===Kl.LF){return Ds.LF}return void 0}t.to=i})(ou||(ou={}));var Lm;(function(t){function e(i){if(typeof i==="object"){return i.viewId}switch(i){case Mo.SourceControl:return Sd.Scm;case Mo.Window:return Sd.Window;case Mo.Notification:return Sd.Notification}throw new Error(`Unknown 'ProgressLocation'`)}t.from=e})(Lm||(Lm={}));var Nm;(function(t){function e(n){const s={start:n.start+1,end:n.end+1};if(n.kind){s.kind=Mm.from(n.kind)}return s}t.from=e;function i(n){const s={start:n.start-1,end:n.end-1};if(n.kind){s.kind=Mm.to(n.kind)}return s}t.to=i})(Nm||(Nm={}));var Mm;(function(t){function e(n){if(n){switch(n){case Dr.Comment:return Al.Comment;case Dr.Imports:return Al.Imports;case Dr.Region:return Al.Region}}return void 0}t.from=e;function i(n){if(n){switch(n.value){case Al.Comment.value:return Dr.Comment;case Al.Imports.value:return Dr.Imports;case Al.Region.value:return Dr.Region}}return void 0}t.to=i})(Mm||(Mm={}));var Rd;(function(t){function e(i){if(i){return{pinned:typeof i.preview==="boolean"?!i.preview:void 0,inactive:i.background,preserveFocus:i.preserveFocus,selection:typeof i.selection==="object"?V.from(i.selection):void 0,override:typeof i.override==="boolean"?h9.id:void 0}}return void 0}t.from=e})(Rd||(Rd={}));var gn;(function(t){function e(r){if(r instanceof yc){return r.toJSON()}if(typeof r==="string"){return r}if(i(r)||n(r)){return new yc(r.baseUri??r.base,r.pattern).toJSON()}return r}t.from=e;function i(r){const o=r;if(!o){return false}return b.isUri(o.baseUri)&&typeof o.pattern==="string"}function n(r){const o=r;if(!o){return false}return typeof o.base==="string"&&typeof o.pattern==="string"}function s(r){if(typeof r==="string"){return r}return new yc(b.revive(r.baseUri),r.pattern)}t.to=s})(gn||(gn={}));var Zb;(function(t){function e(i){if(!i){return void 0}else if(Array.isArray(i)){return i.map(e)}else if(typeof i==="string"){return i}else{const n=i;return{language:n.language,scheme:n.scheme,pattern:gn.from(n.pattern)??void 0,exclusive:n.exclusive,notebookType:n.notebookType}}}t.from=e})(Zb||(Zb={}));var ar;(function(t){function e(n){return{start:n.start,end:n.end}}t.from=e;function i(n){return new tr(n.start,n.end)}t.to=i})(ar||(ar={}));var au;(function(t){function e(n){return{timing:typeof n.runStartTime==="number"&&typeof n.runEndTime==="number"?{startTime:n.runStartTime,endTime:n.runEndTime}:void 0,executionOrder:n.executionOrder,success:n.lastRunSuccess}}t.to=e;function i(n){return{lastRunSuccess:n.success,runStartTime:n.timing?.startTime,runEndTime:n.timing?.endTime,executionOrder:n.executionOrder}}t.from=i})(au||(au={}));var Uh;(function(t){function e(n){switch(n){case Ra.Markup:return ec.Markup;case Ra.Code:default:return ec.Code}}t.from=e;function i(n){switch(n){case ec.Markup:return Ra.Markup;case ec.Code:default:return Ra.Code}}t.to=i})(Uh||(Uh={}));var uo;(function(t){function e(n){const s={metadata:n.metadata??Object.create(null),cells:[]};for(const r of n.cells){W_.validate(r);s.cells.push(lu.from(r))}return s}t.from=e;function i(n){const s=new QP(n.cells.map(lu.to));if(!UT(n.metadata)){s.metadata=n.metadata}return s}t.to=i})(uo||(uo={}));var lu;(function(t){function e(n){return{cellKind:Uh.from(n.kind),language:n.languageId,mime:n.mime,source:n.value,metadata:n.metadata,internalMetadata:au.from(n.executionSummary??{}),outputs:n.outputs?n.outputs.map(qo.from):[]}}t.from=e;function i(n){return new W_(Uh.to(n.cellKind),n.source,n.language,n.mime,n.outputs?n.outputs.map(qo.to):void 0,n.metadata,n.internalMetadata?au.to(n.internalMetadata):void 0)}t.to=i})(lu||(lu={}));var cu;(function(t){function e(n){return{mime:n.mime,valueBytes:ae.wrap(n.data)}}t.from=e;function i(n){return new JP(n.valueBytes.buffer,n.mime)}t.to=i})(cu||(cu={}));var qo;(function(t){function e(n){return{outputId:n.id,items:n.items.map(cu.from),metadata:n.metadata}}t.from=e;function i(n){const s=n.items.map(cu.to);return new Mg(s,n.outputId,n.metadata)}t.to=i})(qo||(qo={}));var Om;(function(t){function e(s){if(n(s)){return{include:gn.from(s.include)??void 0,exclude:gn.from(s.exclude)??void 0}}return gn.from(s)??void 0}t.from=e;function i(s){if(n(s)){return{include:gn.to(s.include),exclude:gn.to(s.exclude)}}return gn.to(s)}t.to=i;function n(s){const r=s;if(!r){return false}return!ai(r.include)&&!ai(r.exclude)}})(Om||(Om={}));var ey;(function(t){function e(i,n,s){const r=typeof i.command==="string"?{title:"",command:i.command}:i.command;return{alignment:i.alignment===am.Left?yg.Left:yg.Right,command:n.toInternal(r,s),text:i.text,tooltip:i.tooltip,accessibilityInformation:i.accessibilityInformation,priority:i.priority}}t.from=e})(ey||(ey={}));var ty;(function(t){function e(i,n,s){const r=typeof i.command==="string"?{title:"",command:i.command}:i.command;return{command:n.toInternal(r,s),label:i.label,description:i.description,detail:i.detail,documentation:i.documentation}}t.from=e})(ty||(ty={}));var iy;(function(t){function e(i){return{transientOutputs:i?.transientOutputs??false,transientCellMetadata:i?.transientCellMetadata??{},transientDocumentMetadata:i?.transientDocumentMetadata??{},cellContentMetadata:i?.cellContentMetadata??{}}}t.from=e})(iy||(iy={}));var Fm;(function(t){function e(n){return{uri:n.uri,provides:n.provides}}t.from=e;function i(n){return new rA(b.revive(n.uri),n.provides)}t.to=i})(Fm||(Fm={}));var uu;(function(t){function e(n){return{message:we.fromStrict(n.message)||"",type:As.Error,expected:n.expectedOutput,actual:n.actualOutput,contextValue:n.contextValue,location:n.location&&{range:V.from(n.location.range),uri:n.location.uri},stackTrace:n.stackTrace?.map(s=>({label:s.label,position:s.position&&ut.from(s.position),uri:s.uri&&b.revive(s.uri).toJSON()}))}}t.from=e;function i(n){const s=new hm(typeof n.message==="string"?n.message:we.to(n.message));s.actualOutput=n.actual;s.expectedOutput=n.expected;s.contextValue=n.contextValue;s.location=n.location?wn.to(n.location):void 0;return s}t.to=i})(uu||(uu={}));var Os;(function(t){t.namespace=pp;t.denamespace=jP})(Os||(Os={}));var ny;(function(t){function e(i){return{controllerId:i.controllerId,profileId:i.profileId,group:du.from(i.kind)}}t.from=e})(ny||(ny={}));var du;(function(t){const e={[Cc.Coverage]:Ui.Coverage,[Cc.Debug]:Ui.Debug,[Cc.Run]:Ui.Run};function i(n){return e.hasOwnProperty(n)?e[n]:Ui.Run}t.from=i})(du||(du={}));var jo;(function(t){function e(n){const s=B_(n).controllerId;return{extId:Me.fromExtHostTestItem(n,s).toString(),label:n.label,uri:b.revive(n.uri),busy:n.busy,tags:n.tags.map(r=>Os.namespace(s,r.id)),range:_t.lift(V.from(n.range)),description:n.description||null,sortText:n.sortText||null,error:n.error?we.fromStrict(n.error)||null:null}}t.from=e;function i(n){return{parent:void 0,error:void 0,id:Me.fromString(n.extId).localId,label:n.label,uri:b.revive(n.uri),tags:(n.tags||[]).map(s=>{const{tagId:r}=Os.denamespace(s);return new Dh(r)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>void 0,replace:()=>{},size:0},range:V.to(n.range||void 0),canResolveChildren:false,busy:n.busy,description:n.description||void 0,sortText:n.sortText||void 0}}t.toPlain=i})(jo||(jo={}));(function(t){function e(n){return{id:n.id}}t.from=e;function i(n){return new Dh(n.id)}t.to=i})(Os||(Os={}));var sy;(function(t){const e=(n,s)=>{const r=n.value;if(!r){return void 0}const o={...jo.toPlain(r.item),parent:s,taskStates:r.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(l=>l.type===As.Error).map(uu.to)})),children:[]};if(n.children){for(const a of n.children.values()){const l=e(a,o);if(l){o.children.push(l)}}}return o};function i(n){const s=new B7;for(const a of n.items){s.insert(Me.fromString(a.item.extId).path,a)}const r=[s.nodes];const o=[];while(r.length){for(const a of r.pop()){if(a.value){o.push(a)}else if(a.children){r.push(a.children.values())}}}return{completedAt:n.completedAt,results:o.map(a=>e(a)).filter(Un)}}t.to=i})(sy||(sy={}));var $h;(function(t){function e(a){return{covered:a.covered,total:a.total}}function i(a){return"line"in a?ut.from(a):V.from(a)}function n(a){if(!a){return void 0}return"endLineNumber"in a?V.to(a):ut.to(a)}function s(a){if(a.type===Ga.Statement){const l=[];if(a.branches){for(const c of a.branches){l.push({executed:c.count,location:n(c.location),label:c.label})}}return new aA(a.count,n(a.location),a.branches?.map(c=>new lA(c.count,n(c.location),c.label)))}else{return new cA(a.name,a.count,n(a.location))}}t.to=s;function r(a){if(typeof a.executed==="number"&&a.executed<0){throw new Error(`Invalid coverage count ${a.executed}`)}if("branches"in a){return{count:a.executed,location:i(a.location),type:Ga.Statement,branches:a.branches.length?a.branches.map(l=>({count:l.executed,location:l.location&&i(l.location),label:l.label})):void 0}}else{return{type:Ga.Declaration,name:a.name,count:a.executed,location:i(a.location)}}}t.fromDetails=r;function o(a,l,c){wp(c.statementCoverage);wp(c.branchCoverage);wp(c.declarationCoverage);return{id:l,uri:c.uri,statement:e(c.statementCoverage),branch:c.branchCoverage&&e(c.branchCoverage),declaration:c.declarationCoverage&&e(c.declarationCoverage),testIds:c instanceof eu&&c.includesTests.length?c.includesTests.map(u=>Me.fromExtHostTestItem(u,a).toString()):void 0}}t.fromFile=o})($h||($h={}));var ry;(function(t){function e(i){switch(i){case ig.Invoke:return ah.Invoke;case ig.Auto:return ah.Automatic}}t.to=e})(ry||(ry={}));var Za;(function(t){function e(n){const s=new sx(es.to(n.kind),n.name,n.detail||"",b.revive(n.uri),V.to(n.range),V.to(n.selectionRange));s._sessionId=n._sessionId;s._itemId=n._itemId;return s}t.to=e;function i(n,s,r){s=s??n._sessionId;r=r??n._itemId;if(s===void 0||r===void 0){throw new Error("invalid item")}return{_sessionId:s,_itemId:r,kind:es.from(n.kind),name:n.name,detail:n.detail??"",uri:n.uri,range:V.from(n.range),selectionRange:V.from(n.selectionRange),tags:n.tags?.map(qr.from)}}t.from=i})(Za||(Za={}));var Um;(function(t){function e(i){if(!i){return void 0}return{value:i.value,tooltip:i.tooltip}}t.from=e})(Um||(Um={}));var el;(function(t){function e(r,o,a){const l=o.fileData;if(l){return new yM(new SM(l.name,b.revive(l.uri),l.id,MT(()=>a(l.id))))}if(r===Ps.uriList&&o.uriListData){return new Yg(s(o.uriListData))}return new Yg(o.asString)}t.to=e;async function i(r,o,a=Pi()){const l=await o.asString();if(r===Ps.uriList){return{id:a,asString:l,fileData:void 0,uriListData:n(l)}}const c=o.asFile();return{id:a,asString:l,fileData:c?{name:c.name,uri:c.uri,id:c._itemId??c.id}:void 0}}t.from=i;function n(r){return W1.split(r).map(o=>{if(o.startsWith("#")){return o}try{return b.parse(o)}catch{}return o})}function s(r){return W1.create(r.map(o=>{return typeof o==="string"?o:b.revive(o)}))}})(el||(el={}));var hu;(function(t){function e(s,r){const o=s.items.map(([a,l])=>{return[a,el.to(a,l,r)]});return new Yc(o)}t.toDataTransfer=e;async function i(s){const r=await Promise.all(Array.from(s,async([o,a])=>{return[o,await el.from(o,a)]}));return{items:r}}t.from=i;async function n(s){const r=await Promise.all(Array.from(s,async([o,a])=>{return[o,await el.from(o,a,a.id)]}));return{items:r}}t.fromList=n})(hu||(hu={}));var $m;(function(t){function e(n,s){return{kind:"reply",agentId:n.participant??s?.agentId??"",subCommand:n.command??s?.command,message:n.prompt,title:n.label}}t.from=e;function i(n){return{prompt:n.message,label:n.title,participant:n.agentId,command:n.subCommand}}t.to=i})($m||($m={}));var fu;(function(t){function e(n){switch(n){case xr.System:return Dn.System;case xr.User:return Dn.User;case xr.Assistant:return Dn.Assistant}}t.to=e;function i(n){switch(n){case Dn.System:return xr.System;case Dn.User:return xr.User;case Dn.Assistant:return xr.Assistant}return xr.User}t.from=i})(fu||(fu={}));var qk;(function(t){function e(n){const s=n.content.map(a=>{if(a.type==="text"){return new ci(a.value,a.audience)}else if(a.type==="tool_result"){const l=zt(a.value.map(c=>{if(c.type==="text"){return new ci(c.value,c.audience)}else if(c.type==="data"){return new xi(c.data.buffer,c.mimeType)}else if(c.type==="prompt_tsx"){return new zo(c.value)}else{return void 0}}));return new tu(a.toolCallId,l,a.isError)}else if(a.type==="image_url"){return new xi(a.value.data.buffer,a.value.mimeType)}else if(a.type==="data"){return new xi(a.data.buffer,a.mimeType)}else if(a.type==="tool_use"){return new dl(a.toolCallId,a.name,a.parameters)}return void 0}).filter(a=>a!==void 0);const r=fu.to(n.role);const o=new yA(r,s,n.name);return o}t.to=e;function i(n){const s=fu.from(n.role);const r=n.name;let o=n.content;if(typeof o==="string"){o=[new ci(o)]}const a=o.map(l=>{if(l instanceof tu){return{type:"tool_result",toolCallId:l.callId,value:zt(l.content.map(c=>{if(c instanceof ci){return{type:"text",value:c.value,audience:c.audience}}else if(c instanceof zo){return{type:"prompt_tsx",value:c.value}}else if(c instanceof xi){return{type:"data",mimeType:c.mimeType,data:ae.wrap(c.data),audience:c.audience}}else{return void 0}})),isError:l.isError}}else if(l instanceof xi){if(kA(l)){const c={mimeType:l.mimeType,data:ae.wrap(l.data)};return{type:"image_url",value:c}}else{return{type:"data",mimeType:l.mimeType,data:ae.wrap(l.data),audience:l.audience}}}else if(l instanceof dl){return{type:"tool_use",toolCallId:l.callId,name:l.name,parameters:l.input}}else if(l instanceof ci){return{type:"text",value:l.value}}else{if(typeof l!=="string"){throw new Error("Unexpected chat message content type")}return{type:"text",value:l}}});return{role:s,name:r,content:a}}t.from=i})(qk||(qk={}));var Hm;(function(t){function e(n){const s=n.content.map(a=>{if(a.type==="text"){return new ci(a.value,a.audience)}else if(a.type==="tool_result"){const l=a.value.map(c=>{if(c.type==="text"){return new ci(c.value,c.audience)}else if(c.type==="data"){return new xi(c.data.buffer,c.mimeType)}else{return new zo(c.value)}});return new tu(a.toolCallId,l,a.isError)}else if(a.type==="image_url"){return new xi(a.value.data.buffer,a.value.mimeType)}else if(a.type==="data"){return new xi(a.data.buffer,a.mimeType)}else if(a.type==="thinking"){return new iu(a.value,a.id,a.metadata)}else{return new dl(a.toolCallId,a.name,a.parameters)}});const r=fu.to(n.role);const o=new SA(r,s,n.name);return o}t.to=e;function i(n){const s=fu.from(n.role);const r=n.name;let o=n.content;if(typeof o==="string"){o=[new ci(o)]}const a=o.map(l=>{if(l instanceof tu){return{type:"tool_result",toolCallId:l.callId,value:zt(l.content.map(c=>{if(c instanceof ci){return{type:"text",value:c.value,audience:c.audience}}else if(c instanceof zo){return{type:"prompt_tsx",value:c.value}}else if(c instanceof xi){return{type:"data",mimeType:c.mimeType,data:ae.wrap(c.data),audience:c.audience}}else{return void 0}})),isError:l.isError}}else if(l instanceof xi){if(kA(l)){const c={mimeType:l.mimeType,data:ae.wrap(l.data)};return{type:"image_url",value:c}}else{return{type:"data",mimeType:l.mimeType,data:ae.wrap(l.data),audience:l.audience}}}else if(l instanceof dl){return{type:"tool_use",toolCallId:l.callId,name:l.name,parameters:l.input}}else if(l instanceof ci){return{type:"text",value:l.value}}else if(l instanceof iu){return{type:"thinking",value:l.value,id:l.id,metadata:l.metadata}}else{if(typeof l!=="string"){throw new Error("Unexpected chat message content type llm 2")}return{type:"text",value:l}}});return{role:s,name:r,content:a}}t.from=i})(Hm||(Hm={}));function kA(t){const e=typeof t.mimeType==="string"?t.mimeType.toLowerCase():"";switch(e){case"image/png":case"image/jpeg":case"image/jpg":case"image/gif":case"image/webp":case"image/bmp":return true;default:return false}}var Hh;(function(t){function e(n){return{kind:"markdownContent",content:we.from(n.value)}}t.from=e;function i(n){return new V_(we.to(n.content))}t.to=i})(Hh||(Hh={}));var Bm;(function(t){function e(n){return{kind:"codeblockUri",uri:n.value,isEdit:n.isEdit,undoStopId:n.undoStopId}}t.from=e;function i(n){return new G_(b.revive(n.uri),n.isEdit,n.undoStopId)}t.to=i})(Bm||(Bm={}));var Wm;(function(t){function e(n){return{kind:"markdownVuln",content:we.from(n.value),vulnerabilities:n.vulnerabilities}}t.from=e;function i(n){return new Th(we.to(n.content),n.vulnerabilities)}t.to=i})(Wm||(Wm={}));var Vm;(function(t){function e(i){return{kind:"confirmation",title:i.title,message:we.from(i.message),data:i.data,buttons:i.buttons}}t.from=e})(Vm||(Vm={}));var zm;(function(t){function e(r){switch(r){case Gs.Text:return"text";case Gs.SingleSelect:return"singleSelect";case Gs.MultiSelect:return"multiSelect";default:return"text"}}function i(r){switch(r){case"text":return Gs.Text;case"singleSelect":return Gs.SingleSelect;case"multiSelect":return Gs.MultiSelect;default:return Gs.Text}}function n(r){return{kind:"questionCarousel",questions:r.questions.map(o=>({id:o.id,type:e(o.type),title:o.title,message:o.message?we.from(o.message):void 0,options:o.options,defaultValue:o.defaultValue,allowFreeformInput:o.allowFreeformInput})),allowSkip:r.allowSkip}}t.from=n;function s(r){const o=r.questions.map(a=>new mA(a.id,i(a.type),a.title,{message:a.message?typeof a.message==="string"?new rn(a.message):we.to(a.message):void 0,options:a.options?.map(l=>({id:l.id,label:l.label,value:l.value})),defaultValue:a.defaultValue,allowFreeformInput:a.allowFreeformInput}));return new Rh(o,r.allowSkip)}t.to=s})(zm||(zm={}));var Bh;(function(t){function e(n){const{value:s,baseUri:r}=n;function o(a,l){return a.map(c=>{const u=b.joinPath(l,c.name);return{label:c.name,uri:u,children:c.children&&o(c.children,u)}})}return{kind:"treeData",treeData:{label:ts(r),uri:r,children:o(s,r)}}}t.from=e;function i(n){const s=Wi(n.treeData);function r(l){return l.map(c=>{return{name:c.label,children:c.children&&r(c.children)}})}const o=s.uri;const a=s.children?r(s.children):[];return new z_(a,o)}t.to=i})(Bh||(Bh={}));var oy;(function(t){function e(n){return{kind:"multiDiffData",multiDiffData:{title:n.title,resources:n.value.map(s=>({originalUri:s.originalUri,modifiedUri:s.modifiedUri,goToFileUri:s.goToFileUri,added:s.added,removed:s.removed}))},readOnly:n.readOnly}}t.from=e;function i(n){const s=n.multiDiffData.resources.map(r=>({originalUri:r.originalUri?b.revive(r.originalUri):void 0,modifiedUri:r.modifiedUri?b.revive(r.modifiedUri):void 0,goToFileUri:r.goToFileUri?b.revive(r.goToFileUri):void 0,added:r.added,removed:r.removed}));return new cx(s,n.multiDiffData.title,n.readOnly)}t.to=i})(oy||(oy={}));var pu;(function(t){function e(n){const s=o=>b.isUri(o);const r=o=>"name"in o;return{kind:"inlineReference",name:n.title,inlineReference:s(n.value)?n.value:r(n.value)?pl.from(n.value):Rs.from(n.value)}}t.from=e;function i(n){const s=Wi(n);return new Ph(b.isUri(s.inlineReference)?s.inlineReference:"location"in s.inlineReference?pl.to(s.inlineReference):Rs.to(s.inlineReference),n.name)}t.to=i})(pu||(pu={}));var Wh;(function(t){function e(n){return{kind:"progressMessage",content:we.from(n.value)}}t.from=e;function i(n){return new ux(n.content.value)}t.to=i})(Wh||(Wh={}));var Vh;(function(t){function e(n){return{kind:"thinking",value:n.value,id:n.id,metadata:n.metadata}}t.from=e;function i(n){return new kc(n.value??"",n.id,n.metadata)}t.to=i})(Vh||(Vh={}));var qm;(function(t){function e(n){return{kind:"hook",hookType:n.hookType,stopReason:n.stopReason,systemMessage:n.systemMessage,metadata:n.metadata}}t.from=e;function i(n){return new q_(n.hookType,n.stopReason,n.systemMessage,n.metadata)}t.to=i})(qm||(qm={}));var zh;(function(t){function e(n){return{kind:"warning",content:we.from(n.value)}}t.from=e;function i(n){return new Ah(n.content.value)}t.to=i})(zh||(zh={}));var ay;(function(t){function e(i){return{kind:"extensions",extensions:i.extensions}}t.from=e})(ay||(ay={}));var ly;(function(t){function e(i){return{kind:"pullRequest",author:i.author,title:i.title,description:i.description,uri:i.uri,linkTag:i.linkTag}}t.from=e})(ly||(ly={}));var cy;(function(t){function e(n){return{kind:"move",uri:n.uri,range:V.from(n.range)}}t.from=e;function i(n){return new K_(b.revive(n.uri),V.to(n.range))}t.to=i})(cy||(cy={}));var uy;(function(t){function e(a){let l;let c;if(a.toolSpecificData&&i(a.toolSpecificData)){l=n(a.toolSpecificData,a.isError);c=void 0}else{c=a.toolSpecificData?s(a.toolSpecificData):void 0}return{kind:"toolInvocationSerialized",toolCallId:a.toolCallId,toolId:a.toolName,invocationMessage:a.invocationMessage?we.from(a.invocationMessage):a.toolName,originMessage:a.originMessage?we.from(a.originMessage):void 0,pastTenseMessage:a.pastTenseMessage?we.from(a.pastTenseMessage):void 0,isConfirmed:a.isConfirmed,isComplete:a.isComplete??true,source:Bo.External,toolSpecificData:c,resultDetails:l,presentation:a.presentation==="hidden"?Bc.Hidden:a.presentation==="hiddenAfterComplete"?Bc.HiddenAfterComplete:void 0,subAgentInvocationId:a.subAgentInvocationId}}t.from=e;function i(a){return a!==null&&typeof a==="object"&&"input"in a&&typeof a.input==="string"&&"output"in a&&Array.isArray(a.output)}function n(a,l){return{input:a.input,output:a.output.map(c=>{const u=c.mimeType.startsWith("text/");return{type:"embed",mimeType:c.mimeType,value:u?ae.wrap(c.data).toString():vl(ae.wrap(c.data)),isText:u}}),isError:l??false}}function s(a){if("command"in a&&"language"in a){return{kind:"terminal",command:a.command,language:a.language}}else if("commandLine"in a&&"language"in a){const l={kind:"terminal",commandLine:a.commandLine,language:a.language,terminalCommandOutput:typeof a.output?.text==="string"?{text:a.output.text}:void 0,terminalCommandState:a.state?{exitCode:a.state.exitCode,duration:a.state.duration}:void 0};return l}return a}function r(a){const l=new px(a.toolId||a.toolName,a.toolCallId,a.isError);if(a.invocationMessage){l.invocationMessage=a.invocationMessage}if(a.originMessage){l.originMessage=a.originMessage}if(a.pastTenseMessage){l.pastTenseMessage=a.pastTenseMessage}if(a.isConfirmed!==void 0){l.isConfirmed=a.isConfirmed}if(a.isComplete!==void 0){l.isComplete=a.isComplete}if(a.toolSpecificData){l.toolSpecificData=o(a.toolSpecificData)}l.subAgentInvocationId=a.subAgentInvocationId;l.subAgentName=a.subAgentName;return l}t.to=r;function o(a){if(a.kind==="terminal"){if(a.commandLine){const l={commandLine:a.commandLine,language:a.language};if(a.terminalCommandOutput){l.output={text:a.terminalCommandOutput.text,truncated:a.terminalCommandOutput.truncated,lineCount:a.terminalCommandOutput.lineCount}}if(a.terminalCommandState){l.state={exitCode:a.terminalCommandState.exitCode,duration:a.terminalCommandState.duration}}return l}else{return{command:a.command,language:a.language}}}else if(a.kind==="terminal2"){return{commandLine:a.commandLine,language:a.language}}return a}})(uy||(uy={}));var jm;(function(t){function e(i){return{kind:"progressTask",content:we.from(i.value)}}t.from=e})(jm||(jm={}));var dy;(function(t){function e(i){return{kind:"progressTaskResult",content:typeof i==="string"?we.from(i):void 0}}t.from=e})(dy||(dy={}));var qh;(function(t){function e(n,s,r){const o=s.toInternal(n.value,r)??{command:n.value.command,title:n.value.title};return{kind:"command",command:o}}t.from=e;function i(n,s){return new j_(s.fromInternal(n.command)??{command:n.command.id,title:n.command.title})}t.to=i})(qh||(qh={}));var Gm;(function(t){function e(n){return{kind:"textEdit",uri:n.uri,edits:n.edits.map(s=>vi.from(s)),done:n.isDone}}t.from=e;function i(n){const s=new Lh(b.revive(n.uri),n.edits.map(r=>vi.to(r)));s.isDone=n.done;return s}t.to=i})(Gm||(Gm={}));var Km;(function(t){function e(i){if(i.newCellMetadata){return{editType:Lo.Metadata,index:i.range.start,metadata:i.newCellMetadata}}else if(i.newNotebookMetadata){return{editType:Lo.DocumentMetadata,metadata:i.newNotebookMetadata}}else{return{editType:Lo.Replace,index:i.range.start,count:i.range.end-i.range.start,cells:i.newCells.map(lu.from)}}}t.from=e})(Km||(Km={}));var Qm;(function(t){function e(i){return{kind:"notebookEdit",uri:i.uri,edits:i.edits.map(Km.from),done:i.isDone}}t.from=e})(Qm||(Qm={}));var Jm;(function(t){function e(i){return{kind:"workspaceEdit",edits:i.edits.map(n=>({oldResource:n.oldResource,newResource:n.newResource}))}}t.from=e})(Jm||(Jm={}));var tl;(function(t){function e(n){const s=Kt.isThemeIcon(n.iconPath)?n.iconPath:b.isUri(n.iconPath)?{light:b.revive(n.iconPath)}:n.iconPath&&"light"in n.iconPath&&"dark"in n.iconPath&&b.isUri(n.iconPath.light)&&b.isUri(n.iconPath.dark)?{light:b.revive(n.iconPath.light),dark:b.revive(n.iconPath.dark)}:void 0;if(typeof n.value==="object"&&"variableName"in n.value){return{kind:"reference",reference:{variableName:n.value.variableName,value:b.isUri(n.value.value)||!n.value.value?n.value.value:Rs.from(n.value.value)},iconPath:s,options:n.options}}return{kind:"reference",reference:b.isUri(n.value)||typeof n.value==="string"?n.value:Rs.from(n.value),iconPath:s,options:n.options}}t.from=e;function i(n){const s=Wi(n);const r=o=>b.isUri(o)?o:Rs.to(o);return new Ya(typeof s.reference==="string"?s.reference:"variableName"in s.reference?{variableName:s.reference.variableName,value:s.reference.value&&r(s.reference.value)}:r(s.reference))}t.to=i})(tl||(tl={}));var Ym;(function(t){function e(i){return{kind:"codeCitation",value:i.value,license:i.license,snippet:i.snippet}}t.from=e})(Ym||(Ym={}));var jh;(function(t){function e(s,r,o){if(s instanceof V_){return Hh.from(s)}else if(s instanceof Ph){return pu.from(s)}else if(s instanceof Ya){return tl.from(s)}else if(s instanceof ux){return Wh.from(s)}else if(s instanceof kc){return Vh.from(s)}else if(s instanceof q_){return qm.from(s)}else if(s instanceof z_){return Bh.from(s)}else if(s instanceof cx){return oy.from(s)}else if(s instanceof j_){return qh.from(s,r,o)}else if(s instanceof Lh){return Gm.from(s)}else if(s instanceof mm){return Qm.from(s)}else if(s instanceof Th){return Wm.from(s)}else if(s instanceof G_){return Bm.from(s)}else if(s instanceof Ah){return zh.from(s)}else if(s instanceof pm){return Vm.from(s)}else if(s instanceof Rh){return zm.from(s)}else if(s instanceof gm){return Ym.from(s)}else if(s instanceof K_){return cy.from(s)}else if(s instanceof dx){return ay.from(s)}else if(s instanceof hx){return ly.from(s)}else if(s instanceof px){return uy.from(s)}else if(s instanceof fx){return Jm.from(s)}return{kind:"markdownContent",content:we.from("")}}t.from=e;function i(s,r){switch(s.kind){case"reference":return tl.to(s);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return n(s,r)}return void 0}t.to=i;function n(s,r){switch(s.kind){case"markdownContent":return Hh.to(s);case"inlineReference":return pu.to(s);case"progressMessage":return void 0;case"treeData":return Bh.to(s);case"command":return qh.to(s,r)}return void 0}t.toContent=n})(jh||(jh={}));var Gh;(function(t){function e(i,n,s,r,o,a,l){const c=[];const u=[];for(const p of i.variables.variables){if(p.kind==="tool"){c.push(p)}else if(p.kind==="toolset"){c.push(...p.value)}else{u.push(p)}}const d=Yd.parseLocalSessionId(i.sessionResource)??i.sessionResource.toString();const f={id:i.requestId,prompt:i.message,command:i.command,attempt:i.attempt??0,enableCommandDetection:i.enableCommandDetection??true,isParticipantDetected:i.isParticipantDetected??false,sessionId:d,sessionResource:i.sessionResource,references:u.map(p=>Xm.to(p,r,l)).filter(Un),toolReferences:c.map(ml.to),location:Kh.to(i.location),acceptedConfirmationData:i.acceptedConfirmationData,rejectedConfirmationData:i.rejectedConfirmationData,location2:n,toolInvocationToken:Object.freeze({sessionId:d,sessionResource:i.sessionResource}),tools:o,model:s,editedFileEvents:i.editedFileEvents,modeInstructions:i.modeInstructions?.content,modeInstructions2:hy.to(i.modeInstructions),subAgentInvocationId:i.subAgentInvocationId,subAgentName:i.subAgentName,hasHooksEnabled:i.hasHooksEnabled??false,hooks:i.hooks?Cy.to(i.hooks):void 0};if(!it(a,"chatParticipantPrivate")){delete f.id;delete f.attempt;delete f.enableCommandDetection;delete f.isParticipantDetected;delete f.location;delete f.location2;delete f.editedFileEvents;delete f.sessionId;delete f.subAgentInvocationId;delete f.subAgentName;delete f.hasHooksEnabled;delete f.hooks}if(!it(a,"chatParticipantAdditions")){delete f.acceptedConfirmationData;delete f.rejectedConfirmationData;delete f.tools}return f}t.to=e})(Gh||(Gh={}));var Kh;(function(t){function e(n){switch(n){case ki.Notebook:return ps.Notebook;case ki.Terminal:return ps.Terminal;case ki.Chat:return ps.Panel;case ki.EditorInline:return ps.Editor}}t.to=e;function i(n){switch(n){case ps.Notebook:return ki.Notebook;case ps.Terminal:return ki.Terminal;case ps.Panel:return ki.Chat;case ps.Editor:return ki.EditorInline}}t.from=i})(Kh||(Kh={}));var Xm;(function(t){function e(i,n,s){let r=i.value;if(!r){let a;try{a=JSON.stringify(i)}catch{a=`kind=${i.kind}, id=${i.id}, name=${i.name}`}s.error(`[ChatPromptReference] Ignoring invalid reference in variable: ${a}`);return void 0}if($p(r)){r=b.revive(r)}else if(r&&typeof r==="object"&&"uri"in r&&"range"in r&&$p(r.uri)){r=Rs.to(Wi(r))}else if(b9(i)){const a=i.references?.[0]?.reference;r=new bA(i.mimeType??"image/png",()=>Promise.resolve(new Uint8Array(Object.values(i.value))),a&&b.isUri(a)?a:void 0)}else if(i.kind==="diagnostic"){const a=i.filterSeverity&&Nh.to(i.filterSeverity);const l=i.filterUri&&b.revive(i.filterUri).toString();r=new gx(n.map(([c,u])=>{if(i.filterUri&&c.toString()!==l){return[c,[]]}return[c,u.filter(d=>{if(a&&d.severity>a){return false}if(i.filterRange&&!_t.areIntersectingOrTouching(i.filterRange,V.from(d.range))){return false}return true})]}).filter(([,c])=>c.length>0))}let o;if(ew(i)||y9(i)){if(i.toolReferences){o=Zm.to(i.toolReferences)}}return{id:i.id,name:i.name,range:i.range&&[i.range.start,i.range.endExclusive],toolReferences:o,value:r,modelDescription:i.modelDescription}}t.to=e})(Xm||(Xm={}));var ml;(function(t){function e(i){const n=i.value;if(n){throw new Error("Invalid tool reference")}return{name:i.id,range:i.range&&[i.range.start,i.range.endExclusive]}}t.to=e})(ml||(ml={}));var Zm;(function(t){function e(i){const n=[];for(const s of i){if(s.kind==="tool"){n.push(ml.to(s))}else if(s.kind==="toolset"){n.push(...s.value.map(ml.to))}else{throw new Error("Invalid tool reference in prompt variables")}}return n}t.to=e})(Zm||(Zm={}));var hy;(function(t){function e(i){if(i){return{name:i.name,content:i.content,toolReferences:Zm.to(i.toolReferences),metadata:i.metadata}}return void 0}t.to=e})(hy||(hy={}));var fy;(function(t){function e(i,n,s){return{id:i.id,label:i.label,fullName:i.fullName,icon:i.icon?.id,value:i.values[0].value,insertText:i.insertText,detail:i.detail,documentation:i.documentation,command:n.toInternal(i.command,s)}}t.from=e})(fy||(fy={}));var Ic;(function(t){function e(s){return{errorDetails:s.errorDetails,metadata:n(s.metadata),nextQuestion:s.nextQuestion,details:s.details,usage:s.usage}}t.to=e;function i(s){return{errorDetails:s.errorDetails,metadata:s.metadata,nextQuestion:s.nextQuestion,details:s.details,usage:s.usage}}t.from=i;function n(s){return $c(s,r=>{if(r.$mid===nt.LanguageModelToolResult){return new Q_($c(r.content,n))}else if(r.$mid===nt.LanguageModelTextPart){return new ci(r.value)}else if(r.$mid===nt.LanguageModelThinkingPart){return new iu(r.value,r.id,r.metadata)}else if(r.$mid===nt.LanguageModelPromptTsxPart){return new zo(r.value)}return void 0})}})(Ic||(Ic={}));var py;(function(t){function e(i,n,s){if(n.action.kind==="vote"){return}const r=Ic.to(i);if(n.action.kind==="command"){const o=n.action.commandButton.command;const a={command:s.fromInternal(o)??{command:o.id,title:o.title}};const l={kind:"command",commandButton:a};return{action:l,result:r}}else if(n.action.kind==="followUp"){const o={kind:"followUp",followup:$m.to(n.action.followup)};return{action:o,result:r}}else if(n.action.kind==="inlineChat"){return{action:{kind:"editor",accepted:n.action.action==="accepted"},result:r}}else if(n.action.kind==="chatEditingSessionAction"){const o=new Map([["accepted",js.Accepted],["rejected",js.Rejected],["saved",js.Saved]]);return{action:{kind:"chatEditingSessionAction",outcome:o.get(n.action.outcome)??js.Rejected,uri:b.revive(n.action.uri),hasRemainingEdits:n.action.hasRemainingEdits},result:r}}else if(n.action.kind==="chatEditingHunkAction"){const o=new Map([["accepted",js.Accepted],["rejected",js.Rejected]]);return{action:{kind:"chatEditingHunkAction",outcome:o.get(n.action.outcome)??js.Rejected,uri:b.revive(n.action.uri),hasRemainingEdits:n.action.hasRemainingEdits,lineCount:n.action.lineCount,linesAdded:n.action.linesAdded,linesRemoved:n.action.linesRemoved},result:r}}else{return{action:n.action,result:r}}}t.to=e})(py||(py={}));var e_;(function(t){function e(i,n,s){if("terminalCommand"in i){return{terminalCommand:i.terminalCommand,shouldExecute:i.shouldExecute}}if("uri"in i){return{uri:i.uri}}return n.toInternal(i,s)}t.from=e})(e_||(e_={}));var t_;(function(t){function e(i){return{...i,documentation:we.fromStrict(i.documentation)}}t.from=e})(t_||(t_={}));var gy;(function(t){function e(i,n){if(Array.isArray(i)){return{items:i.map(s=>t_.from(s))}}return{items:i.items.map(s=>t_.from(s)),resourceOptions:i.resourceOptions?my.from(i.resourceOptions,n):void 0}}t.from=e})(gy||(gy={}));var my;(function(t){function e(i,n){return{...i,pathSeparator:n,cwd:i.cwd,globPattern:gn.from(i.globPattern)??void 0}}t.from=e})(my||(my={}));var _y;(function(t){function e(i){return{kind:vy.to(i.kind),acceptedLength:i.acceptedLength}}t.to=e})(_y||(_y={}));var vy;(function(t){function e(i){switch(i){case vd.Word:return La.Word;case vd.Line:return La.Line;case vd.Suggest:return La.Suggest;default:return La.Unknown}}t.to=e})(vy||(vy={}));var wy;(function(t){function e(i,n){if(i.kind===tg.Ignored){const s=i.supersededBy?n(i.supersededBy):void 0;return{kind:gc.Ignored,supersededBy:s,userTypingDisagreed:i.userTypingDisagreed}}else if(i.kind===tg.Accepted){return{kind:gc.Accepted}}return{kind:gc.Rejected}}t.to=e})(wy||(wy={}));var by;(function(t){function e(n){if(n===mc.Label){return uc.Label}else{return uc.Code}}t.from=e;function i(n){switch(n){case uc.Label:return mc.Label;default:return mc.Code}}t.to=i})(by||(by={}));var yy;(function(t){function e(i,n){return{id:n,label:i.label,description:i.description,canEdit:i.canEdit,collapsibleState:i.collapsibleState||_w.None,contextValue:i.contextValue}}t.from=e})(yy||(yy={}));var Sy;(function(t){function e(i){if(i.type==="mcp"){return new EA(i.label,i.serverLabel||i.label,i.instructions)}else if(i.type==="extension"){return new xA(i.extensionId.value,i.label)}else{return void 0}}t.to=e})(Sy||(Sy={}));var i_;(function(t){function e(n){const s=new Q_(n.content.map(r=>{if(r.kind==="text"){return new ci(r.value,r.audience)}else if(r.kind==="data"){return new xi(r.value.data.buffer,r.value.mimeType,r.audience)}else{return new zo(r.value)}}));if(n.toolMetadata!==void 0){s.toolMetadata=n.toolMetadata}return s}t.to=e;function i(n,s){if(n.toolResultMessage){O(s,"chatParticipantPrivate")}const r=c=>{if(c.audience){O(s,"languageModelToolResultAudience")}};let o=false;let a=void 0;if(Array.isArray(n.toolResultDetails)){a=n.toolResultDetails?.map(c=>{return b.isUri(c)?c:Rs.from(c)})}else{if(n.toolResultDetails2){a={output:{type:"data",mimeType:n.toolResultDetails2.mime,value:ae.wrap(n.toolResultDetails2.value)}};o=true}}const l={content:n.content.map(c=>{if(c instanceof ci){r(c);return{kind:"text",value:c.value,audience:c.audience}}else if(c instanceof zo){return{kind:"promptTsx",value:c.value}}else if(c instanceof xi){r(c);o=true;return{kind:"data",value:{mimeType:c.mimeType,data:ae.wrap(c.data)},audience:c.audience}}else{throw new Error("Unknown LanguageModelToolResult part type")}}),toolResultMessage:we.fromStrict(n.toolResultMessage),toolResultDetails:a,toolMetadata:n.toolMetadata};return o?new ji(l):l}t.from=i})(i_||(i_={}));var Fr;(function(t){function e(s){return s}t.fromThemeIcon=e;function i(s){if(!s){return void 0}else if(Kt.isThemeIcon(s)){return s}else if(b.isUri(s)){return s}else if(typeof s==="string"){return b.file(s)}else if(typeof s==="object"&&s!==null&&"dark"in s){const r=typeof s.dark==="string"?b.file(s.dark):s.dark;const o=typeof s.light==="string"?b.file(s.light):s.light;return!r?void 0:{dark:r,light:o??r}}else{return void 0}}t.from=i;function n(s){if(!s){return void 0}else if(Kt.isThemeIcon(s)){return s}else if($p(s)){return b.revive(s)}else{const r=s;return{light:b.revive(r.light),dark:b.revive(r.dark)}}}t.to=n})(Fr||(Fr={}));var xy;(function(t){function e(n){return{query:n.query,kind:i(n.kind),settings:n.settings}}t.fromSettingsSearchResult=e;function i(n){switch(n){case co.EMBEDDED:return co.EMBEDDED;case co.LLM_RANKED:return co.LLM_RANKED;case co.CANCELED:return co.CANCELED;default:throw new Error("Unknown AiSettingsSearchResultKind")}}})(xy||(xy={}));var tc;(function(t){function e(s){return!!s.uri}function i(s){return Vc.toSerialized(e(s)?{type:Ro.HTTP,uri:s.uri,headers:Object.entries(s.headers),authentication:s.authentication?{providerId:s.authentication.providerId,scopes:s.authentication.scopes}:void 0}:{type:Ro.Stdio,cwd:s.cwd?.fsPath,args:s.args,command:s.command,env:s.env,envFile:void 0})}t.from=i;function n(s){const r=Vc.fromSerialized(s.launch);if(r.type===Ro.HTTP){return new Fb(s.label,r.uri,Object.fromEntries(r.headers),s.cacheNonce==="$$NONE"?void 0:s.cacheNonce)}else{const o=new Ob(s.label,r.command,[...r.args],Object.fromEntries(Object.entries(r.env).map(([a,l])=>[a,l===null?null:String(l)])),s.cacheNonce==="$$NONE"?void 0:s.cacheNonce);if(r.cwd){o.cwd=b.file(r.cwd)}return o}}t.to=n})(tc||(tc={}));var Ey;(function(t){function e(i){switch(i){case wc.Error:return Td.Error;case wc.Warning:return Td.Warning;case wc.Information:return Td.Information;default:throw new Error("Unknown SourceControlInputBoxValidationType")}}t.from=e})(Ey||(Ey={}));var Cy;(function(t){function e(i){const n={};for(const[s,r]of Object.entries(i)){if(!r||r.length===0){continue}const o=[];for(const a of r){const l=ky.to(a);if(l){o.push(l)}}if(o.length>0){n[s]=o}}return n}t.to=e})(Cy||(Cy={}));var ky;(function(t){function e(i){const n=k9(i,Xu);if(!n){return void 0}return{command:n,cwd:i.cwd,env:i.env,timeout:i.timeout}}t.to=e})(ky||(ky={}));class Do{constructor(e,i,n){this.uri=e;this.ranges=i;this.previewText=n}}class mx{constructor(e,i,n){this.uri=e;this.text=i;this.lineNumber=n}}class Dy{constructor(e){this.keyword=e}}var Ir;(function(t){t[t["None"]=1]="None";t[t["FilesExclude"]=2]="FilesExclude";t[t["SearchAndFilesExclude"]=3]="SearchAndFilesExclude"})(Ir||(Ir={}));var n_;(function(t){t[t["Information"]=1]="Information";t[t["Warning"]=2]="Warning"})(n_||(n_={}));const DA=2e4;const IA=" ";const TA=" characters skipped ";const VM=(IA.length+TA.length+5)*2;var jk;(function(t){t[t["file"]=0]="file";t[t["text"]=1]="text";t[t["aiText"]=2]="aiText"})(jk||(jk={}));var il;(function(t){t[t["File"]=1]="File";t[t["Text"]=2]="Text";t[t["aiText"]=3]="aiText"})(il||(il={}));function Gk(t){return!!t.rangeLocations&&!!t.previewText}var Kk;(function(t){t[t["Normal"]=0]="Normal";t[t["NewSearchStarted"]=1]="NewSearchStarted"})(Kk||(Kk={}));class zM{constructor(e,i,n,s){this.rangeLocations=[];this.webviewIndex=s;const r=Array.isArray(i)?i:[i];if(n&&n.matchLines===1&&qM(r)){e=OL(e,n.matchLines);let o="";let a=0;let l=0;const c=Math.floor(n.charsPerLine/5);for(const u of r){const d=Math.max(u.startColumn-c,0);const f=u.startColumn+n.charsPerLine;if(d>l+c+VM){const p=IA+(d-l)+TA;o+=p+e.slice(d,f);a+=d-(l+p.length)}else{o+=e.slice(l,f)}l=f;this.rangeLocations.push({source:u,preview:new jM(0,u.startColumn-a,u.endColumn-a)})}this.previewText=o}else{const o=Array.isArray(i)?i[0].startLineNumber:i.startLineNumber;const a=E1(i,l=>({preview:new PA(l.startLineNumber-o,l.startColumn,l.endLineNumber-o,l.endColumn),source:l}));this.rangeLocations=Array.isArray(a)?a:[a];this.previewText=e}}}function qM(t){const e=t[0].startLineNumber;for(const i of t){if(i.startLineNumber!==e||i.endLineNumber!==e){return false}}return true}class PA{constructor(e,i,n,s){this.startLineNumber=e;this.startColumn=i;this.endLineNumber=n;this.endColumn=s}}class jM extends PA{constructor(e,i,n){super(e,i,e,n)}}var Qk;(function(t){t["List"]="list";t["Tree"]="tree"})(Qk||(Qk={}));var Jk;(function(t){t["Default"]="default";t["FileNames"]="fileNames";t["Type"]="type";t["Modified"]="modified";t["CountDescending"]="countDescending";t["CountAscending"]="countAscending"})(Jk||(Jk={}));var Yk;(function(t){t["Auto"]="auto";t["Manual"]="manual";t["RunOnEmpty"]="runOnEmpty"})(Yk||(Yk={}));function GM(t,e=true){const i=t&&t.files&&t.files.exclude;const n=e&&t&&t.search&&t.search.exclude;if(!i&&!n){return void 0}if(!i||!n){return i||n||void 0}let s=Object.create(null);s=ol(s,Pt(i));s=ol(s,Pt(n),true);return s}function Xk(t,e){const i=t.ignoreGlobCase?{ignoreCase:true}:void 0;if(t.excludePattern&&dc(t.excludePattern,e,i)){return false}if(t.includePattern||t.usingSearchPaths){if(t.includePattern&&dc(t.includePattern,e,i)){return true}if(t.usingSearchPaths){return!!t.folderQueries&&t.folderQueries.some(n=>{const s=n.folder.fsPath;if(Bp(e,s,t.ignoreGlobCase)){const r=Gd(s,e);return!n.includePattern||!!dc(n.includePattern,r,i)}else{return false}})}return false}return true}var Zk;(function(t){t[t["unknownEncoding"]=1]="unknownEncoding";t[t["regexParseError"]=2]="regexParseError";t[t["globParseError"]=3]="globParseError";t[t["invalidLiteral"]=4]="invalidLiteral";t[t["rgProcessError"]=5]="rgProcessError";t[t["other"]=6]="other";t[t["canceled"]=7]="canceled"})(Zk||(Zk={}));function Tc(t,e){const i={...t||{},...e||{}};return Object.keys(i).filter(n=>{const s=i[n];return typeof s==="boolean"&&s})}class AA{constructor(e,i){this._parsedIncludeExpression=null;const n=e.ignoreGlobCase||i.ignoreGlobCase?{ignoreCase:true}:void 0;this._excludeExpression=i.excludePattern?.map(r=>{return{...e.excludePattern||{},...r.pattern||{}}})??[];if(this._excludeExpression.length===0){this._excludeExpression=[e.excludePattern||{}]}this._parsedExcludeExpression=this._excludeExpression.map(r=>zc(r,n));let s=e.includePattern;if(i.includePattern){if(s){s={...s,...i.includePattern}}else{s=i.includePattern}}if(s){this._parsedIncludeExpression=zc(s,n)}}_evalParsedExcludeExpression(e,i,n){let s=null;for(const r of this._parsedExcludeExpression){const o=r(e,i,n);if(typeof o==="string"){s=o;break}}return s}matchesExcludesSync(e,i,n){if(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,i,n)){return true}return false}includedInQuerySync(e,i,n){if(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,i,n)){return false}if(this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,i,n)){return false}return true}includedInQuery(e,i,n){const s=()=>{return this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,i,n):true};return Promise.all(this._parsedExcludeExpression.map(r=>{const o=r(e,i,n);if(Uo(o)){return o.then(a=>{if(a){return false}return s()})}return s()})).then(r=>r.some(o=>!!o))}hasSiblingExcludeClauses(){return this._excludeExpression.reduce((e,i)=>KM(i)||e,false)}}function KM(t){for(const e in t){if(typeof t[e]!=="boolean"){return true}}return false}function QM(t){if(!t){return void 0}let e;return i=>{if(!e){e=(t()||Promise.resolve([])).then(n=>n?RA(n):{})}return e.then(n=>!!n[i])}}function JM(t){if(!t){return void 0}let e;return i=>{if(!e){const n=t();e=n?RA(n):{}}return!!e[i]}}function RA(t){const e={};for(const i of t){e[i]=true}return e}function LA(t){return t.flatMap(e=>e.patterns.map(i=>{return e.baseUri?{baseUri:e.baseUri,pattern:i}:i}))}const Iy={matchLines:100,charsPerLine:1e4};const Y_="utf8";const _x="utf8bom";const s_="utf16be";const r_="utf16le";const yp=[254,255];const Ty=[255,254];const td=[239,187,191];const YM=512;const XM=512;const ZM=512*8;const eO=512*128;var Py;(function(t){t[t["STREAM_IS_BINARY"]=1]="STREAM_IS_BINARY"})(Py||(Py={}));class tO extends Error{constructor(e,i){super(e);this.decodeStreamErrorKind=i}}class vx{static async create(e){let i=void 0;if(e!==Y_){const n=await import("./iconv-lite-umd-BPrln117.js").then(function(s){return s.i});i=n.getDecoder(NA(e))}else{const n=new TextDecoder;i={write(s){return n.decode(s,{stream:true})},end(){return n.decode()}}}return new vx(i)}constructor(e){this.iconvLiteDecoder=e}write(e){return this.iconvLiteDecoder.write(e)}end(){return this.iconvLiteDecoder.end()}}function iO(t,e){const i=e.minBytesRequiredForDetection??(e.guessEncoding?ZM:XM);return new Promise((n,s)=>{const r=WT(d=>d.join(""));const o=[];let a=0;let l=void 0;const c=new Tt;const u=async()=>{try{const d=await dO({buffer:ae.concat(o),bytesRead:a},e.guessEncoding,e.candidateGuessEncodings);if(d.seemsBinary&&e.acceptTextOnly){throw new tO("Stream is binary but only text is accepted for decoding",Py.STREAM_IS_BINARY)}d.encoding=await e.overwriteEncoding(d.encoding);l=await vx.create(d.encoding);const f=l.write(ae.concat(o).buffer);r.write(f);o.length=0;a=0;n({stream:r,detected:d})}catch(d){c.cancel();r.destroy();s(d)}};zT(t,{onData:async d=>{if(l){r.write(l.write(d.buffer))}else{o.push(d);a+=d.byteLength;if(a>=i){t.pause();await u();setTimeout(()=>t.resume())}}},onError:d=>r.error(d),onEnd:async()=>{if(!l){await u()}r.end(l?.end())}},c.token)})}async function nO(t,e,i){const n=await import("./iconv-lite-umd-BPrln117.js").then(function(a){return a.i});const s=n.getEncoder(NA(e),i);let r=false;let o=false;return{read(){if(o){return null}const a=t.read();if(typeof a!=="string"){o=true;if(!r&&i?.addBOM){switch(e){case Y_:case _x:return ae.wrap(Uint8Array.from(td));case s_:return ae.wrap(Uint8Array.from(yp));case r_:return ae.wrap(Uint8Array.from(Ty))}}const l=s.end();if(l&&l.length>0){r=true;return ae.wrap(l)}return null}r=true;return ae.wrap(s.write(a))}}}function NA(t){if(t===_x||t===null){return Y_}return t}function sO(t,e){if(!t||e<yp.length){return null}const i=t.readUInt8(0);const n=t.readUInt8(1);if(i===yp[0]&&n===yp[1]){return s_}if(i===Ty[0]&&n===Ty[1]){return r_}if(e<td.length){return null}const s=t.readUInt8(2);if(i===td[0]&&n===td[1]&&s===td[2]){return _x}return null}const rO=["ascii","utf-16","utf-32"];async function oO(t,e){const i=await import("./index-BwphZ2Vw.js").then(function(a){return a.i});const n=t.slice(0,eO);const s=uO(n.buffer);if(e){e=zt(e.map(a=>cO(a)));if(e.length===0){e=void 0}}let r;try{r=i.detect(s,e?{detectEncodings:e}:void 0)}catch(a){return null}if(!r?.encoding){return null}const o=r.encoding.toLowerCase();if(0<=rO.indexOf(o)){return null}return lO(r.encoding)}const aO={"ibm866":"cp866","big5":"cp950"};function MA(t){return t.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function lO(t){const e=MA(t);const i=aO[e];return i||e}function cO(t){const e=MA(t);const i=hO[e];return i?i.guessableName:void 0}function uO(t){let e="";for(let i=0;i<t.length;i++){e+=String.fromCharCode(t[i])}return e}function dO({buffer:t,bytesRead:e},i,n){let s=sO(t,e);let r=false;if(s!==s_&&s!==r_&&t){let o=true;let a=true;let l=false;for(let c=0;c<e&&c<YM;c++){const u=c%2===1;const d=t.readUInt8(c)===0;if(d){l=true}if(o&&(u&&!d||!u&&d)){o=false}if(a&&(u&&d||!u&&!d)){a=false}if(d&&!o&&!a){break}}if(l){if(o){s=r_}else if(a){s=s_}else{r=true}}}if(i&&!r&&!s&&t){return oO(t.slice(0,e),n).then(o=>{return{seemsBinary:false,encoding:o}})}return{seemsBinary:r,encoding:s}}const Kv={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:true,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},cp1125:{labelLong:"Cyrillic (CP 1125)",labelShort:"CP 1125",order:21,guessableName:"IBM1125"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:22,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:23,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:24},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:25},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:26,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:27,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:28,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:29,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:30},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:31},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:32},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:33},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:34},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:35},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:36},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:37,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:38},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:39,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:40,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:41,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:42},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:43},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:44},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:45},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:46,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:47},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:48}};const hO=(()=>{const t={};for(const e in Kv){if(Kv[e].guessableName){t[e]=Kv[e]}}return t})();var eD;(function(t){t[t["FILE_IS_BINARY"]=0]="FILE_IS_BINARY"})(eD||(eD={}));var tD;(function(t){t[t["SAVED"]=0]="SAVED";t[t["DIRTY"]=1]="DIRTY";t[t["PENDING_SAVE"]=2]="PENDING_SAVE";t[t["CONFLICT"]=3]="CONFLICT";t[t["ORPHAN"]=4]="ORPHAN";t[t["ERROR"]=5]="ERROR"})(tD||(tD={}));var iD;(function(t){t[t["EDITOR"]=1]="EDITOR";t[t["REFERENCE"]=2]="REFERENCE";t[t["OTHER"]=3]="OTHER"})(iD||(iD={}));var nD;(function(t){t[t["Encode"]=0]="Encode";t[t["Decode"]=1]="Decode"})(nD||(nD={}));function fO(t){let e=false;return{read(){if(!e){e=true;return t}return null}}}function Qh(t,e,i){return new wu(n=>o_(n,i)).isEqual(t,e)}function pO(t,e,i){return Qh(t.uri,e.uri,i)?0:rl(t.uri.toString(),e.uri.toString())}function gO(t,e,i){if(t.index!==e.index){return t.index<e.index?-1:1}return Qh(t.uri,e.uri,i)?rl(t.name,e.name):rl(t.uri.toString(),e.uri.toString())}function OA(t,e,i,n){const s=t.slice(0).sort((o,a)=>i(o,a,n));const r=e.slice(0).sort((o,a)=>i(o,a,n));return z5(s,r,(o,a)=>i(o,a,n))}function o_(t,e){const i=e.getCapabilities(t.scheme);return!(i&&i&ws.PathCaseSensitive)}class Pc extends O8{static toExtHostWorkspace(e,i,n,s){if(!e){return{workspace:null,added:[],removed:[]}}const{id:r,name:o,folders:a,configuration:l,transient:c,isUntitled:u,isAgentSessionsWorkspace:d}=e;const f=[];const p=i;if(i){a.forEach((k,S)=>{const R=b.revive(k.uri);const K=Pc._findFolder(n||i,R,s);if(K){K.name=k.name;K.index=k.index;f.push(K)}else{f.push({uri:R,name:k.name,index:S})}})}else{f.push(...a.map(({uri:k,name:S,index:R})=>({uri:b.revive(k),name:S,index:R})))}f.sort((k,S)=>k.index<S.index?-1:1);const m=new Pc(r,o,f,!!c,l?b.revive(l):null,!!u,!!d,k=>o_(k,s));const{added:v,removed:y}=OA(p?p.workspaceFolders:[],m.workspaceFolders,pO,s);return{workspace:m,added:v,removed:y}}static _findFolder(e,i,n){for(let s=0;s<e.folders.length;s++){const r=e.workspaceFolders[s];if(Qh(r.uri,i,n)){return r}}return void 0}constructor(e,i,n,s,r,o,a,l){super(e,n.map(c=>new L4(c)),s,r,l,a);this._name=i;this._isUntitled=o;this._workspaceFolders=[];this._structure=Xs.forUris(l,()=>true);n.forEach(c=>{this._workspaceFolders.push(c);this._structure.set(c.uri,c)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,i){if(i&&this._structure.get(e)){e=lf(e)}return this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let Ay=class Tz{constructor(e,i,n,s,r){this._onDidChangeWorkspace=new L;this.onDidChangeWorkspace=this._onDidChangeWorkspace.event;this._onDidGrantWorkspaceTrust=new L;this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event;this._onDidChangeWorkspaceTrustedFolders=new L;this.onDidChangeWorkspaceTrustedFolders=this._onDidChangeWorkspaceTrustedFolders.event;this._activeSearchCallbacks=[];this._trusted=false;this._editSessionIdentityProviders=new Map;this._providerHandlePool=0;this._onWillCreateEditSessionIdentityEvent=new ld;this._canonicalUriProviders=new Map;this._logService=s;this._extHostFileSystemInfo=n;this._uriTransformerService=r;this._requestIdProvider=new A8;this._barrier=new Es;this._proxy=e.getProxy(ee.MainThreadWorkspace);this._messageService=e.getProxy(ee.MainThreadMessageService);const o=i.workspace;this._confirmedWorkspace=o?new Pc(o.id,o.name,[],!!o.transient,o.configuration?b.revive(o.configuration):null,!!o.isUntitled,!!o.isAgentSessionsWorkspace,a=>o_(a,n)):void 0}$initializeWorkspace(e,i){this._trusted=i;this.$acceptWorkspaceData(e);this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get isAgentSessionsWorkspace(){return this._actualWorkspace?.isAgentSessionsWorkspace??false}get workspaceFile(){if(this._actualWorkspace){if(this._actualWorkspace.configuration){if(this._actualWorkspace.isUntitled){return b.from({scheme:ne.untitled,path:ts(lf(this._actualWorkspace.configuration))})}return this._actualWorkspace.configuration}}return void 0}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(!this._actualWorkspace){return void 0}return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){await this._barrier.wait();if(!this._actualWorkspace){return void 0}return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,i,n,...s){const r=[];if(Array.isArray(s)){s.forEach(u=>{if(b.isUri(u.uri)&&!r.some(d=>Qh(d.uri,u.uri,this._extHostFileSystemInfo))){r.push({uri:u.uri,name:u.name||F1(u.uri)})}})}if(!!this._unconfirmedWorkspace){return false}if([i,n].some(u=>typeof u!=="number"||u<0)){return false}if(n===0&&r.length===0){return false}const o=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(i+n>o.length){return false}const a=o.slice(0);a.splice(i,n,...r.map(u=>({uri:u.uri,name:u.name||F1(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const d=a[u];if(a.some((f,p)=>p!==u&&Qh(d.uri,f.uri,this._extHostFileSystemInfo))){return false}}a.forEach((u,d)=>u.index=d);const{added:l,removed:c}=OA(o,a,gO,this._extHostFileSystemInfo);if(l.length===0&&c.length===0){return false}if(this._proxy){const u=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(u,i,n,r).then(void 0,d=>{this._unconfirmedWorkspace=void 0;const f={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(gt.Error,h(2710,"Extension '{0}' failed to update workspace folders: {1}",u,d.toString()),f,[])})}this.trySetWorkspaceFolders(a);return true}getWorkspaceFolder(e,i){if(!this._actualWorkspace){return void 0}return this._actualWorkspace.getWorkspaceFolder(e,i)}async getWorkspaceFolder2(e,i){await this._barrier.wait();if(!this._actualWorkspace){return void 0}return this._actualWorkspace.getWorkspaceFolder(e,i)}async resolveWorkspaceFolder(e){await this._barrier.wait();if(!this._actualWorkspace){return void 0}return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace){return void 0}const{folders:e}=this._actualWorkspace;if(e.length===0){return void 0}return e[0].uri.fsPath}getRelativePath(e,i){let n;let s="";if(typeof e==="string"){n=b.file(e);s=e}else if(typeof e!=="undefined"){n=e;s=e.fsPath}if(!n){return s}const r=this.getWorkspaceFolder(n,true);if(!r){return s}if(typeof i==="undefined"&&this._actualWorkspace){i=this._actualWorkspace.folders.length>1}let o=v4(r.uri,n);if(i&&r.name){o=`${r.name}/${o}`}return o}trySetWorkspaceFolders(e){if(this._actualWorkspace){this._unconfirmedWorkspace=Pc.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0}}$acceptWorkspaceData(e){const{workspace:i,added:n,removed:s}=Pc.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=i||void 0;this._unconfirmedWorkspace=void 0;this._onDidChangeWorkspace.fire(Object.freeze({added:n,removed:s}))}findFiles(e,i,n,s,r=Ze.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${s.value}, entryPoint: findFiles`);let o="";let a=true;if(i===null){a=false}else if(i!==void 0){if(typeof i==="string"){o=i}else{o=i.pattern}}return this._findFilesImpl({type:"include",value:e},{exclude:[o],maxResults:n,useExcludeSettings:a?Ir.FilesExclude:Ir.None,useIgnoreFiles:{local:false}},r)}findFiles2(e,i={},n,s=Ze.None){this._logService.trace(`extHostWorkspace#findFiles2New: fileSearch, extension: ${n.value}, entryPoint: findFiles2New`);return this._findFilesImpl({type:"filePatterns",value:e},i,s)}async _findFilesImpl(e,i,n){if(n.isCancellationRequested){return Promise.resolve([])}const s=e.type==="include"?[e.value]:e.value??[];if(!Array.isArray(s)){console.error("Invalid file pattern provided",s);throw new Error(`Invalid file pattern provided ${JSON.stringify(s)}`)}const r=s.map(o=>{const a=sD(i.exclude);const l={ignoreSymlinks:typeof i.followSymlinks==="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local==="boolean"?!i.useIgnoreFiles.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global==="boolean"?!i.useIgnoreFiles.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent==="boolean"?!i.useIgnoreFiles.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===Ir.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==Ir.SearchAndFilesExclude,maxResults:i.maxResults,excludePattern:a.length>0?a:void 0,_reason:"startFileSearch",shouldGlobSearch:e.type==="include"?void 0:true};const c=Sp(gn.from(o));const u=c?.folder;if(e.type==="include"){l.includePattern=c?.pattern}else{l.filePattern=c?.pattern}return{folder:u,options:l}});return this._findFilesBase(r,n)}async _findFilesBase(e,i){const n=await Promise.all(e?.map(a=>this._proxy.$startFileSearch(a.folder??null,a.options,i).then(l=>Array.isArray(l)?l.map(c=>b.revive(c)):[]))??[]);const s=n.flat();const r=new wu(a=>o_(a,this._extHostFileSystemInfo));const o=new Map;for(const a of s){const l=r.getComparisonKey(a);if(!o.has(l)){o.set(l,a)}}return Array.from(o.values())}findTextInFiles2(e,i,n,s=Ze.None){this._logService.trace(`extHostWorkspace#findTextInFiles2: textSearch, extension: ${n.value}, entryPoint: findTextInFiles2`);const r=f=>{if(!i){return{folder:void 0,options:{}}}const p=f?Sp(gn.from(f)):void 0;const m=i.exclude?sD(i.exclude):void 0;return{options:{ignoreSymlinks:typeof i.followSymlinks==="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local==="boolean"?!i.useIgnoreFiles?.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global==="boolean"?!i.useIgnoreFiles?.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent==="boolean"?!i.useIgnoreFiles?.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===Ir.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==Ir.SearchAndFilesExclude,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:i.previewOptions?{matchLines:i.previewOptions?.numMatchLines??100,charsPerLine:i.previewOptions?.charsPerLine??1e4}:void 0,surroundingContext:i.surroundingContext,includePattern:p?.pattern,excludePattern:m},folder:p?.folder}};const o=i?.include?.map(f=>r(f))??[r(void 0)];const a=o.filter(f=>!!f);const l=new pe;const c=l.add(new L);const u=this.findTextInFilesBase(e,a,(f,p)=>c.fire({result:f,uri:p}),s);const d=new Yi(async f=>{l.add(c.event(p=>{const m=p.result;const v=p.uri;if(Gk(m)){f.emitOne(new Do(v,m.rangeLocations.map(y=>({previewRange:new Fe(y.preview.startLineNumber,y.preview.startColumn,y.preview.endLineNumber,y.preview.endColumn),sourceRange:new Fe(y.source.startLineNumber,y.source.startColumn,y.source.endLineNumber,y.source.endColumn)})),m.previewText))}else{f.emitOne(new mx(v,m.text,m.lineNumber))}}));await u});return{results:d,complete:u.then(f=>{l.dispose();return{limitHit:f?.limitHit??false}})}}async findTextInFilesBase(e,i,n,s=Ze.None){const r=this._requestIdProvider.getNext();let o=false;s.onCancellationRequested(a=>{o=true});this._activeSearchCallbacks[r]=a=>{if(o){return}const l=b.revive(a.resource);a.results.forEach(c=>{const u=Wi(c);n(u,l)})};if(s.isCancellationRequested){return{}}try{const a=await Promise.all(i?.map(l=>this._proxy.$startTextSearch(e,l.folder??null,l.options,r,s)||{})??[]);delete this._activeSearchCallbacks[r];return a.reduce((l,c)=>{return{limitHit:l?.limitHit||(c?.limitHit??false),message:[l?.message??[],c?.message??[]].flat()}},{})??{limitHit:false}}catch(a){delete this._activeSearchCallbacks[r];throw a}}async findTextInFiles(e,i,n,s,r=Ze.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${s.value}, entryPoint: findTextInFiles`);const o=typeof i.previewOptions==="undefined"?{matchLines:100,charsPerLine:1e4}:i.previewOptions;const a=Sp(gn.from(i.include));const l=typeof i.exclude==="string"?i.exclude:i.exclude?i.exclude.pattern:void 0;const c={ignoreSymlinks:typeof i.followSymlinks==="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles==="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles==="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles==="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes==="boolean"?!i.useDefaultExcludes:true,disregardSearchExcludeSettings:typeof i.useSearchExclude==="boolean"?!i.useSearchExclude:true,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:o,surroundingContext:i.afterContext,includePattern:a?.pattern,excludePattern:l?[{pattern:l}]:void 0};const u=(d,f)=>{if(Gk(d)){n({uri:f,preview:{text:d.previewText,matches:E1(d.rangeLocations,p=>new Fe(p.preview.startLineNumber,p.preview.startColumn,p.preview.endLineNumber,p.preview.endColumn))},ranges:E1(d.rangeLocations,p=>new Fe(p.source.startLineNumber,p.source.startColumn,p.source.endLineNumber,p.source.endColumn))})}else{n({uri:f,text:d.text,lineNumber:d.lineNumber})}};return this.findTextInFilesBase(e,[{options:c,folder:a?.folder}],u,r)}$handleTextSearchResult(e,i){this._activeSearchCallbacks[i]?.(e)}async save(e){const i=await this._proxy.$save(e,{saveAs:false});return b.revive(i)}async saveAs(e){const i=await this._proxy.$save(e,{saveAs:true});return b.revive(i)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}lookupAuthorization(e){return this._proxy.$lookupAuthorization(e)}lookupKerberosAuthorization(e){return this._proxy.$lookupKerberosAuthorization(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestResourceTrust(e){return this._proxy.$requestResourceTrust(e)}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){if(!this._trusted){this._trusted=true;this._onDidGrantWorkspaceTrust.fire()}}$onDidChangeWorkspaceTrustedFolders(){this._onDidChangeWorkspaceTrustedFolders.fire()}isResourceTrusted(e){return this._proxy.$isResourceTrusted(e)}registerEditSessionIdentityProvider(e,i){if(this._editSessionIdentityProviders.has(e)){throw new Error(`A provider has already been registered for scheme ${e}`)}this._editSessionIdentityProviders.set(e,i);const n=this._uriTransformerService.transformOutgoingScheme(e);const s=this._providerHandlePool++;this._proxy.$registerEditSessionIdentityProvider(s,n);return ye(()=>{this._editSessionIdentityProviders.delete(e);this._proxy.$unregisterEditSessionIdentityProvider(s)})}async $getEditSessionIdentifier(e,i){this._logService.info("Getting edit session identifier for workspaceFolder",e);const n=await this.resolveWorkspaceFolder(b.revive(e));if(!n){this._logService.warn("Unable to resolve workspace folder");return void 0}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",n);const s=this._editSessionIdentityProviders.get(n.uri.scheme);this._logService.info(`Provider for scheme ${n.uri.scheme} is defined: `,!!s);if(!s){return void 0}const r=await s.provideEditSessionIdentity(n,i);this._logService.info("Provider returned edit session identifier: ",r);if(!r){return void 0}return r}async $provideEditSessionIdentityMatch(e,i,n,s){this._logService.info("Getting edit session identifier for workspaceFolder",e);const r=await this.resolveWorkspaceFolder(b.revive(e));if(!r){this._logService.warn("Unable to resolve workspace folder");return void 0}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",r);const o=this._editSessionIdentityProviders.get(r.uri.scheme);this._logService.info(`Provider for scheme ${r.uri.scheme} is defined: `,!!o);if(!o){return void 0}const a=await o.provideEditSessionIdentityMatch?.(i,n,s);this._logService.info("Provider returned edit session identifier match result: ",a);if(!a){return void 0}return a}getOnWillCreateEditSessionIdentityEvent(e){return(i,n,s)=>{const r=function o(a){i.call(n,a)};r.extension=e;return this._onWillCreateEditSessionIdentityEvent.event(r,void 0,s)}}async $onWillCreateEditSessionIdentity(e,i,n){const s=await this.resolveWorkspaceFolder(b.revive(e));if(s===void 0){throw new Error("Unable to resolve workspace folder")}await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:s},i,async(r,o)=>{const a=Date.now();await Promise.resolve(r);if(Date.now()-a>n){this._logService.warn("SLOW edit session create-participant",o.extension.identifier)}});if(i.isCancellationRequested){return void 0}}registerCanonicalUriProvider(e,i){if(this._canonicalUriProviders.has(e)){throw new Error(`A provider has already been registered for scheme ${e}`)}this._canonicalUriProviders.set(e,i);const n=this._uriTransformerService.transformOutgoingScheme(e);const s=this._providerHandlePool++;this._proxy.$registerCanonicalUriProvider(s,n);return ye(()=>{this._canonicalUriProviders.delete(e);this._proxy.$unregisterCanonicalUriProvider(s)})}async provideCanonicalUri(e,i,n){const s=this._canonicalUriProviders.get(e.scheme);if(!s){return void 0}const r=await s.provideCanonicalUri?.(b.revive(e),i,n);if(!r){return void 0}return r}async $provideCanonicalUri(e,i,n){return this.provideCanonicalUri(b.revive(e),{targetScheme:i},n)}async decode(e,i){const[n,s]=this.toEncodeDecodeParameters(i);const r=await this._proxy.$resolveDecoding(n,s);const o=(await iO(SR(ae.wrap(e)),{...r,acceptTextOnly:true,overwriteEncoding:a=>{if(a===null||a===r.preferredEncoding){return Promise.resolve(r.preferredEncoding)}return this._proxy.$validateDetectedEncoding(n,a,s)}})).stream;return VT(o,a=>a.join(""))}async encode(e,i){const[n,s]=this.toEncodeDecodeParameters(i);const{encoding:r,addBOM:o}=await this._proxy.$resolveEncoding(n,s);if(r===Y_&&!o){return ae.fromString(e).buffer}const a=await nO(fO(e),r,{addBOM:o});return bR(a).buffer}toEncodeDecodeParameters(e){const i=$p(e?.uri)?e.uri:void 0;const n=typeof e?.encoding==="string"?e.encoding:void 0;return[i,n?{encoding:n}:void 0]}};Ay=W([P(0,st),P(1,wi),P(2,bu),P(3,et),P(4,P_)],Ay);const ur=te("IExtHostWorkspace");function Sp(t){let e;let i;if(t){if(typeof t==="string"){e=t}else{e=t.pattern;i=b.revive(t.baseUri)}return{pattern:e,folder:i}}return void 0}function sD(t){return(t?.map(e=>{if(typeof e==="string"){if(e===""){return void 0}return{pattern:e,uri:void 0}}else{const i=Sp(e);if(!i){return void 0}return{pattern:i.pattern,uri:i.folder}}})??[]).filter(e=>!!e)}var yi;(function(t){t[t["None"]=0]="None";t[t["UnexpectedEndOfComment"]=1]="UnexpectedEndOfComment";t[t["UnexpectedEndOfString"]=2]="UnexpectedEndOfString";t[t["UnexpectedEndOfNumber"]=3]="UnexpectedEndOfNumber";t[t["InvalidUnicode"]=4]="InvalidUnicode";t[t["InvalidEscapeCharacter"]=5]="InvalidEscapeCharacter";t[t["InvalidCharacter"]=6]="InvalidCharacter"})(yi||(yi={}));var Se;(function(t){t[t["OpenBraceToken"]=1]="OpenBraceToken";t[t["CloseBraceToken"]=2]="CloseBraceToken";t[t["OpenBracketToken"]=3]="OpenBracketToken";t[t["CloseBracketToken"]=4]="CloseBracketToken";t[t["CommaToken"]=5]="CommaToken";t[t["ColonToken"]=6]="ColonToken";t[t["NullKeyword"]=7]="NullKeyword";t[t["TrueKeyword"]=8]="TrueKeyword";t[t["FalseKeyword"]=9]="FalseKeyword";t[t["StringLiteral"]=10]="StringLiteral";t[t["NumericLiteral"]=11]="NumericLiteral";t[t["LineCommentTrivia"]=12]="LineCommentTrivia";t[t["BlockCommentTrivia"]=13]="BlockCommentTrivia";t[t["LineBreakTrivia"]=14]="LineBreakTrivia";t[t["Trivia"]=15]="Trivia";t[t["Unknown"]=16]="Unknown";t[t["EOF"]=17]="EOF"})(Se||(Se={}));var Bt;(function(t){t[t["InvalidSymbol"]=1]="InvalidSymbol";t[t["InvalidNumberFormat"]=2]="InvalidNumberFormat";t[t["PropertyNameExpected"]=3]="PropertyNameExpected";t[t["ValueExpected"]=4]="ValueExpected";t[t["ColonExpected"]=5]="ColonExpected";t[t["CommaExpected"]=6]="CommaExpected";t[t["CloseBraceExpected"]=7]="CloseBraceExpected";t[t["CloseBracketExpected"]=8]="CloseBracketExpected";t[t["EndOfFileExpected"]=9]="EndOfFileExpected";t[t["InvalidCommentToken"]=10]="InvalidCommentToken";t[t["UnexpectedEndOfComment"]=11]="UnexpectedEndOfComment";t[t["UnexpectedEndOfString"]=12]="UnexpectedEndOfString";t[t["UnexpectedEndOfNumber"]=13]="UnexpectedEndOfNumber";t[t["InvalidUnicode"]=14]="InvalidUnicode";t[t["InvalidEscapeCharacter"]=15]="InvalidEscapeCharacter";t[t["InvalidCharacter"]=16]="InvalidCharacter"})(Bt||(Bt={}));var Ry;(function(t){t.DEFAULT={allowTrailingComma:true}})(Ry||(Ry={}));function mO(t,e=false){let i=0;const n=t.length;let s="";let r=0;let o=Se.Unknown;let a=yi.None;function l(v){let y=0;let k=0;while(y<v){const S=t.charCodeAt(i);if(S>=he._0&&S<=he._9){k=k*16+S-he._0}else if(S>=he.A&&S<=he.F){k=k*16+S-he.A+10}else if(S>=he.a&&S<=he.f){k=k*16+S-he.a+10}else{break}i++;y++}if(y<v){k=-1}return k}function c(v){i=v;s="";r=0;o=Se.Unknown;a=yi.None}function u(){const v=i;if(t.charCodeAt(i)===he._0){i++}else{i++;while(i<t.length&&Ol(t.charCodeAt(i))){i++}}if(i<t.length&&t.charCodeAt(i)===he.dot){i++;if(i<t.length&&Ol(t.charCodeAt(i))){i++;while(i<t.length&&Ol(t.charCodeAt(i))){i++}}else{a=yi.UnexpectedEndOfNumber;return t.substring(v,i)}}let y=i;if(i<t.length&&(t.charCodeAt(i)===he.E||t.charCodeAt(i)===he.e)){i++;if(i<t.length&&t.charCodeAt(i)===he.plus||t.charCodeAt(i)===he.minus){i++}if(i<t.length&&Ol(t.charCodeAt(i))){i++;while(i<t.length&&Ol(t.charCodeAt(i))){i++}y=i}else{a=yi.UnexpectedEndOfNumber}}return t.substring(v,y)}function d(){let v="",y=i;while(true){if(i>=n){v+=t.substring(y,i);a=yi.UnexpectedEndOfString;break}const k=t.charCodeAt(i);if(k===he.doubleQuote){v+=t.substring(y,i);i++;break}if(k===he.backslash){v+=t.substring(y,i);i++;if(i>=n){a=yi.UnexpectedEndOfString;break}const S=t.charCodeAt(i++);switch(S){case he.doubleQuote:v+='"';break;case he.backslash:v+="\\";break;case he.slash:v+="/";break;case he.b:v+="\b";break;case he.f:v+="\f";break;case he.n:v+="\n";break;case he.r:v+="\r";break;case he.t:v+="	";break;case he.u:{const R=l(4);if(R>=0){v+=String.fromCharCode(R)}else{a=yi.InvalidUnicode}break}default:a=yi.InvalidEscapeCharacter}y=i;continue}if(k>=0&&k<=31){if(Nf(k)){v+=t.substring(y,i);a=yi.UnexpectedEndOfString;break}else{a=yi.InvalidCharacter}}i++}return v}function f(){s="";a=yi.None;r=i;if(i>=n){r=n;return o=Se.EOF}let v=t.charCodeAt(i);if(Qv(v)){do{i++;s+=String.fromCharCode(v);v=t.charCodeAt(i)}while(Qv(v));return o=Se.Trivia}if(Nf(v)){i++;s+=String.fromCharCode(v);if(v===he.carriageReturn&&t.charCodeAt(i)===he.lineFeed){i++;s+="\n"}return o=Se.LineBreakTrivia}switch(v){case he.openBrace:i++;return o=Se.OpenBraceToken;case he.closeBrace:i++;return o=Se.CloseBraceToken;case he.openBracket:i++;return o=Se.OpenBracketToken;case he.closeBracket:i++;return o=Se.CloseBracketToken;case he.colon:i++;return o=Se.ColonToken;case he.comma:i++;return o=Se.CommaToken;case he.doubleQuote:i++;s=d();return o=Se.StringLiteral;case he.slash:{const y=i-1;if(t.charCodeAt(i+1)===he.slash){i+=2;while(i<n){if(Nf(t.charCodeAt(i))){break}i++}s=t.substring(y,i);return o=Se.LineCommentTrivia}if(t.charCodeAt(i+1)===he.asterisk){i+=2;const k=n-1;let S=false;while(i<k){const R=t.charCodeAt(i);if(R===he.asterisk&&t.charCodeAt(i+1)===he.slash){i+=2;S=true;break}i++}if(!S){i++;a=yi.UnexpectedEndOfComment}s=t.substring(y,i);return o=Se.BlockCommentTrivia}s+=String.fromCharCode(v);i++;return o=Se.Unknown}case he.minus:s+=String.fromCharCode(v);i++;if(i===n||!Ol(t.charCodeAt(i))){return o=Se.Unknown}case he._0:case he._1:case he._2:case he._3:case he._4:case he._5:case he._6:case he._7:case he._8:case he._9:s+=u();return o=Se.NumericLiteral;default:while(i<n&&p(v)){i++;v=t.charCodeAt(i)}if(r!==i){s=t.substring(r,i);switch(s){case"true":return o=Se.TrueKeyword;case"false":return o=Se.FalseKeyword;case"null":return o=Se.NullKeyword}return o=Se.Unknown}s+=String.fromCharCode(v);i++;return o=Se.Unknown}}function p(v){if(Qv(v)||Nf(v)){return false}switch(v){case he.closeBrace:case he.closeBracket:case he.openBrace:case he.openBracket:case he.doubleQuote:case he.colon:case he.comma:case he.slash:return false}return true}function m(){let v;do{v=f()}while(v>=Se.LineCommentTrivia&&v<=Se.Trivia);return v}return{setPosition:c,getPosition:()=>i,scan:e?m:f,getToken:()=>o,getTokenValue:()=>s,getTokenOffset:()=>r,getTokenLength:()=>i-r,getTokenError:()=>a}}function Qv(t){return t===he.space||t===he.tab||t===he.verticalTab||t===he.formFeed||t===he.nonBreakingSpace||t===he.ogham||t>=he.enQuad&&t<=he.zeroWidthSpace||t===he.narrowNoBreakSpace||t===he.mathematicalSpace||t===he.ideographicSpace||t===he.byteOrderMark}function Nf(t){return t===he.lineFeed||t===he.carriageReturn||t===he.lineSeparator||t===he.paragraphSeparator}function Ol(t){return t>=he._0&&t<=he._9}var he;(function(t){t[t["nullCharacter"]=0]="nullCharacter";t[t["maxAsciiCharacter"]=127]="maxAsciiCharacter";t[t["lineFeed"]=10]="lineFeed";t[t["carriageReturn"]=13]="carriageReturn";t[t["lineSeparator"]=8232]="lineSeparator";t[t["paragraphSeparator"]=8233]="paragraphSeparator";t[t["nextLine"]=133]="nextLine";t[t["space"]=32]="space";t[t["nonBreakingSpace"]=160]="nonBreakingSpace";t[t["enQuad"]=8192]="enQuad";t[t["emQuad"]=8193]="emQuad";t[t["enSpace"]=8194]="enSpace";t[t["emSpace"]=8195]="emSpace";t[t["threePerEmSpace"]=8196]="threePerEmSpace";t[t["fourPerEmSpace"]=8197]="fourPerEmSpace";t[t["sixPerEmSpace"]=8198]="sixPerEmSpace";t[t["figureSpace"]=8199]="figureSpace";t[t["punctuationSpace"]=8200]="punctuationSpace";t[t["thinSpace"]=8201]="thinSpace";t[t["hairSpace"]=8202]="hairSpace";t[t["zeroWidthSpace"]=8203]="zeroWidthSpace";t[t["narrowNoBreakSpace"]=8239]="narrowNoBreakSpace";t[t["ideographicSpace"]=12288]="ideographicSpace";t[t["mathematicalSpace"]=8287]="mathematicalSpace";t[t["ogham"]=5760]="ogham";t[t["_"]=95]="_";t[t["$"]=36]="$";t[t["_0"]=48]="_0";t[t["_1"]=49]="_1";t[t["_2"]=50]="_2";t[t["_3"]=51]="_3";t[t["_4"]=52]="_4";t[t["_5"]=53]="_5";t[t["_6"]=54]="_6";t[t["_7"]=55]="_7";t[t["_8"]=56]="_8";t[t["_9"]=57]="_9";t[t["a"]=97]="a";t[t["b"]=98]="b";t[t["c"]=99]="c";t[t["d"]=100]="d";t[t["e"]=101]="e";t[t["f"]=102]="f";t[t["g"]=103]="g";t[t["h"]=104]="h";t[t["i"]=105]="i";t[t["j"]=106]="j";t[t["k"]=107]="k";t[t["l"]=108]="l";t[t["m"]=109]="m";t[t["n"]=110]="n";t[t["o"]=111]="o";t[t["p"]=112]="p";t[t["q"]=113]="q";t[t["r"]=114]="r";t[t["s"]=115]="s";t[t["t"]=116]="t";t[t["u"]=117]="u";t[t["v"]=118]="v";t[t["w"]=119]="w";t[t["x"]=120]="x";t[t["y"]=121]="y";t[t["z"]=122]="z";t[t["A"]=65]="A";t[t["B"]=66]="B";t[t["C"]=67]="C";t[t["D"]=68]="D";t[t["E"]=69]="E";t[t["F"]=70]="F";t[t["G"]=71]="G";t[t["H"]=72]="H";t[t["I"]=73]="I";t[t["J"]=74]="J";t[t["K"]=75]="K";t[t["L"]=76]="L";t[t["M"]=77]="M";t[t["N"]=78]="N";t[t["O"]=79]="O";t[t["P"]=80]="P";t[t["Q"]=81]="Q";t[t["R"]=82]="R";t[t["S"]=83]="S";t[t["T"]=84]="T";t[t["U"]=85]="U";t[t["V"]=86]="V";t[t["W"]=87]="W";t[t["X"]=88]="X";t[t["Y"]=89]="Y";t[t["Z"]=90]="Z";t[t["ampersand"]=38]="ampersand";t[t["asterisk"]=42]="asterisk";t[t["at"]=64]="at";t[t["backslash"]=92]="backslash";t[t["bar"]=124]="bar";t[t["caret"]=94]="caret";t[t["closeBrace"]=125]="closeBrace";t[t["closeBracket"]=93]="closeBracket";t[t["closeParen"]=41]="closeParen";t[t["colon"]=58]="colon";t[t["comma"]=44]="comma";t[t["dot"]=46]="dot";t[t["doubleQuote"]=34]="doubleQuote";t[t["equals"]=61]="equals";t[t["exclamation"]=33]="exclamation";t[t["greaterThan"]=62]="greaterThan";t[t["lessThan"]=60]="lessThan";t[t["minus"]=45]="minus";t[t["openBrace"]=123]="openBrace";t[t["openBracket"]=91]="openBracket";t[t["openParen"]=40]="openParen";t[t["percent"]=37]="percent";t[t["plus"]=43]="plus";t[t["question"]=63]="question";t[t["semicolon"]=59]="semicolon";t[t["singleQuote"]=39]="singleQuote";t[t["slash"]=47]="slash";t[t["tilde"]=126]="tilde";t[t["backspace"]=8]="backspace";t[t["formFeed"]=12]="formFeed";t[t["byteOrderMark"]=65279]="byteOrderMark";t[t["tab"]=9]="tab";t[t["verticalTab"]=11]="verticalTab"})(he||(he={}));function _O(t,e,i=Ry.DEFAULT){const n=mO(t,false);function s(le){return le?()=>le(n.getTokenOffset(),n.getTokenLength()):()=>true}function r(le){return le?Re=>le(Re,n.getTokenOffset(),n.getTokenLength()):()=>true}const o=s(e.onObjectBegin),a=r(e.onObjectProperty),l=s(e.onObjectEnd),c=s(e.onArrayBegin),u=s(e.onArrayEnd),d=r(e.onLiteralValue),f=r(e.onSeparator),p=s(e.onComment),m=r(e.onError);const v=i&&i.disallowComments;const y=i&&i.allowTrailingComma;function k(){while(true){const le=n.scan();switch(n.getTokenError()){case yi.InvalidUnicode:S(Bt.InvalidUnicode);break;case yi.InvalidEscapeCharacter:S(Bt.InvalidEscapeCharacter);break;case yi.UnexpectedEndOfNumber:S(Bt.UnexpectedEndOfNumber);break;case yi.UnexpectedEndOfComment:if(!v){S(Bt.UnexpectedEndOfComment)}break;case yi.UnexpectedEndOfString:S(Bt.UnexpectedEndOfString);break;case yi.InvalidCharacter:S(Bt.InvalidCharacter);break}switch(le){case Se.LineCommentTrivia:case Se.BlockCommentTrivia:if(v){S(Bt.InvalidCommentToken)}else{p()}break;case Se.Unknown:S(Bt.InvalidSymbol);break;case Se.Trivia:case Se.LineBreakTrivia:break;default:return le}}}function S(le,Re=[],Ne=[]){m(le);if(Re.length+Ne.length>0){let He=n.getToken();while(He!==Se.EOF){if(Re.indexOf(He)!==-1){k();break}else if(Ne.indexOf(He)!==-1){break}He=k()}}}function R(le){const Re=n.getTokenValue();if(le){d(Re)}else{a(Re)}k();return true}function K(){switch(n.getToken()){case Se.NumericLiteral:{let le=0;try{le=JSON.parse(n.getTokenValue());if(typeof le!=="number"){S(Bt.InvalidNumberFormat);le=0}}catch(Re){S(Bt.InvalidNumberFormat)}d(le);break}case Se.NullKeyword:d(null);break;case Se.TrueKeyword:d(true);break;case Se.FalseKeyword:d(false);break;default:return false}k();return true}function q(){if(n.getToken()!==Se.StringLiteral){S(Bt.PropertyNameExpected,[],[Se.CloseBraceToken,Se.CommaToken]);return false}R(false);if(n.getToken()===Se.ColonToken){f(":");k();if(!Q()){S(Bt.ValueExpected,[],[Se.CloseBraceToken,Se.CommaToken])}}else{S(Bt.ColonExpected,[],[Se.CloseBraceToken,Se.CommaToken])}return true}function se(){o();k();let le=false;while(n.getToken()!==Se.CloseBraceToken&&n.getToken()!==Se.EOF){if(n.getToken()===Se.CommaToken){if(!le){S(Bt.ValueExpected,[],[])}f(",");k();if(n.getToken()===Se.CloseBraceToken&&y){break}}else if(le){S(Bt.CommaExpected,[],[])}if(!q()){S(Bt.ValueExpected,[],[Se.CloseBraceToken,Se.CommaToken])}le=true}l();if(n.getToken()!==Se.CloseBraceToken){S(Bt.CloseBraceExpected,[Se.CloseBraceToken],[])}else{k()}return true}function j(){c();k();let le=false;while(n.getToken()!==Se.CloseBracketToken&&n.getToken()!==Se.EOF){if(n.getToken()===Se.CommaToken){if(!le){S(Bt.ValueExpected,[],[])}f(",");k();if(n.getToken()===Se.CloseBracketToken&&y){break}}else if(le){S(Bt.CommaExpected,[],[])}if(!Q()){S(Bt.ValueExpected,[],[Se.CloseBracketToken,Se.CommaToken])}le=true}u();if(n.getToken()!==Se.CloseBracketToken){S(Bt.CloseBracketExpected,[Se.CloseBracketToken],[])}else{k()}return true}function Q(){switch(n.getToken()){case Se.OpenBracketToken:return j();case Se.OpenBraceToken:return se();case Se.StringLiteral:return R(true);default:return K()}}k();if(n.getToken()===Se.EOF){if(i.allowEmptyContent){return true}S(Bt.ValueExpected,[],[]);return false}if(!Q()){S(Bt.ValueExpected,[],[]);return false}if(n.getToken()!==Se.EOF){S(Bt.EndOfFileExpected,[],[])}return true}function id(t){return Object.isFrozen(t)?t:H1(t)}class Cn{static createEmptyModel(e){return new Cn({},[],[],void 0,e)}constructor(e,i,n,s,r){this._contents=e;this._keys=i;this._overrides=n;this._raw=s;this.logService=r;this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration){if(this._raw){const e=(Array.isArray(this._raw)?this._raw:[this._raw]).map(i=>{if(i instanceof Cn){return i}const n=new vO("",this.logService);n.parseRaw(i);return n.configurationModel});this._rawConfiguration=e.reduce((i,n)=>n===i?n:i.merge(n),e[0])}else{this._rawConfiguration=this}}return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}get raw(){if(!this._raw){return void 0}if(Array.isArray(this._raw)&&this._raw.every(e=>e instanceof Cn)){return void 0}return this._raw}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?hg(this.contents,e):this.contents}inspect(e,i){const n=this;return{get value(){return id(n.rawConfiguration.getValue(e))},get override(){return i?id(n.rawConfiguration.getOverrideValue(e,i)):void 0},get merged(){return id(i?n.rawConfiguration.override(i).getValue(e):n.rawConfiguration.getValue(e))},get overrides(){const s=[];for(const{contents:r,identifiers:o,keys:a}of n.rawConfiguration.overrides){const l=new Cn(r,a,[],void 0,n.logService).getValue(e);if(l!==void 0){s.push({identifiers:o,value:l})}}return s.length?id(s):void 0}}}getOverrideValue(e,i){const n=this.getContentsForOverrideIdentifer(i);return n?e?hg(n,e):n:void 0}getKeysForOverrideIdentifier(e){const i=[];for(const n of this.overrides){if(n.identifiers.includes(e)){i.push(...n.keys)}}return Ea(i)}getAllOverrideIdentifiers(){const e=[];for(const i of this.overrides){e.push(...i.identifiers)}return Ea(e)}override(e){let i=this.overrideConfigurations.get(e);if(!i){i=this.createOverrideConfigurationModel(e);this.overrideConfigurations.set(e,i)}return i}merge(...e){const i=Pt(this.contents);const n=Pt(this.overrides);const s=[...this.keys];const r=this._raw?Array.isArray(this._raw)?[...this._raw]:[this._raw]:[this];for(const o of e){r.push(...o._raw?Array.isArray(o._raw)?o._raw:[o._raw]:[o]);if(o.isEmpty()){continue}this.mergeContents(i,o.contents);for(const a of o.overrides){const[l]=n.filter(c=>mn(c.identifiers,a.identifiers));if(l){this.mergeContents(l.contents,a.contents);l.keys.push(...a.keys);l.keys=Ea(l.keys)}else{n.push(Pt(a))}}for(const a of o.keys){if(s.indexOf(a)===-1){s.push(a)}}}return new Cn(i,s,n,!r.length||r.every(o=>o instanceof Cn)?void 0:r,this.logService)}createOverrideConfigurationModel(e){const i=this.getContentsForOverrideIdentifer(e);if(!i||typeof i!=="object"||!Object.keys(i).length){return this}const n={};for(const s of Ea([...Object.keys(this.contents),...Object.keys(i)])){let r=this.contents[s];const o=i[s];if(o){if(typeof r==="object"&&typeof o==="object"){r=Pt(r);this.mergeContents(r,o)}else{r=o}}n[s]=r}return new Cn(n,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,i){for(const n of Object.keys(i)){if(n in e){if(Gt(e[n])&&Gt(i[n])){this.mergeContents(e[n],i[n]);continue}}e[n]=Pt(i[n])}}getContentsForOverrideIdentifer(e){let i=null;let n=null;const s=r=>{if(r){if(n){this.mergeContents(n,r)}else{n=Pt(r)}}};for(const r of this.overrides){if(r.identifiers.length===1&&r.identifiers[0]===e){i=r.contents}else if(r.identifiers.includes(e)){s(r.contents)}}s(i);return n}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,i){this.updateValue(e,i,true)}setValue(e,i){this.updateValue(e,i,false)}removeValue(e){const i=this.keys.indexOf(e);if(i===-1){return}this.keys.splice(i,1);E3(this.contents,e);if(sr.test(e)){this.overrides.splice(this.overrides.findIndex(n=>mn(n.identifiers,eh(e))),1)}}updateValue(e,i,n){TP(this.contents,e,i,s=>this.logService.error(s));n=n||this.keys.indexOf(e)===-1;if(n){this.keys.push(e)}if(sr.test(e)){const s=this.contents[e];const r=eh(e);const o={identifiers:r,keys:Object.keys(s),contents:lw(s,l=>this.logService.error(l))};const a=this.overrides.findIndex(l=>mn(l.identifiers,r));if(a!==-1){this.overrides[a]=o}else{this.overrides.push(o)}}}}class vO{constructor(e,i){this._name=e;this.logService=i;this._raw=null;this._configurationModel=null;this._restrictedConfigurations=[];this._parseErrors=[]}get configurationModel(){return this._configurationModel||Cn.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,i){if(!ai(e)){const n=this.doParseContent(e);this.parseRaw(n,i)}}reparse(e){if(this._raw){this.parseRaw(this._raw,e)}}parseRaw(e,i){this._raw=e;const{contents:n,keys:s,overrides:r,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,i);this._configurationModel=new Cn(n,s,r,a?[e]:void 0,this.logService);this._restrictedConfigurations=o||[]}doParseContent(e){let i={};let n=null;let s=[];const r=[];function o(l){if(Array.isArray(s)){s.push(l)}else if(n!==null){s[n]=l}}const a={onObjectBegin:()=>{const l={};o(l);r.push(s);s=l;n=null},onObjectProperty:l=>{n=l},onObjectEnd:()=>{s=r.pop()},onArrayBegin:()=>{const l=[];o(l);r.push(s);s=l;n=null},onArrayEnd:()=>{s=r.pop()},onLiteralValue:o,onError:(l,c,u)=>{}};if(e){try{_O(e,a);i=s[0]||{}}catch(l){this.logService.error(`Error while parsing settings file ${this._name}: ${l}`);this._parseErrors=[l]}}return i}doParseRaw(e,i){const n=ei.as(Yo.Configuration);const s=n.getConfigurationProperties();const r=n.getExcludedConfigurationProperties();const o=this.filter(e,s,r,true,i);e=o.raw;const a=lw(e,u=>this.logService.error(`Conflict in settings file ${this._name}: ${u}`));const l=Object.keys(e);const c=this.toOverrides(e,u=>this.logService.error(`Conflict in settings file ${this._name}: ${u}`));return{contents:a,keys:l,overrides:c,restricted:o.restricted,hasExcludedProperties:o.hasExcludedProperties}}filter(e,i,n,s,r){let o=false;if(!r?.scopes&&!r?.skipRestricted&&!r?.skipUnregistered&&!r?.exclude?.length){return{raw:e,restricted:[],hasExcludedProperties:o}}const a={};const l=[];for(const c in e){if(sr.test(c)&&s){const u=this.filter(e[c],i,n,false,r);a[c]=u.raw;o=o||u.hasExcludedProperties;l.push(...u.restricted)}else{const u=i[c];if(u?.restricted){l.push(c)}if(this.shouldInclude(c,u,n,r)){a[c]=e[c]}else{o=true}}}return{raw:a,restricted:l,hasExcludedProperties:o}}shouldInclude(e,i,n,s){if(s.exclude?.includes(e)){return false}if(s.include?.includes(e)){return true}if(s.skipRestricted&&i?.restricted){return false}if(s.skipUnregistered&&!i){return false}const r=i??n[e];const o=r?typeof r.scope!=="undefined"?r.scope:At.WINDOW:void 0;if(o===void 0||s.scopes===void 0){return true}return s.scopes.includes(o)}toOverrides(e,i){const n=[];for(const s of Object.keys(e)){if(sr.test(s)){const r={};const o=e[s];for(const a in o){r[a]=o[a]}n.push({identifiers:eh(s),keys:Object.keys(r),contents:lw(r,i)})}}return n}}class wO{constructor(e,i,n,s,r,o,a,l,c,u,d,f,p){this.key=e;this.overrides=i;this._value=n;this.overrideIdentifiers=s;this.defaultConfiguration=r;this.policyConfiguration=o;this.applicationConfiguration=a;this.userConfiguration=l;this.localUserConfiguration=c;this.remoteUserConfiguration=u;this.workspaceConfiguration=d;this.folderConfigurationModel=f;this.memoryConfigurationModel=p}get value(){return id(this._value)}toInspectValue(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get defaultInspectValue(){if(!this._defaultInspectValue){this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)}return this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){if(this._policyInspectValue===void 0){this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null}return this._policyInspectValue}get policyValue(){return this.policyInspectValue?.merged}get policy(){return this.policyInspectValue?.value!==void 0?{value:this.policyInspectValue.value}:void 0}get applicationInspectValue(){if(this._applicationInspectValue===void 0){this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null}return this._applicationInspectValue}get applicationValue(){return this.applicationInspectValue?.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){if(!this._userInspectValue){this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)}return this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){if(!this._userLocalInspectValue){this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)}return this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){if(!this._userRemoteInspectValue){this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)}return this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){if(this._workspaceInspectValue===void 0){this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null}return this._workspaceInspectValue}get workspaceValue(){return this.workspaceInspectValue?.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){if(this._workspaceFolderInspectValue===void 0){this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null}return this._workspaceFolderInspectValue}get workspaceFolderValue(){return this.workspaceFolderInspectValue?.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){if(this._memoryInspectValue===void 0){this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)}return this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}}let Ly=class FA{constructor(e,i,n,s,r,o,a,l,c,u){this._defaultConfiguration=e;this._policyConfiguration=i;this._applicationConfiguration=n;this._localUserConfiguration=s;this._remoteUserConfiguration=r;this._workspaceConfiguration=o;this._folderConfigurations=a;this._memoryConfiguration=l;this._memoryConfigurationByResource=c;this.logService=u;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations=new It;this._userConfiguration=null}getValue(e,i,n){const s=this.getConsolidatedConfigurationModel(e,i,n);return s.getValue(e)}updateValue(e,i,n={}){let s;if(n.resource){s=this._memoryConfigurationByResource.get(n.resource);if(!s){s=Cn.createEmptyModel(this.logService);this._memoryConfigurationByResource.set(n.resource,s)}}else{s=this._memoryConfiguration}if(i===void 0){s.removeValue(e)}else{s.setValue(e,i)}if(!n.resource){this._workspaceConsolidatedConfiguration=null}}inspect(e,i,n){const s=this.getConsolidatedConfigurationModel(e,i,n);const r=this.getFolderConfigurationModelForResource(i.resource,n);const o=i.resource?this._memoryConfigurationByResource.get(i.resource)||this._memoryConfiguration:this._memoryConfiguration;const a=new Set;for(const l of s.overrides){for(const c of l.identifiers){if(s.getOverrideValue(e,c)!==void 0){a.add(c)}}}return new wO(e,i,s.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,n?this._workspaceConfiguration:void 0,r?r:void 0,o)}keys(e){const i=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.keys.slice(0),policy:this._policyConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:i?i.keys.slice(0):[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(e){this._policyConfiguration=e}updateApplicationConfiguration(e){this._applicationConfiguration=e;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e;this._userConfiguration=null;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e;this._userConfiguration=null;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,i){this._folderConfigurations.set(e,i);this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e);this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,i){const n=[];if(!i){const{added:s,updated:r,removed:o}=eo(this._defaultConfiguration,e);i=[...s,...r,...o]}for(const s of i){for(const r of eh(s)){const o=this._defaultConfiguration.getKeysForOverrideIdentifier(r);const a=e.getKeysForOverrideIdentifier(r);const l=[...a.filter(c=>o.indexOf(c)===-1),...o.filter(c=>a.indexOf(c)===-1),...o.filter(c=>!Gi(this._defaultConfiguration.override(r).getValue(c),e.override(r).getValue(c)))];n.push([r,l])}}this.updateDefaultConfiguration(e);return{keys:i,overrides:n}}compareAndUpdatePolicyConfiguration(e){const{added:i,updated:n,removed:s}=eo(this._policyConfiguration,e);const r=[...i,...n,...s];if(r.length){this.updatePolicyConfiguration(e)}return{keys:r,overrides:[]}}compareAndUpdateApplicationConfiguration(e){const{added:i,updated:n,removed:s,overrides:r}=eo(this.applicationConfiguration,e);const o=[...i,...n,...s];if(o.length){this.updateApplicationConfiguration(e)}return{keys:o,overrides:r}}compareAndUpdateLocalUserConfiguration(e){const{added:i,updated:n,removed:s,overrides:r}=eo(this.localUserConfiguration,e);const o=[...i,...n,...s];if(o.length){this.updateLocalUserConfiguration(e)}return{keys:o,overrides:r}}compareAndUpdateRemoteUserConfiguration(e){const{added:i,updated:n,removed:s,overrides:r}=eo(this.remoteUserConfiguration,e);const o=[...i,...n,...s];if(o.length){this.updateRemoteUserConfiguration(e)}return{keys:o,overrides:r}}compareAndUpdateWorkspaceConfiguration(e){const{added:i,updated:n,removed:s,overrides:r}=eo(this.workspaceConfiguration,e);const o=[...i,...n,...s];if(o.length){this.updateWorkspaceConfiguration(e)}return{keys:o,overrides:r}}compareAndUpdateFolderConfiguration(e,i){const n=this.folderConfigurations.get(e);const{added:s,updated:r,removed:o,overrides:a}=eo(n,i);const l=[...s,...r,...o];if(l.length||!n){this.updateFolderConfiguration(e,i)}return{keys:l,overrides:a}}compareAndDeleteFolderConfiguration(e){const i=this.folderConfigurations.get(e);if(!i){throw new Error("Unknown folder")}this.deleteFolderConfiguration(e);const{added:n,updated:s,removed:r,overrides:o}=eo(i,void 0);return{keys:[...n,...s,...r],overrides:o}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){if(!this._userConfiguration){if(this._remoteUserConfiguration.isEmpty()){this._userConfiguration=this._localUserConfiguration}else{const e=this._localUserConfiguration.merge(this._remoteUserConfiguration);this._userConfiguration=new Cn(e.contents,e.keys,e.overrides,void 0,this.logService)}}return this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(e,i,n){let s=this.getConsolidatedConfigurationModelForResource(i,n);if(i.overrideIdentifier){s=s.override(i.overrideIdentifier)}if(!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0){s=s.merge();for(const r of this._policyConfiguration.keys){s.setValue(r,this._policyConfiguration.getValue(r))}}return s}getConsolidatedConfigurationModelForResource({resource:e},i){let n=this.getWorkspaceConsolidatedConfiguration();if(i&&e){const s=i.getFolder(e);if(s){n=this.getFolderConsolidatedConfiguration(s.uri)||n}const r=this._memoryConfigurationByResource.get(e);if(r){n=n.merge(r)}}return n}getWorkspaceConsolidatedConfiguration(){if(!this._workspaceConsolidatedConfiguration){this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)}return this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let i=this._foldersConsolidatedConfigurations.get(e);if(!i){const n=this.getWorkspaceConsolidatedConfiguration();const s=this._folderConfigurations.get(e);if(s){i=n.merge(s);this._foldersConsolidatedConfigurations.set(e,i)}else{i=n}}return i}getFolderConfigurationModelForResource(e,i){if(i&&e){const n=i.getFolder(e);if(n){return this._folderConfigurations.get(n.uri)}}return void 0}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,i)=>{const{contents:n,overrides:s,keys:r}=this._folderConfigurations.get(i);e.push([i,{contents:n,overrides:s,keys:r}]);return e},[])}}allKeys(){const e=new Set;this._defaultConfiguration.keys.forEach(i=>e.add(i));this.userConfiguration.keys.forEach(i=>e.add(i));this._workspaceConfiguration.keys.forEach(i=>e.add(i));this._folderConfigurations.forEach(i=>i.keys.forEach(n=>e.add(n)));return[...e.values()]}allOverrideIdentifiers(){const e=new Set;this._defaultConfiguration.getAllOverrideIdentifiers().forEach(i=>e.add(i));this.userConfiguration.getAllOverrideIdentifiers().forEach(i=>e.add(i));this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(i=>e.add(i));this._folderConfigurations.forEach(i=>i.getAllOverrideIdentifiers().forEach(n=>e.add(n)));return[...e.values()]}getAllKeysForOverrideIdentifier(e){const i=new Set;this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n));this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n));this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n));this._folderConfigurations.forEach(n=>n.getKeysForOverrideIdentifier(e).forEach(s=>i.add(s)));return[...i.values()]}static parse(e,i){const n=this.parseConfigurationModel(e.defaults,i);const s=this.parseConfigurationModel(e.policy,i);const r=this.parseConfigurationModel(e.application,i);const o=this.parseConfigurationModel(e.userLocal,i);const a=this.parseConfigurationModel(e.userRemote,i);const l=this.parseConfigurationModel(e.workspace,i);const c=e.folders.reduce((u,d)=>{u.set(b.revive(d[0]),this.parseConfigurationModel(d[1],i));return u},new It);return new FA(n,s,r,o,a,l,c,Cn.createEmptyModel(i),new It,i)}static parseConfigurationModel(e,i){return new Cn(e.contents,e.keys,e.overrides,e.raw,i)}};class bO{constructor(e,i,n,s,r){this.change=e;this.previous=i;this.currentConfiguraiton=n;this.currentWorkspace=s;this.logService=r;this._marker="\n";this._markerCode1=this._marker.charCodeAt(0);this._markerCode2=".".charCodeAt(0);this.affectedKeys=new Set;this._previousConfiguration=void 0;for(const o of e.keys){this.affectedKeys.add(o)}for(const[,o]of e.overrides){for(const a of o){this.affectedKeys.add(a)}}this._affectsConfigStr=this._marker;for(const o of this.affectedKeys){this._affectsConfigStr+=o+this._marker}}get previousConfiguration(){if(!this._previousConfiguration&&this.previous){this._previousConfiguration=Ly.parse(this.previous.data,this.logService)}return this._previousConfiguration}affectsConfiguration(e,i){const n=this._marker+e;const s=this._affectsConfigStr.indexOf(n);if(s<0){return false}const r=s+n.length;if(r>=this._affectsConfigStr.length){return false}const o=this._affectsConfigStr.charCodeAt(r);if(o!==this._markerCode1&&o!==this._markerCode2){return false}if(i){const a=this.previousConfiguration?this.previousConfiguration.getValue(e,i,this.previous?.workspace):void 0;const l=this.currentConfiguraiton.getValue(e,i,this.currentWorkspace);return!Gi(a,l)}return true}}function eo(t,e){const{added:i,removed:n,updated:s}=rD(e?.rawConfiguration,t?.rawConfiguration);const r=[];const o=t?.getAllOverrideIdentifiers()||[];const a=e?.getAllOverrideIdentifiers()||[];if(e){const l=a.filter(c=>!o.includes(c));for(const c of l){r.push([c,e.getKeysForOverrideIdentifier(c)])}}if(t){const l=o.filter(c=>!a.includes(c));for(const c of l){r.push([c,t.getKeysForOverrideIdentifier(c)])}}if(e&&t){for(const l of o){if(a.includes(l)){const c=rD({contents:t.getOverrideValue(void 0,l)||{},keys:t.getKeysForOverrideIdentifier(l)},{contents:e.getOverrideValue(void 0,l)||{},keys:e.getKeysForOverrideIdentifier(l)});r.push([l,[...c.added,...c.removed,...c.updated]])}}}return{added:i,removed:n,updated:s,overrides:r}}function rD(t,e){const i=t?e?t.keys.filter(r=>e.keys.indexOf(r)===-1):[...t.keys]:[];const n=e?t?e.keys.filter(r=>t.keys.indexOf(r)===-1):[...e.keys]:[];const s=[];if(t&&e){for(const r of e.keys){if(t.keys.indexOf(r)!==-1){const o=hg(e.contents,r);const a=hg(t.contents,r);if(!Gi(o,a)){s.push(r)}}}}return{added:i,removed:n,updated:s}}function Mf(t,e){if(e){const i=e.split(".");let n=t;for(let s=0;n&&s<i.length;s++){n=n[i[s]]}return n}return void 0}function yO(t){return t instanceof b}function SO(t){return Gt(t)&&t.uri instanceof b&&!!t.languageId&&typeof t.languageId==="string"}function xO(t){return Gt(t)&&!t.uri&&!!t.languageId&&typeof t.languageId==="string"}function EO(t){return Gt(t)&&t.uri instanceof b&&(!t.name||typeof t.name==="string")&&(!t.index||typeof t.index==="number")}function oD(t){if(yO(t)){return{resource:t}}if(SO(t)){return{resource:t.uri,overrideIdentifier:t.languageId}}if(xO(t)){return{overrideIdentifier:t.languageId}}if(EO(t)){return{resource:t.uri}}if(t===null){return{resource:null}}return void 0}let Ny=class Pz{constructor(e,i,n){this._proxy=e.getProxy(ee.MainThreadConfiguration);this._extHostWorkspace=i;this._logService=n;this._barrier=new Es;this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new CO(this._proxy,this._extHostWorkspace,e,this._logService);this._barrier.open()}$acceptConfigurationChanged(e,i){this.getConfigProvider().then(n=>n.$acceptConfigurationChanged(e,i))}};Ny=W([P(0,st),P(1,ur),P(2,et)],Ny);class CO{constructor(e,i,n,s){this._onDidChangeConfiguration=new L;this._proxy=e;this._logService=s;this._extHostWorkspace=i;this._configuration=Ly.parse(n,s);this._configurationScopes=this._toMap(n.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,i){const n={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=Ly.parse(e,this._logService);this._configurationScopes=this._toMap(e.configurationScopes);this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(i,n))}getConfiguration(e,i,n){const s=oD(i)||{};const r=this._toReadonlyValue(this._configuration.getValue(e,s,this._extHostWorkspace.workspace));if(e){this._validateConfigurationAccess(e,s,n?.identifier)}function o(l){if(l===void 0||l===null){return null}if(typeof l==="boolean"){return l?ri.USER:ri.WORKSPACE}switch(l){case bc.Global:return ri.USER;case bc.Workspace:return ri.WORKSPACE;case bc.WorkspaceFolder:return ri.WORKSPACE_FOLDER}}const a={has(l){return typeof Mf(r,l)!=="undefined"},get:(l,c)=>{this._validateConfigurationAccess(e?`${e}.${l}`:l,s,n?.identifier);let u=Mf(r,l);if(typeof u==="undefined"){u=c}else{let d=void 0;const f=(p,m)=>{if(Gt(p)){let v=void 0;const y=()=>{d=d?d:Pt(r);v=v?v:Mf(d,m)};return new Proxy(p,{get:(k,S)=>{if(typeof S==="string"&&S.toLowerCase()==="tojson"){y();return()=>v}if(d){v=v?v:Mf(d,m);return v[S]}const R=k[S];if(typeof S==="string"){return f(R,`${m}.${S}`)}return R},set:(k,S,R)=>{y();if(v){v[S]=R}return true},deleteProperty:(k,S)=>{y();if(v){delete v[S]}return true},defineProperty:(k,S,R)=>{y();if(v){Object.defineProperty(v,S,R)}return true}})}if(Array.isArray(p)){return Pt(p)}return p};u=f(u,l)}return u},update:(l,c,u,d)=>{l=e?`${e}.${l}`:l;const f=o(u);if(c!==void 0){return this._proxy.$updateConfigurationOption(f,l,c,s,d)}else{return this._proxy.$removeConfigurationOption(f,l,s,d)}},inspect:l=>{l=e?`${e}.${l}`:l;const c=this._configuration.inspect(l,s,this._extHostWorkspace.workspace);if(c){return{key:l,defaultValue:Pt(c.policy?.value??c.default?.value),globalLocalValue:Pt(c.userLocal?.value),globalRemoteValue:Pt(c.userRemote?.value),globalValue:Pt(c.user?.value??c.application?.value),workspaceValue:Pt(c.workspace?.value),workspaceFolderValue:Pt(c.workspaceFolder?.value),defaultLanguageValue:Pt(c.default?.override),globalLocalLanguageValue:Pt(c.userLocal?.override),globalRemoteLanguageValue:Pt(c.userRemote?.override),globalLanguageValue:Pt(c.user?.override??c.application?.override),workspaceLanguageValue:Pt(c.workspace?.override),workspaceFolderLanguageValue:Pt(c.workspaceFolder?.override),languageIds:Pt(c.overrideIdentifiers)}}return void 0}};if(typeof r==="object"){ol(a,r,false)}return Object.freeze(a)}_toReadonlyValue(e){const i=n=>{return Gt(n)?new Proxy(n,{get:(s,r)=>i(s[r]),set:(s,r,o)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(r)}' of object`)},deleteProperty:(s,r)=>{throw new Error(`TypeError: Cannot delete read only property '${String(r)}' of object`)},defineProperty:(s,r)=>{throw new Error(`TypeError: Cannot define property '${String(r)}' for a readonly object`)},setPrototypeOf:s=>{throw new Error(`TypeError: Cannot set prototype for a readonly object`)},isExtensible:()=>false,preventExtensions:()=>true}):n};return i(e)}_validateConfigurationAccess(e,i,n){const s=sr.test(e)?At.RESOURCE:this._configurationScopes.get(e);const r=n?`[${n.value}] `:"";if(At.RESOURCE===s){if(typeof i?.resource==="undefined"){this._logService.warn(`${r}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`)}return}if(At.WINDOW===s){if(i?.resource){this._logService.warn(`${r}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`)}return}}_toConfigurationChangeEvent(e,i){const n=new bO(e,i,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(s,r)=>n.affectsConfiguration(s,oD(r))})}_toMap(e){return e.reduce((i,n)=>{i.set(n[0],n[1]);return i},new Map)}}const jr=te("IExtHostConfiguration");class kO{constructor(e,i){this.versionId=e;this.removedDueToLooping=i}}class nl extends me{static isHostExtension(e,i,n){if(i.getExtensionDescription(e)){return false}const s=n.getExtensionDescription(e);if(!s){return false}if((s.main||s.browser)&&s.api==="none"){return true}return false}constructor(e,i){super();this._activationEventsReader=e;this._onDidChange=this._register(new L);this.onDidChange=this._onDidChange.event;this._versionId=0;this._extensionDescriptions=i;this._initialize()}_initialize(){this._extensionDescriptions.sort(IO);this._extensionsMap=new $o;this._extensionsArr=[];this._activationMap=new Map;for(const e of this._extensionDescriptions){if(this._extensionsMap.has(e.identifier)){console.error("Extension `"+e.identifier.value+"` is already registered");continue}this._extensionsMap.set(e.identifier,e);this._extensionsArr.push(e);const i=this._activationEventsReader.readActivationEvents(e);for(const n of i){if(!this._activationMap.has(n)){this._activationMap.set(n,[])}this._activationMap.get(n).push(e)}}}set(e){this._extensionDescriptions=e;this._initialize();this._versionId++;this._onDidChange.fire(void 0);return{versionId:this._versionId}}deltaExtensions(e,i){this._extensionDescriptions=aD(this._extensionDescriptions,i);this._extensionDescriptions=this._extensionDescriptions.concat(e);const n=nl._findLoopingExtensions(this._extensionDescriptions);this._extensionDescriptions=aD(this._extensionDescriptions,n.map(s=>s.identifier));this._initialize();this._versionId++;this._onDidChange.fire(void 0);return new kO(this._versionId,n)}static _findLoopingExtensions(e){const i=new class{constructor(){this._arcs=new Map;this._nodesSet=new Set;this._nodesArr=[]}addNode(a){if(!this._nodesSet.has(a)){this._nodesSet.add(a);this._nodesArr.push(a)}}addArc(a,l){this.addNode(a);this.addNode(l);if(this._arcs.has(a)){this._arcs.get(a).push(l)}else{this._arcs.set(a,[l])}}getArcs(a){if(this._arcs.has(a)){return this._arcs.get(a)}return[]}hasOnlyGoodArcs(a,l){const c=i.getArcs(a);for(let u=0;u<c.length;u++){if(!l.has(c[u])){return false}}return true}getNodes(){return this._nodesArr}};const n=new $o;for(const a of e){n.set(a.identifier,a);if(a.extensionDependencies){for(const l of a.extensionDependencies){i.addArc(ht.toKey(a.identifier),ht.toKey(l))}}}const s=new Set;i.getNodes().filter(a=>i.getArcs(a).length===0).forEach(a=>s.add(a));const r=i.getNodes().filter(a=>!s.has(a));let o;do{o=false;for(let a=0;a<r.length;a++){const l=r[a];if(i.hasOnlyGoodArcs(l,s)){r.splice(a,1);a--;s.add(l);o=true}}}while(o);return r.map(a=>n.get(a))}containsActivationEvent(e){return this._activationMap.has(e)}containsExtension(e){return this._extensionsMap.has(e)}getExtensionDescriptionsForActivationEvent(e){const i=this._activationMap.get(e);return i?i.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new DO(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(e){const i=this._extensionsMap.get(e);return i?i:void 0}getExtensionDescriptionByUUID(e){for(const i of this._extensionsArr){if(i.uuid===e){return i}}return void 0}getExtensionDescriptionByIdOrUUID(e,i){return this.getExtensionDescription(e)??(i?this.getExtensionDescriptionByUUID(i):void 0)}}class DO{constructor(e,i){this.versionId=e;this.extensions=i}}var ho;(function(t){t[t["Builtin"]=0]="Builtin";t[t["User"]=1]="User";t[t["Dev"]=2]="Dev"})(ho||(ho={}));function IO(t,e){const i=t.isBuiltin?ho.Builtin:t.isUnderDevelopment?ho.Dev:ho.User;const n=e.isBuiltin?ho.Builtin:e.isUnderDevelopment?ho.Dev:ho.User;if(i!==n){return i-n}const s=mt.basename(t.extensionLocation.path);const r=mt.basename(e.extensionLocation.path);if(s<r){return-1}if(s>r){return 1}return 0}function aD(t,e){const i=new bl(e);return t.filter(n=>!i.has(n.identifier))}class ku{static{this.NONE=new ku(false,-1,-1,-1)}constructor(e,i,n,s){this.startup=e;this.codeLoadingTime=i;this.activateCallTime=n;this.activateResolvedTime=s}}class Jv{constructor(e){this._startup=e;this._codeLoadingStart=-1;this._codeLoadingStop=-1;this._activateCallStart=-1;this._activateCallStop=-1;this._activateResolveStart=-1;this._activateResolveStop=-1}_delta(e,i){if(e===-1||i===-1){return-1}return i-e}build(){return new ku(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class X_{constructor(e,i,n,s,r,o){this.activationFailed=e;this.activationFailedError=i;this.activationTimes=n;this.module=s;this.exports=r;this.disposable=o}}class TO extends X_{constructor(e){super(false,null,e,{activate:void 0,deactivate:void 0},void 0,me.None)}}class PO extends X_{constructor(){super(false,null,ku.NONE,{activate:void 0,deactivate:void 0},void 0,me.None)}}class a_ extends X_{constructor(e){super(true,e,ku.NONE,{activate:void 0,deactivate:void 0},void 0,me.None)}}let My=class Az{constructor(e,i,n,s){this._logService=s;this._registry=e;this._globalRegistry=i;this._host=n;this._operations=new $o;this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,i]of this._operations){i.dispose()}}async waitForActivatingExtensions(){const e=[];for(const[i,n]of this._operations){e.push(n.wait())}await Promise.all(e)}isActivated(e){const i=this._operations.get(e);return Boolean(i&&i.value)}getActivatedExtension(e){const i=this._operations.get(e);if(!i||!i.value){throw new Error(`Extension '${e.value}' is not known or not activated`)}return i.value}async activateByEvent(e,i){if(this._alreadyActivatedEvents[e]){return}const n=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(n.map(s=>({id:s.identifier,reason:{startup:i,extensionId:s.identifier,activationEvent:e}})));this._alreadyActivatedEvents[e]=true}activateById(e,i){const n=this._registry.getExtensionDescription(e);if(!n){throw new Error(`Extension '${e.value}' is not known`)}return this._activateExtensions([{id:n.identifier,reason:i}])}async _activateExtensions(e){const i=e.filter(n=>!this.isActivated(n.id)).map(n=>this._handleActivationRequest(n));await Promise.all(i.map(n=>n.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id)){return this._operations.get(e.id)}if(this._isHostExtension(e.id)){return this._createAndSaveOperation(e,null,[],null)}const i=this._registry.getExtensionDescription(e.id);if(!i){const r=new Error(`Cannot activate unknown extension '${e.id.value}'`);const o=this._createAndSaveOperation(e,null,[],new a_(r));this._host.onExtensionActivationError(e.id,r,new Hk(e.id.value));return o}const n=[];const s=typeof i.extensionDependencies==="undefined"?[]:i.extensionDependencies;for(const r of s){if(this._isResolvedExtension(r)){continue}const o=this._operations.get(r);if(o){n.push(o);continue}if(this._isHostExtension(r)){n.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(r).identifier,reason:e.reason}));continue}const a=this._registry.getExtensionDescription(r);if(a){if(!a.main&&!a.browser){continue}n.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}const l=i.displayName||i.identifier.value;const c=new Error(`Cannot activate the '${l}' extension because it depends on unknown extension '${r}'`);const u=this._createAndSaveOperation(e,i.displayName,[],new a_(c));this._host.onExtensionActivationError(i.identifier,c,new Hk(r));return u}return this._createAndSaveOperation(e,i.displayName,n,null)}_createAndSaveOperation(e,i,n,s){const r=new Oy(e.id,i,e.reason,n,s,this._host,this._logService);this._operations.set(e.id,r);return r}_isHostExtension(e){return nl.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const i=this._globalRegistry.getExtensionDescription(e);if(!i){return false}return!i.main&&!i.browser}};My=W([P(3,et)],My);let Oy=class Rz{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,i,n,s,r,o,a){this._id=e;this._displayName=i;this._reason=n;this._deps=s;this._value=r;this._host=o;this._logService=a;this._barrier=new Es;this._isDisposed=false;this._initialize()}dispose(){this._isDisposed=true}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate();this._barrier.open()}async _waitForDepsThenActivate(){if(this._value){return}while(this._deps.length>0){for(let e=0;e<this._deps.length;e++){const i=this._deps[e];if(i.value&&!i.value.activationFailed){this._deps.splice(e,1);e--;continue}if(i.value&&i.value.activationFailed){const n=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${i.friendlyName}' failed to activate`);n.detail=i.value.activationFailedError;this._value=new a_(n);this._host.onExtensionActivationError(this._id,n,null);return}}if(this._deps.length>0){await Promise.race(this._deps.map(e=>e.wait()))}}await this._activate()}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const i=new Error;if(e&&e.name){i.name=e.name}if(e&&e.message){i.message=`Activating extension '${this._id.value}' failed: ${e.message}.`}else{i.message=`Activating extension '${this._id.value}' failed: ${e}.`}if(e&&e.stack){i.stack=e.stack}this._value=new a_(i);if(this._isDisposed&&Ls(e)){return}this._host.onExtensionActivationError(this._id,i,null);this._logService.error(`Activating extension ${this._id.value} failed due to an error:`);this._logService.error(e)}}};Oy=W([P(6,et)],Oy);class UA{constructor(e,i){this._logService=i;this._onDidChangeStorage=new L;this.onDidChangeStorage=this._onDidChangeStorage.event;this._proxy=e.getProxy(ee.MainThreadStorage)}registerExtensionStorageKeysToSync(e,i){this._proxy.$registerExtensionStorageKeysToSync(e,i)}async initializeExtensionStorage(e,i,n){const s=await this._proxy.$initializeExtensionStorage(e,i);let r;if(s){r=this.safeParseValue(e,i,s)}return r||n}setValue(e,i,n){return this._proxy.$setValue(e,i,n)}$acceptValue(e,i,n){const s=this.safeParseValue(e,i,n);if(s){this._onDidChangeStorage.fire({shared:e,key:i,value:s})}}safeParseValue(e,i,n){try{return JSON.parse(n)}catch(s){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${i}, global: ${e}): ${s}`)}return void 0}}const wx=te("IExtHostStorage");class $A{constructor(e,i,n){this._deferredPromises=new Map;this._id=e;this._shared=i;this._storage=n;this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(s=>{this._value=s;return this});this._storageListener=this._storage.onDidChangeStorage(s=>{if(s.shared===this._shared&&s.key===this._id){this._value=s.value}});this._scheduler=new wl(()=>{const s=this._deferredPromises;this._deferredPromises=new Map;(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const r of s.values()){r.complete()}}catch(r){for(const o of s.values()){o.error(r)}}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,i){let n=this._value[e];if(typeof n==="undefined"){n=i}return n}update(e,i){if(i!==null&&typeof i==="object"){this._value[e]=JSON.parse(JSON.stringify(i))}else{this._value[e]=i}const n=this._deferredPromises.get(e);if(n!==void 0){return n.p}const s=new Bn;this._deferredPromises.set(e,s);if(!this._scheduler.isScheduled()){this._scheduler.schedule()}return s.p}dispose(){this._storageListener.dispose()}}class AO extends $A{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,i){super(e.identifier.value,true,i);this._extension=e}}var Ws;let Fy=Ws=class Lz{constructor(e,i){this._fileSystemProvider=new Map;this._writeQueue=new a8;this._proxy=e.getProxy(ee.MainThreadFileSystem);const n=this;this.value=Object.freeze({async stat(s){try{let r;const o=n._fileSystemProvider.get(s.scheme);if(o){await n._proxy.$ensureActivation(s.scheme);r=await o.impl.stat(s)}else{r=await n._proxy.$stat(s)}return{type:r.type,ctime:r.ctime,mtime:r.mtime,size:r.size,permissions:r.permissions===Va.Readonly?1:void 0}}catch(r){Ws._handleError(r)}},async readDirectory(s){try{const r=n._fileSystemProvider.get(s.scheme);if(r){await n._proxy.$ensureActivation(s.scheme);return(await r.impl.readDirectory(s)).slice()}else{return await n._proxy.$readdir(s)}}catch(r){return Ws._handleError(r)}},async createDirectory(s){try{const r=n._fileSystemProvider.get(s.scheme);if(r&&!r.isReadonly){await n._proxy.$ensureActivation(s.scheme);return await n.mkdirp(r.impl,r.extUri,s)}else{return await n._proxy.$mkdir(s)}}catch(r){return Ws._handleError(r)}},async readFile(s){try{const r=n._fileSystemProvider.get(s.scheme);if(r){await n._proxy.$ensureActivation(s.scheme);return(await r.impl.readFile(s)).slice()}else{const o=await n._proxy.$readFile(s);return o.buffer}}catch(r){return Ws._handleError(r)}},async writeFile(s,r){try{const o=n._fileSystemProvider.get(s.scheme);if(o&&!o.isReadonly){await n._proxy.$ensureActivation(s.scheme);await n.mkdirp(o.impl,o.extUri,o.extUri.dirname(s));return await n._writeQueue.queueFor(s,()=>Promise.resolve(o.impl.writeFile(s,r,{create:true,overwrite:true})))}else{return await n._proxy.$writeFile(s,ae.wrap(r))}}catch(o){return Ws._handleError(o)}},async delete(s,r){try{const o=n._fileSystemProvider.get(s.scheme);if(o&&!o.isReadonly&&!r?.useTrash){await n._proxy.$ensureActivation(s.scheme);return await o.impl.delete(s,{recursive:false,...r})}else{return await n._proxy.$delete(s,{recursive:false,useTrash:false,atomic:false,...r})}}catch(o){return Ws._handleError(o)}},async rename(s,r,o){try{return await n._proxy.$rename(s,r,{...{overwrite:false},...o})}catch(a){return Ws._handleError(a)}},async copy(s,r,o){try{return await n._proxy.$copy(s,r,{...{overwrite:false},...o})}catch(a){return Ws._handleError(a)}},isWritableFileSystem(s){const r=i.getCapabilities(s);if(typeof r==="number"){return!(r&ws.Readonly)}return void 0}})}async mkdirp(e,i,n){const s=[];while(!i.isEqual(n,i.dirname(n))){try{const r=await e.stat(n);if((r.type&Wa.Directory)===0){throw fi.FileExists(`Unable to create folder '${n.scheme===ne.file?n.fsPath:n.toString(true)}' that already exists but is not a directory`)}break}catch(r){if(zp(r)!==Oe.FileNotFound){throw r}s.push(i.basename(n));n=i.dirname(n)}}for(let r=s.length-1;r>=0;r--){n=i.joinPath(n,s[r]);try{await e.createDirectory(n)}catch(o){if(zp(o)!==Oe.FileExists){throw o}}}}static _handleError(e){if(e instanceof fi){throw e}if(e instanceof A_){switch(e.code){case Oe.FileExists:throw fi.FileExists(e.message);case Oe.FileNotFound:throw fi.FileNotFound(e.message);case Oe.FileNotADirectory:throw fi.FileNotADirectory(e.message);case Oe.FileIsADirectory:throw fi.FileIsADirectory(e.message);case Oe.NoPermissions:throw fi.NoPermissions(e.message);case Oe.Unavailable:throw fi.Unavailable(e.message);default:throw new fi(e.message,e.name)}}if(!(e instanceof Error)){throw new fi(String(e))}if(e.name==="ENOPRO"||e.message.includes("ENOPRO")){throw fi.Unavailable(e.message)}switch(e.name){case Oe.FileExists:throw fi.FileExists(e.message);case Oe.FileNotFound:throw fi.FileNotFound(e.message);case Oe.FileNotADirectory:throw fi.FileNotADirectory(e.message);case Oe.FileIsADirectory:throw fi.FileIsADirectory(e.message);case Oe.NoPermissions:throw fi.NoPermissions(e.message);case Oe.Unavailable:throw fi.Unavailable(e.message);default:throw new fi(e.message,e.name)}}addFileSystemProvider(e,i,n){this._fileSystemProvider.set(e,{impl:i,extUri:n?.isCaseSensitive?ft:GL,isReadonly:!!n?.isReadonly});return ye(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){return this._fileSystemProvider.get(e)?.extUri??ft}};Fy=Ws=W([P(0,st),P(1,bu)],Fy);const Z_=te("IExtHostConsumerFileSystem");const bx=te("IExtensionStoragePaths");let Uy=class Nz{constructor(e,i,n){this._logService=i;this._extHostFileSystem=n;this._workspace=e.workspace??void 0;this._environment=e.environment;this.whenReady=this._getOrCreateWorkspaceStoragePath().then(s=>this._value=s)}async _getWorkspaceStorageURI(e){return b.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){if(!this._workspace){return Promise.resolve(void 0)}const e=this._workspace.id;const i=await this._getWorkspaceStorageURI(e);try{await this._extHostFileSystem.value.stat(i);this._logService.trace("[ExtHostStorage] storage dir already exists",i);return i}catch{}try{this._logService.trace("[ExtHostStorage] creating dir and metadata-file",i);await this._extHostFileSystem.value.createDirectory(i);await this._extHostFileSystem.value.writeFile(b.joinPath(i,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:b.revive(this._workspace.configuration)?.toString(),name:this._workspace.name},void 0,2)));return i}catch(n){this._logService.error("[ExtHostStorage]",n);return void 0}}workspaceValue(e){if(this._value){return b.joinPath(this._value,e.identifier.value)}return void 0}globalValue(e){return b.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};Uy=W([P(0,wi),P(1,et),P(2,Z_)],Uy);var lD;(function(t){t["Http"]="http";t["Https"]="https"})(lD||(lD={}));var Fa;(function(t){t["ConstantPrivate"]="constantPrivate";t["Private"]="private";t["Public"]="public"})(Fa||(Fa={}));var cD;(function(t){t[t["Notify"]=1]="Notify";t[t["OpenBrowser"]=2]="OpenBrowser";t[t["OpenPreview"]=3]="OpenPreview";t[t["Silent"]=4]="Silent";t[t["Ignore"]=5]="Ignore";t[t["OpenBrowserOnce"]=6]="OpenBrowserOnce"})(cD||(cD={}));function RO(t){if(t.scheme!=="http"&&t.scheme!=="https"){return void 0}const e=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(t.authority);if(!e){return void 0}return{address:e[1],port:+e[2]}}const $y=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function uD(t){return $y.indexOf(t)>=0}const Hy=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function dD(t){return Hy.indexOf(t)>=0}class LO{constructor(e,i,n){this.remoteAddress=e;this.localAddress=i;this._dispose=n;this._onDispose=new L;this.onDidDispose=this._onDispose.event}dispose(){this._onDispose.fire();return this._dispose()}}let hD=class Mz extends me{constructor(e,i){super();this.logService=e;this.configurationService=i;this._onTunnelOpened=new L;this.onTunnelOpened=this._onTunnelOpened.event;this._onTunnelClosed=new L;this.onTunnelClosed=this._onTunnelClosed.event;this._onAddedTunnelProvider=new L;this.onAddedTunnelProvider=this._onAddedTunnelProvider.event;this._tunnels=new Map;this._canElevate=false;this._canChangeProtocol=true;this._privacyOptions=[];this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){const e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){this._tunnelProvider=e;if(!e){this._canElevate=false;this._privacyOptions=[];this._onAddedTunnelProvider.fire();return{dispose:()=>{}}}this._onAddedTunnelProvider.fire();return{dispose:()=>{this._tunnelProvider=void 0;this._canElevate=false;this._privacyOptions=[]}}}setTunnelFeatures(e){this._canElevate=e.elevation;this._privacyOptions=e.privacyOptions;this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){const e=[];const i=Array.from(this._tunnels.values());for(const n of i){const s=Array.from(n.values());for(const r of s){const o=await r.value;if(o&&typeof o!=="string"){e.push(o)}}}return e}async dispose(){super.dispose();for(const e of this._tunnels.values()){for(const{value:i}of e.values()){await i.then(n=>typeof n!=="string"?n?.dispose():void 0)}e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,i,n,s,r){this.addTunnelToMap(e,i,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:i,localAddress:n,privacy:s,protocol:r,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,i){if(dD(e)||uD(e)){e=$y[0]}const n=this.getTunnelFromMap(e,i);if(n){++n.refcount;return n.value}return void 0}openTunnel(e,i,n,s,r,o=false,a,l){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${i}:${n} on local port ${r}.`);const c=this._tunnelProvider??e;if(!c){return void 0}if(!i){i="localhost"}if(!s){s=this.defaultTunnelHost}if(this._tunnelProvider&&this._factoryInProgress.has(n)){this.logService.debug(`ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.`);return}const u=this.retainOrCreateTunnel(c,i,n,s,r,o,a,l);if(!u){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel was not created.`);return u}return u.then(d=>{if(!d){this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined.");this.removeEmptyOrErrorTunnelFromMap(i,n);return void 0}else if(typeof d==="string"){this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel.");this.removeEmptyOrErrorTunnelFromMap(i,n);return d}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.makeTunnel(d);if(d.tunnelRemoteHost!==i||d.tunnelRemotePort!==n){this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch.")}if(a&&d.privacy!==a){this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch.")}this._onTunnelOpened.fire(f);return f})}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);const i=this._tunnels.get(e.tunnelRemoteHost);if(i){const n=i.get(e.tunnelRemotePort);if(n){n.refcount--;await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,n)}}}}}async tryDisposeTunnel(e,i,n){if(n.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${i}.`);const s=n.value.then(async r=>{if(r&&typeof r!=="string"){await r.dispose(true);this._onTunnelClosed.fire({host:r.tunnelRemoteHost,port:r.tunnelRemotePort})}});if(this._tunnels.has(e)){this._tunnels.get(e).delete(i)}return s}}async closeTunnel(e,i){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${i} `);const n=this._tunnels.get(e);if(n&&n.has(i)){const s=n.get(i);s.refcount=0;await this.tryDisposeTunnel(e,i,s)}}addTunnelToMap(e,i,n){if(!this._tunnels.has(e)){this._tunnels.set(e,new Map)}this._tunnels.get(e).set(i,{refcount:1,value:n})}async removeEmptyOrErrorTunnelFromMap(e,i){const n=this._tunnels.get(e);if(n){const s=n.get(i);const r=s?await s.value:void 0;if(!r||typeof r==="string"){n.delete(i)}if(n.size===0){this._tunnels.delete(e)}}}getTunnelFromMap(e,i){const n=[e];if(uD(e)){n.push(...$y);n.push(...Hy)}else if(dD(e)){n.push(...Hy)}const s=n.map(r=>this._tunnels.get(r));for(const r of s){const o=r?.get(i);if(o){return o}}return void 0}canTunnel(e){return!!RO(e)}createWithProvider(e,i,n,s,r,o,a){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${i}:${n} on local port ${s}.`);const l=n;this._factoryInProgress.add(l);const c=s===void 0?n:s;const u={elevationRequired:r?this.isPortPrivileged(c):false};const d={remoteAddress:{host:i,port:n},localAddressPort:s,privacy:o,public:o?o!==Fa.Private:void 0,protocol:a};const f=e.forwardPort(d,u);if(f){this.addTunnelToMap(i,n,f);f.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider.");this._factoryInProgress.delete(l)})}else{this._factoryInProgress.delete(l)}return f}};hD=W([P(0,et),P(1,Xo)],hD);class NO extends LO{}var By;(function(t){function e(n){return{remoteAddress:n.remoteAddress,localAddress:n.localAddress,public:!!n.public,privacy:n.privacy??(n.public?Fa.Public:Fa.Private),protocol:n.protocol}}t.fromApiTunnel=e;function i(n){return{remoteAddress:{host:n.tunnelRemoteHost,port:n.tunnelRemotePort},localAddress:n.localAddress,public:n.privacy!==Fa.ConstantPrivate&&n.privacy!==Fa.ConstantPrivate,privacy:n.privacy,protocol:n.protocol}}t.fromServiceTunnel=i})(By||(By={}));const yx=te("IExtHostTunnelService");let Wy=class Oz extends me{constructor(e,i,n){super();this.logService=n;this._showCandidatePort=()=>{return Promise.resolve(true)};this._extensionTunnels=new Map;this._onDidChangeTunnels=new L;this.onDidChangeTunnels=this._onDidChangeTunnels.event;this._providerHandleCounter=0;this._portAttributesProviders=new Map;this._proxy=e.getProxy(ee.MainThreadTunnelService)}async openTunnel(e,i){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${e.identifier.value} called openTunnel API for ${i.remoteAddress.host}:${i.remoteAddress.port}.`);const n=await this._proxy.$openTunnel(i,e.displayName);if(n){const s=new NO(n.remoteAddress,n.localAddress,()=>{return this._proxy.$closeTunnel(n.remoteAddress)});this._register(s);return s}return void 0}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(e,i){if(e.portRange===void 0&&e.commandPattern===void 0){this.logService.error("PortAttributesProvider must specify either a portRange or a commandPattern")}const n=this.nextPortAttributesProviderHandle();this._portAttributesProviders.set(n,{selector:e,provider:i});this._proxy.$registerPortsAttributesProvider(e,n);return new Ve(()=>{this._portAttributesProviders.delete(n);this._proxy.$unregisterPortsAttributesProvider(n)})}async $providePortAttributes(e,i,n,s,r){const o=[];for(const l of e){const c=this._portAttributesProviders.get(l);if(!c){return[]}o.push(...await Promise.all(i.map(async u=>{let d;try{d=await c.provider.providePortAttributes({port:u,pid:n,commandLine:s},r)}catch(f){d=await c.provider.providePortAttributes(u,n,s,r)}return{providedAttributes:d,port:u}})))}const a=o.filter(l=>!!l.providedAttributes);return a.length>0?a.map(l=>{return{autoForwardAction:l.providedAttributes.autoForwardAction,port:l.port}}):[]}async $registerCandidateFinder(e){}registerTunnelProvider(e,i){if(this._forwardPortProvider){throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.")}this._forwardPortProvider=async(s,r)=>{const o=await e.provideTunnel(s,r,Ze.None);return o??void 0};const n=i.tunnelFeatures?{elevation:!!i.tunnelFeatures?.elevation,privacyOptions:i.tunnelFeatures?.privacyOptions,protocol:i.tunnelFeatures.protocol===void 0?true:i.tunnelFeatures.protocol}:void 0;this._proxy.$setTunnelProvider(n,true);return Promise.resolve(ye(()=>{this._forwardPortProvider=void 0;this._proxy.$setTunnelProvider(void 0,false)}))}hasTunnelProvider(){return this._proxy.$hasTunnelProvider()}async setTunnelFactory(e,i){if(e){if(e.candidatePortSource!==void 0){this._proxy.$setCandidatePortSource(e.candidatePortSource)}if(e.showCandidatePort){this._showCandidatePort=e.showCandidatePort;this._proxy.$setCandidateFilter()}const n=e.tunnelFactory??(i?this.makeManagedTunnelFactory(i):void 0);if(n){this._forwardPortProvider=n;let s=e.tunnelFeatures?.privacyOptions??[];if(e.tunnelFeatures?.public&&s.length===0){s=[{id:"private",label:h(2708,"Private"),themeIcon:"lock"},{id:"public",label:h(2709,"Public"),themeIcon:"eye"}]}const r=e.tunnelFeatures?{elevation:!!e.tunnelFeatures?.elevation,public:!!e.tunnelFeatures?.public,privacyOptions:s,protocol:true}:void 0;this._proxy.$setTunnelProvider(r,!!e.tunnelFactory)}}else{this._forwardPortProvider=void 0}return ye(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(e){return void 0}async $closeTunnel(e,i){if(this._extensionTunnels.has(e.host)){const n=this._extensionTunnels.get(e.host);if(n.has(e.port)){if(i){n.get(e.port).disposeListener.dispose()}await n.get(e.port).tunnel.dispose();n.delete(e.port)}}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(e,i){if(this._forwardPortProvider){try{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const n=this._forwardPortProvider(e,i);this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider.");if(n!==void 0){const s=await n;this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider.");if(s===void 0){this.logService.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return void 0}if(!this._extensionTunnels.has(e.remoteAddress.host)){this._extensionTunnels.set(e.remoteAddress.host,new Map)}const r=this._register(s.onDidDispose(()=>{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose.");return this._proxy.$closeTunnel(s.remoteAddress)}));this._extensionTunnels.get(e.remoteAddress.host).set(e.remoteAddress.port,{tunnel:s,disposeListener:r});return By.fromApiTunnel(s)}else{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}}catch(n){this.logService.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error");if(n instanceof Error){return n.message}}}return void 0}async $applyCandidateFilter(e){const i=await Promise.all(e.map(s=>this._showCandidatePort(s.host,s.port,s.detail??"")));const n=e.filter((s,r)=>i[r]);this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${e.map(s=>s.port).join(", ")} to ${n.map(s=>s.port).join(", ")}`);return n}};Wy=W([P(0,st),P(1,wi),P(2,et)],Wy);function MO(t){return[...t.entries()]}function OO(t){return t?[...t.entries()]:[]}var fD;(function(t){t["AutomationProfile"]="terminal.integrated.automationProfile.";t["DefaultProfile"]="terminal.integrated.defaultProfile.";t["Profiles"]="terminal.integrated.profiles."})(fD||(fD={}));var pD;(function(t){t["SendKeybindingsToShell"]="terminal.integrated.sendKeybindingsToShell";t["AutomationProfileLinux"]="terminal.integrated.automationProfile.linux";t["AutomationProfileMacOs"]="terminal.integrated.automationProfile.osx";t["AutomationProfileWindows"]="terminal.integrated.automationProfile.windows";t["ProfilesWindows"]="terminal.integrated.profiles.windows";t["ProfilesMacOs"]="terminal.integrated.profiles.osx";t["ProfilesLinux"]="terminal.integrated.profiles.linux";t["DefaultProfileLinux"]="terminal.integrated.defaultProfile.linux";t["DefaultProfileMacOs"]="terminal.integrated.defaultProfile.osx";t["DefaultProfileWindows"]="terminal.integrated.defaultProfile.windows";t["UseWslProfiles"]="terminal.integrated.useWslProfiles";t["TabsDefaultColor"]="terminal.integrated.tabs.defaultColor";t["TabsDefaultIcon"]="terminal.integrated.tabs.defaultIcon";t["TabsEnabled"]="terminal.integrated.tabs.enabled";t["TabsEnableAnimation"]="terminal.integrated.tabs.enableAnimation";t["TabsHideCondition"]="terminal.integrated.tabs.hideCondition";t["TabsShowActiveTerminal"]="terminal.integrated.tabs.showActiveTerminal";t["TabsShowActions"]="terminal.integrated.tabs.showActions";t["TabsLocation"]="terminal.integrated.tabs.location";t["TabsFocusMode"]="terminal.integrated.tabs.focusMode";t["MacOptionIsMeta"]="terminal.integrated.macOptionIsMeta";t["MacOptionClickForcesSelection"]="terminal.integrated.macOptionClickForcesSelection";t["AltClickMovesCursor"]="terminal.integrated.altClickMovesCursor";t["CopyOnSelection"]="terminal.integrated.copyOnSelection";t["EnableMultiLinePasteWarning"]="terminal.integrated.enableMultiLinePasteWarning";t["DrawBoldTextInBrightColors"]="terminal.integrated.drawBoldTextInBrightColors";t["FontFamily"]="terminal.integrated.fontFamily";t["FontSize"]="terminal.integrated.fontSize";t["LetterSpacing"]="terminal.integrated.letterSpacing";t["LineHeight"]="terminal.integrated.lineHeight";t["MinimumContrastRatio"]="terminal.integrated.minimumContrastRatio";t["TabStopWidth"]="terminal.integrated.tabStopWidth";t["FastScrollSensitivity"]="terminal.integrated.fastScrollSensitivity";t["MouseWheelScrollSensitivity"]="terminal.integrated.mouseWheelScrollSensitivity";t["BellDuration"]="terminal.integrated.bellDuration";t["FontWeight"]="terminal.integrated.fontWeight";t["FontWeightBold"]="terminal.integrated.fontWeightBold";t["CursorBlinking"]="terminal.integrated.cursorBlinking";t["CursorStyle"]="terminal.integrated.cursorStyle";t["CursorStyleInactive"]="terminal.integrated.cursorStyleInactive";t["CursorWidth"]="terminal.integrated.cursorWidth";t["Scrollback"]="terminal.integrated.scrollback";t["DetectLocale"]="terminal.integrated.detectLocale";t["DefaultLocation"]="terminal.integrated.defaultLocation";t["GpuAcceleration"]="terminal.integrated.gpuAcceleration";t["TerminalTitleSeparator"]="terminal.integrated.tabs.separator";t["TerminalTitle"]="terminal.integrated.tabs.title";t["TerminalDescription"]="terminal.integrated.tabs.description";t["RightClickBehavior"]="terminal.integrated.rightClickBehavior";t["MiddleClickBehavior"]="terminal.integrated.middleClickBehavior";t["Cwd"]="terminal.integrated.cwd";t["ConfirmOnExit"]="terminal.integrated.confirmOnExit";t["ConfirmOnKill"]="terminal.integrated.confirmOnKill";t["EnableBell"]="terminal.integrated.enableBell";t["EnableVisualBell"]="terminal.integrated.enableVisualBell";t["CommandsToSkipShell"]="terminal.integrated.commandsToSkipShell";t["AllowChords"]="terminal.integrated.allowChords";t["AllowMnemonics"]="terminal.integrated.allowMnemonics";t["TabFocusMode"]="terminal.integrated.tabFocusMode";t["EnvMacOs"]="terminal.integrated.env.osx";t["EnvLinux"]="terminal.integrated.env.linux";t["EnvWindows"]="terminal.integrated.env.windows";t["EnvironmentChangesRelaunch"]="terminal.integrated.environmentChangesRelaunch";t["ShowExitAlert"]="terminal.integrated.showExitAlert";t["SplitCwd"]="terminal.integrated.splitCwd";t["WindowsUseConptyDll"]="terminal.integrated.windowsUseConptyDll";t["WordSeparators"]="terminal.integrated.wordSeparators";t["EnableFileLinks"]="terminal.integrated.enableFileLinks";t["AllowedLinkSchemes"]="terminal.integrated.allowedLinkSchemes";t["UnicodeVersion"]="terminal.integrated.unicodeVersion";t["EnablePersistentSessions"]="terminal.integrated.enablePersistentSessions";t["PersistentSessionReviveProcess"]="terminal.integrated.persistentSessionReviveProcess";t["HideOnStartup"]="terminal.integrated.hideOnStartup";t["HideOnLastClosed"]="terminal.integrated.hideOnLastClosed";t["PreserveDrawingBuffer"]="terminal.integrated.preserveDrawingBuffer";t["CustomGlyphs"]="terminal.integrated.customGlyphs";t["RescaleOverlappingGlyphs"]="terminal.integrated.rescaleOverlappingGlyphs";t["PersistentSessionScrollback"]="terminal.integrated.persistentSessionScrollback";t["InheritEnv"]="terminal.integrated.inheritEnv";t["ShowLinkHover"]="terminal.integrated.showLinkHover";t["IgnoreProcessNames"]="terminal.integrated.ignoreProcessNames";t["ShellIntegrationEnabled"]="terminal.integrated.shellIntegration.enabled";t["ShellIntegrationShowWelcome"]="terminal.integrated.shellIntegration.showWelcome";t["ShellIntegrationDecorationsEnabled"]="terminal.integrated.shellIntegration.decorationsEnabled";t["ShellIntegrationTimeout"]="terminal.integrated.shellIntegration.timeout";t["ShellIntegrationQuickFixEnabled"]="terminal.integrated.shellIntegration.quickFixEnabled";t["ShellIntegrationEnvironmentReporting"]="terminal.integrated.shellIntegration.environmentReporting";t["EnableImages"]="terminal.integrated.enableImages";t["SmoothScrolling"]="terminal.integrated.smoothScrolling";t["IgnoreBracketedPasteMode"]="terminal.integrated.ignoreBracketedPasteMode";t["FocusAfterRun"]="terminal.integrated.focusAfterRun";t["FontLigaturesEnabled"]="terminal.integrated.fontLigatures.enabled";t["FontLigaturesFeatureSettings"]="terminal.integrated.fontLigatures.featureSettings";t["FontLigaturesFallbackLigatures"]="terminal.integrated.fontLigatures.fallbackLigatures";t["EnableKittyKeyboardProtocol"]="terminal.integrated.enableKittyKeyboardProtocol";t["EnableWin32InputMode"]="terminal.integrated.enableWin32InputMode";t["AllowInUntrustedWorkspace"]="terminal.integrated.allowInUntrustedWorkspace";t["DeveloperPtyHostLatency"]="terminal.integrated.developer.ptyHost.latency";t["DeveloperPtyHostStartupDelay"]="terminal.integrated.developer.ptyHost.startupDelay";t["DevMode"]="terminal.integrated.developer.devMode"})(pD||(pD={}));var gD;(function(t){t["Bash"]="bash";t["Fish"]="fish";t["Sh"]="sh";t["Csh"]="csh";t["Ksh"]="ksh";t["Zsh"]="zsh"})(gD||(gD={}));var Vy;(function(t){t["CommandPrompt"]="cmd";t["Wsl"]="wsl";t["GitBash"]="gitbash"})(Vy||(Vy={}));var mD;(function(t){t["PowerShell"]="pwsh";t["Python"]="python";t["Julia"]="julia";t["NuShell"]="nu";t["Node"]="node";t["Xonsh"]="xonsh"})(mD||(mD={}));var _D;(function(t){t[t["Api"]=0]="Api";t[t["Process"]=1]="Process";t[t["Sequence"]=2]="Sequence";t[t["Config"]=3]="Config"})(_D||(_D={}));var vD;(function(t){t["LocalPty"]="localPty";t["PtyHost"]="ptyHost";t["PtyHostWindow"]="ptyHostWindow";t["Logger"]="logger";t["Heartbeat"]="heartbeat"})(vD||(vD={}));var gu;(function(t){t["Cwd"]="cwd";t["InitialCwd"]="initialCwd";t["FixedDimensions"]="fixedDimensions";t["Title"]="title";t["ShellType"]="shellType";t["HasChildProcesses"]="hasChildProcesses";t["ResolvedShellLaunchConfig"]="resolvedShellLaunchConfig";t["OverrideDimensions"]="overrideDimensions";t["FailedShellIntegrationActivation"]="failedShellIntegrationActivation";t["UsedShellIntegrationInjection"]="usedShellIntegrationInjection";t["ShellIntegrationInjectionFailureReason"]="shellIntegrationInjectionFailureReason"})(gu||(gu={}));var wD;(function(t){t[t["BeatInterval"]=5e3]="BeatInterval";t[t["ConnectingBeatInterval"]=2e4]="ConnectingBeatInterval";t[t["FirstWaitMultiplier"]=1.2]="FirstWaitMultiplier";t[t["SecondWaitMultiplier"]=1]="SecondWaitMultiplier";t[t["CreateProcessTimeout"]=5e3]="CreateProcessTimeout"})(wD||(wD={}));var bD;(function(t){t[t["Panel"]=1]="Panel";t[t["Editor"]=2]="Editor"})(bD||(bD={}));var yD;(function(t){t["TerminalView"]="view";t["Editor"]="editor"})(yD||(yD={}));var SD;(function(t){t[t["GraceTime"]=6e4]="GraceTime";t[t["ShortGraceTime"]=6e3]="ShortGraceTime"})(SD||(SD={}));var xD;(function(t){t[t["HighWatermarkChars"]=1e5]="HighWatermarkChars";t[t["LowWatermarkChars"]=5e3]="LowWatermarkChars";t[t["CharCountAckSize"]=5e3]="CharCountAckSize"})(xD||(xD={}));var ED;(function(t){t["GitBash"]="Git Bash";t["Pwsh"]="PowerShell"})(ED||(ED={}));var CD;(function(t){t[t["Off"]=0]="Off";t[t["FinalTerm"]=1]="FinalTerm";t[t["VSCode"]=2]="VSCode"})(CD||(CD={}));var kD;(function(t){t["InjectionSettingDisabled"]="injectionSettingDisabled";t["NoExecutable"]="noExecutable";t["FeatureTerminal"]="featureTerminal";t["IgnoreShellIntegrationFlag"]="ignoreShellIntegrationFlag";t["UnsupportedWindowsBuild"]="unsupportedWindowsBuild";t["UnsupportedArgs"]="unsupportedArgs";t["UnsupportedShell"]="unsupportedShell";t["FailedToSetStickyBit"]="failedToSetStickyBit";t["FailedToCreateTmpDir"]="failedToCreateTmpDir"})(kD||(kD={}));var DD;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Shutdown"]=1]="Shutdown";t[t["Process"]=2]="Process";t[t["User"]=3]="User";t[t["Extension"]=4]="Extension"})(DD||(DD={}));const FO={Backend:"workbench.contributions.terminal.processBackend"};function zy(t){return t?.toLowerCase()??""}class UO{constructor(e){this.remoteAuthority=e}affects(e){return zy(e)===this.remoteAuthority}}class $O{constructor(){this._backends=new Map;this._onDidChangeBackends=new L;this.onDidChangeBackends=this._onDidChangeBackends.event}get backends(){return this._backends}registerTerminalBackend(e){const i=zy(e.remoteAuthority);if(this._backends.has(i)){throw new Error(`A terminal backend with remote authority '${i}' was already registered.`)}this._backends.set(i,e);this._onDidChangeBackends.fire(new UO(i))}getTerminalBackend(e){return this._backends.get(zy(e))}}ei.add(FO.Backend,new $O);class HO{constructor(e){this._callback=e;this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values()){e.dispose()}}startBuffering(e,i,n=5){const s=i(r=>{const o=Xe(r)?r:r.data;let a=this._terminalBufferMap.get(e);if(a){a.data.push(o);return}const l=setTimeout(()=>this.flushBuffer(e),n);a={data:[o],timeoutId:l,dispose:()=>{clearTimeout(l);this.flushBuffer(e);s.dispose()}};this._terminalBufferMap.set(e,a)});return s}stopBuffering(e){const i=this._terminalBufferMap.get(e);i?.dispose()}flushBuffer(e){const i=this._terminalBufferMap.get(e);if(i){this._terminalBufferMap.delete(e);this._callback(e,i.data.join(""))}}}const oa=(t,e,i,n)=>{let s=e;return{enumerable:true,configurable:false,get(){return s},set(r){if(!i(s,r)){const o=s;s=r;t.listener?.(n(r,o))}}}};const Fl=(t,e)=>t===e;const to={range:(t,e)=>{if(t===e){return true}if(!t||!e){return false}return t.isEqual(e)},label:Fl,description:Fl,sortText:Fl,busy:Fl,error:Fl,canResolveChildren:Fl,tags:(t,e)=>{if(t.length!==e.length){return false}if(t.some(i=>!e.find(n=>i.id===n.id))){return false}return true}};const Ul=t=>e=>({op:Di.SetProp,update:t(e)});const BO=(t,e)=>({range:(()=>{let i;const n=Ul(s=>({range:_t.lift(V.from(s))}));return{enumerable:true,configurable:false,get(){return i},set(s){t.listener?.({op:Di.DocumentSynced});if(!to.range(i,s)){i=s;t.listener?.(n(s))}}}})(),label:oa(t,e,to.label,Ul(i=>({label:i}))),description:oa(t,void 0,to.description,Ul(i=>({description:i}))),sortText:oa(t,void 0,to.sortText,Ul(i=>({sortText:i}))),canResolveChildren:oa(t,false,to.canResolveChildren,i=>({op:Di.UpdateCanResolveChildren,state:i})),busy:oa(t,false,to.busy,Ul(i=>({busy:i}))),error:oa(t,void 0,to.error,Ul(i=>({error:we.fromStrict(i)||null}))),tags:oa(t,[],to.tags,(i,n)=>({op:Di.SetTags,new:i.map(Os.from),old:n.map(Os.from)}))});const WO=t=>{const e=Me.fromString(t.extId);const i=new kl(e.controllerId,e.localId,t.label,b.revive(t.uri)||void 0);i.range=V.to(t.range||void 0);i.description=t.description||void 0;i.sortText=t.sortText||void 0;i.tags=t.tags.map(n=>Os.to({id:jP(n).tagId}));return i};const ID=t=>{let e;for(const i of t.tests){const n=WO(i.item);B_(n).parent=e;e=n}return e};class kl{constructor(e,i,n,s){if(i.includes(Ln.Delimiter)){throw new Error(`Test IDs may not include the ${JSON.stringify(i)} symbol`)}const r=cM(this,e);Object.defineProperties(this,{id:{value:i,enumerable:true,writable:false},uri:{value:s,enumerable:true,writable:false},parent:{enumerable:false,get(){return r.parent instanceof Sx?void 0:r.parent}},children:{value:lM(r,B_,kl),enumerable:true,writable:false},...BO(r,n)})}}class Sx extends kl{constructor(e,i){super(e,e,i,void 0);this._isRoot=true}}class VO extends rM{constructor(e,i,n){super({controllerId:e,getDocumentVersion:s=>s&&n.getDocument(s)?.version,getApiFor:B_,getChildren:s=>s.children,root:new Sx(e,i),toITestItem:jo.from})}}let qy=class Fz extends me{constructor(e,i,n){super();this.initData=i;this._onDidChangeTelemetryEnabled=this._register(new L);this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event;this._onDidChangeTelemetryConfiguration=this._register(new L);this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event;this._productConfig={usage:true,error:true};this._level=Pr.NONE;this._inLoggingOnlyMode=false;this._telemetryLoggers=new Map;this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly;const s=i.remote.isRemote?"remoteExtHostTelemetry":e?"workerExtHostTelemetry":"extHostTelemetry";this._outputLogger=this._register(n.createLogger(s,{name:h(2705,"Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:true,group:JN}))}getTelemetryConfiguration(){return this._level===Pr.USAGE}getTelemetryDetails(){return{isCrashEnabled:this._level>=Pr.CRASH,isErrorsEnabled:this._productConfig.error?this._level>=Pr.ERROR:false,isUsageEnabled:this._productConfig.usage?this._level>=Pr.USAGE:false}}instantiateLogger(e,i,n){const s=this.getTelemetryDetails();const r=new HA(i,n,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:s.isUsageEnabled,isErrorsEnabled:s.isErrorsEnabled});const o=this._telemetryLoggers.get(e.identifier.value)??[];this._telemetryLoggers.set(e.identifier.value,[...o,r]);return r.apiTelemetryLogger}$initializeTelemetryLevel(e,i,n){this._level=e;this._productConfig=n??{usage:true,error:true}}getBuiltInCommonProperties(e){const i=Object.create(null);i["common.extname"]=`${e.publisher}.${e.name}`;i["common.extversion"]=e.version;i["common.vscodemachineid"]=this.initData.telemetryInfo.machineId;i["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId;i["common.vscodecommithash"]=this.initData.commit;i["common.sqmid"]=this.initData.telemetryInfo.sqmId;i["common.devDeviceId"]=this.initData.telemetryInfo.devDeviceId??this.initData.telemetryInfo.machineId;i["common.vscodeversion"]=this.initData.version;i["common.vscodereleasedate"]=this.initData.date;i["common.isnewappinstall"]=BA(this.initData.telemetryInfo.firstSessionDate);i["common.product"]=this.initData.environment.appHost;switch(this.initData.uiKind){case Wd.Web:i["common.uikind"]="web";break;case Wd.Desktop:i["common.uikind"]="desktop";break;default:i["common.uikind"]="unknown"}i["common.remotename"]=YN(this.initData.remote.authority,this.initData);return i}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration();this._level=e;const i=this.getTelemetryDetails();this._telemetryLoggers.forEach((n,s)=>{const r=n.filter(o=>!o.isDisposed);if(r.length===0){this._telemetryLoggers.delete(s)}else{this._telemetryLoggers.set(s,r)}});this._telemetryLoggers.forEach(n=>{for(const s of n){s.updateTelemetryEnablements(i.isUsageEnabled,i.isErrorsEnabled)}});if(this._oldTelemetryEnablement!==this.getTelemetryConfiguration()){this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration())}this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails())}onExtensionError(e,i){const n=this._telemetryLoggers.get(e.value);const s=n?.filter(o=>!o.isDisposed);if(!s){this._telemetryLoggers.delete(e.value);return false}let r=false;for(const o of s){if(o.ignoreUnhandledExtHostErrors){continue}o.logError(i);r=true}return r}};qy=W([P(1,wi),P(2,Ko)],qy);class HA{static validateSender(e){if(typeof e!=="object"){throw new TypeError("TelemetrySender argument is invalid")}if(typeof e.sendEventData!=="function"){throw new TypeError("TelemetrySender.sendEventData must be a function")}if(typeof e.sendErrorData!=="function"){throw new TypeError("TelemetrySender.sendErrorData must be a function")}if(typeof e.flush!=="undefined"&&typeof e.flush!=="function"){throw new TypeError("TelemetrySender.flush must be a function or undefined")}}constructor(e,i,n,s,r,o,a){this._extension=n;this._logger=s;this._inLoggingOnlyMode=r;this._commonProperties=o;this._onDidChangeEnableStates=new L;this.ignoreUnhandledExtHostErrors=i?.ignoreUnhandledErrors??false;this._ignoreBuiltinCommonProperties=i?.ignoreBuiltInCommonProperties??false;this._additionalCommonProperties=i?.additionalCommonProperties;this._sender=e;this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,i){if(this._apiObject){this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:i};this._onDidChangeEnableStates.fire(this._apiObject)}}mixInCommonPropsAndCleanData(e){let i=e.properties?e.properties??{}:e;i=$k(i,[]);if(this._additionalCommonProperties){i=ol(i,this._additionalCommonProperties)}if(!this._ignoreBuiltinCommonProperties){i=ol(i,this._commonProperties)}if(e.properties){e.properties=i}else{e=i}return e}logEvent(e,i){if(!this._sender){return}if(this._extension.publisher==="vscode"){e=this._extension.name+"/"+e}else{e=this._extension.identifier.value+"/"+e}i=this.mixInCommonPropsAndCleanData(i||{});if(!this._inLoggingOnlyMode){this._sender?.sendEventData(e,i)}this._logger.trace(e,i)}logUsage(e,i){if(!this._telemetryEnablements.isUsageEnabled){return}this.logEvent(e,i)}logError(e,i){if(!this._telemetryEnablements.isErrorsEnabled||!this._sender){return}if(typeof e==="string"){this.logEvent(e,i)}else{const n={name:e.name,message:e.message,stack:e.stack,cause:e.cause};const s=$k(n,[]);const r=new Error(typeof s.message==="string"?s.message:void 0,{cause:s.cause});r.stack=typeof s.stack==="string"?s.stack:void 0;r.name=typeof s.name==="string"?s.name:"unknown";i=this.mixInCommonPropsAndCleanData(i||{});if(!this._inLoggingOnlyMode){this._sender.sendErrorData(r,i)}this._logger.trace("exception",i)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this;const i={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(i)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){if(this._sender?.flush){let e=this._sender;this._sender=void 0;Promise.resolve(e.flush()).then(e=void 0);this._apiObject=void 0}else{this._sender=void 0}}}function BA(t){const e=Date.now()-new Date(t).getTime();return isNaN(e)?false:e<1e3*60*60*24}const ev=te("IExtHostTelemetry");let jy=class Uz{#e;#t;#i;constructor(e,i,n){this._commands=new Map;this._apiCommands=new Map;this.#e=e.getProxy(ee.MainThreadCommands);this._logService=i;this.#i=n;this.#t=e.getProxy(ee.MainThreadTelemetry);this.converter=new zO(this,s=>{const r=this._apiCommands.get(s);return r?.result===De.Void?r:void 0},i);this._argumentProcessors=[{processArgument(s){return Wi(s)}},{processArgument(s){return $c(s,function(r){if(_t.isIRange(r)){return V.to(r)}if($n.isIPosition(r)){return ut.to(r)}if(_t.isIRange(r.range)&&b.isUri(r.uri)){return wn.to(r)}if(r instanceof ae){return r.buffer.buffer}if(!Array.isArray(r)){return r}})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const i=this.registerCommand(false,e.id,async(...n)=>{const s=e.args.map((o,a)=>{if(!o.validate(n[a])){throw new Error(`Invalid argument '${o.name}' when running '${e.id}', received: ${typeof n[a]==="object"?JSON.stringify(n[a],null,"	"):n[a]} `)}return o.convert(n[a])});const r=await this.executeCommand(e.internalId,...s);return e.result.convert(r,n,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});this._apiCommands.set(e.id,e);return new Ve(()=>{i.dispose();this._apiCommands.delete(e.id)})}registerCommand(e,i,n,s,r,o){this._logService.trace("ExtHostCommands#registerCommand",i);if(!i.trim().length){throw new Error("invalid id")}if(this._commands.has(i)){throw new Error(`command '${i}' already exists`)}this._commands.set(i,{callback:n,thisArg:s,metadata:r,extension:o});if(e){this.#e.$registerCommand(i)}return new Ve(()=>{if(this._commands.delete(i)){if(e){this.#e.$unregisterCommand(i)}}})}executeCommand(e,...i){this._logService.trace("ExtHostCommands#executeCommand",e);return this._doExecuteCommand(e,i,true)}async _doExecuteCommand(e,i,n){if(this._commands.has(e)){this.#e.$fireCommandActivationEvent(e);return this._executeContributedCommand(e,i,false)}else{let s=false;const r=$c(i,function(o){if(o instanceof je){return ut.from(o)}else if(o instanceof Fe){return V.from(o)}else if(o instanceof Tn){return wn.from(o)}else if(tr.isNotebookRange(o)){return ar.from(o)}else if(o instanceof ArrayBuffer){s=true;return ae.wrap(new Uint8Array(o))}else if(o instanceof Uint8Array){s=true;return ae.wrap(o)}else if(o instanceof ae){s=true;return o}if(!Array.isArray(o)){return o}});try{const o=await this.#e.$executeCommand(e,s?new ji(r):r,n);return Wi(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry"){return this._doExecuteCommand(e,i,false)}else{throw o}}}}async _executeContributedCommand(e,i,n){const s=this._commands.get(e);if(!s){throw new Error("Unknown command")}const{callback:r,thisArg:o,metadata:a}=s;if(a?.args){for(let c=0;c<a.args.length;c++){try{HT(i[c],a.args[c].constraint)}catch(u){throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[c].name}' - ${a.args[c].description}`)}}}const l=Wr.create();try{return await r.apply(o,i)}catch(c){if(e===this.converter.delegatingCommandId){const u=this.converter.getActualCommand(...i);if(u){e=u.command}}if(!Ls(c)){this._logService.error(c,e,s.extension?.identifier)}if(!n){throw c}if(s.extension?.identifier){const u=this.#i.onExtensionError(s.extension.identifier,c);this._logService.trace("forwarded error to extension?",u,s.extension?.identifier)}throw new class $z extends Error{constructor(){super(xu(c));this.id=e;this.source=s.extension?.displayName??s.extension?.name}}}finally{this._reportTelemetry(s,e,l.elapsed())}}_reportTelemetry(e,i,n){if(!e.extension){return}if(i.startsWith("code.copilot.logStructured")){return}this.#t.$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new ex(i),duration:n})}$executeContributedCommand(e,...i){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const n=this._commands.get(e);if(!n){return Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}else{i=i.map(s=>this._argumentProcessors.reduce((r,o)=>o.processArgument(r,n.extension),s));return this._executeContributedCommand(e,i,true)}}getCommands(e=false){this._logService.trace("ExtHostCommands#getCommands",e);return this.#e.$getCommands().then(i=>{if(e){i=i.filter(n=>n[0]!=="_")}return i})}$getContributedCommandMetadata(){const e=Object.create(null);for(const[i,n]of this._commands){const{metadata:s}=n;if(s){e[i]=s}}return Promise.resolve(e)}};jy=W([P(0,st),P(1,et),P(2,ev)],jy);const Zo=te("IExtHostCommands");class zO{constructor(e,i,n){this._commands=e;this._lookupApiCommand=i;this._logService=n;this.delegatingCommandId=`__vsc${Pi()}`;this._cache=new Map;this._cachIdPool=0;this._commands.registerCommand(true,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,i){if(!e){return void 0}const n={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command){return n}const s=this._lookupApiCommand(e.command);if(s){n.id=s.internalId;n.arguments=s.args.map((r,o)=>r.convert(e.arguments&&e.arguments[o]))}else if(rf(e.arguments)){const r=`${e.command} /${++this._cachIdPool}`;this._cache.set(r,e);i.add(ye(()=>{this._cache.delete(r);this._logService.trace("CommandsConverter#DISPOSE",r)}));n.$ident=r;n.id=this.delegatingCommandId;n.arguments=[r];this._logService.trace("CommandsConverter#CREATE",e.command,r)}return n}fromInternal(e){if(typeof e.$ident==="string"){return this._cache.get(e.$ident)}else{return{command:e.id,title:e.title,arguments:e.arguments}}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const i=this.getActualCommand(...e);this._logService.trace("CommandsConverter#EXECUTE",e[0],i?i.command:"MISSING");if(!i){return Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}return this._commands.executeCommand(i.command,...i.arguments||[])}}class z{static{this.Uri=new z("uri","Uri of a text document",e=>b.isUri(e),e=>e)}static{this.Position=new z("position","A position in a text document",e=>je.isPosition(e),ut.from)}static{this.Range=new z("range","A range in a text document",e=>Fe.isRange(e),V.from)}static{this.Selection=new z("selection","A selection in a text document",e=>or.isSelection(e),Ms.from)}static{this.Number=new z("number","",e=>typeof e==="number",e=>e)}static{this.String=new z("string","",e=>typeof e==="string",e=>e)}static Arr(e){return new z(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,i=>Array.isArray(i)&&i.every(n=>e.validate(n)),i=>i.map(n=>e.convert(n)))}static{this.CallHierarchyItem=new z("item","A call hierarchy item",e=>e instanceof tx,gl.from)}static{this.TypeHierarchyItem=new z("item","A type hierarchy item",e=>e instanceof sx,Za.from)}static{this.TestItem=new z("testItem","A VS Code TestItem",e=>e instanceof kl,jo.from)}static{this.TestProfile=new z("testProfile","A VS Code test profile",e=>e instanceof oA,ny.from)}constructor(e,i,n,s){this.name=e;this.description=i;this.validate=n;this.convert=s}optional(){return new z(this.name,`(optional) ${this.description}`,e=>e===void 0||e===null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(e,i){return new z(e??this.name,i??this.description,this.validate,this.convert)}}class De{static{this.Void=new De("no result",e=>e)}constructor(e,i){this.description=e;this.convert=i}}class Pe{constructor(e,i,n,s,r){this.id=e;this.internalId=i;this.description=n;this.args=s;this.result=r}}const Du=te("IExtHostTerminalService");class TD extends me{constructor(e,i,n,s){super();this._proxy=e;this._id=i;this._creationOptions=n;this._name=s;this._disposed=false;this._state={isInteractedWith:false,shell:void 0};this.isOpen=false;this._onWillDispose=this._register(new L);this.onWillDispose=this._onWillDispose.event;this._creationOptions=Object.freeze(this._creationOptions);this._pidPromise=new Promise(o=>this._pidPromiseComplete=o);const r=this;this.value={get name(){return r._name||""},get processId(){return r._pidPromise},get creationOptions(){return r._creationOptions},get exitStatus(){return r._exitStatus},get state(){return r._state},get selection(){return r._selection},get shellIntegration(){return r.shellIntegration},sendText(o,a=true){r._checkDisposed();r._proxy.$sendText(r._id,o,a)},show(o){r._checkDisposed();r._proxy.$show(r._id,o)},hide(){r._checkDisposed();r._proxy.$hide(r._id)},dispose(){if(!r._disposed){r._disposed=true;r._proxy.$dispose(r._id)}},get dimensions(){if(r._cols===void 0||r._rows===void 0){return void 0}return{columns:r._cols,rows:r._rows}}}}dispose(){this._onWillDispose.fire();super.dispose()}async create(e,i){if(typeof this._id!=="string"){throw new Error("Terminal has already been created")}await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??i?.cwd??void 0,env:e.env??void 0,icon:WA(e.iconPath)??void 0,color:Hc.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:i?.forceShellIntegration??void 0,isFeatureTerminal:i?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:true,useShellEnvironment:i?.useShellEnvironment??void 0,location:i?.location||this._serializeParentTerminal(e.location,i?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0,shellIntegrationNonce:e.shellIntegrationNonce??void 0})}async createExtensionTerminal(e,i,n,s,r,o){if(typeof this._id!=="string"){throw new Error("Terminal has already been created")}await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:true,icon:s,color:Hc.isThemeColor(r)?r.id:void 0,location:i?.location||this._serializeParentTerminal(e,n),isTransient:true,shellIntegrationNonce:o??void 0});if(typeof this._id==="string"){throw new Error("Terminal creation failed")}return this._id}_serializeParentTerminal(e,i){if(typeof e==="object"){if(mo(e,{parentTerminal:true})&&e.parentTerminal&&i){return{parentTerminal:i}}if(mo(e,{viewColumn:true})){return{viewColumn:_i.from(e.viewColumn),preserveFocus:e.preserveFocus}}return void 0}return e}_checkDisposed(){if(this._disposed){throw new Error("Terminal has already been disposed")}}set name(e){this._name=e}setExitStatus(e,i){this._exitStatus=Object.freeze({code:e,reason:i})}setDimensions(e,i){if(e===this._cols&&i===this._rows){return false}if(e===0||i===0){return false}this._cols=e;this._rows=i;return true}setInteractedWith(){if(!this._state.isInteractedWith){this._state={...this._state,isInteractedWith:true};return true}return false}setShellType(e){if(this._state.shell!==e){this._state={...this._state,shell:e};return true}return false}setSelection(e){this._selection=e}_setProcessId(e){if(this._pidPromiseComplete){this._pidPromiseComplete(e);this._pidPromiseComplete=void 0}else{this._pidPromise.then(i=>{if(i!==e){this._pidPromise=Promise.resolve(e)}})}}}class Yv{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e;this.id=0;this.shouldPersist=false;this._onProcessData=new L;this.onProcessData=this._onProcessData.event;this._onProcessReady=new L;this._onDidChangeProperty=new L;this.onDidChangeProperty=this._onDidChangeProperty.event;this._onProcessExit=new L;this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,i){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${i}`)}async start(){return void 0}shutdown(){this._pty.close()}input(e){this._pty.handleInput?.(e)}sendSignal(e){}resize(e,i){this._pty.setDimensions?.({columns:e,rows:i})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){this._pty.onDidWrite(i=>this._onProcessData.fire(i));this._pty.onDidClose?.((i=void 0)=>{this._onProcessExit.fire(i===void 0?void 0:i)});this._pty.onDidOverrideDimensions?.(i=>{if(i){this._onDidChangeProperty.fire({type:gu.OverrideDimensions,value:{cols:i.columns,rows:i.rows}})}});this._pty.onDidChangeName?.(i=>{this._onDidChangeProperty.fire({type:gu.Title,value:i})});this._pty.open(e?e:void 0);if(e){this._pty.setDimensions?.(e)}this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let qO=1;let Gy=class Hz extends me{get activeTerminal(){return this._activeTerminal?.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,i,n){super();this._extHostCommands=i;this._terminals=[];this._terminalProcesses=new Map;this._terminalProcessDisposables={};this._extensionTerminalAwaitingStart={};this._getTerminalPromises={};this._environmentVariableCollections=new Map;this._lastQuickFixCommands=this._register(new $r);this._linkProviders=new Set;this._completionProviders=new Map;this._profileProviders=new Map;this._quickFixProviders=new Map;this._terminalLinkCache=new Map;this._terminalLinkCancellationSource=new Map;this._onDidCloseTerminal=new L;this.onDidCloseTerminal=this._onDidCloseTerminal.event;this._onDidOpenTerminal=new L;this.onDidOpenTerminal=this._onDidOpenTerminal.event;this._onDidChangeActiveTerminal=new L;this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event;this._onDidChangeTerminalDimensions=new L;this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event;this._onDidChangeTerminalState=new L;this.onDidChangeTerminalState=this._onDidChangeTerminalState.event;this._onDidChangeShell=new L;this.onDidChangeShell=this._onDidChangeShell.event;this._onDidWriteTerminalData=new L({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()});this.onDidWriteTerminalData=this._onDidWriteTerminalData.event;this._onDidExecuteCommand=new L({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()});this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event;this._proxy=n.getProxy(ee.MainThreadTerminalService);this._bufferer=new HO(this._proxy.$sendProcessData);this._proxy.$registerProcessSupport(e);this._extHostCommands.registerArgumentProcessor({processArgument:s=>{const r=o=>{return this.getTerminalById(o.instanceId)?.value};switch(s?.$mid){case nt.TerminalContext:return r(s);default:{if(Array.isArray(s)){for(let o=0;o<s.length;o++){if(s[o].$mid===nt.TerminalContext){s[o]=r(s[o])}else{break}}}return s}}}});this._register({dispose:()=>{for(const[s,r]of this._terminalProcesses){r.shutdown(true)}}})}getDefaultShell(e){const i=e?this._defaultAutomationProfile:this._defaultProfile;return i?.path||""}getDefaultShellArgs(e){const i=e?this._defaultAutomationProfile:this._defaultProfile;return i?.args||[]}createExtensionTerminal(e,i){const n=new TD(this._proxy,Pi(),e,e.name);const s=new Yv(e.pty);n.createExtensionTerminal(e.location,i,this._serializeParentTerminal(e,i).resolvedExtHostIdentifier,WA(e.iconPath),GO(e.color),e.shellIntegrationNonce).then(r=>{const o=this._setupExtHostProcessListeners(r,s);this._terminalProcessDisposables[r]=o});this._terminals.push(n);return n.value}_serializeParentTerminal(e,i){i=i?i:{};if(e.location&&typeof e.location==="object"&&mo(e.location,{parentTerminal:true})){const n=e.location.parentTerminal;if(n){const s=this._terminals.find(r=>r.value===n);if(s){i.resolvedExtHostIdentifier=s._id}}}else if(e.location&&typeof e.location!=="object"){i.location=e.location}else if(i.location&&typeof i.location==="object"&&mo(i.location,{splitActiveTerminal:true})){i.location={splitActiveTerminal:true}}return i}attachPtyToTerminal(e,i){const n=this.getTerminalById(e);if(!n){throw new Error(`Cannot resolve terminal with id ${e} for virtual process`)}const s=new Yv(i);const r=this._setupExtHostProcessListeners(e,s);this._terminalProcessDisposables[e]=r}async $acceptActiveTerminalChanged(e){const i=this._activeTerminal;if(e===null){this._activeTerminal=void 0;if(i!==this._activeTerminal){this._onDidChangeActiveTerminal.fire(this._activeTerminal)}return}const n=this.getTerminalById(e);if(n){this._activeTerminal=n;if(i!==this._activeTerminal){this._onDidChangeActiveTerminal.fire(this._activeTerminal.value)}}}async $acceptTerminalProcessData(e,i){const n=this.getTerminalById(e);if(n){this._onDidWriteTerminalData.fire({terminal:n.value,data:i})}}async $acceptTerminalDimensions(e,i,n){const s=this.getTerminalById(e);if(s){if(s.setDimensions(i,n)){this._onDidChangeTerminalDimensions.fire({terminal:s.value,dimensions:s.value.dimensions})}}}async $acceptDidExecuteCommand(e,i){const n=this.getTerminalById(e);if(n){this._onDidExecuteCommand.fire({terminal:n.value,...i})}}async $acceptTerminalMaximumDimensions(e,i,n){this._terminalProcesses.get(e)?.resize(i,n)}async $acceptTerminalTitleChange(e,i){const n=this.getTerminalById(e);if(n){n.name=i}}async $acceptTerminalClosed(e,i,n){const s=this._getTerminalObjectIndexById(this._terminals,e);if(s!==null){const r=this._terminals.splice(s,1)[0];r.setExitStatus(i,n);this._onDidCloseTerminal.fire(r.value)}}$acceptTerminalOpened(e,i,n,s){if(i){const a=this._getTerminalObjectIndexById(this._terminals,i);if(a!==null){this._terminals[a]._id=e;this._onDidOpenTerminal.fire(this.terminals[a]);this._terminals[a].isOpen=true;return}}const r={name:s.name,shellPath:s.executable,shellArgs:s.args,cwd:typeof s.cwd==="string"?s.cwd:b.revive(s.cwd),env:s.env,hideFromUser:s.hideFromUser};const o=new TD(this._proxy,e,r,n);this._terminals.push(o);this._onDidOpenTerminal.fire(o.value);o.isOpen=true}async $acceptTerminalProcessId(e,i){const n=this.getTerminalById(e);n?._setProcessId(i)}async $startExtensionTerminal(e,i){const n=this.getTerminalById(e);if(!n){return{message:h(2706,"Could not find the terminal with id {0} on the extension host",e)}}if(!n.isOpen){await new Promise(r=>{const o=this.onDidOpenTerminal(async a=>{if(a===n.value){o.dispose();r()}})})}const s=this._terminalProcesses.get(e);if(s){s.startSendingEvents(i)}else{this._extensionTerminalAwaitingStart[e]={initialDimensions:i}}return void 0}_setupExtHostProcessListeners(e,i){const n=new pe;n.add(i.onProcessReady(r=>this._proxy.$sendProcessReady(e,r.pid,r.cwd,r.windowsPty)));n.add(i.onDidChangeProperty(r=>this._proxy.$sendProcessProperty(e,r)));this._bufferer.startBuffering(e,i.onProcessData);n.add(i.onProcessExit(r=>this._onProcessExit(e,r)));this._terminalProcesses.set(e,i);const s=this._extensionTerminalAwaitingStart[e];if(s&&i instanceof Yv){i.startSendingEvents(s.initialDimensions);delete this._extensionTerminalAwaitingStart[e]}return n}$acceptProcessAckDataEvent(e,i){this._terminalProcesses.get(e)?.acknowledgeDataEvent(i)}$acceptProcessInput(e,i){this._terminalProcesses.get(e)?.input(i)}$acceptTerminalInteraction(e){const i=this.getTerminalById(e);if(i?.setInteractedWith()){this._onDidChangeTerminalState.fire(i.value)}}$acceptTerminalSelection(e,i){this.getTerminalById(e)?.setSelection(i)}$acceptProcessResize(e,i,n){try{this._terminalProcesses.get(e)?.resize(i,n)}catch(s){if(s.code!=="EPIPE"&&s.code!=="ERR_IPC_CHANNEL_CLOSED"){throw s}}}$acceptProcessShutdown(e,i){this._terminalProcesses.get(e)?.shutdown(i)}$acceptProcessRequestInitialCwd(e){this._terminalProcesses.get(e)?.getInitialCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:gu.InitialCwd,value:i}))}$acceptProcessRequestCwd(e){this._terminalProcesses.get(e)?.getCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:gu.Cwd,value:i}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerProfileProvider(e,i,n){if(this._profileProviders.has(i)){throw new Error(`Terminal profile provider "${i}" already registered`)}this._profileProviders.set(i,n);this._proxy.$registerProfileProvider(i,e.identifier.value);return new Ve(()=>{this._profileProviders.delete(i);this._proxy.$unregisterProfileProvider(i)})}registerTerminalCompletionProvider(e,i,...n){if(this._completionProviders.has(e.identifier.value)){throw new Error(`Terminal completion provider "${e.identifier.value}" already registered`)}this._completionProviders.set(e.identifier.value,i);this._proxy.$registerCompletionProvider(e.identifier.value,e.identifier.value,...n);return new Ve(()=>{this._completionProviders.delete(e.identifier.value);this._proxy.$unregisterCompletionProvider(e.identifier.value)})}async $provideTerminalCompletions(e,i){const n=new Tt().token;if(n.isCancellationRequested||!this.activeTerminal){return void 0}const s=this._completionProviders.get(e);if(!s){return}const r=await s.provideTerminalCompletions(this.activeTerminal,i,n);if(r===null||r===void 0){return void 0}const o=!nn||this.activeTerminal.state?.shell===Vy.GitBash?"/":"\\";return gy.from(r,o)}$acceptTerminalShellType(e,i){const n=this.getTerminalById(e);if(n?.setShellType(i)){this._onDidChangeTerminalState.fire(n.value)}}registerTerminalQuickFixProvider(e,i,n){if(this._quickFixProviders.has(e)){throw new Error(`Terminal quick fix provider "${e}" is already registered`)}this._quickFixProviders.set(e,n);this._proxy.$registerQuickFixProvider(e,i);return new Ve(()=>{this._quickFixProviders.delete(e);this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,i){const n=new Tt().token;if(n.isCancellationRequested){return}const s=this._quickFixProviders.get(e);if(!s){return}const r=await s.provideTerminalQuickFixes(i,n);if(r===null||Array.isArray(r)&&r.length===0){return void 0}const o=new pe;this._lastQuickFixCommands.value=o;if(!Array.isArray(r)){return r?e_.from(r,this._extHostCommands.converter,o):void 0}const a=[];for(const l of r){const c=e_.from(l,this._extHostCommands.converter,o);if(c){a.push(c)}}return a}async $createContributedProfileTerminal(e,i){const n=new Tt().token;let s=await this._profileProviders.get(e)?.provideTerminalProfile(n);if(n.isCancellationRequested){return}if(s&&!mo(s,{options:true})){s={options:s}}if(!s||!mo(s,{options:true})){throw new Error(`No terminal profile options provided for id "${e}"`)}if(mo(s.options,{pty:true})){this.createExtensionTerminal(s.options,i);return}this.createTerminalFromOptions(s.options,i)}registerLinkProvider(e){this._linkProviders.add(e);if(this._linkProviders.size===1){this._proxy.$startLinkProvider()}return new Ve(()=>{this._linkProviders.delete(e);if(this._linkProviders.size===0){this._proxy.$stopLinkProvider()}})}async $provideLinks(e,i){const n=this.getTerminalById(e);if(!n){return[]}this._terminalLinkCache.delete(e);const s=this._terminalLinkCancellationSource.get(e);s?.dispose(true);const r=new Tt;this._terminalLinkCancellationSource.set(e,r);const o=[];const a={terminal:n.value,line:i};const l=[];for(const d of this._linkProviders){l.push(Uc.withAsyncBody(async f=>{r.token.onCancellationRequested(()=>f({provider:d,links:[]}));const p=await d.provideTerminalLinks(a,r.token)||[];if(!r.token.isCancellationRequested){f({provider:d,links:p})}}))}const c=await Promise.all(l);if(r.token.isCancellationRequested){return[]}const u=new Map;for(const d of c){if(d&&d.links.length>0){o.push(...d.links.map(f=>{const p={id:qO++,startIndex:f.startIndex,length:f.length,label:f.tooltip};u.set(p.id,{provider:d.provider,link:f});return p}))}}this._terminalLinkCache.set(e,u);return o}$activateLink(e,i){const n=this._terminalLinkCache.get(e)?.get(i);if(!n){return}n.provider.handleTerminalLink(n.link)}_onProcessExit(e,i){this._bufferer.stopBuffering(e);this._terminalProcesses.delete(e);delete this._extensionTerminalAwaitingStart[e];const n=this._terminalProcessDisposables[e];if(n){n.dispose();delete this._terminalProcessDisposables[e]}this._proxy.$sendProcessExit(e,i)}getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}getTerminalIdByApiObject(e){const i=this._terminals.findIndex(n=>{return n.value===e});return i>=0?i:null}_getTerminalObjectById(e,i){const n=this._getTerminalObjectIndexById(e,i);return n!==null?e[n]:null}_getTerminalObjectIndexById(e,i){const n=e.findIndex(s=>{return s._id===i});return n>=0?n:null}getEnvironmentVariableCollection(e){let i=this._environmentVariableCollections.get(e.identifier.value);if(!i){i=this._register(new PD);this._setEnvironmentVariableCollection(e.identifier.value,i)}return i.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,i){const n=MO(i.map);const s=OO(i.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,i.persistent,n.length===0?void 0:n,s)}$initEnvironmentVariableCollections(e){e.forEach(i=>{const n=i[0];const s=this._register(new PD(i[1]));this._setEnvironmentVariableCollection(n,s)})}$acceptDefaultProfile(e,i){const n=this._defaultProfile;this._defaultProfile=e;this._defaultAutomationProfile=i;if(n?.path!==e.path){this._onDidChangeShell.fire(e.path)}}_setEnvironmentVariableCollection(e,i){this._environmentVariableCollections.set(e,i);this._register(i.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,i)}))}};Gy=W([P(1,Zo),P(2,st)],Gy);class PD extends me{get persistent(){return this._persistent}set persistent(e){this._persistent=e;this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){super();this.map=new Map;this.scopedCollections=new Map;this.descriptionMap=new Map;this._persistent=true;this._onDidChangeCollection=new L;this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const i=this.getScopeKey(e);let n=this.scopedCollections.get(i);if(!n){n=new jO(this,e);this.scopedCollections.set(i,n);this._register(n.onDidChangeCollection(()=>this._onDidChangeCollection.fire()))}return n}replace(e,i,n,s){this._setIfDiffers(e,{value:i,type:hc.Replace,options:n??{applyAtProcessCreation:true},scope:s})}append(e,i,n,s){this._setIfDiffers(e,{value:i,type:hc.Append,options:n??{applyAtProcessCreation:true},scope:s})}prepend(e,i,n,s){this._setIfDiffers(e,{value:i,type:hc.Prepend,options:n??{applyAtProcessCreation:true},scope:s})}_setIfDiffers(e,i){if(i.options&&i.options.applyAtProcessCreation===false&&!i.options.applyAtShellIntegration){throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration")}const n=this.getKey(e,i.scope);const s=this.map.get(n);const r=i.options?{applyAtProcessCreation:i.options.applyAtProcessCreation??false,applyAtShellIntegration:i.options.applyAtShellIntegration??false}:{applyAtProcessCreation:true};if(!s||s.value!==i.value||s.type!==i.type||s.options?.applyAtProcessCreation!==r.applyAtProcessCreation||s.options?.applyAtShellIntegration!==r.applyAtShellIntegration||s.scope?.workspaceFolder?.index!==i.scope?.workspaceFolder?.index){const o=this.getKey(e,i.scope);const a={variable:e,...i,options:r};this.map.set(o,a);this._onDidChangeCollection.fire()}}get(e,i){const n=this.getKey(e,i);const s=this.map.get(n);return s?AD(s):void 0}getKey(e,i){const n=this.getScopeKey(i);return n.length?`${e}:::${n}`:e}getScopeKey(e){return this.getWorkspaceKey(e?.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const i=new Map;for(const[n,s]of this.map){if(this.getScopeKey(s.scope)===this.getScopeKey(e)){i.set(s.variable,AD(s))}}return i}delete(e,i){const n=this.getKey(e,i);this.map.delete(n);this._onDidChangeCollection.fire()}clear(e){if(e?.workspaceFolder){for(const[i,n]of this.map){if(n.scope?.workspaceFolder?.index===e.workspaceFolder.index){this.map.delete(i)}}this.clearDescription(e)}else{this.map.clear();this.descriptionMap.clear()}this._onDidChangeCollection.fire()}setDescription(e,i){const n=this.getScopeKey(i);const s=this.descriptionMap.get(n);if(!s||s.description!==e){let r;if(typeof e==="string"){r=e}else{r=e?.value.split("\n\n")[0]}const o={description:r,scope:i};this.descriptionMap.set(n,o);this._onDidChangeCollection.fire()}}getDescription(e){const i=this.getScopeKey(e);return this.descriptionMap.get(i)?.description}clearDescription(e){const i=this.getScopeKey(e);this.descriptionMap.delete(i)}}class jO{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,i){this.collection=e;this.scope=i;this._onDidChangeCollection=new L}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,i,n){this.collection.replace(e,i,n,this.scope)}append(e,i,n){this.collection.append(e,i,n,this.scope)}prepend(e,i,n){this.collection.prepend(e,i,n,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,i){this.collection.getVariableMap(this.scope).forEach((n,s)=>e.call(i,s,n,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope);this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let Ky=class Bz extends Gy{constructor(e,i){super(false,e,i)}createTerminal(e,i,n){throw new x1}createTerminalFromOptions(e,i){throw new x1}};Ky=W([P(0,Zo),P(1,st)],Ky);function WA(t){if(!t||typeof t==="string"){return void 0}if(!mo(t,{id:true})){return t}return{id:t.id,color:t.color}}function GO(t){return Hc.isThemeColor(t)?t:void 0}function AD(t){const e={...t};delete e.scope;e.options=e.options??void 0;return e}const KO={label:h(6630,"Other Models"),order:Number.MAX_SAFE_INTEGER};const VA="__";function QO(t){return typeof t==="object"&&t!==null&&"wwwAuthenticate"in t&&typeof t.wwwAuthenticate==="string"}const xx="/.well-known";const JO=`${xx}/oauth-protected-resource`;const YO=`${xx}/oauth-authorization-server`;const Xv=`${xx}/openid-configuration`;const Ex=" ";var l_;(function(t){t["InvalidRequest"]="invalid_request";t["InvalidClient"]="invalid_client";t["InvalidGrant"]="invalid_grant";t["UnauthorizedClient"]="unauthorized_client";t["UnsupportedGrantType"]="unsupported_grant_type";t["InvalidScope"]="invalid_scope"})(l_||(l_={}));var RD;(function(t){t["AuthorizationPending"]="authorization_pending";t["SlowDown"]="slow_down";t["AccessDenied"]="access_denied";t["ExpiredToken"]="expired_token"})(RD||(RD={}));var LD;(function(t){t["InvalidRedirectUri"]="invalid_redirect_uri";t["InvalidClientMetadata"]="invalid_client_metadata";t["InvalidSoftwareStatement"]="invalid_software_statement";t["UnapprovedSoftwareStatement"]="unapproved_software_statement"})(LD||(LD={}));function XO(t){if(typeof t!=="object"||t===null){return false}const e=t;if(!e.resource){return false}if(e.scopes_supported!==void 0&&!Array.isArray(e.scopes_supported)){return false}return true}const ZO=["issuer","authorization_endpoint","token_endpoint","registration_endpoint","jwks_uri"];function eF(t){if(typeof t!=="object"||t===null){return false}const e=t;if(!e.issuer){throw new Error("Authorization server metadata must have an issuer")}for(const i of ZO){if(!e[i]){continue}if(typeof e[i]!=="string"){throw new Error(`Authorization server metadata '${i}' must be a string`)}if(!e[i].startsWith("https://")&&!e[i].startsWith("http://")){throw new Error(`Authorization server metadata '${i}' must start with http:// or https://`)}}return true}function tF(t){if(typeof t!=="object"||t===null){return false}const e=t;return e.client_id!==void 0}function ND(t){if(typeof t!=="object"||t===null){return false}const e=t;return e.access_token!==void 0&&e.token_type!==void 0}function MD(t){if(typeof t!=="object"||t===null){return false}const e=t;return e.error!==void 0}function iF(t){if(typeof t!=="object"||t===null){return false}const e=t;return e.error!==void 0}function nF(t){return{issuer:t.toString(),authorization_endpoint:new URL("/authorize",t).toString(),token_endpoint:new URL("/token",t).toString(),registration_endpoint:new URL("/register",t).toString(),response_types_supported:["code","id_token","id_token token"]}}const OD=["authorization_code","refresh_token","urn:ietf:params:oauth:grant-type:device_code"];const sF=33418;async function zA(t,e,i){if(!t.registration_endpoint){throw new Error("Server does not support dynamic registration")}const n={client_name:e,client_uri:"https://code.visualstudio.com",grant_types:t.grant_types_supported?t.grant_types_supported.filter(o=>OD.includes(o)):OD,response_types:["code"],redirect_uris:["https://insiders.vscode.dev/redirect","https://vscode.dev/redirect","http://127.0.0.1/",`http://127.0.0.1:${sF}/`],scope:i?.join(Ex),token_endpoint_auth_method:"none",application_type:"native"};const s=await fetch(t.registration_endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok){const o=await s.text();let a=o;try{const l=JSON.parse(o);if(iF(l)){a=`${l.error}${l.error_description?`: ${l.error_description}`:""}`}}catch{}throw new Error(`Registration to ${t.registration_endpoint} failed: ${a}`)}const r=await s.json();if(tF(r)){return r}throw new Error(`Invalid authorization dynamic client registration response: ${JSON.stringify(r)}`)}function qA(t){const e=[];const i=[];let n="";let s=false;for(let o=0;o<t.length;o++){const a=t[o];if(a==='"'){s=!s;n+=a}else if(a===","&&!s){if(n.trim()){i.push(n.trim())}n=""}else{n+=a}}if(n.trim()){i.push(n.trim())}let r;for(const o of i){const a=o.includes("=");if(!a){if(r){e.push(r)}r={scheme:o.trim(),params:{}}}else{const l=o.indexOf(" ");if(l>0){const c=o.substring(0,l);const u=o.substring(l+1);if(!c.includes("=")&&u.includes("=")){if(r){e.push(r)}r={scheme:c.trim(),params:{}};const d=u.indexOf("=");if(d>0){const f=u.substring(0,d).trim();const p=u.substring(d+1).trim().replace(/^"|"$/g,"");if(f&&p!==void 0){r.params[f]=p}}continue}}if(r){const c=o.indexOf("=");if(c>0){const u=o.substring(0,c).trim();const d=o.substring(c+1).trim().replace(/^"|"$/g,"");if(u&&d!==void 0){r.params[u]=d}}}}}if(r){e.push(r)}return e}function FD(t){const e=t.split(".");if(e.length!==3){throw new Error("Invalid JWT token format: token must have three parts separated by dots")}const[i,n]=e;try{const s=JSON.parse(Oo(i).toString());if(typeof s!=="object"){throw new Error("Invalid JWT token format: header is not a JSON object")}const r=JSON.parse(Oo(n).toString());if(typeof r!=="object"){throw new Error("Invalid JWT token format: payload is not a JSON object")}return r}catch(s){if(s instanceof Error){throw new Error(`Failed to parse JWT token: ${s.message}`)}throw new Error("Failed to parse JWT token")}}function rF(t,e){if(t===e){return true}if(!t||!e){return false}if(t.length!==e.length){return false}const i=[...t].sort();const n=[...e].sort();return i.every((s,r)=>s===n[r])}async function oF(t,e,i={}){const{sameOriginHeaders:n={},fetch:s=fetch}=i;const r=new URL(t);const o=async(u,d)=>{let f={"Accept":"application/json"};const p=new URL(u);if(p.origin===r.origin){f={...f,...n}}const m=await s(u,{method:"GET",headers:f});if(m.status!==200){let y;try{y=await m.text()}catch{y=m.statusText}throw new Error(`Failed to fetch resource metadata from ${u}: ${m.status} ${y}`)}const v=await m.json();if(XO(v)){const y=new URL(v.resource).toString();const k=new URL(d).toString();if(y!==k){throw new Error(`Protected Resource Metadata 'resource' property value "${y}" does not match expected value "${k}" for URL ${u}. Per RFC 9728, these MUST match. See https://datatracker.ietf.org/doc/html/rfc9728#PRConfigurationValidation`)}return v}else{throw new Error(`Invalid resource metadata from ${u}. Expected to follow shape of https://datatracker.ietf.org/doc/html/rfc9728#name-protected-resource-metadata (Hints: is scopes_supported an array? Is resource a string?). Current payload: ${JSON.stringify(v)}`)}};const a=[];if(e){try{const u=await o(e,t);return{metadata:u,discoveryUrl:e,errors:a}}catch(u){a.push(u instanceof Error?u:new Error(String(u)))}}const l=r.pathname!=="/";const c=`${r.origin}${JO}`;if(l){const u=`${c}${r.pathname}`;try{const d=await o(u,t);return{metadata:d,discoveryUrl:u,errors:a}}catch(d){a.push(d instanceof Error?d:new Error(String(d)))}}try{const u=await o(c,r.origin);return{metadata:u,discoveryUrl:c,errors:a}}catch(u){a.push(u instanceof Error?u:new Error(String(u)))}if(a.length===1){throw a[0]}else{throw new AggregateError(a,"Failed to fetch resource metadata from all attempted URLs")}}async function aF(t){if(t.status!==200){return void 0}try{const e=await t.json();if(eF(e)){return e}}catch{}return void 0}async function lF(t){try{return await t.text()}catch{return t.statusText}}async function cF(t,e={}){const{additionalHeaders:i={},fetch:n=fetch}=e;const s=new URL(t);const r=s.pathname==="/"?"":s.pathname;const o=[];const a=async f=>{try{const p=await n(f,{method:"GET",headers:{...i,"Accept":"application/json"}});const m=await aF(p);if(m){return m}o.push(new Error(`Failed to fetch authorization server metadata from ${f}: ${p.status} ${await lF(p)}`));return void 0}catch(p){o.push(p instanceof Error?p:new Error(String(p)));return void 0}};const l=new URL(YO,t).toString()+r;let c=await a(l);if(c){return{metadata:c,discoveryUrl:l,errors:o}}const u=new URL(Xv,t).toString()+r;c=await a(u);if(c){return{metadata:c,discoveryUrl:u,errors:o}}const d=t.endsWith("/")?t+Xv.substring(1):t+Xv;c=await a(d);if(c){return{metadata:c,discoveryUrl:d,errors:o}}if(o.length===1){throw o[0]}else{throw new AggregateError(o,"Failed to fetch authorization server metadata from all attempted URLs")}}var Qy;let Jy=class Wz{static{Qy=this}static{this.InitialState={focused:true,active:true}}getState(){const e=this._state;return{get focused(){return e.focused},get active(){return e.active}}}constructor(e,i){this._onDidChangeWindowState=new L;this.onDidChangeWindowState=this._onDidChangeWindowState.event;this._state=Qy.InitialState;if(e.handle){this._nativeHandle=Oo(e.handle).buffer}this._proxy=i.getProxy(ee.MainThreadWindow);this._proxy.$getInitialState().then(({isFocused:n,isActive:s})=>{this.onDidChangeWindowProperty("focused",n);this.onDidChangeWindowProperty("active",s)})}get nativeHandle(){return this._nativeHandle}$onDidChangeActiveNativeWindowHandle(e){this._nativeHandle=e?Oo(e).buffer:void 0}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,i){if(i===this._state[e]){return}this._state={...this._state,[e]:i};this._onDidChangeWindowState.fire(this._state)}openUri(e,i){let n;if(typeof e==="string"){n=e;try{e=b.parse(e)}catch(s){return Promise.reject(`Invalid uri - '${e}'`)}}if(Oc(e.scheme)){return Promise.reject("Invalid scheme - cannot be empty")}else if(e.scheme===ne.command){return Promise.reject(`Invalid scheme '${e.scheme}'`)}return this._proxy.$openUri(e,n,i)}async asExternalUri(e,i){if(Oc(e.scheme)){return Promise.reject("Invalid scheme - cannot be empty")}const n=await this._proxy.$asExternalUri(e,i);return b.from(n)}};Jy=Qy=W([P(0,wi),P(1,st)],Jy);const tv=te("IExtHostWindow");var Yy;let Xy=class Vz{static{Yy=this}static{this.HandlePool=0}constructor(e){this.handles=new bl;this.handlers=new Map;this._proxy=e.getProxy(ee.MainThreadUrls)}registerUriHandler(e,i){const n=e.identifier;if(this.handles.has(n)){throw new Error(`Protocol handler already registered for extension ${n}`)}const s=Yy.HandlePool++;this.handles.add(n);this.handlers.set(s,i);this._proxy.$registerUriHandler(s,n,e.displayName||e.name);return ye(()=>{this.handles.delete(n);this.handlers.delete(s);this._proxy.$unregisterUriHandler(s)})}$handleExternalUri(e,i){const n=this.handlers.get(e);if(!n){return Promise.resolve(void 0)}try{n.handleUri(b.revive(i))}catch(s){Ti(s)}return Promise.resolve(void 0)}async createAppUri(e){return b.revive(await this._proxy.$createAppUri(e))}};Xy=Yy=W([P(0,st)],Xy);const iv=te("IExtHostUrlsService");function jA(t){return(e,i,n)=>{let s=null;let r=null;if(typeof n.value==="function"){s="value";r=n.value}else if(typeof n.get==="function"){s="get";r=n.get}if(!r||typeof i==="symbol"){throw new Error("not supported")}n[s]=t(r,i)}}function GA(t,e,i){return jA((n,s)=>{const r=`$debounce$${s}`;const o=`$debounce$result$${s}`;return function(...a){if(!this[o]){this[o]=void 0}clearTimeout(this[r]);this[r]=setTimeout(()=>{n.apply(this,a);this[o]=void 0},t)}})}function uF(t,e,i){return jA((n,s)=>{const r=`$throttle$timer$${s}`;const o=`$throttle$result$${s}`;const a=`$throttle$lastRun$${s}`;const l=`$throttle$pending$${s}`;return function(...c){if(!this[o]){this[o]=i?i():void 0}if(this[a]===null||this[a]===void 0){this[a]=-Number.MAX_VALUE}if(e){this[o]=e(this[o],...c)}if(this[l]){return}const u=this[a]+t;if(u<=Date.now()){this[a]=Date.now();n.apply(this,[this[o]]);this[o]=i?i():void 0}else{this[l]=true;this[r]=setTimeout(()=>{this[l]=false;this[a]=Date.now();n.apply(this,[this[o]]);this[o]=i?i():void 0},u-Date.now())}}})}const nv=te("IExtHostProgress");let Zy=class zz{constructor(e){this._handles=0;this._mapHandleToCancellationSource=new Map;this._proxy=e.getProxy(ee.MainThreadProgress)}async withProgress(e,i,n){const s=this._handles++;const{title:r,location:o,cancellable:a}=i;const l={label:e.displayName||e.name,id:e.identifier.value};this._proxy.$startProgress(s,{location:Lm.from(o),title:r,source:l,cancellable:a},!e.isUnderDevelopment?e.identifier.value:void 0).catch(S1);return this._withProgress(s,n,!!a)}async withProgressFromSource(e,i,n){const s=this._handles++;const{title:r,location:o,cancellable:a}=i;this._proxy.$startProgress(s,{location:Lm.from(o),title:r,source:e,cancellable:a},void 0).catch(S1);return this._withProgress(s,n,!!a)}_withProgress(e,i,n){let s;if(n){s=new Tt;this._mapHandleToCancellationSource.set(e,s)}const r=a=>{this._proxy.$progressEnd(a);this._mapHandleToCancellationSource.delete(a);s?.dispose()};let o;try{o=i(new e0(this._proxy,e),n&&s?s.token:Ze.None)}catch(a){r(e);throw a}o.then(a=>r(e),a=>r(e));return o}$acceptProgressCanceled(e){const i=this._mapHandleToCancellationSource.get(e);if(i){i.cancel();this._mapHandleToCancellationSource.delete(e)}}};Zy=W([P(0,st)],Zy);function dF(t,e){t.message=e.message;if(typeof e.increment==="number"){if(typeof t.increment==="number"){t.increment+=e.increment}else{t.increment=e.increment}}return t}class e0 extends BS{constructor(e,i){super(n=>this.throttledReport(n));this._proxy=e;this._handle=i}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}e0.__decorator=W([uF(100,(t,e)=>dF(t,e),()=>Object.create(null))],e0.prototype,"throttledReport",null);const Cx=te("IExtHostAuthentication");let t0=class qz{constructor(e,i,n,s,r,o,a){this._initData=i;this._extHostWindow=n;this._extHostUrls=s;this._extHostProgress=r;this._extHostLoggerService=o;this._logService=a;this._dynamicAuthProviderCtor=i0;this._authenticationProviders=new Map;this._providerOperations=new b4;this._onDidChangeSessions=new L;this._getSessionTaskSingler=new hF;this._onDidDynamicAuthProviderTokensChange=new L;this._proxy=e.getProxy(ee.MainThreadAuthentication)}getExtensionScopedSessionsEvent(e){const i=e.toLowerCase();return wt.chain(this._onDidChangeSessions.event,n=>n.filter(s=>!s.extensionIdFilter||s.extensionIdFilter.includes(i)).map(s=>({provider:s.provider})))}async getSession(e,i,n,s={}){const r=ht.toKey(e.identifier);const o=Object.keys(s);const a=o.map(c=>{switch(c){case"account":return`${c}:${s.account?.id}`;case"createIfNone":case"forceNewSession":{const u=typeof s[c]==="boolean"?`${s[c]}`:`'${s[c]?.detail}/${s[c]?.learnMore?.toString()}'`;return`${c}:${u}`}case"authorizationServer":return`${c}:${s.authorizationServer?.toString(true)}`;default:return`${c}:${!!s[c]}`}}).sort().join(", ");let l;if(QO(n)){const c=n;const u=c.wwwAuthenticate;const d=c.fallbackScopes?[...c.fallbackScopes].sort().join(" "):"";l=`${r} ${i} challenge:${u} ${d} ${a}`}else{const c=[...n].sort().join(" ");l=`${r} ${i} ${c} ${a}`}return await this._getSessionTaskSingler.getOrCreate(l,async()=>{await this._proxy.$ensureProvider(i);const c=e.displayName||e.name;return this._proxy.$getSession(i,n,r,c,s)})}async getAccounts(e){await this._proxy.$ensureProvider(e);return await this._proxy.$getAccounts(e)}registerAuthenticationProvider(e,i,n,s){void this._providerOperations.queue(e,async()=>{if(this._authenticationProviders.get(e)){this._logService.error(`An authentication provider with id '${e}' is already registered. The existing provider will not be replaced.`);return}const r=n.onDidChangeSessions(o=>this._proxy.$sendDidChangeSessions(e,o));this._authenticationProviders.set(e,{label:i,provider:n,disposable:r,options:s??{supportsMultipleAccounts:false}});await this._proxy.$registerAuthenticationProvider({id:e,label:i,supportsMultipleAccounts:s?.supportsMultipleAccounts??false,supportedAuthorizationServers:s?.supportedAuthorizationServers,supportsChallenges:s?.supportsChallenges})});return new Ve(()=>{void this._providerOperations.queue(e,async()=>{const r=this._authenticationProviders.get(e);if(r){r.disposable?.dispose();this._authenticationProviders.delete(e);await this._proxy.$unregisterAuthenticationProvider(e)}})})}$createSession(e,i,n){return this._providerOperations.queue(e,async()=>{const s=this._authenticationProviders.get(e);if(s){n.authorizationServer=b.revive(n.authorizationServer);return await s.provider.createSession(i,n)}throw new Error(`Unable to find authentication provider with handle: ${e}`)})}$removeSession(e,i){return this._providerOperations.queue(e,async()=>{const n=this._authenticationProviders.get(e);if(n){return await n.provider.removeSession(i)}throw new Error(`Unable to find authentication provider with handle: ${e}`)})}$getSessions(e,i,n){return this._providerOperations.queue(e,async()=>{const s=this._authenticationProviders.get(e);if(s){n.authorizationServer=b.revive(n.authorizationServer);return await s.provider.getSessions(i,n)}throw new Error(`Unable to find authentication provider with handle: ${e}`)})}$getSessionsFromChallenges(e,i,n){return this._providerOperations.queue(e,async()=>{const s=this._authenticationProviders.get(e);if(s){const r=s.provider;if(typeof r.getSessionsFromChallenges==="function"){n.authorizationServer=b.revive(n.authorizationServer);return await r.getSessionsFromChallenges(i,n)}throw new Error(`Authentication provider with handle: ${e} does not support getSessionsFromChallenges`)}throw new Error(`Unable to find authentication provider with handle: ${e}`)})}$createSessionFromChallenges(e,i,n){return this._providerOperations.queue(e,async()=>{const s=this._authenticationProviders.get(e);if(s){const r=s.provider;if(typeof r.createSessionFromChallenges==="function"){n.authorizationServer=b.revive(n.authorizationServer);return await r.createSessionFromChallenges(i,n)}throw new Error(`Authentication provider with handle: ${e} does not support createSessionFromChallenges`)}throw new Error(`Unable to find authentication provider with handle: ${e}`)})}$onDidChangeAuthenticationSessions(e,i,n){if(!e.startsWith(VA)){this._onDidChangeSessions.fire({provider:{id:e,label:i},extensionIdFilter:n})}return Promise.resolve()}$onDidUnregisterAuthenticationProvider(e){return this._providerOperations.queue(e,async()=>{const i=this._authenticationProviders.get(e);if(i){i.disposable?.dispose();this._authenticationProviders.delete(e)}})}async $registerDynamicAuthProvider(e,i,n,s,r,o){if(!s){const l=b.revive(e);if(i.registration_endpoint){try{const c=await zA(i,this._initData.environment.appName,n?.scopes_supported);s=c.client_id;r=c.client_secret}catch(c){this._logService.warn(`Dynamic registration failed for ${l.toString()}: ${c.message}. Prompting user for client ID and client secret...`)}}if(!s){this._logService.info(`Prompting user for client registration details for ${l.toString()}`);const c=await this._proxy.$promptForClientRegistration(l.toString());if(!c){throw new Error("User did not provide client details")}s=c.clientId;r=c.clientSecret;this._logService.info(`User provided client registration for ${l.toString()}`);if(r){this._logService.trace(`User provided client secret for ${l.toString()}`)}else{this._logService.trace(`User did not provide client secret for ${l.toString()}`)}}}const a=new this._dynamicAuthProviderCtor(this._extHostWindow,this._extHostUrls,this._initData,this._extHostProgress,this._extHostLoggerService,this._proxy,b.revive(e),i,n,s,r,this._onDidDynamicAuthProviderTokensChange,o||[]);await this._providerOperations.queue(a.id,async()=>{this._authenticationProviders.set(a.id,{label:a.label,provider:a,disposable:Ve.from(a,a.onDidChangeSessions(l=>this._proxy.$sendDidChangeSessions(a.id,l)),a.onDidChangeClientId(()=>this._proxy.$sendDidChangeDynamicProviderInfo({providerId:a.id,clientId:a.clientId,clientSecret:a.clientSecret}))),options:{supportsMultipleAccounts:true}});await this._proxy.$registerDynamicAuthenticationProvider({id:a.id,label:a.label,supportsMultipleAccounts:true,authorizationServer:e,resourceServer:n?b.parse(n.resource):void 0,clientId:a.clientId,clientSecret:a.clientSecret})});return a.id}async $onDidChangeDynamicAuthProviderTokens(e,i,n){this._onDidDynamicAuthProviderTokensChange.fire({authProviderId:e,clientId:i,tokens:n})}};t0=W([P(0,st),P(1,wi),P(2,tv),P(3,iv),P(4,nv),P(5,Ko),P(6,et)],t0);class hF{constructor(){this._inFlightPromises=new Map}getOrCreate(e,i){const n=this._inFlightPromises.get(e);if(n){return n}const s=i().finally(()=>this._inFlightPromises.delete(e));this._inFlightPromises.set(e,s);return s}}let i0=class jz{constructor(e,i,n,s,r,o,a,l,c,u,d,f,p){this._extHostWindow=e;this._extHostUrls=i;this._initData=n;this._extHostProgress=s;this._proxy=o;this.authorizationServer=a;this._serverMetadata=l;this._resourceMetadata=c;this._clientId=u;this._clientSecret=d;this._onDidChangeSessions=new L;this.onDidChangeSessions=this._onDidChangeSessions.event;this._onDidChangeClientId=new L;this.onDidChangeClientId=this._onDidChangeClientId.event;const m=a.toString(true);this.id=c?.resource?m+" "+c?.resource:m;this.label=c?.resource_name??this.authorizationServer.authority;this._logger=r.createLogger(this.id,{name:`Auth: ${this.label}`});this._disposable=new pe;this._disposable.add(this._onDidChangeSessions);const v=wt.chain(f.event,y=>y.filter(k=>k.authProviderId===this.id&&k.clientId===u).map(k=>k.tokens));this._tokenStore=this._disposable.add(new fF({onDidChange:v,set:y=>o.$setSessionsForDynamicAuthProvider(this.id,this.clientId,y)},p,this._logger));this._disposable.add(this._tokenStore.onDidChangeSessions(y=>this._onDidChangeSessions.fire(y)));this._createFlows=[];if(l.authorization_endpoint){this._createFlows.push({label:h(2687,"URL Handler"),handler:(y,k,S)=>this._createWithUrlHandler(y,k,S)})}}get clientId(){return this._clientId}get clientSecret(){return this._clientSecret}async getSessions(e,i){this._logger.info(`Getting sessions for scopes: ${e?.join(" ")??"all"}`);if(!e){return this._tokenStore.sessions}const n=[...e].sort();const s=e.join(" ");let r=this._tokenStore.sessions.filter(o=>mn([...o.scopes].sort(),n));this._logger.info(`Found ${r.length} sessions for scopes: ${s}`);if(r.length){const o=[];const a=[];const l=new Map(this._tokenStore.tokens.map(c=>[c.access_token,c]));for(const c of r){const u=l.get(c.accessToken);if(u&&u.expires_in){const d=Date.now();const f=u.expires_in*1e3;if(d>u.created_at+f-5*60*1e3){this._logger.info(`Token for session ${c.id} is about to expire, refreshing...`);a.push(u);if(!u.refresh_token){this._logger.warn(`No refresh token available for scopes ${c.scopes.join(" ")}. Throwing away token.`);continue}try{const p=await this.exchangeRefreshTokenForToken(u.refresh_token);if(p.scope!==s){this._logger.warn(`Token scopes '${p.scope}' do not match requested scopes '${s}'. Overwriting token with what was requested...`);p.scope=s}this._logger.info(`Successfully created a new token for scopes ${c.scopes.join(" ")}.`);o.push(p)}catch(p){this._logger.error(`Failed to refresh token: ${p}`)}}}}if(o.length||a.length){this._tokenStore.update({added:o,removed:a});r=this._tokenStore.sessions.filter(c=>mn([...c.scopes].sort(),n))}this._logger.info(`Found ${r.length} sessions for scopes: ${s}`);return r}return[]}async createSession(e,i){this._logger.info(`Creating session for scopes: ${e.join(" ")}`);let n;for(let r=0;r<this._createFlows.length;r++){const{handler:o}=this._createFlows[r];try{n=await this._extHostProgress.withProgressFromSource({label:this.label,id:this.id},{location:Mo.Notification,title:h(2688,"Authenticating to '{0}'",this.label),cancellable:true},(a,l)=>o(e,a,l));if(n){break}}catch(a){const l=this._createFlows[r+1]?.label;if(!l){break}const c=Ls(a)?h(2689,"Having trouble authenticating to '{0}'? Would you like to try a different way? ({1})",this.label,l):h(2690,"You have not yet finished authenticating to '{0}'. Would you like to try a different way? ({1})",this.label,l);const u=await this._proxy.$showContinueNotification(c);if(!u){throw new Vi}this._logger.error(`Failed to create token via flow '${l}': ${a}`)}}if(!n){throw new Error("Failed to create authentication token")}if(n.scope!==e.join(" ")){this._logger.warn(`Token scopes '${n.scope}' do not match requested scopes '${e.join(" ")}'. Overwriting token with what was requested...`);n.scope=e.join(" ")}this._tokenStore.update({added:[{...n,created_at:Date.now()}],removed:[]});const s=this._tokenStore.sessions.find(r=>r.accessToken===n.access_token);this._logger.info(`Created ${n.refresh_token?"refreshable":"non-refreshable"} session for scopes: ${n.scope}${n.expires_in?` that expires in ${n.expires_in} seconds`:""}`);return s}async removeSession(e){this._logger.info(`Removing session with id: ${e}`);const i=this._tokenStore.sessions.find(s=>s.id===e);if(!i){this._logger.error(`Session with id ${e} not found`);return}const n=this._tokenStore.tokens.find(s=>s.access_token===i.accessToken);if(!n){this._logger.error(`Failed to retrieve token for removed session: ${i.id}`);return}this._tokenStore.update({added:[],removed:[n]});this._logger.info(`Removed token for session: ${i.id} with scopes: ${i.scopes.join(" ")}`)}dispose(){this._disposable.dispose()}async _createWithUrlHandler(e,i,n){if(!this._serverMetadata.authorization_endpoint){throw new Error("Authorization Endpoint required")}if(!this._serverMetadata.token_endpoint){throw new Error("Token endpoint not available in server metadata")}const s=this.generateRandomString(64);const r=await this.generateCodeChallenge(s);const o=this.generateRandomString(32);const a=b.parse(`${this._initData.environment.appUriScheme}://dynamicauthprovider/${this.authorizationServer.authority}/authorize?nonce=${o}`);let l;try{l=await this._extHostUrls.createAppUri(a)}catch(y){throw new Error(`Failed to create external URI: ${y}`)}const c=new URL(this._serverMetadata.authorization_endpoint);c.searchParams.append("client_id",this._clientId);c.searchParams.append("response_type","code");c.searchParams.append("state",l.toString());c.searchParams.append("code_challenge",r);c.searchParams.append("code_challenge_method","S256");const u=e.join(" ");if(u){c.searchParams.append("scope",u)}if(this._resourceMetadata?.resource){c.searchParams.append("resource",this._resourceMetadata.resource)}const d="https://vscode.dev/redirect";c.searchParams.append("redirect_uri",d);const f=this.waitForAuthorizationCode(a);this._logger.info(`Opening authorization URL for scopes: ${u}`);this._logger.trace(`Authorization URL: ${c.toString()}`);const p=await this._extHostWindow.openUri(c.toString(),{});if(!p){throw new Vi}i.report({message:h(2691,"Complete the authentication in the browser window that has opened.")});let m;try{const y=await DS(f,n);m=y.code}catch(y){if(Ls(y)){this._logger.info("Authorization code request was cancelled by the user.");throw y}this._logger.error(`Failed to receive authorization code: ${y}`);throw new Error(`Failed to receive authorization code: ${y}`)}this._logger.info(`Authorization code received for scopes: ${u}`);const v=await this.exchangeCodeForToken(m,s,d);return v}generateRandomString(e){const i=new Uint8Array(e);crypto.getRandomValues(i);return Array.from(i).map(n=>n.toString(16).padStart(2,"0")).join("").substring(0,e)}async generateCodeChallenge(e){const i=new TextEncoder;const n=i.encode(e);const s=await crypto.subtle.digest("SHA-256",n);return vl(ae.wrap(new Uint8Array(s)),false,false).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async waitForAuthorizationCode(e){const i=await this._proxy.$waitForUriHandler(e);const n=/[?&]code=([^&]+)/.exec(i.query||"");if(!n||n.length<2){throw new Error("Authentication failed: No authorization code received")}return{code:n[1]}}async exchangeCodeForToken(e,i,n){if(!this._serverMetadata.token_endpoint){throw new Error("Token endpoint not available in server metadata")}const s=new URLSearchParams;s.append("client_id",this._clientId);s.append("grant_type","authorization_code");s.append("code",e);s.append("redirect_uri",n);s.append("code_verifier",i);if(this._resourceMetadata?.resource){s.append("resource",this._resourceMetadata.resource)}if(this._clientSecret){s.append("client_secret",this._clientSecret)}this._logger.info("Exchanging authorization code for token...");this._logger.trace(`Url: ${this._serverMetadata.token_endpoint}`);this._logger.trace(`Token request body: ${s.toString()}`);let r;try{r=await fetch(this._serverMetadata.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Accept":"application/json"},body:s.toString()})}catch(a){this._logger.error(`Failed to exchange authorization code for token: ${a}`);throw new Error(`Failed to exchange authorization code for token: ${a}`)}if(!r.ok){const a=await r.text();throw new Error(`Token exchange failed: ${r.status} ${r.statusText} - ${a}`)}const o=await r.json();if(ND(o)){this._logger.info(`Successfully exchanged authorization code for token.`);return o}else if(MD(o)&&o.error===l_.InvalidClient){this._logger.warn(`Client ID (${this._clientId}) was invalid, generated a new one.`);await this._generateNewClientId();throw new Error(`Client ID was invalid, generated a new one. Please try again.`)}throw new Error(`Invalid authorization token response: ${JSON.stringify(o)}`)}async exchangeRefreshTokenForToken(e){if(!this._serverMetadata.token_endpoint){throw new Error("Token endpoint not available in server metadata")}const i=new URLSearchParams;i.append("client_id",this._clientId);i.append("grant_type","refresh_token");i.append("refresh_token",e);if(this._resourceMetadata?.resource){i.append("resource",this._resourceMetadata.resource)}if(this._clientSecret){i.append("client_secret",this._clientSecret)}const n=await fetch(this._serverMetadata.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Accept":"application/json"},body:i.toString()});const s=await n.json();if(ND(s)){return{...s,created_at:Date.now()}}else if(MD(s)&&s.error===l_.InvalidClient){this._logger.warn(`Client ID (${this._clientId}) was invalid, generated a new one.`);await this._generateNewClientId();throw new Error(`Client ID was invalid, generated a new one. Please try again.`)}throw new Error(`Invalid authorization token response: ${JSON.stringify(s)}`)}async _generateNewClientId(){try{const e=await zA(this._serverMetadata,this._initData.environment.appName,this._resourceMetadata?.scopes_supported);this._clientId=e.client_id;this._clientSecret=e.client_secret;this._onDidChangeClientId.fire()}catch(e){this._logger.info(`Dynamic registration failed for ${this.authorizationServer.toString()}: ${e}. Prompting user for client ID and client secret.`);try{const i=await this._proxy.$promptForClientRegistration(this.authorizationServer.toString());if(!i){throw new Error("User did not provide client details")}this._clientId=i.clientId;this._clientSecret=i.clientSecret;this._logger.info(`User provided client ID for ${this.authorizationServer.toString()}`);if(i.clientSecret){this._logger.info(`User provided client secret for ${this.authorizationServer.toString()}`)}else{this._logger.info(`User did not provide client secret for ${this.authorizationServer.toString()} (optional)`)}this._onDidChangeClientId.fire()}catch(i){this._logger.error(`Failed to fetch new client ID and user did not provide one: ${e}`);throw new Error(`Failed to fetch new client ID and user did not provide one: ${e}`)}}}};i0=W([P(0,tv),P(1,iv),P(2,wi),P(3,nv),P(4,Ko)],i0);class fF{constructor(e,i,n){this._persistence=e;this._logger=n;this._onDidChangeSessions=new L;this.onDidChangeSessions=this._onDidChangeSessions.event;this._disposable=new pe;this._tokensObservable=X9("tokens",i);this._sessionsObservable=mP({equalsFn:(s,r)=>mn(s,r,(o,a)=>o.accessToken===a.accessToken)},s=>this._tokensObservable.read(s).map(r=>this._getSessionFromToken(r)));this._disposable.add(this._registerChangeEventAutorun());this._disposable.add(this._persistence.onDidChange(s=>this._tokensObservable.set(s,void 0)))}get tokens(){return this._tokensObservable.get()}get sessions(){return this._sessionsObservable.get()}dispose(){this._disposable.dispose()}update({added:e,removed:i}){this._logger.trace(`Updating tokens: added ${e.length}, removed ${i.length}`);const n=[...this._tokensObservable.get()];for(const s of i){const r=n.findIndex(o=>o.access_token===s.access_token);if(r!==-1){n.splice(r,1)}}for(const s of e){const r=n.findIndex(o=>o.access_token===s.access_token);if(r===-1){n.push(s)}else{n[r]=s}}if(e.length||i.length){this._tokensObservable.set(n,void 0);void this._persistence.set(n)}this._logger.trace(`Tokens updated: ${n.length} tokens stored.`)}_registerChangeEventAutorun(){let e=[];return ag(i=>{this._logger.trace("Checking for session changes...");const n=this._sessionsObservable.read(i);if(e===n){this._logger.trace("No session changes detected.");return}if(!n||n.length===0){this._logger.trace("All sessions removed.");if(e.length>0){this._onDidChangeSessions.fire({added:[],removed:e,changed:[]});e=[]}return}const s=[];const r=[];for(const o of n){const a=e.some(l=>l.accessToken===o.accessToken);if(!a){s.push(o)}}for(const o of e){const a=n.some(l=>l.accessToken===o.accessToken);if(!a){r.push(o)}}if(s.length>0||r.length>0){this._logger.trace(`Sessions changed: added ${s.length}, removed ${r.length}`);this._onDidChangeSessions.fire({added:s,removed:r,changed:[]})}e=n})}_getSessionFromToken(e){let i;if(e.id_token){try{i=FD(e.id_token)}catch(s){}}if(!i){try{i=FD(e.access_token)}catch(s){}}const n=e.scope?e.scope.split(" "):i?.scope?i.scope.split(" "):[];return{id:jS(e.access_token,0).toString(),accessToken:e.access_token,account:{id:i?.sub||"unknown",label:i?.preferred_username||i?.name||i?.email||"MCP"},scopes:n,idToken:e.id_token}}}var n0;const kx=te("IExtHostLanguageModels");class pF{constructor(){this._defaultStream=new d8;this._isDone=false;const e=this;const[i,n]=Yi.tee(e._defaultStream.asyncIterable);this.apiObject={get stream(){return i},get text(){return n.map(s=>{if(s instanceof ci){return s.value}else{return void 0}}).coalesce()}}}handleResponsePart(e){if(this._isDone){return}const i=[];for(const n of qi.wrap(e)){let s;if(n.type==="text"){s=new ci(n.value,n.audience)}else if(n.type==="thinking"){s=new iu(n.value,n.id,n.metadata)}else if(n.type==="data"){s=new xi(n.data.buffer,n.mimeType,n.audience)}else{s=new dl(n.toolCallId,n.name,n.parameters)}i.push(s)}this._defaultStream.emitMany(i)}reject(e){this._isDone=true;this._defaultStream.reject(e)}resolve(){this._isDone=true;this._defaultStream.resolve()}}let s0=class Gz{static{n0=this}static{this._idPool=1}constructor(e,i,n){this._logService=i;this._extHostAuthentication=n;this._onDidChangeModelAccess=new L;this._onDidChangeProviders=new L;this.onDidChangeProviders=this._onDidChangeProviders.event;this._onDidChangeModelProxyAvailability=new L;this.onDidChangeModelProxyAvailability=this._onDidChangeModelProxyAvailability.event;this._languageModelProviders=new Map;this._localModels=new Map;this._modelAccessList=new $o;this._pendingRequest=new Map;this._ignoredFileProviders=new Map;this._languageAccessInformationExtensions=new Set;this._proxy=e.getProxy(ee.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose();this._onDidChangeProviders.dispose();this._onDidChangeModelProxyAvailability.dispose()}registerLanguageModelChatProvider(e,i,n){this._languageModelProviders.set(i,{extension:e,provider:n});this._proxy.$registerLanguageModelProvider(i);let s;if(n.onDidChangeLanguageModelChatInformation){s=n.onDidChangeLanguageModelChatInformation(()=>{this._proxy.$onLMProviderChange(i)})}return ye(()=>{this._languageModelProviders.delete(i);this._localModels.forEach((r,o)=>{if(r.metadata.vendor===i){this._localModels.delete(o)}});s?.dispose();this._proxy.$unregisterProvider(i)})}toModelIdentifier(e,i,n){return i?`${e}/${i}/${n}`:`${e}/${n}`}getVendorFromModelIdentifier(e){const i=e.indexOf("/");return i===-1?void 0:e.substring(0,i)}async $provideLanguageModelChatInfo(e,i,n){const s=this._languageModelProviders.get(e);if(!s){return[]}const r=await s.provider.provideLanguageModelChatInformation({silent:i.silent,configuration:i.configuration},n)??[];const o=r.map(a=>{let l;if(a.requiresAuthorization&&it(s.extension,"chatProvider")){l={providerLabel:s.extension.displayName||s.extension.name,accountLabel:typeof a.requiresAuthorization==="object"?a.requiresAuthorization.label:void 0}}if(a.capabilities.editTools){O(s.extension,"chatProvider")}const c={};if(it(s.extension,"chatProvider")){if(a.isDefault===true){for(const u of Object.values(ki)){if(typeof u==="string"){c[u]=true}}}else if(typeof a.isDefault==="object"){for(const u of Object.keys(a.isDefault)){const d=parseInt(u);c[Kh.from(d)]=a.isDefault[d]}}}return{metadata:{extension:s.extension.identifier,id:a.id,vendor:e,name:a.name??"",family:a.family??"",detail:a.detail,tooltip:a.tooltip,version:a.version,multiplier:a.multiplier,maxInputTokens:a.maxInputTokens,maxOutputTokens:a.maxOutputTokens,auth:l,isDefaultForLocation:c,isUserSelectable:a.isUserSelectable,statusIcon:a.statusIcon,modelPickerCategory:a.category??KO,capabilities:a.capabilities?{vision:a.capabilities.imageInput,editTools:a.capabilities.editTools,toolCalling:!!a.capabilities.toolCalling,agentMode:!!a.capabilities.toolCalling}:void 0},identifier:this.toModelIdentifier(e,i.group,a.id)}});this._localModels.forEach((a,l)=>{if(a.metadata.vendor===e&&a.group===i.group){this._localModels.delete(l)}});for(let a=0;a<o.length;a++){this._localModels.set(o[a].identifier,{group:i.group,metadata:o[a].metadata,info:r[a]})}return o}async $startChatRequest(e,i,n,s,r,o){const a=this._localModels.get(e);if(!a){throw new Error("Model not found")}const l=this._languageModelProviders.get(a.metadata.vendor);if(!l){throw new Error(`Language model provider for '${a.metadata.id}' not found.`)}const c=[];const u=()=>{if(c.length>0){this._proxy.$reportResponsePart(i,new ji(c));c.length=0}};const d=new wl(u,30);const f=v=>{const y=c.push(v);if(y>30){u();d.cancel()}else{d.schedule()}};const p=new BS(async v=>{if(o.isCancellationRequested){this._logService.warn(`[CHAT](${l.extension.identifier.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let y;if(v instanceof dl){y={type:"tool_use",name:v.name,parameters:v.input,toolCallId:v.callId}}else if(v instanceof ci){y={type:"text",value:v.value,audience:v.audience}}else if(v instanceof xi){y={type:"data",mimeType:v.mimeType,data:ae.wrap(v.data),audience:v.audience}}else if(v instanceof iu){y={type:"thinking",value:v.value,id:v.id,metadata:v.metadata}}if(!y){this._logService.warn(`[CHAT](${l.extension.identifier.value}) UNKNOWN part ${JSON.stringify(v)}`);return}f(y)});let m;try{m=l.provider.provideLanguageModelChatResponse(a.info,s.value.map(Hm.to),{...r,modelOptions:r.modelOptions??{},requestInitiator:ht.toKey(n),toolMode:r.toolMode??wm.Auto},p,o)}catch(v){throw v}Promise.resolve(m).then(()=>{u();this._proxy.$reportResponseDone(i,void 0)},v=>{u();this._proxy.$reportResponseDone(i,Rc(v))})}$provideTokenLength(e,i,n){const s=this._localModels.get(e);if(!s){return Promise.resolve(0)}const r=this._languageModelProviders.get(s.metadata.vendor);if(!r){return Promise.resolve(0)}return Promise.resolve(r.provider.provideTokenCount(s.info,i,n))}async getDefaultLanguageModel(e,i){let n;if(i){await this.selectLanguageModels(e,{})}for(const[s,r]of this._localModels){if(r.metadata.isDefaultForLocation[ki.Chat]){n=s;break}}if(!n&&!i){return this.getDefaultLanguageModel(e,true)}return this.getLanguageModelByIdentifier(e,n)}async getLanguageModelByIdentifier(e,i){if(!i){return void 0}let n=this._localModels.get(i);if(!n){this._logService.warn(`[LanguageModelProxy](${e.identifier.value}) Could not find model '${i}' in local cache. Trying to resolve model again.`);const r=this.getVendorFromModelIdentifier(i);if(!r){this._logService.warn(`[LanguageModelProxy](${e.identifier.value}) Could not extract vendor from model identifier '${i}'.`);return void 0}await this.selectLanguageModels(e,{vendor:r});n=this._localModels.get(i);if(!n){this._logService.warn(`[LanguageModelProxy](${e.identifier.value}) Could not find model '${i}' in local cache after re-resolving models.`);return void 0}}if(this._isUsingAuth(e.identifier,n.metadata)){await this._fakeAuthPopulate(n.metadata)}let s;if(!s){const r=this;s={id:n.info.id,vendor:n.metadata.vendor,family:n.info.family,version:n.info.version,name:n.info.name,capabilities:{supportsImageToText:n.metadata.capabilities?.vision??false,supportsToolCalling:!!n.metadata.capabilities?.toolCalling,editToolsHint:n.metadata.capabilities?.editTools},maxInputTokens:n.metadata.maxInputTokens,countTokens(o,a){if(!r._localModels.has(i)){throw Ci.NotFound(i)}return r._computeTokenLength(i,o,a??Ze.None)},sendRequest(o,a,l){if(!r._localModels.has(i)){throw Ci.NotFound(i)}return r._sendChatRequest(e,i,o,a??{},l??Ze.None)}}}return s}async selectLanguageModels(e,i){const n=await this._proxy.$selectChatModels({...i,extension:e.identifier});const s=[];const r=n.map(a=>this.getLanguageModelByIdentifier(e,a));const o=await Promise.all(r);for(const a of o){if(a){s.push(a)}}return s}async _sendChatRequest(e,i,n,s,r){const o=this._convertMessages(e,n);const a=e.identifier;const l=this._localModels.get(i)?.metadata;if(!l||!this._localModels.has(i)){throw Ci.NotFound(`Language model '${i}' is unknown.`)}if(this._isUsingAuth(a,l)){const d=await this._getAuthAccess(e,{identifier:l.extension,displayName:l.auth.providerLabel},s.justification,false);if(!d||!this._modelAccessList.get(a)?.has(l.extension)){throw Ci.NoPermissions(`Language model '${i}' cannot be used by '${a.value}'.`)}}const c=Math.random()*1e6|0;const u=new pF;this._pendingRequest.set(c,{languageModelId:i,res:u});try{await this._proxy.$tryStartChatRequest(a,i,c,new ji(o),s,r)}catch(d){this._pendingRequest.delete(c);throw Ci.tryDeserialize(d)??d}return u.apiObject}_convertMessages(e,i){const n=[];for(const s of i){if(s.role===Dn.System){O(e,"languageModelSystem")}n.push(Hm.from(s))}return n}async $acceptResponsePart(e,i){const n=this._pendingRequest.get(e);if(n){n.res.handleResponsePart(i.value)}}async $acceptResponseDone(e,i){const n=this._pendingRequest.get(e);if(!n){return}this._pendingRequest.delete(e);if(i){n.res.reject(Ci.tryDeserialize(i)??LT(i))}else{n.res.resolve()}}async _getAuthAccess(e,i,n,s){const r=VA+i.identifier.value;const o=await this._extHostAuthentication.getSession(e,r,[],{silent:true});if(o){this.$updateModelAccesslist([{from:e.identifier,to:i.identifier,enabled:true}]);return true}if(s){return false}try{const a=n?h(2697,"Justification: {1}",i.displayName,n):void 0;await this._extHostAuthentication.getSession(e,r,[],{forceNewSession:{detail:a}});this.$updateModelAccesslist([{from:e.identifier,to:i.identifier,enabled:true}]);return true}catch(a){return false}}_isUsingAuth(e,i){return!!i.auth&&!ht.equals(i.extension,e)}async _fakeAuthPopulate(e){if(!e.auth){return}for(const i of this._languageAccessInformationExtensions){try{await this._getAuthAccess(i,{identifier:e.extension,displayName:""},void 0,true)}catch(n){this._logService.error("Fake Auth request failed");this._logService.error(n)}}}async _computeTokenLength(e,i,n){const s=this._localModels.get(e);if(!s){throw Ci.NotFound(`Language model '${e}' is unknown.`)}return this._languageModelProviders.get(s.metadata.vendor)?.provider.provideTokenCount(s.info,i,n)??0}$updateModelAccesslist(e){const i=new Array;for(const{from:n,to:s,enabled:r}of e){const o=this._modelAccessList.get(n)??new bl;const a=o.has(s);if(a!==r){if(r){o.add(s)}else{o.delete(s)}this._modelAccessList.set(n,o);const l={from:n,to:s};i.push(l);this._onDidChangeModelAccess.fire(l)}}}createLanguageModelAccessInformation(e){this._languageAccessInformationExtensions.add(e);const i=wt.signal(wt.filter(this._onDidChangeModelAccess.event,s=>ht.equals(s.from,e.identifier)));const n=wt.signal(this._onDidChangeProviders.event);return{get onDidChange(){return wt.any(i,n)},canSendRequest(s){return true}}}fileIsIgnored(e,i,n=Ze.None){O(e,"chatParticipantAdditions");return this._proxy.$fileIsIgnored(i,n)}get isModelProxyAvailable(){return!!this._languageModelProxyProvider}async getModelProxy(e){O(e,"languageModelProxy");if(!this._languageModelProxyProvider){this._logService.trace("[LanguageModelProxy] No LanguageModelProxyProvider registered");throw new Error("No language model proxy provider is registered.")}const i=ht.toKey(e.identifier);try{const n=await Promise.resolve(this._languageModelProxyProvider.provideModelProxy(i,Ze.None));if(!n){this._logService.warn(`[LanguageModelProxy] Provider returned no proxy for ${i}`);throw new Error("Language model proxy is not available.")}return n}catch(n){this._logService.error(`[LanguageModelProxy] Provider failed to return proxy for ${i}`,n);throw n}}async $isFileIgnored(e,i,n){const s=this._ignoredFileProviders.get(e);if(!s){throw new Error("Unknown LanguageModelIgnoredFileProvider")}return await s.provideFileIgnored(b.revive(i),n)??false}registerIgnoredFileProvider(e,i){O(e,"chatParticipantPrivate");const n=n0._idPool++;this._proxy.$registerFileIgnoreProvider(n);this._ignoredFileProviders.set(n,i);return ye(()=>{this._proxy.$unregisterFileIgnoreProvider(n);this._ignoredFileProviders.delete(n)})}registerLanguageModelProxyProvider(e,i){O(e,"chatParticipantPrivate");this._languageModelProxyProvider=i;this._onDidChangeModelProxyAvailability.fire();return ye(()=>{if(this._languageModelProxyProvider===i){this._languageModelProxyProvider=void 0;this._onDidChangeModelProxyAvailability.fire()}})}};s0=n0=W([P(0,st),P(1,et),P(2,Cx)],s0);function gF(t){return t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0")+"T"+String(t.getHours()).padStart(2,"0")+":"+String(t.getMinutes()).padStart(2,"0")+":"+String(t.getSeconds()).padStart(2,"0")+"."+(t.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}const sv={DateTimeFormat(t,e){return new $i(()=>{try{return new Intl.DateTimeFormat(t,e)}catch{return new Intl.DateTimeFormat(void 0,e)}})},Collator(t,e){return new $i(()=>{try{return new Intl.Collator(t,e)}catch{return new Intl.Collator(void 0,e)}})},Segmenter(t,e){return new $i(()=>{try{return new Intl.Segmenter(t,e)}catch{return new Intl.Segmenter(void 0,e)}})},Locale(t,e){return new $i(()=>{try{return new Intl.Locale(t,e)}catch{return new Intl.Locale(xo,e)}})},NumberFormat(t,e){return new $i(()=>{try{return new Intl.NumberFormat(t,e)}catch{return new Intl.NumberFormat(void 0,e)}})}};class rv{constructor(e){const i=CE(e);this._defaultValue=i;this._asciiMap=rv._createAsciiMap(i);this._map=new Map}static _createAsciiMap(e){const i=new Uint8Array(256);i.fill(e);return i}set(e,i){const n=CE(i);if(e>=0&&e<256){this._asciiMap[e]=n}else{this._map.set(e,n)}}get(e){if(e>=0&&e<256){return this._asciiMap[e]}else{return this._map.get(e)||this._defaultValue}}clear(){this._asciiMap.fill(this._defaultValue);this._map.clear()}}var UD;(function(t){t[t["False"]=0]="False";t[t["True"]=1]="True"})(UD||(UD={}));var ir;(function(t){t[t["Regular"]=0]="Regular";t[t["Whitespace"]=1]="Whitespace";t[t["WordSeparator"]=2]="WordSeparator"})(ir||(ir={}));class mF extends rv{constructor(e,i){super(ir.Regular);this._segmenter=null;this._cachedLine=null;this._cachedSegments=[];this.intlSegmenterLocales=i;if(this.intlSegmenterLocales.length>0){this._segmenter=sv.Segmenter(this.intlSegmenterLocales,{granularity:"word"})}else{this._segmenter=null}for(let n=0,s=e.length;n<s;n++){this.set(e.charCodeAt(n),ir.WordSeparator)}this.set(M.Space,ir.Whitespace);this.set(M.Tab,ir.Whitespace)}findPrevIntlWordBeforeOrAtOffset(e,i){let n=null;for(const s of this._getIntlSegmenterWordsOnLine(e)){if(s.index>i){break}n=s}return n}findNextIntlWordAtOrAfterOffset(e,i){for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index<i){continue}return n}return null}_getIntlSegmenterWordsOnLine(e){if(!this._segmenter){return[]}if(this._cachedLine===e){return this._cachedSegments}this._cachedLine=e;this._cachedSegments=this._filterWordSegments(this._segmenter.value.segment(e));return this._cachedSegments}_filterWordSegments(e){const i=[];for(const n of e){if(this._isWordLike(n)){i.push(n)}}return i}_isWordLike(e){if(e.isWordLike){return true}return false}}const $D=new of(10);function _F(t,e){const i=`${t}/${e.join(",")}`;let n=$D.get(i);if(!n){n=new mF(t,e);$D.set(i,n)}return n}class HD{constructor(e,i,n,s){this.searchString=e;this.isRegex=i;this.matchCase=n;this.wordSeparators=s}parseSearchRequest(){if(this.searchString===""){return null}let e;if(this.isRegex){e=KA(this.searchString)}else{e=this.searchString.indexOf("\n")>=0}let i=null;try{i=xL(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:false,multiline:e,global:true,unicode:true})}catch(s){return null}if(!i){return null}let n=!this.isRegex&&!e;if(n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()){n=this.matchCase}return new o9(i,this.wordSeparators?_F(this.wordSeparators,[]):null,n?this.searchString:null)}}function KA(t){if(!t||t.length===0){return false}for(let e=0,i=t.length;e<i;e++){const n=t.charCodeAt(e);if(n===M.LineFeed){return true}if(n===M.Backslash){e++;if(e>=i){break}const s=t.charCodeAt(e);if(s===M.n||s===M.r||s===M.W){return true}}}return false}function BD(t,e,i){if(!i){return new J1(t,null)}const n=[];for(let s=0,r=e.length;s<r;s++){n[s]=e[s]}return new J1(t,n)}function vF(t,e,i,n,s){if(n===0){return true}const r=e.charCodeAt(n-1);if(t.get(r)!==ir.Regular){return true}if(r===M.CarriageReturn||r===M.LineFeed){return true}if(s>0){const o=e.charCodeAt(n);if(t.get(o)!==ir.Regular){return true}}return false}function wF(t,e,i,n,s){if(n+s===i){return true}const r=e.charCodeAt(n+s);if(t.get(r)!==ir.Regular){return true}if(r===M.CarriageReturn||r===M.LineFeed){return true}if(s>0){const o=e.charCodeAt(n+s-1);if(t.get(o)!==ir.Regular){return true}}return false}function QA(t,e,i,n,s){return vF(t,e,i,n,s)&&wF(t,e,i,n,s)}class bF{constructor(e,i){this._wordSeparators=e;this._searchRegex=i;this._prevMatchStartIndex=-1;this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e;this._prevMatchStartIndex=-1;this._prevMatchLength=0}next(e){const i=e.length;let n;do{if(this._prevMatchStartIndex+this._prevMatchLength===i){return null}n=this._searchRegex.exec(e);if(!n){return null}const s=n.index;const r=n[0].length;if(s===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){if(f4(e,i,this._searchRegex.lastIndex)>65535){this._searchRegex.lastIndex+=2}else{this._searchRegex.lastIndex+=1}continue}return null}this._prevMatchStartIndex=s;this._prevMatchLength=r;if(!this._wordSeparators||QA(this._wordSeparators,e,i,s,r)){return n}}while(n);return null}}const Dx=te("contextService");const yF=te("editorGroupsService");const SF=te("pathService");function xF(t){return typeof t==="object"&&"uri"in t&&"pattern"in t}let WD=class Kz{constructor(e,i,n,s,r,o){this.configurationService=e;this.workspaceContextService=i;this.editorGroupsService=n;this.logService=s;this.pathService=r;this.uriIdentityService=o}aiText(e,i,n={}){const s=this.commonQuery(i?.map(Ov),n);return{...s,type:il.aiText,contentPattern:e}}text(e,i,n={}){e=this.getContentPattern(e,n);const s=this.configurationService.getValue();const r=i&&i.some(a=>{const l=this.configurationService.getValue({resource:a});return!l.search.useRipgrep});const o=this.commonQuery(i?.map(Ov),n);return{...o,type:il.Text,contentPattern:e,previewOptions:n.previewOptions,maxFileSize:n.maxFileSize,usePCRE2:s.search.usePCRE2||r||false,surroundingContext:n.surroundingContext,userDisabledExcludesAndIgnoreFiles:n.disregardExcludeSettings&&n.disregardIgnoreFiles}}getContentPattern(e,i){const n=this.configurationService.getValue();if(e.isRegExp){e.pattern=e.pattern.replace(/\r?\n/g,"\\n")}const s={...e,wordSeparators:n.editor.wordSeparators};if(this.isCaseSensitive(e,i)){s.isCaseSensitive=true}if(this.isMultiline(e)){s.isMultiline=true}if(i.notebookSearchConfig?.includeMarkupInput){if(!s.notebookInfo){s.notebookInfo={}}s.notebookInfo.isInNotebookMarkdownInput=i.notebookSearchConfig.includeMarkupInput}if(i.notebookSearchConfig?.includeMarkupPreview){if(!s.notebookInfo){s.notebookInfo={}}s.notebookInfo.isInNotebookMarkdownPreview=i.notebookSearchConfig.includeMarkupPreview}if(i.notebookSearchConfig?.includeCodeInput){if(!s.notebookInfo){s.notebookInfo={}}s.notebookInfo.isInNotebookCellInput=i.notebookSearchConfig.includeCodeInput}if(i.notebookSearchConfig?.includeOutput){if(!s.notebookInfo){s.notebookInfo={}}s.notebookInfo.isInNotebookCellOutput=i.notebookSearchConfig.includeOutput}return s}file(e,i={}){const n=this.commonQuery(e,i);return{...n,type:il.File,filePattern:i.filePattern?i.filePattern.trim():i.filePattern,exists:i.exists,sortByScore:i.sortByScore,cacheKey:i.cacheKey,shouldGlobMatchFilePattern:i.shouldGlobSearch}}handleIncludeExclude(e,i){if(!e){return{}}if(Array.isArray(e)){e=e.filter(n=>n.length>0).map(xp);if(!e.length){return{}}}else{e=xp(e)}return i?this.parseSearchPaths(e):{pattern:Zv(...Array.isArray(e)?e:[e])}}commonQuery(e=[],i={}){let n=Array.isArray(i.excludePattern)?i.excludePattern.map(u=>u.pattern).flat():i.excludePattern;n=n?.length===1?n[0]:n;const s=this.handleIncludeExclude(i.includePattern,i.expandPatterns);const r=this.handleIncludeExclude(n,i.expandPatterns);const o=e.length>1;const a=(s.searchPaths&&s.searchPaths.length?s.searchPaths.map(u=>this.getFolderQueryForSearchPath(u,i,r)):e.map(u=>this.getFolderQueryForRoot(u,i,r,o))).filter(u=>!!u);const l={_reason:i._reason,folderQueries:a,usingSearchPaths:!!(s.searchPaths&&s.searchPaths.length),extraFileResources:i.extraFileResources,excludePattern:r.pattern,includePattern:s.pattern,ignoreGlobCase:i.ignoreGlobCase,onlyOpenEditors:i.onlyOpenEditors,maxResults:i.maxResults,onlyFileScheme:i.onlyFileScheme};if(i.onlyOpenEditors){const u=zt(this.editorGroupsService.groups.flatMap(p=>p.editors.map(m=>m.resource)));this.logService.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(u));const d=u.filter(p=>Xk(l,p.fsPath));const f=this.commonQueryFromFileList(d);this.logService.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(f));return{...l,...f}}const c=i.extraFileResources&&i.extraFileResources.filter(u=>Xk(l,u.fsPath));l.extraFileResources=c&&c.length?c:void 0;return l}commonQueryFromFileList(e){const i=[];const n=new It;const s={};let r=false;e.forEach(o=>{if(o.scheme===ne.walkThrough){return}const a=QL(o);if(a){const l=this.workspaceContextService.getWorkspaceFolder(o)?.uri??this.uriIdentityService.extUri.dirname(o);let c=n.get(l);if(!c){r=true;c={folder:l,includePattern:{}};i.push(c);n.set(l,c)}const u=Gd(l.fsPath,o.fsPath);Lc(c.includePattern)[VD(u.replace(/\\/g,"/"))]=true}else{if(o.fsPath){r=true;s[VD(o.fsPath)]=true}}});return{folderQueries:i,includePattern:s,usingSearchPaths:true,excludePattern:r?void 0:{"**/*":true}}}isCaseSensitive(e,i){if(i.isSmartCase){if(e.isRegExp){if(TE(e.pattern,true)){return true}}else if(TE(e.pattern)){return true}}return!!e.isCaseSensitive}isMultiline(e){if(e.isMultiline){return true}if(e.isRegExp&&KA(e.pattern)){return true}if(e.pattern.indexOf("\n")>=0){return true}return!!e.isMultiline}parseSearchPaths(e){const i=d=>{return Fp(d)||/^\.\.?([\/\\]|$)/.test(d)};const n=Array.isArray(e)?e:CF(e);const s=n.map(d=>{const f=this.pathService.resolvedUserHome;if(f){return E9(d,f.scheme===ne.file?f.fsPath:f.path)}return d});const r=j5(s,d=>i(d)?"searchPaths":"exprSegments");const o=(r.exprSegments||[]).map(d=>N1(d,"/")).map(d=>N1(d,"\\")).map(d=>{if(d[0]==="."){d="*"+d}return kF(d)});const a={};const l=this.expandSearchPathPatterns(r.searchPaths||[]);if(l&&l.length){a.searchPaths=l}const c=o.flat();const u=Zv(...c);if(u){a.pattern=u}return a}getExcludesForFolder(e,i){return i.disregardExcludeSettings?void 0:GM(e,!i.disregardSearchExcludeSettings)}expandSearchPathPatterns(e){if(!e||!e.length){return[]}const i=e.flatMap(s=>{let{pathPortion:r,globPortion:o}=EF(s);if(o){o=e1(o)}const a=this.expandOneSearchPath(r);return a.flatMap(l=>this.resolveOneSearchPathPattern(l,o))});const n=new Map;i.forEach(s=>{const r=s.searchPath.toString();const o=n.get(r);if(o){if(s.pattern){o.pattern=o.pattern||{};o.pattern[s.pattern]=true}}else{n.set(r,{searchPath:s.searchPath,pattern:s.pattern?Zv(s.pattern):void 0})}});return Array.from(n.values())}expandOneSearchPath(e){if(Fp(e)){const i=this.workspaceContextService.getWorkspace().folders;if(i[0]&&i[0].uri.scheme!==ne.file){return[{searchPath:i[0].uri.with({path:e})}]}return[{searchPath:b.file(Mc(e))}]}if(this.workspaceContextService.getWorkbenchState()===qp.FOLDER){const i=this.workspaceContextService.getWorkspace().folders[0].uri;e=xp(e);if(e.startsWith("../")||e===".."){const s=mt.resolve(i.path,e);return[{searchPath:i.with({path:s})}]}const n=e1(e);return[{searchPath:i,pattern:n}]}else if(e==="./"||e===".\\"){return[]}else{const i=e.replace(/^\.[\/\\]/,"");const n=this.workspaceContextService.getWorkspace().folders;const s=n.map(r=>{const o=i.match(new RegExp(`^${sl(r.name)}(?:/(.*)|$)`));return o?{match:o,folder:r}:null}).filter(Un);if(s.length){return s.map(r=>{const o=r.match[1];return{searchPath:r.folder.uri,pattern:o&&e1(o)}})}else{const r=e.match(/\.[\/\\](.+)[\/\\]?/);const o=r?r[1]:e;const a=h(14845,"Workspace folder does not exist: {0}",o);throw new Error(a)}}}resolveOneSearchPathPattern(e,i){const n=e.pattern&&i?`${e.pattern}/${i}`:e.pattern||i;const s=[{searchPath:e.searchPath,pattern:n}];if(n&&!n.endsWith("**")){s.push({searchPath:e.searchPath,pattern:n+"/**"})}return s}getFolderQueryForSearchPath(e,i,n){const s=this.getFolderQueryForRoot(Ov(e.searchPath),i,n,false);if(!s){return null}return{...s,...{includePattern:e.pattern}}}getFolderQueryForRoot(e,i,n,s){let r;const o=b.isUri(e)?e:e.uri;let a=i.excludePattern?.map(p=>{const m=i.excludePattern&&xF(p)?p.uri:void 0;const v=!m||!(b.isUri(e)&&this.uriIdentityService.extUri.isEqual(e,m));return v?m:void 0});if(!a?.length){a=[void 0]}if(n.searchPaths){const p=n.searchPaths.filter(m=>Fc(m.searchPath,o))[0];if(p&&!p.pattern){return null}else if(p){r=p.pattern}}const l=this.configurationService.getValue({resource:o});const c=this.getExcludesForFolder(l,i);const u={...c||{},...r||{}};const d=b.isUri(e)?ts(e):e.name;const f=a.map(p=>{return Object.keys(u).length>0?{folder:p,pattern:u}:void 0}).filter(p=>p);return{folder:o,folderName:s?d:void 0,excludePattern:f,fileEncoding:l.files&&l.files.encoding,disregardIgnoreFiles:typeof i.disregardIgnoreFiles==="boolean"?i.disregardIgnoreFiles:!l.search?.useIgnoreFiles,disregardGlobalIgnoreFiles:typeof i.disregardGlobalIgnoreFiles==="boolean"?i.disregardGlobalIgnoreFiles:!l.search?.useGlobalIgnoreFiles,disregardParentIgnoreFiles:typeof i.disregardParentIgnoreFiles==="boolean"?i.disregardParentIgnoreFiles:!l.search?.useParentIgnoreFiles,ignoreSymlinks:typeof i.ignoreSymlinks==="boolean"?i.ignoreSymlinks:!l.search?.followSymlinks,ignoreGlobCase:i.ignoreGlobCase}}};WD=W([P(0,Xo),P(1,Dx),P(2,yF),P(3,et),P(4,SF),P(5,kP)],WD);function EF(t){const e=t.match(/[\*\{\}\(\)\[\]\?]/);if(e){const i=e.index;const n=t.substr(0,i).match(/[/|\\][^/\\]*$/);if(n){let s=t.substr(0,n.index);if(!s.match(/[/\\]/)){s+="/"}return{pathPortion:s,globPortion:t.substr((n.index||0)+1)}}}return{pathPortion:t}}function Zv(...t){return t.length?t.reduce((e,i)=>{e[i]=true;return e},Object.create(null)):void 0}function CF(t){return bg(t,",").map(e=>e.trim()).filter(e=>!!e.length)}function kF(t){const e=[`**/${t}/**`,`**/${t}`];return e.map(i=>i.replace(/\*\*\/\*\*/g,"**"))}function xp(t){return t.replace(/\\/g,"/")}function e1(t){return xp(t).replace(/^\.\//,"").replace(/\/+$/g,"")}function VD(t){return t.replace(/([?*[\]])/g,"[$1]")}te("searchService");const DF=7e3;function IF(t,e){const i=e.activationEvents;if(!i){return Promise.resolve(void 0)}const n=[];const s=[];for(const u of i){if(/^workspaceContains:/.test(u)){const d=u.substr("workspaceContains:".length);if(d.indexOf("*")>=0||d.indexOf("?")>=0||t.forceUsingSearch){s.push(d)}else{n.push(d)}}}if(n.length===0&&s.length===0){return Promise.resolve(void 0)}const{promise:r,resolve:o}=XL();const a=u=>o({activationEvent:u});const l=Promise.all(n.map(u=>TF(t,u,a))).then(()=>{});const c=PF(t,e.identifier,s,a);Promise.all([l,c]).then(()=>{o(void 0)});return r}async function TF(t,e,i){for(const n of t.folders){if(await t.exists(Mi(b.revive(n),e))){i(`workspaceContains:${e}`);return}}}async function PF(t,e,i,n){if(i.length===0){return Promise.resolve(void 0)}const s=new Tt;const r=t.checkExists(t.folders,i,s.token);const o=setTimeout(async()=>{s.cancel();t.logService.info(`Not activating extension '${e.value}': Timed out while searching for 'workspaceContains' pattern ${i.join(",")}`)},DF);let a=false;try{a=await r}catch(l){if(!Ls(l)){Ti(l)}}s.dispose();clearTimeout(o);if(a){n(`workspaceContains:${i.join(",")}`)}}class JA{constructor(e){this._onDidChangePassword=new L;this.onDidChangePassword=this._onDidChangePassword.event;this._proxy=e.getProxy(ee.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,i){return this._proxy.$getPassword(e,i)}store(e,i,n){return this._proxy.$setPassword(e,i,n)}delete(e,i){return this._proxy.$deletePassword(e,i)}keys(e){return this._proxy.$getKeys(e)}}const Ix=te("IExtHostSecretState");class AF{#e;constructor(e,i){this.disposables=new pe;this._id=ht.toKey(e.identifier);this.#e=i;this.onDidChange=wt.map(wt.filter(this.#e.onDidChangePassword,n=>n.extensionId===this._id),n=>({key:n.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return this.#e.get(this._id,e)}store(e,i){return this.#e.store(this._id,e,i)}delete(e){return this.#e.delete(this._id,e)}keys(){return this.#e.keys(this._id)||[]}}let r0=class Qz{constructor(e,i,n){this.logService=n;this.bundleCache=new Map;this._proxy=i.getProxy(ee.MainThreadLocalization);this.currentLanguage=e.environment.appLanguage;this.isDefaultLanguage=this.currentLanguage===xo}getMessage(e,i){const{message:n,args:s,comment:r}=i;if(this.isDefaultLanguage){return kE(n,s??{})}let o=n;if(r&&r.length>0){o+=`/${Array.isArray(r)?r.join(""):r}`}const a=this.bundleCache.get(e)?.contents[o];if(!a){this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`)}return kE(a??n,s??{})}getBundle(e){return this.bundleCache.get(e)?.contents}getBundleUri(e){return this.bundleCache.get(e)?.uri}async initializeLocalizedMessages(e){if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin){return}if(this.bundleCache.has(e.identifier.value)){return}let i;const n=await this.getBundleLocation(e);if(!n){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{const s=await this._proxy.$fetchBundleContents(n);const r=JSON.parse(s);i=e.isBuiltin?r.contents?.bundle:r}catch(s){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${n}: ${s.message}`);return}if(i){this.bundleCache.set(e.identifier.value,{contents:i,uri:n})}}async getBundleLocation(e){if(e.isBuiltin){const i=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return b.revive(i)}return e.l10n?b.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};r0=W([P(0,wi),P(1,st),P(2,et)],r0);const Tx=te("IExtHostLocalizationService");const Px=te("IExtHostManagedSockets");let o0=class Jz{constructor(e){this._remoteSocketIdCounter=0;this._factory=null;this._managedRemoteSockets=new Map;this._proxy=e.getProxy(ee.MainThreadManagedSockets)}setFactory(e,i){for(const n of this._managedRemoteSockets.values()){n.dispose()}if(this._factory){this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId)}this._factory=new RF(e,i);this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e){throw new Error(`No socket factory with id ${e}`)}const i=++this._remoteSocketIdCounter;const n=await this._factory.makeConnection();const s=new pe;this._managedRemoteSockets.set(i,new LF(i,n,s));s.add(ye(()=>this._managedRemoteSockets.delete(i)));s.add(n.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(i);s.dispose()}));s.add(n.onDidClose(r=>{this._proxy.$onDidManagedSocketClose(i,r?.stack??r?.message);s.dispose()}));s.add(n.onDidReceiveMessage(r=>this._proxy.$onDidManagedSocketHaveData(i,ae.wrap(r))));return i}$remoteSocketWrite(e,i){this._managedRemoteSockets.get(e)?.actual.send(i.buffer)}$remoteSocketEnd(e){const i=this._managedRemoteSockets.get(e);if(i){i.actual.end();i.dispose()}}async $remoteSocketDrain(e){await this._managedRemoteSockets.get(e)?.actual.drain?.()}};o0=W([P(0,st)],o0);class RF{constructor(e,i){this.socketFactoryId=e;this.makeConnection=i}}class LF extends me{constructor(e,i,n){super();this.socketId=e;this.actual=i;this._register(n)}}var a0;const YA=te("IHostUtils");let l0=a0=class Yz extends me{constructor(e,i,n,s,r,o,a,l,c,u,d,f,p){super();this._extHostManagedSockets=f;this._extHostLanguageModels=p;this._onDidChangeRemoteConnectionData=this._register(new L);this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event;this._realPathCache=new Map;this._isTerminating=false;this._hostUtils=i;this._extHostContext=n;this._initData=a;this._extHostWorkspace=s;this._extHostConfiguration=r;this._logService=o;this._extHostTunnelService=c;this._extHostTerminalService=u;this._extHostLocalizationService=d;this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(ee.MainThreadWorkspace);this._mainThreadTelemetryProxy=this._extHostContext.getProxy(ee.MainThreadTelemetry);this._mainThreadExtensionsProxy=this._extHostContext.getProxy(ee.MainThreadExtensionService);this._almostReadyToRunExtensions=new Es;this._readyToStartExtensionHost=new Es;this._readyToRunExtensions=new Es;this._eagerExtensionsActivated=new Es;this._activationEventsReader=new MF(this._initData.extensions.activationEvents);this._globalRegistry=new nl(this._activationEventsReader,this._initData.extensions.allExtensions);const m=new bl(this._initData.extensions.myExtensions);this._myRegistry=new nl(this._activationEventsReader,XA(this._globalRegistry,m));if(sa){this._logService.info(`Creating extension host with the following global extensions: ${$l(this._globalRegistry)}`);this._logService.info(`Creating extension host with the following local extensions: ${$l(this._myRegistry)}`)}this._storage=new UA(this._extHostContext,this._logService);this._secretState=new JA(this._extHostContext);this._storagePath=l;this._instaService=this._store.add(e.createChild(new TS([wx,this._storage],[Ix,this._secretState])));this._activator=this._register(new My(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(v,y,k)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(v,Rc(y),k)},actualActivateExtension:async(v,y)=>{if(nl.isHostExtension(v,this._myRegistry,this._globalRegistry)){await this._mainThreadExtensionsProxy.$activateExtension(v,y);return new PO}const k=this._myRegistry.getExtensionDescription(v);return this._activateExtension(k,y)}},this._logService));this._extensionPathIndex=null;this._resolvers=Object.create(null);this._started=false;this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions();this._almostReadyToRunExtensions.open();await this._extHostWorkspace.waitForInitializeCall();pn("code/extHost/ready");this._readyToStartExtensionHost.open();if(this._initData.autoStart){this._startExtensionHost()}}catch(e){Ti(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{const i=this._myRegistry.getAllExtensionDescriptions();const n=i.map(r=>r.identifier);const s=n.filter(r=>this.isActivated(r));e=s.map(r=>{return this._deactivate(r)})}catch(i){}await Promise.all(e)}terminate(e,i=0){if(this._isTerminating){return}this._isTerminating=true;this._logService.info(`Extension host terminating: ${e}`);this._logService.flush();this._extHostTerminalService.dispose();this._activator.dispose();if(qd){y1(s=>{this._logService.error(s)})}this._extHostContext.dispose();const n=this._deactivateAll();Promise.race([Ts(5e3),n]).finally(()=>{if(this._hostUtils.pid){this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${i}`)}else{this._logService.info(`Extension host exiting with code ${i}`)}this._logService.flush();this._logService.dispose();this._hostUtils.exit(i)})}isActivated(e){if(this._readyToRunExtensions.isOpen()){return this._activator.isActivated(e)}return false}async getExtension(e){const i=await this._mainThreadExtensionsProxy.$getExtension(e);return i&&{...i,identifier:new ht(i.identifier.value),extensionLocation:b.revive(i.extensionLocation)}}_activateByEvent(e,i){return this._activator.activateByEvent(e,i)}_activateById(e,i){return this._activator.activateById(e,i)}activateByIdWithErrors(e,i){return this._activateById(e,i).then(()=>{const n=this._activator.getActivatedExtension(e);if(n.activationFailed){return Promise.reject(n.activationFailedError)}return void 0})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen()){return this._activator.getActivatedExtension(e).exports}else{try{return this._activator.getActivatedExtension(e).exports}catch(i){return null}}}async _realPathExtensionUri(e){if(e.scheme===ne.file&&this._hostUtils.fsRealpath){const i=e.fsPath;if(!this._realPathCache.has(i)){this._realPathCache.set(i,this._hostUtils.fsRealpath(i))}const n=await this._realPathCache.get(i);return b.file(n)}return e}async getExtensionPathIndex(){if(!this._extensionPathIndex){this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>{return new NF(e)})}return this._extensionPathIndex}async _createExtensionPathIndex(e){const i=Xs.forUris(n=>{return jL.ignorePathCasing(n)});await Promise.all(e.map(async n=>{if(this._getEntryPoint(n)){const s=await this._realPathExtensionUri(n.extensionLocation);i.set(s,n)}}));return i}_deactivate(e){let i=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()){return i}if(!this._activator.isActivated(e)){return i}const n=this._activator.getActivatedExtension(e);if(!n){return i}try{if(typeof n.module.deactivate==="function"){i=Promise.resolve(n.module.deactivate()).then(void 0,s=>{this._logService.error(s);return Promise.resolve(void 0)})}}catch(s){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`);this._logService.error(s)}try{n.disposable.dispose()}catch(s){this._logService.error(`An error occurred when disposing the subscriptions for extension '${e.value}':`);this._logService.error(s)}return i}async _activateExtension(e,i){if(!this._initData.remote.isRemote){await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier)}else{this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier)}return this._doActivateExtension(e,i).then(n=>{const s=n.activationTimes;this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,s.codeLoadingTime,s.activateCallTime,s.activateResolvedTime,i);this._logExtensionActivationTimes(e,i,"success",s);return n},n=>{this._logExtensionActivationTimes(e,i,"failure");throw n})}_logExtensionActivationTimes(e,i,n,s){const r=qD(e,i);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...r,...s||{},outcome:n})}_doActivateExtension(e,i){const n=qD(e,i);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",n);const s=this._getEntryPoint(e);if(!s){return Promise.resolve(new TO(ku.NONE))}this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${i.startup}, activationEvent: '${i.activationEvent}'${e.identifier.value!==i.extensionId.value?`, root cause: ${i.extensionId.value}`:``}`);this._logService.flush();const r=this._isESM(e);const o=new pe;const a=new Jv(i.startup);return Promise.all([r?this._loadESMModule(e,Mi(e.extensionLocation,s),a):this._loadCommonJSModule(e,Mi(e.extensionLocation,s),a),this._loadExtensionContext(e,o)]).then(l=>{pn(`code/extHost/willActivateExtension/${e.identifier.value}`);return a0._callActivate(this._logService,e.identifier,l[0],l[1],o,a)}).then(l=>{pn(`code/extHost/didActivateExtension/${e.identifier.value}`);return l})}_loadExtensionContext(e,i){const n=this._extHostLanguageModels.createLanguageModelAccessInformation(e);const s=i.add(new AO(e,this._storage));const r=i.add(new $A(e.identifier.value,false,this._storage));const o=i.add(new AF(e,this._secretState));const a=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?Ec.Test:Ec.Development:Ec.Production;const l=this._initData.remote.isRemote?Ja.Workspace:Ja.UI;this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`);return Promise.all([s.whenReady,r.whenReady,this._storagePath.whenReady]).then(()=>{const c=this;let u;let d;const f=it(e,"ipc")?this._initData.messagePorts?.get(ht.toKey(e.identifier)):void 0;return Object.freeze({globalState:s,workspaceState:r,secrets:o,subscriptions:[],get languageModelAccessInformation(){return n},get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(p){return A1(e.extensionLocation.fsPath,p)},get storagePath(){return c._storagePath.workspaceValue(e)?.fsPath},get globalStoragePath(){return c._storagePath.globalValue(e).fsPath},get logPath(){return A1(c._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return b.joinPath(c._initData.logsLocation,e.identifier.value)},get storageUri(){return c._storagePath.workspaceValue(e)},get globalStorageUri(){return c._storagePath.globalValue(e)},get extensionMode(){return a},get extension(){if(u===void 0){u=new nd(c,e.identifier,e,l,false)}return u},get extensionRuntime(){O(e,"extensionRuntime");return c.extensionRuntime},get environmentVariableCollection(){return c._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!d){if(!f){return void 0}const p=wt.buffer(wt.fromDOMEventEmitter(f,"message",m=>m.data));f.start();d={onDidReceiveMessage:p,postMessage:f.postMessage.bind(f)}}return d}})})}static _callActivate(e,i,n,s,r,o){n=n||{activate:void 0,deactivate:void 0};return this._callActivateOptional(e,i,n,s,o).then(a=>{return new X_(false,null,o.build(),n,a,ye(()=>{r.dispose();Jn(s.subscriptions)}))})}static _callActivateOptional(e,i,n,s,r){if(typeof n.activate==="function"){try{r.activateCallStart();e.trace(`ExtensionService#_callActivateOptional ${i.value}`);const o=n.activate.apply(globalThis,[s]);r.activateCallStop();r.activateResolveStart();return Promise.resolve(o).then(a=>{r.activateResolveStop();return a})}catch(o){return Promise.reject(o)}}else{return Promise.resolve(n)}}_activateOneStartupFinished(e,i){this._activateById(e.identifier,{startup:false,extensionId:e.identifier,activationEvent:i}).then(void 0,n=>{this._logService.error(n)})}_activateAllStartupFinishedDeferred(e,i=0){const n=50;const s=Date.now();ZT(()=>{for(let r=i;r<e.length;r+=1){const o=e[r];for(const a of o.activationEvents??[]){if(a==="onStartupFinished"){if(Date.now()-s>n){this._activateAllStartupFinishedDeferred(e,r);break}else{this._activateOneStartupFinished(o,a)}}}}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks($R());this._extHostConfiguration.getConfigProvider().then(e=>{const i=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation");const n=this._myRegistry.getAllExtensionDescriptions();if(i){this._activateAllStartupFinishedDeferred(n)}else{for(const s of n){if(s.activationEvents){for(const r of s.activationEvents){if(r==="onStartupFinished"){this._activateOneStartupFinished(s,r)}}}}}})}_handleEagerExtensions(){const e=this._activateByEvent("*",true).then(void 0,o=>{this._logService.error(o)});this._register(this._extHostWorkspace.onDidChangeWorkspace(o=>this._handleWorkspaceContainsEagerExtensions(o.added)));const i=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[];const n=this._handleWorkspaceContainsEagerExtensions(i);const s=this._handleRemoteResolverEagerExtensions();const r=Promise.all([s,e,n]).then(()=>{});Promise.race([r,Ts(1e4)]).then(()=>{this._activateAllStartupFinished()});return r}_handleWorkspaceContainsEagerExtensions(e){if(e.length===0){return Promise.resolve(void 0)}return Promise.all(this._myRegistry.getAllExtensionDescriptions().map(i=>{return this._handleWorkspaceContainsEagerExtension(e,i)})).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,i){if(this.isActivated(i.identifier)){return}const n=!this._initData.remote.isRemote&&!!this._initData.remote.authority;const s={logService:this._logService,folders:e.map(o=>o.uri),forceUsingSearch:n||!this._hostUtils.fsExists,exists:o=>this._hostUtils.fsExists(o.fsPath),checkExists:(o,a,l)=>this._mainThreadWorkspaceProxy.$checkExists(o,a,l)};const r=await IF(s,i);if(!r){return}return this._activateById(i.identifier,{startup:true,extensionId:i.identifier,activationEvent:r.activationEvent}).then(void 0,o=>this._logService.error(o))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority){return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,false)}}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){console.error(e);throw e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:i}=this._initData.environment;if(!e||!i){throw new Error(h(2693,"Cannot load test runner."))}const n=(await this.getExtensionPathIndex()).findSubstr(i);const s=this._isESM(n,i.path);const r=await(s?this._loadESMModule(null,i,new Jv(false)):this._loadCommonJSModule(null,i,new Jv(false)));if(!r||typeof r.run!=="function"){throw new Error(h(2694,"Path {0} does not point to a valid extension test runner.",i.toString()))}return new Promise((o,a)=>{const l=(d,f)=>{if(d){if(sa){this._logService.error(`Test runner called back with error`,d)}a(d)}else{if(sa){if(f){this._logService.info(`Test runner called back with ${f} failures.`)}else{this._logService.info(`Test runner called back with successful outcome.`)}}o(typeof f==="number"&&f>0?1:0)}};const c=os(i);const u=r.run(c,l);if(u&&u.then){u.then(()=>{if(sa){this._logService.info(`Test runner finished successfully.`)}o(0)}).catch(d=>{if(sa){this._logService.error(`Test runner finished with error`,d)}a(d instanceof Error&&d.stack?d.stack:String(d))})}})}_startExtensionHost(){if(this._started){throw new Error(`Extension host is already started!`)}this._started=true;return this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>{return Promise.race([this._activator.waitForActivatingExtensions(),Ts(1e3)])}).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open();this._logService.info(`Eager extensions activated`)})}registerRemoteAuthorityResolver(e,i){this._resolvers[e]=i;return ye(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){const{resolver:i}=await this._activateAndGetResolver(e);return i?.resolveExecServer?.(e,{resolveAttempt:0})}async _activateAndGetResolver(e){const i=e.indexOf("+");if(i===-1){throw new Qs(`Not an authority that can be resolved!`,Or.InvalidAuthority)}const n=e.substr(0,i);await this._almostReadyToRunExtensions.wait();await this._activateByEvent(`onResolveRemoteAuthority:${n}`,false);return{authorityPrefix:n,resolver:this._resolvers[n]}}async $resolveAuthority(e,i){const n=Wr.create(false);const s=()=>`[resolveAuthority(${Wk(e)},${i})][${n.elapsed()}ms] `;const r=S=>this._logService.info(`${s()}${S}`);const o=S=>this._logService.warn(`${s()}${S}`);const a=(S,R=void 0)=>this._logService.error(`${s()}${S}`,R);const l=S=>{if(S instanceof Qs){return{type:"error",error:{code:S._code,message:S._message,detail:S._detail}}}throw S};const c=async S=>{r(`activating resolver for ${S}...`);const{resolver:R,authorityPrefix:K}=await this._activateAndGetResolver(S);if(!R){a(`no resolver for ${K}`);throw new Qs(`No remote extension installed to resolve ${K}.`,Or.NoResolverFound)}return{resolver:R,authorityPrefix:K,remoteAuthority:S}};const u=e.split(/@|%40/g).reverse();r(`activating remote resolvers ${u.join(" -> ")}`);let d;try{d=await Promise.all(u.map(c)).catch(async S=>{if(!(S instanceof Qs)||S._code!==Or.InvalidAuthority){throw S}o(`resolving nested authorities failed: ${S.message}`);return[await c(e)]})}catch(S){return l(S)}const f=new l8;f.cancelAndSet(()=>r("waiting..."),1e3);let p;let m;for(const[S,{authorityPrefix:R,resolver:K,remoteAuthority:q}]of d.entries()){try{if(S===d.length-1){r(`invoking final resolve()...`);pn(`code/extHost/willResolveAuthority/${R}`);p=await K.resolve(q,{resolveAttempt:i,execServer:m});pn(`code/extHost/didResolveAuthorityOK/${R}`);r(`setting tunnel factory...`);this._register(await this._extHostTunnelService.setTunnelFactory(K,mp.isManagedResolvedAuthority(p)?p:void 0))}else{r(`invoking resolveExecServer() for ${q}`);pn(`code/extHost/willResolveExecServer/${R}`);m=await K.resolveExecServer?.(q,{resolveAttempt:i,execServer:m});if(!m){throw new Qs(`Exec server was not available for ${q}`,Or.NoResolverFound)}pn(`code/extHost/didResolveExecServerOK/${R}`)}}catch(se){pn(`code/extHost/didResolveAuthorityError/${R}`);a(`returned an error`,se);f.dispose();return l(se)}}f.dispose();const v={environmentTunnels:p.environmentTunnels,features:p.tunnelFeatures?{elevation:p.tunnelFeatures.elevation,privacyOptions:p.tunnelFeatures.privacyOptions,protocol:p.tunnelFeatures.protocol===void 0?true:p.tunnelFeatures.protocol}:void 0};const y={extensionHostEnv:p.extensionHostEnv,isTrusted:p.isTrusted,authenticationSession:p.authenticationSessionForInitializingExtensions?{id:p.authenticationSessionForInitializingExtensions.id,providerId:p.authenticationSessionForInitializingExtensions.providerId}:void 0};r(`returned ${mp.isManagedResolvedAuthority(p)?"managed authority":`${p.host}:${p.port}`}`);let k;if(mp.isManagedResolvedAuthority(p)){const S=i;this._extHostManagedSockets.setFactory(S,p.makeConnection);k={authority:e,connectTo:new uM(S),connectionToken:p.connectionToken}}else{k={authority:e,connectTo:new dM(p.host,p.port),connectionToken:p.connectionToken}}return{type:"ok",value:{authority:k,options:y,tunnelInformation:v}}}async $getCanonicalURI(e,i){this._logService.info(`$getCanonicalURI invoked for authority (${Wk(e)})`);const{resolver:n}=await this._activateAndGetResolver(e);if(!n){return null}const s=b.revive(i);if(typeof n.getCanonicalURI==="undefined"){return s}const r=await Hi(()=>n.getCanonicalURI(s));if(!r){return s}return r}async $startExtensionHost(e){e.toAdd.forEach(o=>o.extensionLocation=b.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:n}=zD(this._activationEventsReader,this._globalRegistry,this._myRegistry,e);const s=await this._createExtensionPathIndex(n);const r=await this.getExtensionPathIndex();r.setSearchTree(s);this._globalRegistry.set(i.getAllExtensionDescriptions());this._myRegistry.set(n);if(sa){this._logService.info(`$startExtensionHost: global extensions: ${$l(this._globalRegistry)}`);this._logService.info(`$startExtensionHost: local extensions: ${$l(this._myRegistry)}`)}return this._startExtensionHost()}$activateByEvent(e,i){if(i===kw.Immediate){return this._almostReadyToRunExtensions.wait().then(n=>this._activateByEvent(e,false))}return this._readyToRunExtensions.wait().then(n=>this._activateByEvent(e,false))}async $activate(e,i){await this._readyToRunExtensions.wait();if(!this._myRegistry.getExtensionDescription(e)){return false}await this._activateById(e,i);return true}async $deltaExtensions(e){e.toAdd.forEach(o=>o.extensionLocation=b.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:n}=zD(this._activationEventsReader,this._globalRegistry,this._myRegistry,e);const s=await this._createExtensionPathIndex(n);const r=await this.getExtensionPathIndex();r.setSearchTree(s);this._globalRegistry.set(i.getAllExtensionDescriptions());this._myRegistry.set(n);if(sa){this._logService.info(`$deltaExtensions: global extensions: ${$l(this._globalRegistry)}`);this._logService.info(`$deltaExtensions: local extensions: ${$l(this._myRegistry)}`)}return Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const i=ae.alloc(e);const n=Math.random()%256;for(let s=0;s<e;s++){i.writeUInt8(n,s)}return i}async $updateRemoteConnectionData(e){this._remoteConnectionData=e;this._onDidChangeRemoteConnectionData.fire()}_isESM(e,i){i??=e?this._getEntryPoint(e):i;return i?.endsWith(".mjs")||e?.type==="module"&&!i?.endsWith(".cjs")}};l0=a0=W([P(0,yl),P(1,YA),P(2,st),P(3,ur),P(4,jr),P(5,et),P(6,wi),P(7,bx),P(8,yx),P(9,Du),P(10,Tx),P(11,Px),P(12,kx)],l0);function zD(t,e,i,n){t.addActivationEvents(n.addActivationEvents);const s=new nl(t,e.getAllExtensionDescriptions());s.deltaExtensions(n.toAdd,n.toRemove);const r=new bl(i.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of n.myToRemove){r.delete(a)}for(const a of n.myToAdd){r.add(a)}const o=XA(s,r);return{globalRegistry:s,myExtensions:o}}function qD(t,e){const i={id:t.identifier.value,name:t.name,extensionVersion:t.version,publisherDisplayName:t.publisher,activationEvents:t.activationEvents?t.activationEvents.join(","):null,isBuiltin:t.isBuiltin,reason:e.activationEvent,reasonId:e.extensionId.value};return i}function $l(t){return t.getAllExtensionDescriptions().map(e=>e.identifier.value).join(",")}const ea=te("IExtHostExtensionService");class nd{#e;#t;#i;constructor(e,i,n,s,r){this.#e=e;this.#t=i;this.#i=n.identifier;this.id=n.identifier.value;this.isBuiltin=n.isBuiltin||n.isUserBuiltin;this.extensionUri=n.extensionLocation;this.extensionPath=Mc(os(n.extensionLocation));this.packageJSON=n;this.extensionKind=s;this.isFromDifferentExtensionHost=r}get isActive(){return this.#e.isActivated(this.#i)}get exports(){if(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost){return void 0}return this.#e.getExtensionExports(this.#i)}async activate(){if(this.isFromDifferentExtensionHost){throw new Error("Cannot activate foreign extension")}await this.#e.activateByIdWithErrors(this.#i,{startup:false,extensionId:this.#t,activationEvent:"api"});return this.exports}}function XA(t,e){return t.getAllExtensionDescriptions().filter(i=>e.has(i.identifier))}class NF{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class MF{constructor(e){this._map=new $o;this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const i of Object.keys(e)){this._map.set(i,e[i])}}}const _f=te("IExtHostApiDeprecationService");let c0=class Xz{constructor(e,i){this._extHostLogService=i;this._reportedUsages=new Set;this._telemetryShape=e.getProxy(ee.MainThreadTelemetry)}report(e,i,n){const s=this.getUsageKey(e,i);if(this._reportedUsages.has(s)){return}this._reportedUsages.add(s);if(i.isUnderDevelopment){this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${n}`)}this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:i.identifier.value,apiId:e})}getUsageKey(e,i){return`${e}-${i.identifier.value}`}};c0=W([P(0,st),P(1,et)],c0);var xe;(function(t){t[t["Off"]=0]="Off";t[t["Trace"]=1]="Trace";t[t["Debug"]=2]="Debug";t[t["Info"]=3]="Info";t[t["Warning"]=4]="Warning";t[t["Error"]=5]="Error"})(xe||(xe={}));const OF=xe.Info;function u0(t,e){return t!==xe.Off&&t<=e}function FF(t,e,i){switch(e){case xe.Trace:t.trace(i);break;case xe.Debug:t.debug(i);break;case xe.Info:t.info(i);break;case xe.Warning:t.warn(i);break;case xe.Error:t.error(i);break;case xe.Off:break;default:throw new Error(`Invalid log level ${e}`)}}function Hl(t,e=false){let i="";for(let n=0;n<t.length;n++){let s=t[n];if(s instanceof Error){s=xu(s,e)}if(typeof s==="object"){try{s=JSON.stringify(s)}catch(r){}}i+=(n>0?" ":"")+s}return i}class ZA extends me{constructor(){super(...arguments);this.level=OF;this._onDidChangeLogLevel=this._register(new L)}get onDidChangeLogLevel(){return this._onDidChangeLogLevel.event}setLevel(e){if(this.level!==e){this.level=e;this._onDidChangeLogLevel.fire(this.level)}}getLevel(){return this.level}checkLogLevel(e){return u0(this.level,e)}canLog(e){if(this._store.isDisposed){return false}return this.checkLogLevel(e)}}class e5 extends ZA{constructor(e){super();this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...i){if(this.canLog(xe.Trace)){this.log(xe.Trace,Hl([e,...i],true))}}debug(e,...i){if(this.canLog(xe.Debug)){this.log(xe.Debug,Hl([e,...i]))}}info(e,...i){if(this.canLog(xe.Info)){this.log(xe.Info,Hl([e,...i]))}}warn(e,...i){if(this.canLog(xe.Warning)){this.log(xe.Warning,Hl([e,...i]))}}error(e,...i){if(this.canLog(xe.Error)){if(e instanceof Error){const n=Array.prototype.slice.call(arguments);n[0]=e.stack;this.log(xe.Error,Hl(n))}else{this.log(xe.Error,Hl([e,...i]))}}}flush(){}}class UF extends ZA{constructor(e){super();this.loggers=e;if(e.length){this.setLevel(e[0].getLevel())}}setLevel(e){for(const i of this.loggers){i.setLevel(e)}super.setLevel(e)}trace(e,...i){for(const n of this.loggers){n.trace(e,...i)}}debug(e,...i){for(const n of this.loggers){n.debug(e,...i)}}info(e,...i){for(const n of this.loggers){n.info(e,...i)}}warn(e,...i){for(const n of this.loggers){n.warn(e,...i)}}error(e,...i){for(const n of this.loggers){n.error(e,...i)}}flush(){for(const e of this.loggers){e.flush()}}dispose(){for(const e of this.loggers){e.dispose()}super.dispose()}}class $F extends me{constructor(e,i,n){super();this.logLevel=e;this.logsHome=i;this._loggers=new It;this._onDidChangeLoggers=this._register(new L);this.onDidChangeLoggers=this._onDidChangeLoggers.event;this._onDidChangeLogLevel=this._register(new L);this.onDidChangeLogLevel=this._onDidChangeLogLevel.event;this._onDidChangeVisibility=this._register(new L);this.onDidChangeVisibility=this._onDidChangeVisibility.event;if(n){for(const s of n){this._loggers.set(s.resource,{logger:void 0,info:s})}}}getLoggerEntry(e){if(Xe(e)){return[...this._loggers.values()].find(i=>i.info.id===e)}return this._loggers.get(e)}getLogger(e){return this.getLoggerEntry(e)?.logger}createLogger(e,i){const n=this.toResource(e);const s=Xe(e)?e:i?.id??Wc(n.toString()).toString(16);let r=this._loggers.get(n)?.logger;const o=i?.logLevel==="always"?xe.Trace:i?.logLevel;if(!r){r=this.doCreateLogger(n,o??this.getLogLevel(n)??this.logLevel,{...i,id:s})}const a={logger:r,info:{resource:n,id:s,logLevel:o,name:i?.name,hidden:i?.hidden,group:i?.group,extensionId:i?.extensionId,when:i?.when}};this.registerLogger(a.info);this._loggers.set(n,a);return r}toResource(e){return Xe(e)?Mi(this.logsHome,`${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`):e}setLogLevel(e,i){if(b.isUri(e)){const n=e;const s=i;const r=this._loggers.get(n);if(r&&s!==r.info.logLevel){r.info.logLevel=s===this.logLevel?void 0:s;r.logger?.setLevel(s);this._loggers.set(r.info.resource,r);this._onDidChangeLogLevel.fire([n,s])}}else{this.logLevel=e;for(const[n,s]of this._loggers.entries()){if(this._loggers.get(n)?.info.logLevel===void 0){s.logger?.setLevel(this.logLevel)}}this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,i){const n=this.getLoggerEntry(e);if(n&&i!==!n.info.hidden){n.info.hidden=!i;this._loggers.set(n.info.resource,n);this._onDidChangeVisibility.fire([n.info.resource,i])}}getLogLevel(e){let i;if(e){i=this._loggers.get(e)?.info.logLevel}return i??this.logLevel}registerLogger(e){const i=this._loggers.get(e.resource);if(i){if(i.info.hidden!==e.hidden){this.setVisibility(e.resource,!e.hidden)}}else{this._loggers.set(e.resource,{info:e,logger:void 0});this._onDidChangeLoggers.fire({added:[e],removed:[]})}}deregisterLogger(e){const i=this.toResource(e);const n=this._loggers.get(i);if(n){if(n.logger){n.logger.dispose()}this._loggers.delete(i);this._onDidChangeLoggers.fire({added:[],removed:[n.info]})}}*getRegisteredLoggers(){for(const e of this._loggers.values()){yield e.info}}getRegisteredLogger(e){return this._loggers.get(e)?.info}dispose(){this._loggers.forEach(e=>e.logger?.dispose());this._loggers.clear();super.dispose()}}function HF(t){switch(t){case xe.Trace:return"trace";case xe.Debug:return"debug";case xe.Info:return"info";case xe.Warning:return"warn";case xe.Error:return"error";case xe.Off:return"off"}}new E("logLevel",HF(xe.Info));let c_=class Zz extends $F{constructor(e,i){super(i.logLevel,i.logsLocation,i.loggers.map(n=>Wi(n)));this._proxy=e.getProxy(ee.MainThreadLogger)}$setLogLevel(e,i){if(i){this.setLogLevel(b.revive(i),e)}else{this.setLogLevel(e)}}setVisibility(e,i){super.setVisibility(e,i);this._proxy.$setVisibility(e,i)}doCreateLogger(e,i,n){return new BF(this._proxy,e,i,n)}};c_=W([P(0,st),P(1,wi)],c_);class BF extends e5{constructor(e,i,n,s){super(s?.logLevel==="always");this.proxy=e;this.file=i;this.isLoggerCreated=false;this.buffer=[];this.setLevel(n);this.proxy.$createLogger(i,s).then(()=>{this.doLog(this.buffer);this.isLoggerCreated=true})}log(e,i){const n=[[e,i]];if(this.isLoggerCreated){this.doLog(n)}else{this.buffer.push(...n)}}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}}class WF extends me{constructor(e,i=[]){super();this.logger=new UF([e,...i]);this._register(e.onDidChangeLogLevel(n=>this.setLevel(n)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...i){this.logger.trace(e,...i)}debug(e,...i){this.logger.debug(e,...i)}info(e,...i){this.logger.info(e,...i)}warn(e,...i){this.logger.warn(e,...i)}error(e,...i){this.logger.error(e,...i)}flush(){this.logger.flush()}}let d0=class eq extends WF{constructor(e,i,n){const s=n.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost";const r=n.remote.isRemote?h(2698,"Extension Host (Remote)"):e?h(2699,"Extension Host (Worker)"):h(2700,"Extension Host");super(i.createLogger(s,{name:r}))}};d0=W([P(1,Ko),P(2,wi)],d0);class jD{static async installEarlyHandler(e){Error.stackTraceLimit=100;const i=e.get(et);const n=e.get(st);const s=n.getProxy(ee.MainThreadErrors);y1(r=>{i.error(r);const o=Rc(r);s.$onUnexpectedError(o)})}static async installFullHandler(e){const i=e.get(et);const n=e.get(st);const s=e.get(ea);const r=e.get(ev);const o=e.get(_f);const a=n.getProxy(ee.MainThreadExtensionService);const l=n.getProxy(ee.MainThreadErrors);const c=await s.getExtensionRegistry();const u=await s.getExtensionPathIndex();const d=new WeakMap;function f(v,y){if(d.has(v)){return d.get(v).stack}let k="";let S;let R;for(const q of y){k+=`
	at ${q.toString()}`;R=q.getFileName();if(!S&&R){S=u.findSubstr(b.file(R))}}const K=`${v.name||"Error"}: ${v.message||""}${k}`;d.set(v,{extensionIdentifier:S?.identifier,stack:K});return K}const p=Symbol("prepareStackTrace wrapped");let m=f;Object.defineProperty(Error,"prepareStackTrace",{configurable:false,get(){return m},set(v){if(v===f||!v||v[p]){m=v||f;return}m=function(y,k){f(y,k);return v.call(Error,y,k)};Object.assign(m,{[p]:true})}});y1(v=>{if(!ac.is(v)){i.error(v)}const y=Rc(v);let k;if(v instanceof D4){k=v.extension}else{const S=d.get(v);k=S?.extensionIdentifier}if(!k){return}if(ac.is(v)){const S=c.getExtensionDescription(k);if(S){o.report(v.name,S,`${v.message}
 FROM: ${v.stack}`)}}else{a.$onExtensionRuntimeError(k,y);const S=r.onExtensionError(k,v);i.trace("forwarded error to extension?",S,k)}});sf.addListener(v=>{l.$onUnexpectedError(v)})}}class Ax{constructor(e,i,n,s,r){this._hostUtils=n;this._rpcProtocol=new Wp(e,null,s);i=Ax._transform(i,this._rpcProtocol);const o=new TS(...x8());o.set(wi,{_serviceBrand:void 0,...i,messagePorts:r});o.set(st,new k8(this._rpcProtocol));o.set(P_,new D8(s));o.set(YA,n);o.set(et,new vs(d0,[true],true));o.set(Ko,new vs(c_,[],true));const a=new Vp(o,true);if(qd){a.invokeFunction(jD.installEarlyHandler)}this._logService=a.invokeFunction(l=>l.get(et));pn(`code/extHost/didCreateServices`);if(this._hostUtils.pid){this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`)}else{this._logService.info(`Extension host started`)}this._logService.trace("initData",i);this._extensionService=a.invokeFunction(l=>l.get(ea));this._extensionService.initialize();if(qd){a.invokeFunction(jD.installFullHandler)}}async asBrowserUri(e){const i=this._rpcProtocol.getProxy(ee.MainThreadExtensionService);return b.revive(await i.$asBrowserUri(e))}async getAllStaticBrowserUris(){const e=this._rpcProtocol.getProxy(ee.MainThreadExtensionService);return(await e.$getAllStaticBrowserUris()).map(([i,n])=>[b.revive(i),b.revive(n)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,i){e.extensions.allExtensions.forEach(s=>{s.extensionLocation=b.revive(i.transformIncomingURIs(s.extensionLocation))});e.environment.appRoot=b.revive(i.transformIncomingURIs(e.environment.appRoot));const n=e.environment.extensionDevelopmentLocationURI;if(n){e.environment.extensionDevelopmentLocationURI=n.map(s=>b.revive(i.transformIncomingURIs(s)))}e.environment.extensionTestsLocationURI=b.revive(i.transformIncomingURIs(e.environment.extensionTestsLocationURI));e.environment.globalStorageHome=b.revive(i.transformIncomingURIs(e.environment.globalStorageHome));e.environment.workspaceStorageHome=b.revive(i.transformIncomingURIs(e.environment.workspaceStorageHome));e.nlsBaseUrl=b.revive(i.transformIncomingURIs(e.nlsBaseUrl));e.logsLocation=b.revive(i.transformIncomingURIs(e.logsLocation));e.workspace=i.transformIncomingURIs(e.workspace);return e}}const VF=(function t(e){const i=n=>{globalThis.removeEventListener("message",i);const s=n.data;Object.defineProperties(globalThis,{"postMessage":{value(r,o){s.postMessage(r,o)}},"onmessage":{get(){return s.onmessage},set(r){s.onmessage=r}}});s.addEventListener("message",r=>{globalThis.dispatchEvent(new MessageEvent("message",{data:r.data,ports:r.ports?[...r.ports]:void 0}))});s.start();globalThis.Worker=class{constructor(){throw new TypeError("Nested workers from within nested worker are NOT supported.")}};importScripts(e)};globalThis.addEventListener("message",i)}).toString();class zF extends EventTarget{constructor(e,i,n){super();this.onmessage=null;this.onmessageerror=null;this.onerror=null;const s=`((${VF})('${i}'))`;const r=new Blob([s],{type:"application/javascript"});const o=URL.createObjectURL(r);const a=new MessageChannel;const l=o;const c={type:"_newWorker",id:l,port:a.port2,url:o,options:n};e(c,[a.port2]);this.postMessage=a.port1.postMessage.bind(a.port1);this.terminate=()=>{const u={type:"_terminateWorker",id:l};e(u);URL.revokeObjectURL(o);a.port1.close();a.port2.close()};Object.defineProperties(this,{"onmessage":{get(){return a.port1.onmessage},set(u){a.port1.onmessage=u}},"onmessageerror":{get(){return a.port1.onmessageerror},set(u){a.port1.onmessageerror=u}}});a.port1.addEventListener("messageerror",u=>{const d=new MessageEvent("messageerror",{data:u.data});this.dispatchEvent(d)});a.port1.addEventListener("message",u=>{const d=new MessageEvent("message",{data:u.data});this.dispatchEvent(d)});a.port1.start()}}new E("inOutput",false);new E("activeLogOutput",false);new E("activeLogOutput.isLog",false);new E("activeLogOutput.levelSettable",false);new E("activeLogOutput.level","");new E("activeLogOutput.levelIsDefault",false);new E(`outputView.scrollLock`,false);new E("activeOutputChannel","");new E("output.filter.trace",true);new E("output.filter.debug",true);new E("output.filter.info",true);new E("output.filter.warning",true);new E("output.filter.error",true);new E("outputFilterFocus",false);new E("output.filter.categories","");var Ld;(function(t){t[t["Append"]=1]="Append";t[t["Replace"]=2]="Replace";t[t["Clear"]=3]="Clear"})(Ld||(Ld={}));const qF={OutputChannels:"workbench.contributions.outputChannels"};function jF(t){return Array.isArray(t.source)}class GF extends me{constructor(){super(...arguments);this.channels=new Map;this._onDidRegisterChannel=this._register(new L);this.onDidRegisterChannel=this._onDidRegisterChannel.event;this._onDidRemoveChannel=this._register(new L);this.onDidRemoveChannel=this._onDidRemoveChannel.event;this._onDidUpdateChannelFiles=this._register(new L);this.onDidUpdateChannelSources=this._onDidUpdateChannelFiles.event}registerChannel(e){if(!this.channels.has(e.id)){this.channels.set(e.id,e);this._onDidRegisterChannel.fire(e.id)}}getChannels(){const e=[];this.channels.forEach(i=>e.push(i));return e}getChannel(e){return this.channels.get(e)}updateChannelSources(e,i){const n=this.channels.get(e);if(n&&jF(n)){n.source=i;this._onDidUpdateChannelFiles.fire(n)}}removeChannel(e){const i=this.channels.get(e);if(i){this.channels.delete(e);this._onDidRemoveChannel.fire(i)}}}ei.add(qF.OutputChannels,new GF);class t5 extends e5{constructor(e,i,n,s,r){super();this.id=e;this.name=i;this.logger=n;this.proxy=s;this.extension=r;this.offset=0;this.visible=false;this.setLevel(n.getLevel());this._register(n.onDidChangeLogLevel(o=>this.setLevel(o)));this._register(ye(()=>this.proxy.$dispose(this.id)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+"\n")}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush();this.proxy.$update(this.id,Ld.Clear,e)}replace(e){const i=this.offset;this.info(e);this.proxy.$update(this.id,Ld.Replace,i);if(this.visible){this.logger.flush()}}show(e,i){this.logger.flush();this.proxy.$reveal(this.id,!!(typeof e==="boolean"?e:i))}hide(){this.proxy.$close(this.id)}log(e,i){this.offset+=ae.fromString(i).byteLength;FF(this.logger,e,i);if(this.visible){this.logger.flush();this.proxy.$update(this.id,Ld.Append)}}}class KF extends t5{appendLine(e){this.append(e)}}let h0=class tq{constructor(e,i,n,s,r,o){this.initData=i;this.extHostFileSystem=n;this.extHostFileSystemInfo=s;this.loggerService=r;this.logService=o;this.extensionLogDirectoryCreationPromise=new It;this.logOutputChannels=new It;this.namePool=1;this.channels=new Map;this.visibleChannelId=null;this.proxy=e.getProxy(ee.MainThreadOutputService);this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(i.logsLocation,`output_logging_${gF(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[i,n]of this.channels){n.visible=i===this.visibleChannelId}}createOutputChannel(e,i,n){e=e.trim();if(!e){throw new Error("illegal argument `name`. must not be falsy")}const s=typeof i==="object"&&i.log;const r=Xe(i)?i:void 0;if(Xe(r)&&!r.trim()){throw new Error("illegal argument `languageId`. must not be empty")}const o=new pe;let a;let l=this.initData.environment.extensionLogLevel?.find(([u])=>ht.equals(n.identifier,u))?.[1];let c;if(s){const u=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,n.identifier.value);c=this.extHostFileSystemInfo.extUri.joinPath(u,`${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`);const d=this.logOutputChannels.get(c);if(d){return d}const f=this.loggerService.getRegisteredLogger(c);if(f?.logLevel!==void 0){l=f.logLevel}a=this.doCreateLogOutputChannel(e,c,l,n,o)}else{a=this.doCreateOutputChannel(e,r,n,o)}a.then(u=>{this.channels.set(u.id,u);u.visible=u.id===this.visibleChannelId;o.add(ye(()=>{this.channels.delete(u.id);if(c){this.logOutputChannels.delete(c)}}))});if(c){const u=this.createExtHostLogOutputChannel(e,l??this.logService.getLevel(),a,o);this.logOutputChannels.set(c,u);return u}return this.createExtHostOutputChannel(e,a,o)}async doCreateOutputChannel(e,i,n,s){if(!this.outputDirectoryPromise){this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation)}const r=await this.outputDirectoryPromise;const o=this.extHostFileSystemInfo.extUri.joinPath(r,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`);const a=s.add(this.loggerService.createLogger(o,{logLevel:"always",donotRotate:true,donotUseFormatters:true,hidden:true}));const l=await this.proxy.$register(e,o,i,n.identifier.value);s.add(ye(()=>this.loggerService.deregisterLogger(o)));return new t5(l,e,a,this.proxy,n)}async doCreateLogOutputChannel(e,i,n,s,r){await this.createExtensionLogDirectory(i);const o=`${s.identifier.value}.${this.extHostFileSystemInfo.extUri.basename(i)}`;const a=r.add(this.loggerService.createLogger(i,{id:o,name:e,logLevel:n,extensionId:s.identifier.value}));r.add(ye(()=>this.loggerService.deregisterLogger(i)));return new KF(o,e,a,this.proxy,s)}createExtensionLogDirectory(e){const i=this.extHostFileSystemInfo.extUri.dirname(e);let n=this.extensionLogDirectoryCreationPromise.get(i);if(!n){this.extensionLogDirectoryCreationPromise.set(i,n=(async()=>{try{await this.extHostFileSystem.value.createDirectory(i)}catch(s){if(zp(s)!==Oe.FileExists){throw s}}})())}return n}createExtHostOutputChannel(e,i,n){const s=()=>{if(n.isDisposed){throw new Error("Channel has been closed")}};i.then(r=>n.add(r));return{get name(){return e},append(r){s();i.then(o=>o.append(r))},appendLine(r){s();i.then(o=>o.appendLine(r))},clear(){s();i.then(r=>r.clear())},replace(r){s();i.then(o=>o.replace(r))},show(r,o){s();i.then(a=>a.show(r,o))},hide(){s();i.then(r=>r.hide())},dispose(){n.dispose()}}}createExtHostLogOutputChannel(e,i,n,s){const r=()=>{if(s.isDisposed){throw new Error("Channel has been closed")}};const o=s.add(new L);function a(l){i=l;o.fire(l)}n.then(l=>{if(l.logLevel!==i){a(l.logLevel)}s.add(l.onDidChangeLogLevel(c=>a(c)))});return{...this.createExtHostOutputChannel(e,n,s),get logLevel(){return i},onDidChangeLogLevel:o.event,trace(l,...c){r();n.then(u=>u.trace(l,...c))},debug(l,...c){r();n.then(u=>u.debug(l,...c))},info(l,...c){r();n.then(u=>u.info(l,...c))},warn(l,...c){r();n.then(u=>u.warn(l,...c))},error(l,...c){r();n.then(u=>u.error(l,...c))}}}};h0=W([P(0,st),P(1,wi),P(2,Z_),P(3,bu),P(4,Ko),P(5,et)],h0);const i5=te("IExtHostOutputService");var sd;let f0=class iq{static{sd=this}static{this._handlePool=0}static{this._maxEventSize=250}constructor(e,i){this._logService=i;this._provider=new Map;this._proxy=e.getProxy(ee.MainThreadDecorations)}registerFileDecorationProvider(e,i){const n=sd._handlePool++;this._provider.set(n,{provider:e,extensionDescription:i});this._proxy.$registerDecorationProvider(n,i.identifier.value);const s=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(r=>{if(!r){this._proxy.$onDidChange(n,null);return}const o=Zn(r);if(o.length<=sd._maxEventSize){this._proxy.$onDidChange(n,o);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",i.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:yL(u.path,"/")}));const l=V5(a,(u,d)=>u.rank-d.rank||rl(u.uri.path,d.uri.path));const c=[];e:for(const u of l){let d;for(const f of u){const p=lc(f.uri.path);if(d!==p){d=p;if(c.push(f.uri)>=sd._maxEventSize){break e}}}}this._proxy.$onDidChange(n,c)});return new Ve(()=>{s?.dispose();this._proxy.$unregisterDecorationProvider(n);this._provider.delete(n)})}async $provideDecorations(e,i,n){if(!this._provider.has(e)){return Object.create(null)}const s=Object.create(null);const{provider:r,extensionDescription:o}=this._provider.get(e);await Promise.all(i.map(async a=>{try{const{uri:l,id:c}=a;const u=await Promise.resolve(r.provideFileDecoration(b.revive(l),n));if(!u){return}try{ub.validate(u);if(u.badge&&typeof u.badge!=="string"){O(o,"codiconDecoration")}s[c]=[u.propagate,u.tooltip,u.badge,u.color]}catch(d){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${d}`)}}catch(l){this._logService.error(l)}}));return s}};f0=sd=W([P(0,st),P(1,et)],f0);const n5=te("IExtHostDecorations");class QF{constructor(e){this.values=e;this.prefixSum=new Uint32Array(e.length);this.prefixSumValidIndex=new Int32Array(1);this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,i){e=Pl(e);const n=this.values;const s=this.prefixSum;const r=i.length;if(r===0){return false}this.values=new Uint32Array(n.length+r);this.values.set(n.subarray(0,e),0);this.values.set(n.subarray(e),e+r);this.values.set(i,e);if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}this.prefixSum=new Uint32Array(this.values.length);if(this.prefixSumValidIndex[0]>=0){this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1))}return true}setValue(e,i){e=Pl(e);i=Pl(i);if(this.values[e]===i){return false}this.values[e]=i;if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}return true}removeValues(e,i){e=Pl(e);i=Pl(i);const n=this.values;const s=this.prefixSum;if(e>=n.length){return false}const r=n.length-e;if(i>=r){i=r}if(i===0){return false}this.values=new Uint32Array(n.length-i);this.values.set(n.subarray(0,e),0);this.values.set(n.subarray(e+i),e);this.prefixSum=new Uint32Array(this.values.length);if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}if(this.prefixSumValidIndex[0]>=0){this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1))}return true}getTotalSum(){if(this.values.length===0){return 0}return this._getPrefixSum(this.values.length-1)}getPrefixSum(e){if(e<0){return 0}e=Pl(e);return this._getPrefixSum(e)}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0]){return this.prefixSum[e]}let i=this.prefixSumValidIndex[0]+1;if(i===0){this.prefixSum[0]=this.values[0];i++}if(e>=this.values.length){e=this.values.length-1}for(let n=i;n<=e;n++){this.prefixSum[n]=this.prefixSum[n-1]+this.values[n]}this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e);return this.prefixSum[e]}getIndexOf(e){e=Math.floor(e);this.getTotalSum();let i=0;let n=this.values.length-1;let s=0;let r=0;let o=0;while(i<=n){s=i+(n-i)/2|0;r=this.prefixSum[s];o=r-this.values[s];if(e<o){n=s-1}else if(e>=r){i=s+1}else{break}}return new JF(s,e-o)}}class JF{constructor(e,i){this.index=e;this.remainder=i;this._prefixSumIndexOfResultBrand=void 0;this.index=e;this.remainder=i}}class YF{constructor(e,i,n,s){this._uri=e;this._lines=i;this._eol=n;this._versionId=s;this._lineStarts=null;this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){if(this._cachedTextValue===null){this._cachedTextValue=this._lines.join(this._eol)}return this._cachedTextValue}onEvents(e){if(e.eol&&e.eol!==this._eol){this._eol=e.eol;this._lineStarts=null}const i=e.changes;for(const n of i){this._acceptDeleteRange(n.range);this._acceptInsertText(new $n(n.range.startLineNumber,n.range.startColumn),n.text)}this._versionId=e.versionId;this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length;const i=this._lines.length;const n=new Uint32Array(i);for(let s=0;s<i;s++){n[s]=this._lines[s].length+e}this._lineStarts=new QF(n)}}_setLineText(e,i){this._lines[e]=i;if(this._lineStarts){this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn){return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1));this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber);if(this._lineStarts){this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}}_acceptInsertText(e,i){if(i.length===0){return}const n=u4(i);if(n.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}n[n.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1);this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]);const s=new Uint32Array(n.length-1);for(let r=1;r<n.length;r++){this._lines.splice(e.lineNumber+r-1,0,n[r]);s[r-1]=n[r].length+this._eol.length}if(this._lineStarts){this._lineStarts.insertValues(e.lineNumber,s)}}}const p0=new Map;function XF(t,e){if(!e){p0.delete(t)}else{p0.set(t,e)}}function ZF(t){return p0.get(t)}class eU extends YF{constructor(e,i,n,s,r,o,a,l,c=true){super(i,n,s,r);this._proxy=e;this._languageId=o;this._isDirty=a;this._encoding=l;this._strictInstanceofChecks=c;this._isDisposed=false}dispose(){tn(!this._isDisposed);this._isDisposed=true;this._isDirty=false}equalLines(e){return mn(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===ne.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},get encoding(){return e._encoding},save(){return e._save()},getText(i){return i?e._getTextInRange(i):e.getText()},get eol(){return e._eol==="\n"?Ds.LF:Ds.CRLF},get lineCount(){return e._lines.length},lineAt(i){return e._lineAt(i)},offsetAt(i){return e._offsetAt(i)},positionAt(i){return e._positionAt(i)},validateRange(i){return e._validateRange(i)},validatePosition(i){return e._validatePosition(i)},getWordRangeAtPosition(i,n){return e._getWordRangeAtPosition(i,n)},[Symbol.for("debug.description")](){return`TextDocument(${e._uri.toString()})`}}}return Object.freeze(this._document)}_acceptLanguageId(e){tn(!this._isDisposed);this._languageId=e}_acceptIsDirty(e){tn(!this._isDisposed);this._isDirty=e}_acceptEncoding(e){tn(!this._isDisposed);this._encoding=e}_save(){if(this._isDisposed){return Promise.reject(new Error("Document has been closed"))}return this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const i=this._validateRange(e);if(i.isEmpty){return""}if(i.isSingleLine){return this._lines[i.start.line].substring(i.start.character,i.end.character)}const n=this._eol,s=i.start.line,r=i.end.line,o=[];o.push(this._lines[s].substring(i.start.character));for(let a=s+1;a<r;a++){o.push(this._lines[a])}o.push(this._lines[r].substring(0,i.end.character));return o.join(n)}_lineAt(e){let i;if(e instanceof je){i=e.line}else if(typeof e==="number"){i=e}else if(!this._strictInstanceofChecks&&je.isPosition(e)){i=e.line}if(typeof i!=="number"||i<0||i>=this._lines.length||Math.floor(i)!==i){throw new Error("Illegal value for `line`")}return new tU(i,this._lines[i],i===this._lines.length-1)}_offsetAt(e){e=this._validatePosition(e);this._ensureLineStarts();return this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e);e=Math.max(0,e);this._ensureLineStarts();const i=this._lineStarts.getIndexOf(e);const n=this._lines[i.index].length;return new je(i.index,Math.min(i.remainder,n))}_validateRange(e){if(this._strictInstanceofChecks){if(!(e instanceof Fe)){throw new Error("Invalid argument")}}else{if(!Fe.isRange(e)){throw new Error("Invalid argument")}}const i=this._validatePosition(e.start);const n=this._validatePosition(e.end);if(i===e.start&&n===e.end){return e}return new Fe(i.line,i.character,n.line,n.character)}_validatePosition(e){if(this._strictInstanceofChecks){if(!(e instanceof je)){throw new Error("Invalid argument")}}else{if(!je.isPosition(e)){throw new Error("Invalid argument")}}if(this._lines.length===0){return e.with(0,0)}let{line:i,character:n}=e;let s=false;if(i<0){i=0;n=0;s=true}else if(i>=this._lines.length){i=this._lines.length-1;n=this._lines[i].length;s=true}else{const r=this._lines[i].length;if(n<0){n=0;s=true}else if(n>r){n=r;s=true}}if(!s){return e}return new je(i,n)}_getWordRangeAtPosition(e,i){const n=this._validatePosition(e);if(!i){i=ZF(this._languageId)}else if(c4(i)){throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${i.source}' because it matches the empty string.`)}const s=oP(n.character+1,sP(i),this._lines[n.line],0);if(s){return new Fe(n.line,s.startColumn-1,n.line,s.endColumn-1)}return void 0}}class tU{constructor(e,i,n){this._line=e;this._text=i;this._isLastLine=n}get lineNumber(){return this._line}get text(){return this._text}get range(){return new Fe(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){if(this._isLastLine){return this.range}return new Fe(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}class Rx{constructor(e){this._prefix=e;this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}class Lx{static{this._Keys=new Rx("TextEditorDecorationType")}constructor(e,i,n){const s=Lx._Keys.nextId();e.$registerTextEditorDecorationType(i.identifier,s,Hb.from(n));this.value=Object.freeze({key:s,dispose(){e.$removeTextEditorDecorationType(s)}})}}class iU{constructor(e,i){this._collectedEdits=[];this._setEndOfLine=void 0;this._finalized=false;this._document=e;this._documentVersionId=e.version;this._undoStopBefore=i.undoStopBefore;this._undoStopAfter=i.undoStopAfter}finalize(){this._finalized=true;return{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized){throw new Error("Edit is only valid while callback runs")}}replace(e,i){this._throwIfFinalized();let n=null;if(e instanceof je){n=new Fe(e,e)}else if(e instanceof Fe){n=e}else{throw new Error("Unrecognized location")}this._pushEdit(n,i,false)}insert(e,i){this._throwIfFinalized();this._pushEdit(new Fe(e,e),i,true)}delete(e){this._throwIfFinalized();let i=null;if(e instanceof Fe){i=e}else{throw new Error("Unrecognized location")}this._pushEdit(i,null,true)}_pushEdit(e,i,n){const s=this._document.validateRange(e);this._collectedEdits.push({range:s,text:i,forceMoveMarkers:n})}setEndOfLine(e){this._throwIfFinalized();if(e!==Ds.LF&&e!==Ds.CRLF){throw Ge("endOfLine")}this._setEndOfLine=e}}class nU{constructor(e,i,n,s){this._proxy=e;this._id=i;this._accept(n);this._logService=s;const r=this;this.value={get tabSize(){return r._tabSize},set tabSize(o){r._setTabSize(o)},get indentSize(){return r._indentSize},set indentSize(o){r._setIndentSize(o)},get insertSpaces(){return r._insertSpaces},set insertSpaces(o){r._setInsertSpaces(o)},get cursorStyle(){return r._cursorStyle},set cursorStyle(o){r._setCursorStyle(o)},get lineNumbers(){return r._lineNumbers},set lineNumbers(o){r._setLineNumbers(o)}}}_accept(e){this._tabSize=e.tabSize;this._indentSize=e.indentSize;this._originalIndentSize=e.originalIndentSize;this._insertSpaces=e.insertSpaces;this._cursorStyle=e.cursorStyle;this._lineNumbers=Dc.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto"){return"auto"}if(typeof e==="number"){const i=Math.floor(e);return i>0?i:null}if(typeof e==="string"){const i=parseInt(e,10);if(isNaN(i)){return null}return i>0?i:null}return null}_setTabSize(e){const i=this._validateTabSize(e);if(i===null){return}if(typeof i==="number"){if(this._tabSize===i){return}this._tabSize=i}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:i}))}_validateIndentSize(e){if(e==="tabSize"){return"tabSize"}if(typeof e==="number"){const i=Math.floor(e);return i>0?i:null}if(typeof e==="string"){const i=parseInt(e,10);if(isNaN(i)){return null}return i>0?i:null}return null}_setIndentSize(e){const i=this._validateIndentSize(e);if(i===null){return}if(typeof i==="number"){if(this._originalIndentSize===i){return}this._indentSize=i;this._originalIndentSize=i}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:i}))}_validateInsertSpaces(e){if(e==="auto"){return"auto"}return e==="false"?false:Boolean(e)}_setInsertSpaces(e){const i=this._validateInsertSpaces(e);if(typeof i==="boolean"){if(this._insertSpaces===i){return}this._insertSpaces=i}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:i}))}_setCursorStyle(e){if(this._cursorStyle===e){return}this._cursorStyle=e;this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e}))}_setLineNumbers(e){if(this._lineNumbers===e){return}this._lineNumbers=e;this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:Dc.from(e)}))}assign(e){const i={};let n=false;if(typeof e.tabSize!=="undefined"){const s=this._validateTabSize(e.tabSize);if(s==="auto"){n=true;i.tabSize=s}else if(typeof s==="number"&&this._tabSize!==s){this._tabSize=s;n=true;i.tabSize=s}}if(typeof e.indentSize!=="undefined"){const s=this._validateIndentSize(e.indentSize);if(s==="tabSize"){n=true;i.indentSize=s}else if(typeof s==="number"&&this._originalIndentSize!==s){this._indentSize=s;this._originalIndentSize=s;n=true;i.indentSize=s}}if(typeof e.insertSpaces!=="undefined"){const s=this._validateInsertSpaces(e.insertSpaces);if(s==="auto"){n=true;i.insertSpaces=s}else if(this._insertSpaces!==s){this._insertSpaces=s;n=true;i.insertSpaces=s}}if(typeof e.cursorStyle!=="undefined"){if(this._cursorStyle!==e.cursorStyle){this._cursorStyle=e.cursorStyle;n=true;i.cursorStyle=e.cursorStyle}}if(typeof e.lineNumbers!=="undefined"){if(this._lineNumbers!==e.lineNumbers){this._lineNumbers=e.lineNumbers;n=true;i.lineNumbers=Dc.from(e.lineNumbers)}}if(n){this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,i))}}_warnOnError(e,i){i.catch(n=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`);this._logService.warn(n)})}}class sU{constructor(e,i,n,s,r,o,a,l){this.id=e;this._proxy=i;this._logService=n;this._disposed=false;this._hasDecorationsForKey=new Set;this._selections=r;this._options=new nU(this._proxy,this.id,o,n);this._visibleRanges=a;this._viewColumn=l;const c=this;this.value=Object.freeze({get document(){return s.value},set document(u){throw new xa("document")},get selection(){return c._selections&&c._selections[0]},set selection(u){if(!(u instanceof or)){throw Ge("selection")}c._selections=[u];c._trySetSelection()},get selections(){return c._selections},set selections(u){if(!Array.isArray(u)||u.some(d=>!(d instanceof or))){throw Ge("selections")}if(u.length===0){u=[new or(0,0,0,0)]}c._selections=u;c._trySetSelection()},get visibleRanges(){return c._visibleRanges},set visibleRanges(u){throw new xa("visibleRanges")},get diffInformation(){return c._diffInformation},get options(){return c._options.value},set options(u){if(!c._disposed){c._options.assign(u)}},get viewColumn(){return c._viewColumn},set viewColumn(u){throw new xa("viewColumn")},edit(u,d={undoStopBefore:true,undoStopAfter:true}){if(c._disposed){return Promise.reject(new Error("TextEditor#edit not possible on closed editors"))}const f=new iU(s.value,d);u(f);return c._applyEdit(f)},insertSnippet(u,d,f={undoStopBefore:true,undoStopAfter:true}){if(c._disposed){return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"))}let p;if(!d||Array.isArray(d)&&d.length===0){p=c._selections.map(m=>V.from(m))}else if(d instanceof je){const{lineNumber:m,column:v}=ut.from(d);p=[{startLineNumber:m,startColumn:v,endLineNumber:m,endColumn:v}]}else if(d instanceof Fe){p=[V.from(d)]}else{p=[];for(const m of d){if(m instanceof Fe){p.push(V.from(m))}else{const{lineNumber:v,column:y}=ut.from(m);p.push({startLineNumber:v,startColumn:y,endLineNumber:v,endColumn:y})}}}if(f.keepWhitespace===void 0){f.keepWhitespace=false}return i.$tryInsertSnippet(e,s.value.version,u.value,p,f)},setDecorations(u,d){const f=d.length===0;if(f&&!c._hasDecorationsForKey.has(u.key)){return}if(f){c._hasDecorationsForKey.delete(u.key)}else{c._hasDecorationsForKey.add(u.key)}c._runOnProxy(()=>{if(CA(d)){return i.$trySetDecorations(e,u.key,WM(d))}else{const p=new Array(4*d.length);for(let m=0,v=d.length;m<v;m++){const y=d[m];p[4*m]=y.start.line+1;p[4*m+1]=y.start.character+1;p[4*m+2]=y.end.line+1;p[4*m+3]=y.end.character+1}return i.$trySetDecorationsFast(e,u.key,p)}})},revealRange(u,d){c._runOnProxy(()=>i.$tryRevealRange(e,V.from(u),d||zg.Default))},show(u){i.$tryShowEditor(e,_i.from(u))},hide(){i.$tryHideEditor(e)},[Symbol.for("debug.description")](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){tn(!this._disposed);this._disposed=true}_acceptOptions(e){tn(!this._disposed);this._options._accept(e)}_acceptVisibleRanges(e){tn(!this._disposed);this._visibleRanges=e}_acceptViewColumn(e){tn(!this._disposed);this._viewColumn=e}_acceptSelections(e){tn(!this._disposed);this._selections=e}_acceptDiffInformation(e){tn(!this._disposed);this._diffInformation=e}async _trySetSelection(){const e=this._selections.map(Ms.from);await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e));return this.value}_applyEdit(e){const i=e.finalize();if(i.edits.length===0&&!i.setEndOfLine){return Promise.resolve(true)}const n=i.edits.map(r=>r.range);n.sort((r,o)=>{if(r.end.line===o.end.line){if(r.end.character===o.end.character){if(r.start.line===o.start.line){return r.start.character-o.start.character}return r.start.line-o.start.line}return r.end.character-o.end.character}return r.end.line-o.end.line});for(let r=0,o=n.length-1;r<o;r++){const a=n[r].end;const l=n[r+1].start;if(l.isBefore(a)){return Promise.reject(new Error("Overlapping ranges are not allowed!"))}}const s=i.edits.map(r=>{return{range:V.from(r.range),text:r.text,forceMoveMarkers:r.forceMoveMarkers}});return this._proxy.$tryApplyEdits(this.id,i.documentVersionId,s,{setEndOfLine:typeof i.setEndOfLine==="number"?ou.from(i.setEndOfLine):void 0,undoStopBefore:i.undoStopBefore,undoStopAfter:i.undoStopAfter})}_runOnProxy(e){if(this._disposed){this._logService.warn("TextEditor is closed/disposed");return Promise.resolve(void 0)}return e().then(()=>this,i=>{if(!(i instanceof Error&&i.name==="DISPOSED")){this._logService.warn(i)}return null})}}class rU{constructor(e){this.value=e;this._count=0}ref(){this._count++}unref(){return--this._count===0}}let g0=class nq{constructor(e,i){this._extHostRpc=e;this._logService=i;this._activeEditorId=null;this._editors=new Map;this._documents=new It;this._onDidAddDocuments=new L;this._onDidRemoveDocuments=new L;this._onDidChangeVisibleTextEditors=new L;this._onDidChangeActiveTextEditor=new L;this.onDidAddDocuments=this._onDidAddDocuments.event;this.onDidRemoveDocuments=this._onDidRemoveDocuments.event;this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event;this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const i=[];const n=[];const s=[];if(e.removedDocuments){for(const r of e.removedDocuments){const o=b.revive(r);const a=this._documents.get(o);if(a?.unref()){this._documents.delete(o);i.push(a.value)}}}if(e.addedDocuments){for(const r of e.addedDocuments){const o=b.revive(r.uri);let a=this._documents.get(o);if(a){if(o.scheme!==ne.vscodeNotebookCell&&o.scheme!==ne.vscodeInteractiveInput){throw new Error(`document '${o} already exists!'`)}}if(!a){a=new rU(new eU(this._extHostRpc.getProxy(ee.MainThreadDocuments),o,r.lines,r.EOL,r.versionId,r.languageId,r.isDirty,r.encoding));this._documents.set(o,a);n.push(a.value)}a.ref()}}if(e.removedEditors){for(const r of e.removedEditors){const o=this._editors.get(r);this._editors.delete(r);if(o){s.push(o)}}}if(e.addedEditors){for(const r of e.addedEditors){const o=b.revive(r.documentUri);tn(this._documents.has(o),`document '${o}' does not exist`);tn(!this._editors.has(r.id),`editor '${r.id}' already exists!`);const a=this._documents.get(o).value;const l=new sU(r.id,this._extHostRpc.getProxy(ee.MainThreadTextEditors),this._logService,new $i(()=>a.document),r.selections.map(Ms.to),r.options,r.visibleRanges.map(c=>V.to(c)),typeof r.editorPosition==="number"?_i.to(r.editorPosition):void 0);this._editors.set(r.id,l)}}if(e.newActiveEditor!==void 0){tn(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`);this._activeEditorId=e.newActiveEditor}Jn(i);Jn(s);if(e.removedDocuments){this._onDidRemoveDocuments.fire(i)}if(e.addedDocuments){this._onDidAddDocuments.fire(n)}if(e.removedEditors||e.addedEditors){this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(r=>r.value))}if(e.newActiveEditor!==void 0){this._onDidChangeActiveTextEditor.fire(this.activeEditor())}}getDocument(e){return this._documents.get(e)?.value}allDocuments(){return qi.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId){return void 0}const i=this._editors.get(this._activeEditorId);if(e){return i}else{return i?.value}}allEditors(){return[...this._editors.values()]}};g0=W([P(0,st),P(1,et)],g0);const Iu=te("IExtHostDocumentsAndEditors");const oU={type:"object",additionalProperties:false,properties:{type:{type:"string",description:h(11986,"The actual task type. Please note that types starting with a '$' are reserved for internal usage.")},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:h(11987,"Additional properties of the task type"),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:h(11988,"Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:""}}};var m0;(function(t){function e(i,n,s){if(!i){return void 0}const r=Xe(i.type)?i.type:void 0;if(!r||r.length===0){s.error(h(11989,"The task type configuration is missing the required 'taskType' property"));return void 0}const o=[];if(Array.isArray(i.required)){for(const a of i.required){if(Xe(a)){o.push(a)}}}return{extensionId:n.value,taskType:r,required:o,properties:i.properties?Pt(i.properties):{},when:i.when?ni.deserialize(i.when):void 0}}t.from=e})(m0||(m0={}));const aU=NP.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:function*(t){for(const e of t){if(e.type){yield`onTaskType:${e.type}`}}},jsonSchema:{description:h(11990,"Contributes task kinds"),type:"array",items:oU}});class lU{constructor(){this._onDefinitionsChanged=new L;this.onDefinitionsChanged=this._onDefinitionsChanged.event;this.taskTypes=Object.create(null);this.readyPromise=new Promise((e,i)=>{aU.setHandler((n,s)=>{this._schema=void 0;try{for(const r of s.removed){const o=r.value;for(const a of o){if(this.taskTypes&&a.type&&this.taskTypes[a.type]){delete this.taskTypes[a.type]}}}for(const r of s.added){const o=r.value;for(const a of o){const l=m0.from(a,r.description.identifier,r.collector);if(l){this.taskTypes[l.taskType]=l}}}if(s.removed.length>0||s.added.length>0){this._onDefinitionsChanged.fire()}}catch(r){}e(void 0)})})}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map(e=>this.taskTypes[e])}getJsonSchema(){if(this._schema===void 0){const e=[];for(const i of this.all()){const n={type:"object",additionalProperties:false};if(i.required.length>0){n.required=i.required.slice(0)}if(i.properties!==void 0){n.properties=Pt(i.properties)}else{n.properties=Object.create(null)}n.properties.type={type:"string",enum:[i.taskType]};e.push(n)}this._schema={oneOf:e}}return this._schema}}const cU=new lU;const uU={IconContribution:"base.contributions.icons"};var GD;(function(t){function e(i,n){let s=i.defaults;while(Kt.isThemeIcon(s)){const r=Tu.getIcon(s.id);if(!r){return void 0}s=r.defaults}return s}t.getDefinition=e})(GD||(GD={}));var KD;(function(t){function e(n){return{weight:n.weight,style:n.style,src:n.src.map(s=>({format:s.format,location:s.location.toString()}))}}t.toJSONObject=e;function i(n){const s=r=>Xe(r)?r:void 0;if(n&&Array.isArray(n.src)&&n.src.every(r=>Xe(r.format)&&Xe(r.location))){return{weight:s(n.weight),style:s(n.style),src:n.src.map(r=>({format:r.format,location:b.parse(r.location)}))}}return void 0}t.fromJSONObject=i})(KD||(KD={}));const dU=/^([\w_-]+)$/;const hU=h(2369,"The font ID must only contain letters, numbers, underscores and dashes.");class fU extends me{constructor(){super();this._onDidChange=this._register(new L);this.onDidChange=this._onDidChange.event;this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h(2370,"The id of the font to use. If not set, the font that is defined first is used."),pattern:dU.source,patternErrorMessage:hU},fontCharacter:{type:"string",description:h(2371,"The font character associated with the icon definition.")}},additionalProperties:false,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};this.iconReferenceSchema={type:"string",pattern:`^${Kt.iconNameExpression}$`,enum:[],enumDescriptions:[]};this.iconsById={};this.iconFontsById={}}registerIcon(e,i,n,s){const r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n;this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);if(l!==-1){this.iconReferenceSchema.enumDescriptions[l]=n}this._onDidChange.fire()}return r}const o={id:e,description:n,defaults:i,deprecationMessage:s};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};if(s){a.deprecationMessage=s}if(n){a.markdownDescription=`${n}: $(${e})`}this.iconSchema.properties[e]=a;this.iconReferenceSchema.enum.push(e);this.iconReferenceSchema.enumDescriptions.push(n||"");this._onDidChange.fire();return{id:e}}deregisterIcon(e){delete this.iconsById[e];delete this.iconSchema.properties[e];const i=this.iconReferenceSchema.enum.indexOf(e);if(i!==-1){this.iconReferenceSchema.enum.splice(i,1);this.iconReferenceSchema.enumDescriptions.splice(i,1)}this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,i){const n=this.iconFontsById[e];if(n){return n}this.iconFontsById[e]=i;this._onDidChange.fire();return i}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(r,o)=>{return r.id.localeCompare(o.id)};const i=r=>{while(Kt.isThemeIcon(r.defaults)){r=this.iconsById[r.defaults.id]}return`codicon codicon-${r?r.id:""}`};const n=[];n.push(`| preview     | identifier                        | default codicon ID                | description`);n.push(`| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |`);const s=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(const r of s.filter(o=>!!o.description).sort(e)){n.push(`|<i class="${i(r)}"></i>|${r.id}|${Kt.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`)}n.push(`| preview     | identifier                        `);n.push(`| ----------- | --------------------------------- |`);for(const r of s.filter(o=>!Kt.isThemeIcon(o.defaults)).sort(e)){n.push(`|<i class="${i(r)}"></i>|${r.id}|`)}return n.join("\n")}}const Tu=new fU;ei.add(uU.IconContribution,Tu);function vf(t,e,i,n){return Tu.registerIcon(t,e,i,n)}function pU(){const t=Y8();for(const e in t){const i="\\"+t[e].toString(16);Tu.registerIcon(e,{fontCharacter:i})}}pU();const s5="vscode://schemas/icons";const r5=ei.as(H_.JSONContribution);r5.registerSchema(s5,Tu.getIconSchema());const QD=new wl(()=>r5.notifySchemaChanged(s5),200);Tu.onDidChange(()=>{if(!QD.isScheduled()){QD.schedule()}});vf("widget-close",_e.close,h(2372,"Icon for the close action in widgets."));vf("goto-previous-location",_e.arrowUp,h(2373,"Icon for goto previous editor location."));vf("goto-next-location",_e.arrowDown,h(2374,"Icon for goto next editor location."));Kt.modify(_e.sync,"spin");Kt.modify(_e.loading,"spin");vf("rerun-task",_e.refresh,h(11778,"View icon of the rerun task."));const gU="settings";new E("taskRunning",false,h(12001,"Whether a task is currently running."));new E("taskTerminalActive",false,h(12002,"Whether the active terminal is a task terminal."));I_(12003,"Tasks");var u_;(function(t){t[t["Escape"]=1]="Escape";t[t["Strong"]=2]="Strong";t[t["Weak"]=3]="Weak"})(u_||(u_={}));(function(t){function e(i){if(!i){return t.Strong}switch(i.toLowerCase()){case"escape":return t.Escape;case"strong":return t.Strong;case"weak":return t.Weak;default:return t.Strong}}t.from=e})(u_||(u_={}));var JD;(function(t){t.defaults={cwd:"${workspaceFolder}"}})(JD||(JD={}));var Jh;(function(t){t[t["Always"]=1]="Always";t[t["Silent"]=2]="Silent";t[t["Never"]=3]="Never"})(Jh||(Jh={}));(function(t){function e(i){switch(i.toLowerCase()){case"always":return t.Always;case"silent":return t.Silent;case"never":return t.Never;default:return t.Always}}t.fromString=e})(Jh||(Jh={}));var Yh;(function(t){t[t["Never"]=1]="Never";t[t["OnProblem"]=2]="OnProblem";t[t["Always"]=3]="Always"})(Yh||(Yh={}));(function(t){function e(i){switch(i.toLowerCase()){case"always":return t.Always;case"never":return t.Never;case"onproblem":return t.OnProblem;default:return t.OnProblem}}t.fromString=e})(Yh||(Yh={}));var Xh;(function(t){t[t["Shared"]=1]="Shared";t[t["Dedicated"]=2]="Dedicated";t[t["New"]=3]="New"})(Xh||(Xh={}));(function(t){function e(i){switch(i.toLowerCase()){case"shared":return t.Shared;case"dedicated":return t.Dedicated;case"new":return t.New;default:return t.Shared}}t.fromString=e})(Xh||(Xh={}));var YD;(function(t){t.defaults={echo:true,reveal:Jh.Always,revealProblems:Yh.Never,focus:false,panel:Xh.Shared,showReuseMessage:true,clear:false,preserveTerminalName:false}})(YD||(YD={}));var d_;(function(t){t[t["Shell"]=1]="Shell";t[t["Process"]=2]="Process";t[t["CustomExecution"]=3]="CustomExecution"})(d_||(d_={}));(function(t){function e(n){switch(n.toLowerCase()){case"shell":return t.Shell;case"process":return t.Process;case"customExecution":return t.CustomExecution;default:return t.Process}}t.fromString=e;function i(n){switch(n){case t.Shell:return"shell";case t.Process:return"process";case t.CustomExecution:return"customExecution";default:return"process"}}t.toString=i})(d_||(d_={}));var XD;(function(t){function e(i){if(Xe(i)){return i}else{return i.value}}t.value=e})(XD||(XD={}));var ZD;(function(t){t.Clean={_id:"clean",isDefault:false};t.Build={_id:"build",isDefault:false};t.Rebuild={_id:"rebuild",isDefault:false};t.Test={_id:"test",isDefault:false};function e(n){return n===t.Clean._id||n===t.Build._id||n===t.Rebuild._id||n===t.Test._id}t.is=e;function i(n){if(n===void 0){return void 0}else if(Xe(n)){if(e(n)){return{_id:n,isDefault:false}}return void 0}else{return n}}t.from=i})(ZD||(ZD={}));var eI;(function(t){t[t["Global"]=1]="Global";t[t["Workspace"]=2]="Workspace";t[t["Folder"]=3]="Folder"})(eI||(eI={}));var tI;(function(t){t.Workspace="workspace";t.Extension="extension";t.InMemory="inMemory";t.WorkspaceFile="workspaceFile";t.User="user";function e(i){switch(i){case t.User:return ri.USER;case t.WorkspaceFile:return ri.WORKSPACE;default:return ri.WORKSPACE_FOLDER}}t.toConfigurationTarget=e})(tI||(tI={}));var iI;(function(t){t["parallel"]="parallel";t["sequence"]="sequence"})(iI||(iI={}));var _0;(function(t){t[t["default"]=1]="default";t[t["folderOpen"]=2]="folderOpen"})(_0||(_0={}));var v0;(function(t){t["terminateNewest"]="terminateNewest";t["terminateOldest"]="terminateOldest";t["prompt"]="prompt";t["warn"]="warn";t["silent"]="silent"})(v0||(v0={}));var nI;(function(t){t.defaults={reevaluateOnRerun:true,runOn:_0.default,instanceLimit:1,instancePolicy:v0.prompt}})(nI||(nI={}));var h_;(function(t){t[t["Process"]=1]="Process";t[t["Terminal"]=2]="Terminal"})(h_||(h_={}));(function(t){t._default=t.Terminal})(h_||(h_={}));var sI;(function(t){t[t["V0_1_0"]=1]="V0_1_0";t[t["V2_0_0"]=2]="V2_0_0"})(sI||(sI={}));var f_;(function(t){t["SingleRun"]="singleRun";t["Background"]="background"})(f_||(f_={}));var Er;(function(t){t["Changed"]="changed";t["ProcessStarted"]="processStarted";t["ProcessEnded"]="processEnded";t["Terminated"]="terminated";t["Start"]="start";t["AcquiredInput"]="acquiredInput";t["DependsOnStarted"]="dependsOnStarted";t["Active"]="active";t["Inactive"]="inactive";t["End"]="end";t["ProblemMatcherStarted"]="problemMatcherStarted";t["ProblemMatcherEnded"]="problemMatcherEnded";t["ProblemMatcherFoundErrors"]="problemMatcherFoundErrors"})(Er||(Er={}));var rI;(function(t){t[t["System"]=0]="System";t[t["User"]=1]="User";t[t["FolderOpen"]=2]="FolderOpen";t[t["ConfigurationChange"]=3]="ConfigurationChange";t[t["Reconnect"]=4]="Reconnect";t[t["ChatAgent"]=5]="ChatAgent"})(rI||(rI={}));var oI;(function(t){function e(u){return{taskId:u._id,taskName:u.configurationProperties.name,runType:u.configurationProperties.isBackground?f_.Background:f_.SingleRun,group:u.configurationProperties.group,__task:u}}function i(u,d,f){return{...e(u),kind:Er.Start,terminalId:d,resolvedVariables:f}}t.start=i;function n(u,d,f){return{...e(u),kind:Er.ProcessStarted,terminalId:d,processId:f}}t.processStarted=n;function s(u,d,f,p){return{...e(u),kind:Er.ProcessEnded,terminalId:d,exitCode:f,durationMs:p}}t.processEnded=s;function r(u,d,f){return{...e(u),kind:Er.Inactive,terminalId:d,durationMs:f}}t.inactive=r;function o(u,d,f){return{...e(u),kind:Er.Terminated,exitReason:f,terminalId:d}}t.terminated=o;function a(u,d,f){return{...e(d),kind:u,terminalId:f}}t.general=a;function l(u,d,f){return{...e(u),kind:Er.ProblemMatcherEnded,hasErrors:d}}t.problemMatcherEnded=l;function c(){return{kind:Er.Changed}}t.changed=c})(oI||(oI={}));var p_;(function(t){function e(n){const s=Object.keys(n).sort();let r="";for(const o of s){let a=n[o];if(a instanceof Object){a=e(a)}else if(typeof a==="string"){a=a.replace(/,/g,",,")}r+=o+","+a+","}return r}function i(n){const s=e(n);const r={_key:s,type:n.taskType};Object.assign(r,n);return r}t.create=i})(p_||(p_={}));var aI;(function(t){t["AutoDetect"]="task.autoDetect";t["SaveBeforeRun"]="task.saveBeforeRun";t["ShowDecorations"]="task.showDecorations";t["ProblemMatchersNeverPrompt"]="task.problemMatchers.neverPrompt";t["SlowProviderWarning"]="task.slowProviderWarning";t["QuickOpenHistory"]="task.quickOpen.history";t["QuickOpenDetail"]="task.quickOpen.detail";t["QuickOpenSkip"]="task.quickOpen.skip";t["QuickOpenShowAll"]="task.quickOpen.showAll";t["AllowAutomaticTasks"]="task.allowAutomaticTasks";t["Reconnection"]="task.reconnection";t["VerboseLogging"]="task.verboseLogging";t["NotifyWindowOnTaskCompletion"]="task.notifyWindowOnTaskCompletion"})(aI||(aI={}));var lI;(function(t){t["Tasks"]="tasks";t["SuppressTaskName"]="tasks.suppressTaskName";t["Windows"]="tasks.windows";t["Osx"]="tasks.osx";t["Linux"]="tasks.linux";t["ShowOutput"]="tasks.showOutput";t["IsShellCommand"]="tasks.isShellCommand";t["ServiceTestSetting"]="tasks.service.testSetting"})(lI||(lI={}));var cI;(function(t){function e(i,n){const s=cU.get(i.type);if(s===void 0){const l=Pt(i);delete l._key;return p_.create(l)}const r=Object.create(null);r.type=s.taskType;const o=new Set;s.required.forEach(l=>o.add(l));const a=s.properties;for(const l of Object.keys(a)){const c=i[l];if(c!==void 0&&c!==null){r[l]=c}else if(o.has(l)){const u=a[l];if(u.default!==void 0){r[l]=Pt(u.default)}else{switch(u.type){case"boolean":r[l]=false;break;case"number":case"integer":r[l]=0;break;case"string":r[l]="";break;default:n.error(h(12004,"Error: the task identifier '{0}' is missing the required property '{1}'. The task identifier will be ignored.",JSON.stringify(i,void 0,0),l));return void 0}}}}return p_.create(r)}t.createTaskIdentifier=e})(cI||(cI={}));var g_;(function(t){function e(n){if(n===void 0||n===null){return void 0}return n}t.from=e;function i(n){if(n===void 0||n===null){return void 0}return n}t.to=i})(g_||(g_={}));var m_;(function(t){function e(n){if(n===void 0||n===null){return void 0}return n}t.from=e;function i(n){if(n===void 0||n===null){return void 0}return n}t.to=i})(m_||(m_={}));var w0;(function(t){function e(n){if(n===void 0||n===null){return void 0}return n}t.from=e;function i(n){if(n===void 0||n===null){return void 0}return n}t.to=i})(w0||(w0={}));var Nd;(function(t){function e(s){if(s){const r=s;return r&&!!r.process}else{return false}}t.is=e;function i(s){if(s===void 0||s===null){return void 0}const r={process:s.process,args:s.args};if(s.options){r.options=w0.from(s.options)}return r}t.from=i;function n(s){if(s===void 0||s===null){return void 0}return new Jc(s.process,s.args,s.options)}t.to=n})(Nd||(Nd={}));var b0;(function(t){function e(n){if(n===void 0||n===null){return void 0}return n}t.from=e;function i(n){if(n===void 0||n===null){return void 0}return n}t.to=i})(b0||(b0={}));var Md;(function(t){function e(s){if(s){const r=s;return r&&(!!r.commandLine||!!r.command)}else{return false}}t.is=e;function i(s){if(s===void 0||s===null){return void 0}const r={};if(s.commandLine!==void 0){r.commandLine=s.commandLine}else{r.command=s.command;r.args=s.args}if(s.options){r.options=b0.from(s.options)}return r}t.from=i;function n(s){if(s===void 0||s===null||s.command===void 0&&s.commandLine===void 0){return void 0}if(s.commandLine){return new ul(s.commandLine,s.options)}else{return new ul(s.command,s.args?s.args:[],s.options)}}t.to=n})(Md||(Md={}));var Br;(function(t){function e(s){if(s){const r=s;return r&&r.customExecution==="customExecution"}else{return false}}t.is=e;function i(s){return{customExecution:"customExecution"}}t.from=i;function n(s,r){return r.get(s)}t.to=n})(Br||(Br={}));var uI;(function(t){function e(i,n){let s;if(i.scope!==void 0&&typeof i.scope!=="number"){s=i.scope.uri}else if(i.scope!==void 0&&typeof i.scope==="number"){if(i.scope===Vo.Workspace&&n&&n.workspaceFile){s=n.workspaceFile}else{s=gU}}return{id:i._id,workspaceFolder:s}}t.from=e})(uI||(uI={}));var y0;(function(t){function e(i){if(i===void 0||i===null){return void 0}return{_id:i.id,isDefault:i.isDefault}}t.from=e})(y0||(y0={}));var Io;(function(t){function e(s,r){if(s===void 0||s===null){return[]}const o=[];for(const a of s){const l=i(a,r);if(l){o.push(l)}}return o}t.fromMany=e;function i(s,r){if(s===void 0||s===null){return void 0}let o;if(s.execution instanceof Jc){o=Nd.from(s.execution)}else if(s.execution instanceof ul){o=Md.from(s.execution)}else if(s.execution&&s.execution instanceof ix){o=Br.from(s.execution)}const a=g_.from(s.definition);let l;if(s.scope){if(typeof s.scope==="number"){l=s.scope}else{l=s.scope.uri}}else{l=Vo.Workspace}if(!a||!l){return void 0}const c={_id:s._id,definition:a,name:s.name,source:{extensionId:r.identifier.value,label:s.source,scope:l},execution:o,isBackground:s.isBackground,group:y0.from(s.group),presentationOptions:m_.from(s.presentationOptions),problemMatchers:Zn(s.problemMatchers),hasDefinedMatchers:s.hasDefinedMatchers,runOptions:s.runOptions?s.runOptions:{reevaluateOnRerun:true},detail:s.detail};return c}t.from=i;async function n(s,r,o){if(s===void 0||s===null){return void 0}let a;if(Nd.is(s.execution)){a=Nd.to(s.execution)}else if(Md.is(s.execution)){a=Md.to(s.execution)}else if(Br.is(s.execution)){a=Br.to(s._id,o)}const l=g_.to(s.definition);let c;if(s.source){if(s.source.scope!==void 0){if(typeof s.source.scope==="number"){c=s.source.scope}else{c=await r.resolveWorkspaceFolder(b.revive(s.source.scope))}}else{c=Vo.Workspace}}if(!l||!c){return void 0}const u=new Kg(l,c,s.name,s.source.label,a,s.problemMatchers);if(s.isBackground!==void 0){u.isBackground=s.isBackground}if(s.group!==void 0){u.group=ph.from(s.group._id);if(u.group&&s.group.isDefault){u.group=new ph(u.group.id,u.group.label);if(s.group.isDefault===true){u.group.isDefault=s.group.isDefault}}}if(s.presentationOptions){u.presentationOptions=m_.to(s.presentationOptions)}if(s._id){u._id=s._id}if(s.detail){u.detail=s.detail}return u}t.to=n})(Io||(Io={}));var S0;(function(t){function e(n){return n}t.from=e;function i(n){if(!n){return void 0}return Object.assign(Object.create(null),n)}t.to=i})(S0||(S0={}));class t1{#e;constructor(e,i,n){this._id=i;this._task=n;this.#e=e}get task(){return this._task}terminate(){this.#e.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}get terminal(){return this._terminal}set terminal(e){this._terminal=e}}let x0=class sq{constructor(e,i,n,s,r,o,a,l){this._onDidExecuteTask=new L;this._onDidTerminateTask=new L;this._onDidTaskProcessStarted=new L;this._onDidTaskProcessEnded=new L;this._onDidStartTaskProblemMatchers=new L;this._onDidEndTaskProblemMatchers=new L;this._proxy=e.getProxy(ee.MainThreadTask);this._workspaceProvider=n;this._editorService=s;this._configurationService=r;this._terminalService=o;this._handleCounter=0;this._handlers=new Map;this._taskExecutions=new Map;this._taskExecutionPromises=new Map;this._providedCustomExecutions2=new Map;this._notProvidedCustomExecutions=new Set;this._activeCustomExecutions2=new Map;this._logService=a;this._deprecationService=l;this._proxy.$registerSupportedExecutions(true)}registerTaskProvider(e,i,n){if(!n){return new Ve(()=>{})}const s=this.nextHandle();this._handlers.set(s,{type:i,provider:n,extension:e});this._proxy.$registerTaskProvider(s,i);return new Ve(()=>{this._handlers.delete(s);this._proxy.$unregisterTaskProvider(s)})}registerTaskSystem(e,i){this._proxy.$registerTaskSystem(e,i)}fetchTasks(e){return this._proxy.$fetchTasks(S0.from(e)).then(async i=>{const n=[];for(const s of i){const r=await Io.to(s,this._workspaceProvider,this._providedCustomExecutions2);if(r){n.push(r)}}return n})}get taskExecutions(){const e=[];this._taskExecutions.forEach(i=>e.push(i));return e}terminateTask(e){if(!(e instanceof t1)){throw new Error("No valid task execution provided")}return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,i,n){const s=this._providedCustomExecutions2.get(e.id);if(s){this._activeCustomExecutions2.set(e.id,s);this._terminalService.attachPtyToTerminal(i,await s.callback(n))}this._lastStartedTask=e.id;const r=await this.getTaskExecution(e);const o=this._terminalService.getTerminalById(i)?.value;if(r){r.terminal=o}this._onDidExecuteTask.fire({execution:r})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id)){return}const i=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id);this._taskExecutions.delete(e.id);this.customExecutionComplete(e);this._onDidTerminateTask.fire({execution:i})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const i=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:i,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const i=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:i,exitCode:e.exitCode})}get onDidStartTaskProblemMatchers(){return this._onDidStartTaskProblemMatchers.event}async $onDidStartTaskProblemMatchers(e){let i;try{i=await this.getTaskExecution(e.execution.id)}catch(n){return}this._onDidStartTaskProblemMatchers.fire({execution:i})}get onDidEndTaskProblemMatchers(){return this._onDidEndTaskProblemMatchers.event}async $onDidEndTaskProblemMatchers(e){let i;try{i=await this.getTaskExecution(e.execution.id)}catch(n){return}this._onDidEndTaskProblemMatchers.fire({execution:i,hasErrors:e.hasErrors})}$provideTasks(e,i){const n=this._handlers.get(e);if(!n){return Promise.reject(new Error("no handler found"))}const s=[];const r=Hi(()=>n.provider.provideTasks(Ze.None)).then(o=>{return this.provideTasksInternal(i,s,n,o)});return new Promise(o=>{r.then(a=>{Promise.all(s).then(()=>{o(a)})})})}async $resolveTask(e,i){const n=this._handlers.get(e);if(!n){return Promise.reject(new Error("no handler found"))}if(i.definition.type!==n.type){throw new Error(`Unexpected: Task of type [${i.definition.type}] cannot be resolved by provider of type [${n.type}].`)}const s=await Io.to(i,this._workspaceProvider,this._providedCustomExecutions2);if(!s){throw new Error("Unexpected: Task cannot be resolved.")}const r=await n.provider.resolveTask(s,Ze.None);if(!r){return}this.checkDeprecation(r,n);const o=Io.from(r,n.extension);if(!o){throw new Error("Unexpected: Task cannot be resolved.")}if(r.definition!==s.definition){throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.")}if(Br.is(o.execution)){await this.addCustomExecution(o,r,true)}return await this.resolveTaskInternal(o)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,i,n){const s=await this._proxy.$createTaskId(e);if(!n&&!this._providedCustomExecutions2.has(s)){this._notProvidedCustomExecutions.add(s);this._activeCustomExecutions2.set(s,i.execution)}this._providedCustomExecutions2.set(s,i.execution)}async getTaskExecution(e,i){if(typeof e==="string"){const r=this._taskExecutionPromises.get(e);if(!r){throw new lr("Unexpected: The specified task is missing an execution")}return r}const n=this._taskExecutionPromises.get(e.id);if(n){return n}let s;if(!i){s=Io.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(r=>{if(!r){throw new lr("Unexpected: Task does not exist.")}return new t1(this,e.id,r)})}else{s=Promise.resolve(new t1(this,e.id,i))}this._taskExecutionPromises.set(e.id,s);return s.then(r=>{this._taskExecutions.set(e.id,r);return r})}checkDeprecation(e,i){const n=e;if(n._deprecated){this._deprecationService.report("Task.constructor",i.extension,"Use the Task constructor that takes a `scope` instead.")}}customExecutionComplete(e){const i=this._activeCustomExecutions2.get(e.id);if(i){this._activeCustomExecutions2.delete(e.id)}if(this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id){this._providedCustomExecutions2.delete(e.id);this._notProvidedCustomExecutions.delete(e.id)}const n=this._notProvidedCustomExecutions.values();let s=n.next();while(!s.done){if(!this._activeCustomExecutions2.has(s.value)&&this._lastStartedTask!==s.value){this._providedCustomExecutions2.delete(s.value);this._notProvidedCustomExecutions.delete(s.value)}s=n.next()}}};x0=W([P(0,st),P(1,wi),P(2,ur),P(3,Iu),P(4,jr),P(5,Du),P(6,et),P(7,_f)],x0);let E0=class rq extends x0{constructor(e,i,n,s,r,o,a,l){super(e,i,n,s,r,o,a,l);this.registerTaskSystem(ne.vscodeRemote,{scheme:ne.vscodeRemote,authority:"",platform:qR(xs.Web)})}async executeTask(e,i){if(!i.execution){throw new Error("Tasks to execute must include an execution")}const n=Io.from(i,e);if(n===void 0){throw new Error("Task is not valid")}if(Br.is(n.execution)){await this.addCustomExecution(n,i,false)}else{throw new x1}const s=await this.getTaskExecution(await this._proxy.$getTaskExecution(n),i);this._proxy.$executeTask(n).catch(r=>{throw new Error(r)});return s}provideTasksInternal(e,i,n,s){const r=[];if(s){for(const o of s){this.checkDeprecation(o,n);if(!o.definition||!e[o.definition.type]){const l=o.source?o.source:"No task source";this._logService.warn(`The task [${l}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=Io.from(o,n.extension);if(a&&Br.is(a.execution)){r.push(a);i.push(this.addCustomExecution(a,o,true))}else{this._logService.warn("Only custom execution tasks supported.")}}}return{tasks:r,extension:n.extension}}async resolveTaskInternal(e){if(Br.is(e.execution)){return e}else{this._logService.warn("Only custom execution tasks supported.")}return void 0}async $resolveVariables(e,i){const n={process:void 0,variables:Object.create(null)};return n}async $jsonTasksSupported(){return false}async $findExecutable(e,i,n){return void 0}};E0=W([P(0,st),P(1,wi),P(2,ur),P(3,Iu),P(4,jr),P(5,Du),P(6,et),P(7,_f)],E0);const o5=te("IExtHostTask");class mU{constructor(){this.pendingRequests=new Map;this.queue=[];this._onError=new L;this._onExit=new L;this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){if(this.messageCallback){this._onError.fire(new Error(`attempt to set more than one 'Message' callback`))}this.messageCallback=e}onEvent(e){if(this.eventCallback){this._onError.fire(new Error(`attempt to set more than one 'Event' callback`))}this.eventCallback=e}onRequest(e){if(this.requestCallback){this._onError.fire(new Error(`attempt to set more than one 'Request' callback`))}this.requestCallback=e}sendResponse(e){if(e.seq>0){this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`))}else{this.internalSend("response",e)}}sendRequest(e,i,n,s){const r={command:e};if(i&&Object.keys(i).length>0){r.arguments=i}this.internalSend("request",r);if(typeof s==="number"){const o=setTimeout(()=>{clearTimeout(o);const a=this.pendingRequests.get(r.seq);if(a){this.pendingRequests.delete(r.seq);const l={type:"response",seq:0,request_seq:r.seq,success:false,command:e,message:h(7538,"Timeout after {0} ms for '{1}'",s,e)};a(l)}},s)}if(n){this.pendingRequests.set(r.seq,n)}return r.seq}acceptMessage(e){if(this.messageCallback){this.messageCallback(e)}else{this.queue.push(e);if(this.queue.length===1){this.processQueue()}}}needsTaskBoundaryBetween(e,i){return e.type!=="event"||i.type!=="event"}async processQueue(){let e;while(this.queue.length){if(!e||this.needsTaskBoundaryBetween(this.queue[0],e)){await Ts(0)}e=this.queue.shift();if(!e){return}switch(e.type){case"event":this.eventCallback?.(e);break;case"request":this.requestCallback?.(e);break;case"response":{const i=e;const n=this.pendingRequests.get(i.request_seq);if(n){this.pendingRequests.delete(i.request_seq);n(i)}break}}}}internalSend(e,i){i.type=e;i.seq=this.sequence++;this.sendMessage(i)}async cancelPendingRequests(){if(this.pendingRequests.size===0){return Promise.resolve()}const e=new Map;this.pendingRequests.forEach((i,n)=>e.set(n,i));await Ts(500);e.forEach((i,n)=>{const s={type:"response",seq:0,request_seq:n,success:false,command:"canceled",message:"canceled"};i(s);this.pendingRequests.delete(n)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}}function _U(t){return t.type&&(t.label||t.program||t.runtime)}const vU=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function wU(t){return!!(t&&t.match(vU))}function bU(t){if(typeof t.path==="string"){if(typeof t.sourceReference==="number"&&t.sourceReference>0);else{if(wU(t.path)){return b.parse(t.path)}else{if(Fp(t.path)){return b.file(t.path)}}}}return t.path}function yU(t){if(typeof t.path==="object"){const e=b.revive(t.path);if(e){if(e.scheme===ne.file){return e.fsPath}else{return e.toString()}}}return t.path}function SU(t,e){const i=yU;const n=Pt(t);a5(n,(s,r)=>{if(s&&r){r.path=i(r)}});return n}function xU(t,e){const i=bU;const n=Pt(t);a5(n,(s,r)=>{if(!s&&r){r.path=i(r)}});return n}function a5(t,e){switch(t.type){case"event":{const i=t;switch(i.event){case"output":e(false,i.body.source);break;case"loadedSource":e(false,i.body.source);break;case"breakpoint":e(false,i.body.breakpoint.source);break}break}case"request":{const i=t;switch(i.command){case"setBreakpoints":e(true,i.arguments.source);break;case"breakpointLocations":e(true,i.arguments.source);break;case"source":e(true,i.arguments.source);break;case"gotoTargets":e(true,i.arguments.source);break;case"launchVSCode":i.arguments.args.forEach(n=>e(false,n));break}break}case"response":{const i=t;if(i.success&&i.body){switch(i.command){case"stackTrace":i.body.stackFrames.forEach(n=>e(false,n.source));break;case"loadedSources":i.body.sources.forEach(n=>e(false,n));break;case"scopes":i.body.scopes.forEach(n=>e(false,n.source));break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(n=>e(false,n.source));break;case"setBreakpoints":i.body.breakpoints.forEach(n=>e(false,n.source));break;case"disassemble":{const n=i;n.body?.instructions.forEach(s=>e(false,s.location))}break;case"locations":e(false,i.body?.source);break}}break}}}const wf=te("IExtHostEditorTabs");class dI{constructor(e,i,n){this._activeTabIdGetter=n;this._parentGroup=i;this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this;const i={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(i)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e;this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case An.TextInput:return new rx(b.revive(this._dto.input.uri));case An.TextDiffInput:return new fm(b.revive(this._dto.input.original),b.revive(this._dto.input.modified));case An.TextMergeInput:return new uA(b.revive(this._dto.input.base),b.revive(this._dto.input.input1),b.revive(this._dto.input.input2),b.revive(this._dto.input.result));case An.CustomEditorInput:return new ox(b.revive(this._dto.input.uri),this._dto.input.viewType);case An.WebviewEditorInput:return new dA(this._dto.input.viewType);case An.NotebookInput:return new ax(b.revive(this._dto.input.uri),this._dto.input.notebookType);case An.NotebookDiffInput:return new lx(b.revive(this._dto.input.original),b.revive(this._dto.input.modified),this._dto.input.notebookType);case An.TerminalEditorInput:return new hA;case An.InteractiveEditorInput:return new fA(b.revive(this._dto.input.uri),b.revive(this._dto.input.inputBoxUri));case An.ChatEditorInput:return new pA;case An.MultiDiffEditorInput:return new gA(this._dto.input.diffEditors.map(e=>new fm(b.revive(e.original),b.revive(e.modified))));default:return void 0}}}class EU{constructor(e,i){this._tabs=[];this._activeTabId="";this._dto=e;this._activeGroupIdGetter=i;for(const n of e.tabs){if(n.isActive){this._activeTabId=n.id}this._tabs.push(new dI(n,this,()=>this.activeTabId()))}}get apiObject(){if(!this._apiObject){const e=this;const i={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return _i.to(e._dto.viewColumn)},get activeTab(){return e._tabs.find(n=>n.tabId===e._activeTabId)?.apiObject},get tabs(){return Object.freeze(e._tabs.map(n=>n.apiObject))}};this._apiObject=Object.freeze(i)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===Ar.TAB_OPEN){const n=new dI(e.tabDto,this,()=>this.activeTabId());this._tabs.splice(e.index,0,n);if(e.tabDto.isActive){this._activeTabId=n.tabId}return n}else if(e.kind===Ar.TAB_CLOSE){const n=this._tabs.splice(e.index,1)[0];if(!n){throw new Error(`Tab close updated received for index ${e.index} which does not exist`)}if(n.tabId===this._activeTabId){this._activeTabId=""}return n}else if(e.kind===Ar.TAB_MOVE){if(e.oldIndex===void 0){throw new Error("Invalid old index on move IPC")}const n=this._tabs.splice(e.oldIndex,1)[0];if(!n){throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`)}this._tabs.splice(e.index,0,n);return n}const i=this._tabs.find(n=>n.tabId===e.tabDto.id);if(!i){throw new Error("INVALID tab")}if(e.tabDto.isActive){this._activeTabId=e.tabDto.id}else if(this._activeTabId===e.tabDto.id&&!e.tabDto.isActive){this._activeTabId=""}i.acceptDtoUpdate(e.tabDto);return i}activeTabId(){return this._activeTabId}}let C0=class oq{constructor(e){this._onDidChangeTabs=new L;this._onDidChangeTabGroups=new L;this._extHostTabGroups=[];this._proxy=e.getProxy(ee.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this;const i={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(n=>n.apiObject))},get activeTabGroup(){const n=e._activeGroupId;const s=Lc(e._extHostTabGroups.find(r=>r.groupId===n)?.apiObject);return s},close:async(n,s)=>{const r=Array.isArray(n)?n:[n];if(!r.length){return true}if(CU(r[0])){return this._closeGroups(r,s)}else{return this._closeTabs(r,s)}}};this._apiObject=Object.freeze(i)}return this._apiObject}$acceptEditorTabModel(e){const i=new Set(this._extHostTabGroups.map(c=>c.groupId));const n=new Set(e.map(c=>c.groupId));const s=G5(i,n);const r=this._extHostTabGroups.filter(c=>s.removed.includes(c.groupId)).map(c=>c.apiObject);const o=[];const a=[];this._extHostTabGroups=e.map(c=>{const u=new EU(c,()=>this._activeGroupId);if(s.added.includes(u.groupId)){o.push(u.apiObject)}else{a.push(u.apiObject)}return u});const l=Lc(e.find(c=>c.isActive===true)?.groupId);if(l!==void 0&&this._activeGroupId!==l){this._activeGroupId=l}this._onDidChangeTabGroups.fire(Object.freeze({opened:o,closed:r,changed:a}))}$acceptTabGroupUpdate(e){const i=this._extHostTabGroups.find(n=>n.groupId===e.groupId);if(!i){throw new Error("Update Group IPC call received before group creation.")}i.acceptGroupDtoUpdate(e);if(e.isActive){this._activeGroupId=e.groupId}this._onDidChangeTabGroups.fire(Object.freeze({changed:[i.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const i=this._extHostTabGroups.find(s=>s.groupId===e.groupId);if(!i){throw new Error("Update Tabs IPC call received before group creation.")}const n=i.acceptTabOperation(e);switch(e.kind){case Ar.TAB_OPEN:this._onDidChangeTabs.fire(Object.freeze({opened:[n.apiObject],closed:[],changed:[]}));return;case Ar.TAB_CLOSE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[n.apiObject],changed:[]}));return;case Ar.TAB_MOVE:case Ar.TAB_UPDATE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[n.apiObject]}));return}}_findExtHostTabFromApi(e){for(const i of this._extHostTabGroups){for(const n of i.tabs){if(n.apiObject===e){return n}}}return}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(i=>i.apiObject===e)}async _closeTabs(e,i){const n=[];for(const s of e){const r=this._findExtHostTabFromApi(s);if(!r){throw new Error("Tab close: Invalid tab not found!")}n.push(r.tabId)}return this._proxy.$closeTab(n,i)}async _closeGroups(e,i){const n=[];for(const s of e){const r=this._findExtHostTabGroupFromApi(s);if(!r){throw new Error("Group close: Invalid group not found!")}n.push(r.groupId)}return this._proxy.$closeGroup(n,i)}};C0=W([P(0,st)],C0);function CU(t){const e=t;if(e.tabs!==void 0){return true}return false}var hI;(function(t){t["ViewletId"]="workbench.view.extension.test";t["ExplorerViewId"]="workbench.view.testing";t["OutputPeekContributionId"]="editor.contrib.testingOutputPeek";t["DecorationsContributionId"]="editor.contrib.testingDecorations";t["CoverageDecorationsContributionId"]="editor.contrib.coverageDecorations";t["CoverageViewId"]="workbench.view.testCoverage";t["ResultsPanelId"]="workbench.panel.testResults";t["ResultsViewId"]="workbench.panel.testResults.view";t["MessageLanguageId"]="vscodeInternalTestMessage"})(hI||(hI={}));var fI;(function(t){t["List"]="list";t["Tree"]="true"})(fI||(fI={}));var pI;(function(t){t["ByLocation"]="location";t["ByStatus"]="status";t["ByDuration"]="duration"})(pI||(pI={}));({[oi.Errored]:h(13256,"Errored"),[oi.Failed]:h(13257,"Failed"),[oi.Passed]:h(13258,"Passed"),[oi.Queued]:h(13259,"Queued"),[oi.Running]:h(13260,"Running"),[oi.Skipped]:h(13261,"Skipped"),[oi.Unset]:h(13262,"Not yet run")});({[Ui.Debug]:h(13264,"Debug"),[Ui.Run]:h(13265,"Run"),[Ui.Coverage]:h(13266,"Coverage")});var k0;(function(t){t["CancelTestRefreshAction"]="testing.cancelTestRefresh";t["CancelTestRunAction"]="testing.cancelRun";t["ClearTestResultsAction"]="testing.clearTestResults";t["CollapseAllAction"]="testing.collapseAll";t["ConfigureTestProfilesAction"]="testing.configureProfile";t["ContinousRunUsingForTest"]="testing.continuousRunUsingForTest";t["CoverageAtCursor"]="testing.coverageAtCursor";t["CoverageByUri"]="testing.coverage.uri";t["CoverageClear"]="testing.coverage.close";t["CoverageCurrentFile"]="testing.coverageCurrentFile";t["CoverageFilterToTest"]="testing.coverageFilterToTest";t["CoverageFilterToTestInEditor"]="testing.coverageFilterToTestInEditor";t["CoverageGoToNextMissedLine"]="testing.coverage.goToNextMissedLine";t["CoverageGoToPreviousMissedLine"]="testing.coverage.goToPreviousMissedLine";t["CoverageLastRun"]="testing.coverageLastRun";t["CoverageSelectedAction"]="testing.coverageSelected";t["CoverageToggleInExplorer"]="testing.toggleCoverageInExplorer";t["CoverageToggleToolbar"]="testing.coverageToggleToolbar";t["CoverageViewChangeSorting"]="testing.coverageViewChangeSorting";t["CoverageViewCollapseAll"]="testing.coverageViewCollapseAll";t["DebugAction"]="testing.debug";t["DebugAllAction"]="testing.debugAll";t["DebugAtCursor"]="testing.debugAtCursor";t["DebugByUri"]="testing.debug.uri";t["DebugCurrentFile"]="testing.debugCurrentFile";t["DebugFailedTests"]="testing.debugFailTests";t["DebugFailedFromLastRun"]="testing.debugFailedFromLastRun";t["DebugLastRun"]="testing.debugLastRun";t["DebugSelectedAction"]="testing.debugSelected";t["FilterAction"]="workbench.actions.treeView.testExplorer.filter";t["GetExplorerSelection"]="_testing.getExplorerSelection";t["GetSelectedProfiles"]="testing.getSelectedProfiles";t["GoToTest"]="testing.editFocusedTest";t["GoToRelatedTest"]="testing.goToRelatedTest";t["PeekRelatedTest"]="testing.peekRelatedTest";t["GoToRelatedCode"]="testing.goToRelatedCode";t["PeekRelatedCode"]="testing.peekRelatedCode";t["HideTestAction"]="testing.hideTest";t["OpenCoverage"]="testing.openCoverage";t["OpenOutputPeek"]="testing.openOutputPeek";t["RefreshTestsAction"]="testing.refreshTests";t["ReRunFailedTests"]="testing.reRunFailTests";t["ReRunFailedFromLastRun"]="testing.reRunFailedFromLastRun";t["ReRunLastRun"]="testing.reRunLastRun";t["RunAction"]="testing.run";t["RunAllAction"]="testing.runAll";t["RunAllWithCoverageAction"]="testing.coverageAll";t["RunAtCursor"]="testing.runAtCursor";t["RunByUri"]="testing.run.uri";t["RunCurrentFile"]="testing.runCurrentFile";t["RunSelectedAction"]="testing.runSelected";t["RunUsingProfileAction"]="testing.runUsing";t["RunWithCoverageAction"]="testing.coverage";t["SearchForTestExtension"]="testing.searchForTestExtension";t["SelectDefaultTestProfiles"]="testing.selectDefaultTestProfiles";t["ShowMostRecentOutputAction"]="testing.showMostRecentOutput";t["StartContinousRun"]="testing.startContinuousRun";t["StartContinousRunFromExtension"]="testing.startContinuousRunFromExtension";t["StopContinousRunFromExtension"]="testing.stopContinuousRunFromExtension";t["StopContinousRun"]="testing.stopContinuousRun";t["TestingSortByDurationAction"]="testing.sortByDuration";t["TestingSortByLocationAction"]="testing.sortByLocation";t["TestingSortByStatusAction"]="testing.sortByStatus";t["TestingViewAsListAction"]="testing.viewAsList";t["TestingViewAsTreeAction"]="testing.viewAsTree";t["ToggleContinousRunForTest"]="testing.toggleContinuousRunForTest";t["ToggleResultsViewLayoutAction"]="testing.toggleResultsViewLayout";t["ToggleInlineTestOutput"]="testing.toggleInlineTestOutput";t["UnhideAllTestsAction"]="testing.unhideAllTests";t["UnhideTestAction"]="testing.unhideTest"})(k0||(k0={}));let kU=0;const gI=new WeakMap;const ov=te("IExtHostTesting");let D0=class aq extends me{constructor(e,i,n,s){super();this.logService=i;this.commands=n;this.editors=s;this.resultsChangedEmitter=this._register(new L);this.controllers=new Map;this.defaultProfilesChangedEmitter=this._register(new L);this.followupProviders=new Set;this.testFollowups=new Map;this.onResultsChanged=this.resultsChangedEmitter.event;this.results=[];this.proxy=e.getProxy(ee.MainThreadTesting);this.observer=new RU(this.proxy);this.runTracker=new TU(this.proxy,i);n.registerArgumentProcessor({processArgument:r=>{switch(r?.$mid){case nt.TestItemContext:{const o=r;const a=o.tests[o.tests.length-1].item.extId;const l=this.controllers.get(Me.root(a));return l?.collection.tree.get(a)?.actual??ID(r)}case nt.TestMessageMenuArgs:{const{test:o,message:a}=r;const l=o.item.extId;return{test:this.controllers.get(Me.root(l))?.collection.tree.get(l)?.actual??ID({tests:[o]}),message:uu.to(a)}}default:return r}}});n.registerCommand(false,"testing.getExplorerSelection",async()=>{const r=await n.executeCommand(k0.GetExplorerSelection);const o=a=>{const l=this.controllers.get(Me.root(a));if(!l){return void 0}return Me.isRoot(a)?l.controller:l.collection.tree.get(a)?.actual};return{include:r?.include.map(o).filter(Un)||[],exclude:r?.exclude.map(o).filter(Un)||[]}})}createTestController(e,i,n,s){if(this.controllers.has(i)){throw new Error(`Attempt to insert a duplicate controller with ID "${i}"`)}const r=new pe;const o=r.add(new VO(i,n,this.editors));o.root.label=n;const a=new Map;const l=new Set;const c=this.proxy;const u=()=>{let p=0;if(s){p|=Pd.Refresh}const m=f.relatedCodeProvider;if(m){if(m?.provideRelatedTests){p|=Pd.TestRelatedToCode}if(m?.provideRelatedCode){p|=Pd.CodeRelatedToTest}}return p};const d={items:o.root.children,get label(){return n},set label(p){n=p;o.root.label=p;c.$updateController(i,{label:n})},get refreshHandler(){return s},set refreshHandler(p){s=p;c.$updateController(i,{capabilities:u()})},get id(){return i},get relatedCodeProvider(){return f.relatedCodeProvider},set relatedCodeProvider(p){O(e,"testRelatedCode");f.relatedCodeProvider=p;c.$updateController(i,{capabilities:u()})},createRunProfile:(p,m,v,y,k,S)=>{let R=Wc(p);while(a.has(R)){R++}return new c5(this.proxy,a,l,this.defaultProfilesChangedEmitter.event,i,R,p,m,v,y,k,S)},createTestItem(p,m,v){return new kl(i,p,m,v)},createTestRun:(p,m,v=true)=>{return this.runTracker.createTestRun(e,i,o,p,m,v)},invalidateTestResults:p=>{if(p===void 0){this.proxy.$markTestRetired(void 0)}else{const m=p instanceof Array?p:[p];this.proxy.$markTestRetired(m.map(v=>Me.fromExtHostTestItem(v,i).toString()))}},set resolveHandler(p){o.resolveHandler=p},get resolveHandler(){return o.resolveHandler},dispose:()=>{r.dispose()}};const f={controller:d,collection:o,profiles:a,extension:e,activeProfiles:l};c.$registerTestController(i,n,u());r.add(ye(()=>c.$unregisterTestController(i)));this.controllers.set(i,f);r.add(ye(()=>this.controllers.delete(i)));r.add(o.onDidGenerateDiff(p=>c.$publishDiff(i,p.map(Pg.serialize))));return d}createTestObserver(){return this.observer.checkout()}async runTests(e,i=Ze.None){const n=l5(e);if(!n){throw new Error("The request passed to `vscode.test.runTests` must include a profile")}const s=this.controllers.get(n.controllerId);if(!s){throw new Error("Controller not found")}await this.proxy.$runTests({preserveFocus:e.preserveFocus??true,group:du.from(n.kind),targets:[{testIds:e.include?.map(r=>Me.fromExtHostTestItem(r,s.collection.root.id).toString())??[s.collection.root.id],profileId:n.profileId,controllerId:n.controllerId}],exclude:e.exclude?.map(r=>r.id)},i)}registerTestFollowupProvider(e){this.followupProviders.add(e);return{dispose:()=>{this.followupProviders.delete(e)}}}async $getTestsRelatedToCode(e,i,n){const s=this.editors.getDocument(b.revive(e));if(!s){return[]}const r=ut.to(i);const o=[];await Promise.all([...this.controllers.values()].map(async a=>{let l;try{l=await a.relatedCodeProvider?.provideRelatedTests?.(s.document,r,n)}catch(c){if(!n.isCancellationRequested){this.logService.warn(`Error thrown while providing related tests for ${a.controller.label}`,c)}}if(l){for(const c of l){o.push(Me.fromExtHostTestItem(c,a.controller.id).toString())}a.collection.flushDiff()}}));return o}async $getCodeRelatedToTest(e,i){const n=this.controllers.get(Me.root(e));if(!n){return[]}const s=n.collection.tree.get(e);if(!s){return[]}const r=await n.relatedCodeProvider?.provideRelatedCode?.(s.actual,i);return r?.map(wn.from)??[]}$syncTests(){for(const{collection:e}of this.controllers.values()){e.flushDiff()}return Promise.resolve()}async $getCoverageDetails(e,i,n){const s=await this.runTracker.getCoverageDetails(e,i,n);return s?.map($h.fromDetails)}async $disposeRun(e){this.runTracker.disposeTestRun(e)}$configureRunProfile(e,i){this.controllers.get(e)?.profiles.get(i)?.configureHandler?.()}$setDefaultRunProfiles(e){const i=new Map;for(const[n,s]of Object.entries(e)){const r=this.controllers.get(n);if(!r){continue}const o=new Map;const a=s.filter(c=>!r.activeProfiles.has(c));const l=[...r.activeProfiles].filter(c=>!s.includes(c));for(const c of a){o.set(c,true);r.activeProfiles.add(c)}for(const c of l){o.set(c,false);r.activeProfiles.delete(c)}if(o.size){i.set(n,o)}}this.defaultProfilesChangedEmitter.fire(i)}async $refreshTests(e,i){await this.controllers.get(e)?.controller.refreshHandler?.(i)}$publishTestResults(e){this.results=Object.freeze(e.map(i=>{const n=sy.to(i);const s=i.tasks.findIndex(r=>r.hasCoverage);if(s!==-1){n.getDetailedCoverage=(r,o=Ze.None)=>this.proxy.$getCoverageDetails(i.id,s,r,o).then(a=>a.map($h.to))}gI.set(n,i.id);return n}).concat(this.results).sort((i,n)=>n.completedAt-i.completedAt).slice(0,32));this.resultsChangedEmitter.fire()}async $expandTest(e,i){const n=this.controllers.get(Me.fromString(e).controllerId)?.collection;if(n){await n.expand(e,i<0?Infinity:i);n.flushDiff()}}$acceptDiff(e){this.observer.applyDiff(e.map(i=>Pg.deserialize({asCanonicalUri:n=>n},i)))}async $runControllerTests(e,i){return Promise.all(e.map(n=>this.runControllerTestRequest(n,false,i)))}async $startContinuousRun(e,i){const n=new Tt(i);const s=await Promise.all(e.map(r=>this.runControllerTestRequest(r,true,n.token)));if(!i.isCancellationRequested&&!s.some(r=>r.error)){await new Promise(r=>i.onCancellationRequested(r))}n.dispose(true);return s}async $provideTestFollowups(e,i){const n=this.results.find(o=>gI.get(o)===e.resultId);const s=n&&LU(Me.fromString(e.extId),n?.results);if(!s){return[]}let r=[];await Promise.all([...this.followupProviders].map(async o=>{try{const a=await o.provideFollowup(n,s,e.taskIndex,e.messageIndex,i);if(a){r=r.concat(a)}}catch(a){this.logService.error(`Error thrown while providing followup for test message`,a)}}));if(i.isCancellationRequested){return[]}return r.map(o=>{const a=kU++;this.testFollowups.set(a,o);return{title:o.title,id:a}})}$disposeTestFollowups(e){for(const i of e){this.testFollowups.delete(i)}}$executeTestFollowup(e){const i=this.testFollowups.get(e);if(!i){return Promise.resolve()}return this.commands.executeCommand(i.command,...i.arguments||[])}$cancelExtensionTestRun(e,i){if(e===void 0){this.runTracker.cancelAllRuns()}else{this.runTracker.cancelRunById(e,i)}}getMetadataForRun(e){for(const i of this.runTracker.trackers){const n=i.getTaskIdForRun(e);if(n){return{taskId:n,runId:i.id}}}return void 0}async runControllerTestRequest(e,i,n){const s=this.controllers.get(e.controllerId);if(!s){return{}}const{collection:r,profiles:o,extension:a}=s;const l=o.get(e.profileId);if(!l){return{}}const c=e.testIds.map(p=>r.tree.get(p)).filter(Un);const u=e.excludeExtIds.map(p=>s.collection.tree.get(p)).filter(Un).filter(p=>c.some(m=>m.fullId.compare(p.fullId)===hs.IsChild));if(!c.length){return{}}const d=new dm(c.some(p=>p.actual instanceof Sx)?void 0:c.map(p=>p.actual),u.map(p=>p.actual),l,i);const f=zN(e)&&this.runTracker.prepareForMainThreadTestRun(a,d,Zh.fromInternal(e,s.collection),l,n);try{await l.runHandler(d,n);return{}}catch(p){return{error:String(p)}}finally{if(f){if(f.hasRunningTasks&&!n.isCancellationRequested){await wt.toPromise(f.onEnd)}}}}};D0=W([P(0,st),P(1,et),P(2,Zo),P(3,Iu)],D0);const DU=1e4;var fo;(function(t){t[t["Running"]=0]="Running";t[t["Cancelling"]=1]="Cancelling";t[t["Ended"]=2]="Ended"})(fo||(fo={}));class IU extends me{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,i,n,s,r,o){super();this.dto=e;this.proxy=i;this.logService=n;this.profile=s;this.extension=r;this.state=fo.Running;this.running=0;this.tasks=new Map;this.sharedTestIds=new Set;this.endEmitter=this._register(new L);this.publishedCoverage=new Map;this.onEnd=this.endEmitter.event;this.cts=this._register(new Tt(o));const a=this._register(new wl(()=>this.forciblyEndTasks(),DU));this._register(this.cts.token.onCancellationRequested(()=>a.schedule()));const l=new L;this.onDidDispose=l.event;this._register(ye(()=>{l.fire();l.dispose()}))}getTaskIdForRun(e){for(const[i,{run:n}]of this.tasks){if(n===e){return i}}return void 0}cancel(e){if(e){this.tasks.get(e)?.cts.cancel()}else if(this.state===fo.Running){this.cts.cancel();this.state=fo.Cancelling}else if(this.state===fo.Cancelling){this.forciblyEndTasks()}}async getCoverageDetails(e,i,n){const[,s]=Me.fromString(e).path;const r=this.publishedCoverage.get(e);if(!r){return[]}const{report:o,extIds:a}=r;const l=this.tasks.get(s);if(!l){throw new Error("unreachable: run task was not found")}let c;if(i&&o instanceof eu){const d=a.indexOf(i);if(d===-1){return[]}c=o.includesTests[d]}const u=c?this.profile?.loadDetailedCoverageForTest?.(l.run,o,c,n):this.profile?.loadDetailedCoverage?.(l.run,o,n);return await u??[]}createRun(e){const i=this.dto.id;const n=this.dto.controllerId;const s=Pi();const r=u=>(d,...f)=>{if(a){this.logService.warn(`Setting the state of test "${d.id}" is a no-op after the run ends.`);return}this.ensureTestIsKnown(d);u(d,...f)};const o=(u,d)=>{const f=d instanceof Array?d.map(uu.from):[uu.from(d)];if(u.uri&&u.range){const p={range:V.from(u.range),uri:u.uri};for(const m of f){m.location=m.location||p}}this.proxy.$appendTestMessagesInRun(i,s,Me.fromExtHostTestItem(u,n).toString(),f)};let a=false;const l=this._register(new Tt(this.cts.token));const c={isPersisted:this.dto.isPersisted,token:l.token,name:e,onDidDispose:this.onDidDispose,addCoverage:u=>{if(a){return}const d=u instanceof eu?u.includesTests:[];if(d.length){for(const m of d){this.ensureTestIsKnown(m)}}const f=u.uri.toString();const p=new Me([i,s,f]).toString();this.publishedCoverage.set(p,{report:u,extIds:d.map(m=>Me.fromExtHostTestItem(m,n).toString())});this.proxy.$appendCoverage(i,s,$h.fromFile(n,p,u))},enqueued:r(u=>{this.proxy.$updateTestStateInRun(i,s,Me.fromExtHostTestItem(u,n).toString(),oi.Queued)}),skipped:r(u=>{this.proxy.$updateTestStateInRun(i,s,Me.fromExtHostTestItem(u,n).toString(),oi.Skipped)}),started:r(u=>{this.proxy.$updateTestStateInRun(i,s,Me.fromExtHostTestItem(u,n).toString(),oi.Running)}),errored:r((u,d,f)=>{o(u,d);this.proxy.$updateTestStateInRun(i,s,Me.fromExtHostTestItem(u,n).toString(),oi.Errored,f)}),failed:r((u,d,f)=>{o(u,d);this.proxy.$updateTestStateInRun(i,s,Me.fromExtHostTestItem(u,n).toString(),oi.Failed,f)}),passed:r((u,d)=>{this.proxy.$updateTestStateInRun(i,s,Me.fromExtHostTestItem(u,this.dto.controllerId).toString(),oi.Passed,d)}),appendOutput:(u,d,f)=>{if(a){return}if(f){this.ensureTestIsKnown(f)}this.proxy.$appendOutputToRun(i,s,ae.fromString(u),d&&wn.from(d),f&&Me.fromExtHostTestItem(f,n).toString())},end:()=>{if(a){return}a=true;this.proxy.$finishedTestRunTask(i,s);if(!--this.running){this.markEnded()}}};this.running++;this.tasks.set(s,{run:c,cts:l});this.proxy.$startedTestRunTask(i,{id:s,ctrlId:this.dto.controllerId,name:e||this.extension.displayName||this.extension.identifier.value,running:true});return c}forciblyEndTasks(){for(const{run:e}of this.tasks.values()){e.end()}}markEnded(){if(this.state!==fo.Ended){this.state=fo.Ended;this.endEmitter.fire()}}ensureTestIsKnown(e){if(!(e instanceof kl)){throw new Ag(e.id)}if(this.sharedTestIds.has(Me.fromExtHostTestItem(e,this.dto.controllerId).toString())){return}const i=[];const n=this.dto.colllection.root;while(true){const s=jo.from(e);i.unshift(s);if(this.sharedTestIds.has(s.extId)){break}this.sharedTestIds.add(s.extId);if(e===n){break}e=e.parent||n}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,i)}dispose(){this.markEnded();super.dispose()}}class TU{get trackers(){return this.tracked.values()}constructor(e,i){this.proxy=e;this.logService=i;this.tracked=new Map;this.trackedById=new Map}getCoverageDetails(e,i,n){const s=Me.root(e);return this.trackedById.get(s)?.getCoverageDetails(e,i,n)||[]}disposeTestRun(e){this.trackedById.get(e)?.dispose();this.trackedById.delete(e);for(const[i,{id:n}]of this.tracked){if(n===e){this.tracked.delete(i)}}}prepareForMainThreadTestRun(e,i,n,s,r){return this.getTracker(i,n,s,e,r)}cancelRunById(e,i){this.trackedById.get(e)?.cancel(i)}cancelAllRuns(){for(const e of this.tracked.values()){e.cancel()}}createTestRun(e,i,n,s,r,o){const a=this.tracked.get(s);if(a){return a.createRun(r)}const l=Zh.fromPublic(i,n,s,o);const c=l5(s);this.proxy.$startedExtensionTestRun({controllerId:i,continuous:!!s.continuous,profile:c&&{group:du.from(c.kind),id:c.profileId},exclude:s.exclude?.map(d=>Me.fromExtHostTestItem(d,n.root.id).toString())??[],id:l.id,include:s.include?.map(d=>Me.fromExtHostTestItem(d,n.root.id).toString())??[n.root.id],preserveFocus:s.preserveFocus??true,persist:o});const u=this.getTracker(s,l,s.profile,e);wt.once(u.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(l.id)});return u.createRun(r)}getTracker(e,i,n,s,r){const o=new IU(i,this.proxy,this.logService,n,s,r);this.tracked.set(e,o);this.trackedById.set(o.id,o);return o}}const l5=t=>{if(!t.profile){return void 0}if(!(t.profile instanceof c5)){throw new Error(`TestRunRequest.profile is not an instance created from TestController.createRunProfile`)}return t.profile};class Zh{static fromPublic(e,i,n,s){return new Zh(e,Pi(),s,i)}static fromInternal(e,i){return new Zh(e.controllerId,e.runId,true,i)}constructor(e,i,n,s){this.controllerId=e;this.id=i;this.isPersisted=n;this.colllection=s}}class PU{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e;this.added=new Set;this.updated=new Set;this.removed=new Set;this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,jo.toPlain(e.item));if(!this.added.has(e)){this.updated.add(e)}}remove(e){if(this.added.delete(e)){return}this.updated.delete(e);const i=Me.parentId(e.item.extId);if(i&&this.alreadyRemoved.has(i.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:i,removed:n}=this;return{get added(){return[...e].map(s=>s.revived)},get updated(){return[...i].map(s=>s.revived)},get removed(){return[...n].map(s=>s.revived)}}}complete(){if(!this.isEmpty){this.emitter.fire(this.getChangeEvent())}}}class AU extends qN{constructor(){super(...arguments);this.changeEmitter=new L;this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,i){return{...e,revived:jo.toPlain(e.item),depth:i?i.depth+1:0,children:new Set}}createChangeCollector(){return new PU(this.changeEmitter)}}class RU{constructor(e){this.proxy=e}checkout(){if(!this.current){this.current=this.createObserverData()}const e=this.current;e.observers++;return{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(i=>i.revived)},dispose:MT(()=>{if(--e.observers===0){this.proxy.$unsubscribeFromDiffs();this.current=void 0}})}}getMirroredTestDataByReference(e){return this.current?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.current?.tests.apply(e)}createObserverData(){const e=new AU({asCanonicalUri:i=>i});this.proxy.$subscribeToDiffs();return{observers:0,tests:e}}}const zu=(t,e,i,n)=>{if(i){Object.assign(i,n)}else{e.$updateTestRunConfig(t.controllerId,t.profileId,n)}};class c5 extends oA{#e;#t;#i;#n;#o;get label(){return this._label}set label(e){if(e!==this._label){this._label=e;zu(this,this.#e,this.#n,{label:e})}}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){if(e!==this._supportsContinuousRun){this._supportsContinuousRun=e;zu(this,this.#e,this.#n,{supportsContinuousRun:e})}}get isDefault(){return this.#t.has(this.profileId)}set isDefault(e){if(e!==this.isDefault){if(e){this.#t.add(this.profileId)}else{this.#t.delete(this.profileId)}zu(this,this.#e,this.#n,{isDefault:e})}}get tag(){return this._tag}set tag(e){if(e?.id!==this._tag?.id){this._tag=e;zu(this,this.#e,this.#n,{tag:e?Os.namespace(this.controllerId,e.id):null})}}get configureHandler(){return this._configureHandler}set configureHandler(e){if(e!==this._configureHandler){this._configureHandler=e;zu(this,this.#e,this.#n,{hasConfigurationHandler:!!e})}}get onDidChangeDefault(){return wt.chain(this.#i,e=>e.map(i=>i.get(this.controllerId)?.get(this.profileId)).filter(Un))}constructor(e,i,n,s,r,o,a,l,c,u=false,d=void 0,f=false){super(r,o,l);this._label=a;this.runHandler=c;this._tag=d;this._supportsContinuousRun=f;this.#e=e;this.#o=i;this.#t=n;this.#i=s;i.set(o,this);const p=du.from(l);if(u){n.add(o)}this.#n={profileId:o,controllerId:r,tag:d?Os.namespace(this.controllerId,d.id):null,label:a,group:p,isDefault:u,hasConfigurationHandler:false,supportsContinuousRun:f};queueMicrotask(()=>{if(this.#n){this.#e.$publishTestRunProfile(this.#n);this.#n=void 0}})}dispose(){if(this.#o?.delete(this.profileId)){this.#o=void 0;this.#e.$removeTestProfile(this.controllerId,this.profileId)}this.#n=void 0}}function LU(t,e){for(let i=0;i<t.path.length;i++){const n=e.find(s=>s.id===t.path[i]);if(!n){return void 0}if(i===t.path.length-1){return n}e=n.children}return void 0}var kt;(function(t){t["Unknown"]="unknown";t["Env"]="env";t["Config"]="config";t["Command"]="command";t["Input"]="input";t["ExtensionInstallFolder"]="extensionInstallFolder";t["WorkspaceFolder"]="workspaceFolder";t["Cwd"]="cwd";t["WorkspaceFolderBasename"]="workspaceFolderBasename";t["UserHome"]="userHome";t["LineNumber"]="lineNumber";t["ColumnNumber"]="columnNumber";t["SelectedText"]="selectedText";t["File"]="file";t["FileWorkspaceFolder"]="fileWorkspaceFolder";t["FileWorkspaceFolderBasename"]="fileWorkspaceFolderBasename";t["RelativeFile"]="relativeFile";t["RelativeFileDirname"]="relativeFileDirname";t["FileDirname"]="fileDirname";t["FileExtname"]="fileExtname";t["FileBasename"]="fileBasename";t["FileBasenameNoExtension"]="fileBasenameNoExtension";t["FileDirnameBasename"]="fileDirnameBasename";t["ExecPath"]="execPath";t["ExecInstallFolder"]="execInstallFolder";t["PathSeparator"]="pathSeparator";t["PathSeparatorAlias"]="/"})(kt||(kt={}));const NU=Object.values(kt).filter(t=>typeof t==="string");class an extends lr{constructor(e,i){super(i);this.variable=e}}class ef{static{this.VARIABLE_LHS="${"}constructor(e){this.locations=new Map;this.newReplacementNotifiers=new Set;if(typeof e==="string"){this.stringRoot=true;this.root={value:e}}else{this.stringRoot=false;this.root=structuredClone(e)}}static parse(e){if(e instanceof ef){return e}const i=new ef(e);i.applyPlatformSpecificKeys();i.parseObject(i.root);return i}applyPlatformSpecificKeys(){const e=this.root;const i=nn?"windows":vn?"osx":Fo?"linux":void 0;if(i&&e&&typeof e==="object"&&e.hasOwnProperty(i)){Object.keys(e[i]).forEach(n=>e[n]=e[i][n])}delete e.windows;delete e.osx;delete e.linux}parseVariable(e,i){if(e[i]!=="$"||e[i+1]!=="{"){return void 0}let n=i+2;let s=1;while(n<e.length){if(e[n]==="{"){s++}else if(e[n]==="}"){s--;if(s===0){break}}n++}if(s!==0){return void 0}const r=e.slice(i,n+1);const o=e.substring(i+2,n);const a=o.indexOf(":");if(a===-1){return{replacement:{id:r,name:o,inner:o},end:n}}return{replacement:{id:r,inner:o,name:o.slice(0,a),arg:o.slice(a+1)},end:n}}parseObject(e){if(typeof e!=="object"||e===null){return}if(Array.isArray(e)){for(let i=0;i<e.length;i++){const n=e[i];if(typeof n==="string"){this.parseString(e,i,n)}else{this.parseObject(n)}}return}for(const[i,n]of Object.entries(e)){this.parseString(e,i,i,true);if(typeof n==="string"){this.parseString(e,i,n)}else{this.parseObject(n)}}}parseString(e,i,n,s,r){let o=0;while(o<n.length){const a=n.indexOf("${",o);if(a===-1){break}const l=this.parseVariable(n,a);if(l){o=l.end+1;if(r?.includes(l.replacement.id)){continue}const c=this.locations.get(l.replacement.id)||{locations:[],replacement:l.replacement};const u={object:e,propertyName:i,replaceKeyName:s};c.locations.push(u);this.locations.set(l.replacement.id,c);if(c.resolved){this._resolveAtLocation(l.replacement,u,c.resolved,r)}else{this.newReplacementNotifiers.forEach(d=>d(l.replacement))}}else{o=a+2}}}*unresolved(){const e=new Map;const i=n=>{e.set(n.id,n)};for(const n of this.locations.values()){if(n.resolved===void 0){e.set(n.replacement.id,n.replacement)}}this.newReplacementNotifiers.add(i);while(true){const n=qi.first(e);if(!n){break}const[s,r]=n;yield r;e.delete(s)}this.newReplacementNotifiers.delete(i)}resolved(){return qi.map(qi.filter(this.locations.values(),e=>!!e.resolved),e=>[e.replacement,e.resolved])}resolve(e,i){if(typeof i!=="object"){i={value:String(i)}}const n=this.locations.get(e.id);if(!n){return}n.resolved=i;if(i.value!==void 0){for(const s of n.locations||qi.empty()){this._resolveAtLocation(e,s,i)}}}_resolveAtLocation(e,{replaceKeyName:i,propertyName:n,object:s},r,o=[]){if(r.value===void 0){return}o.push(e.id);if(i&&typeof n==="string"){const a=s[n];const l=n.replaceAll(e.id,r.value);delete s[n];s[l]=a;this._renameKeyInLocations(s,n,l);this.parseString(s,l,r.value,true,o)}else{s[n]=s[n].replaceAll(e.id,r.value);this.parseString(s,n,r.value,false,o)}o.pop()}_renameKeyInLocations(e,i,n){for(const s of this.locations.values()){for(const r of s.locations){if(r.object===e&&r.propertyName===i){r.propertyName=n}}}}toObject(){if(this.stringRoot){return this.root.value}return this.root}}class MU{constructor(e,i,n,s){this._contributedVariables=new Map;this.resolvableVariables=new Set(NU);this._context=e;this._labelService=i;this._userHomePromise=n;if(s){this._envVariablesPromise=s.then(r=>{return this.prepareEnv(r)})}}prepareEnv(e){if(nn){const i=Object.create(null);Object.keys(e).forEach(n=>{i[n.toLowerCase()]=e[n]});return i}return e}async resolveWithEnvironment(e,i,n){const s=ef.parse(n);for(const r of s.unresolved()){const o=await this.evaluateSingleVariable(r,i?.uri,e);if(o!==void 0){s.resolve(r,String(o))}}return s.toObject()}async resolveAsync(e,i){const n=ef.parse(i);for(const s of n.unresolved()){const r=await this.evaluateSingleVariable(s,e?.uri);if(r!==void 0){n.resolve(s,String(r))}}return n.toObject()}resolveWithInteractionReplace(e,i){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,i){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,i){if(this._contributedVariables.has(e)){throw new Error("Variable "+e+" is contributed twice.")}else{this.resolvableVariables.add(e);this._contributedVariables.set(e,i)}}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:true}):e.fsPath}async evaluateSingleVariable(e,i,n,s){const r={env:n!==void 0?this.prepareEnv(n):await this._envVariablesPromise,userHome:n!==void 0?void 0:await this._userHomePromise};const{name:o,arg:a}=e;const l=d=>{const f=this._context.getFilePath();if(f){return Hu(f)}throw new an(d,h(14401,"Variable {0} can not be resolved. Please open an editor.",e.id))};const c=d=>{const f=l(d);if(this._context.getWorkspaceFolderPathForFile){const p=this._context.getWorkspaceFolderPathForFile();if(p){return Hu(p)}}throw new an(d,h(14402,"Variable {0}: can not find workspace folder of '{1}'.",e.id,kn(f)))};const u=d=>{if(a){const f=this._context.getFolderUri(a);if(f){return f}throw new an(d,h(14403,"Variable {0} can not be resolved. No such folder '{1}'.",d,a))}if(i){return i}if(this._context.getWorkspaceFolderCount()>1){throw new an(d,h(14404,"Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",d))}throw new an(d,h(14405,"Variable {0} can not be resolved. Please open a folder.",d))};switch(o){case"env":if(a){if(r.env){const d=r.env[nn?a.toLowerCase():a];if(Xe(d)){return d}}return""}throw new an(kt.Env,h(14406,"Variable {0} can not be resolved because no environment variable name is given.",e.id));case"config":if(a){const d=this._context.getConfigurationValue(i,a);if(ai(d)){throw new an(kt.Config,h(14407,"Variable {0} can not be resolved because setting '{1}' not found.",e.id,a))}if(Gt(d)){throw new an(kt.Config,h(14408,"Variable {0} can not be resolved because '{1}' is a structured value.",e.id,a))}return d}throw new an(kt.Config,h(14409,"Variable {0} can not be resolved because no settings name is given.",e.id));case"command":return this.resolveFromMap(kt.Command,e.id,a,s,"command");case"input":return this.resolveFromMap(kt.Input,e.id,a,s,"input");case"extensionInstallFolder":if(a){const d=await this._context.getExtension(a);if(!d){throw new an(kt.ExtensionInstallFolder,h(14410,"Variable {0} can not be resolved because the extension {1} is not installed.",e.id,a))}return this.fsPath(d.extensionLocation)}throw new an(kt.ExtensionInstallFolder,h(14411,"Variable {0} can not be resolved because no extension name is given.",e.id));default:{switch(o){case"workspaceRoot":case"workspaceFolder":{const d=u(kt.WorkspaceFolder);return d?Hu(this.fsPath(d)):void 0}case"cwd":{if(!i&&!a){return Nc()}const d=u(kt.Cwd);return d?Hu(this.fsPath(d)):void 0}case"workspaceRootFolderName":case"workspaceFolderBasename":{const d=u(kt.WorkspaceFolderBasename);return d?Hu(kn(this.fsPath(d))):void 0}case"userHome":if(r.userHome){return r.userHome}throw new an(kt.UserHome,h(14412,"Variable {0} can not be resolved. UserHome path is not defined",e.id));case"lineNumber":{const d=this._context.getLineNumber();if(d){return d}throw new an(kt.LineNumber,h(14413,"Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",e.id))}case"columnNumber":{const d=this._context.getColumnNumber();if(d){return d}throw new Error(h(14414,"Variable {0} can not be resolved. Make sure to have a column selected in the active editor.",e.id))}case"selectedText":{const d=this._context.getSelectedText();if(d){return d}throw new an(kt.SelectedText,h(14415,"Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",e.id))}case"file":return l(kt.File);case"fileWorkspaceFolder":return c(kt.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return kn(c(kt.FileWorkspaceFolderBasename));case"relativeFile":if(i||a){return Gd(this.fsPath(u(kt.RelativeFile)),l(kt.RelativeFile))}return l(kt.RelativeFile);case"relativeFileDirname":{const d=lc(l(kt.RelativeFileDirname));if(i||a){const f=Gd(this.fsPath(u(kt.RelativeFileDirname)),d);return f.length===0?".":f}return d}case"fileDirname":return lc(l(kt.FileDirname));case"fileExtname":return Up(l(kt.FileExtname));case"fileBasename":return kn(l(kt.FileBasename));case"fileBasenameNoExtension":{const d=kn(l(kt.FileBasenameNoExtension));return d.slice(0,d.length-Up(d).length)}case"fileDirnameBasename":return kn(lc(l(kt.FileDirnameBasename)));case"execPath":{const d=this._context.getExecPath();if(d){return d}return e.id}case"execInstallFolder":{const d=this._context.getAppRoot();if(d){return d}return e.id}case"pathSeparator":case"/":return Yn;default:{try{return this.resolveFromMap(kt.Unknown,e.id,a,s,void 0)}catch{return e.id}}}}}}resolveFromMap(e,i,n,s,r){if(n&&s){const o=r===void 0?s[n]:s[r+":"+n];if(typeof o==="string"){return o}throw new an(e,h(14416,"Variable {0} can not be resolved because the command has no value.",i))}return i}}const av=te("IExtHostVariableResolverProvider");class OU extends MU{constructor(e,i,n,s,r,o,a){function l(){if(n){const c=n.activeEditor();if(c){return c.document.uri}const u=s.tabGroups.all.find(d=>d.isActive)?.activeTab;if(u!==void 0){if(u.input instanceof fm||u.input instanceof lx){return u.input.modified}else if(u.input instanceof rx||u.input instanceof ax||u.input instanceof ox){return u.input.uri}}}return void 0}super({getFolderUri:c=>{const u=o.folders.filter(d=>d.name===c);if(u&&u.length>0){return u[0].uri}return void 0},getWorkspaceFolderCount:()=>{return o.folders.length},getConfigurationValue:(c,u)=>{return r.getConfiguration(void 0,c).get(u)},getAppRoot:()=>{return Nc()},getExecPath:()=>{return jd["VSCODE_EXEC_PATH"]},getFilePath:()=>{const c=l();if(c){return Mc(c.fsPath)}return void 0},getWorkspaceFolderPathForFile:()=>{if(i){const c=l();if(c){const u=i.getWorkspaceFolder(c);if(u){return Mc(u.uri.fsPath)}}}return void 0},getSelectedText:()=>{if(n){const c=n.activeEditor();if(c&&!c.selection.isEmpty){return c.document.getText(c.selection)}}return void 0},getLineNumber:()=>{if(n){const c=n.activeEditor();if(c){return String(c.selection.end.line+1)}}return void 0},getColumnNumber:()=>{if(n){const c=n.activeEditor();if(c){return String(c.selection.end.character+1)}}return void 0},getExtension:c=>{return e.getExtension(c)}},void 0,a?Promise.resolve(a):void 0,Promise.resolve(jd))}}let I0=class lq extends me{constructor(e,i,n,s,r){super();this.extensionService=e;this.workspaceService=i;this.editorService=n;this.configurationService=s;this.editorTabs=r;this._resolver=new $i(async()=>{const o=await this.configurationService.getConfigProvider();const a=await this.workspaceService.getWorkspaceFolders2()||[];const l={folders:a};this._register(this.workspaceService.onDidChangeWorkspace(async c=>{l.folders=await this.workspaceService.getWorkspaceFolders2()||[]}));return new OU(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,o,l,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){return void 0}};I0=W([P(0,ea),P(1,ur),P(2,Iu),P(3,jr),P(4,wf)],I0);const u5=te("IExtHostDebugService");let T0=class cq extends me{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){return this._activeDebugSession?.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,i,n,s,r,o,a,l){super();this._workspaceService=i;this._extensionService=n;this._configurationService=s;this._editorTabs=r;this._variableResolver=o;this._commands=a;this._testing=l;this._debugSessions=new Map;this._debugVisualizationTreeItemIdsCounter=0;this._debugVisualizationProviders=new Map;this._debugVisualizationTrees=new Map;this._debugVisualizationTreeItemIds=new WeakMap;this._debugVisualizationElements=new Map;this._visualizers=new Map;this._visualizerIdCounter=0;this._configProviderHandleCounter=0;this._configProviders=[];this._adapterFactoryHandleCounter=0;this._adapterFactories=[];this._trackerFactoryHandleCounter=0;this._trackerFactories=[];this._debugAdapters=new Map;this._debugAdaptersTrackers=new Map;this._onDidStartDebugSession=this._register(new L);this._onDidTerminateDebugSession=this._register(new L);this._onDidChangeActiveDebugSession=this._register(new L);this._onDidReceiveDebugSessionCustomEvent=this._register(new L);this._debugServiceProxy=e.getProxy(ee.MainThreadDebugService);this._onDidChangeBreakpoints=this._register(new L);this._onDidChangeActiveStackItem=this._register(new L);this._activeDebugConsole=new UU(this._debugServiceProxy);this._breakpoints=new Map;this._extensionService.getExtensionRegistry().then(c=>{this._register(c.onDidChange(u=>{this.registerAllDebugTypes(c)}));this.registerAllDebugTypes(c)});this._telemetryProxy=e.getProxy(ee.MainThreadTelemetry)}async $getVisualizerTreeItem(e,i){const n=this.hydrateVisualizationContext(i);if(!n){return void 0}const s=await this._debugVisualizationTrees.get(e)?.getTreeItem?.(n);return s?this.convertVisualizerTreeItem(e,s):void 0}registerDebugVisualizationTree(e,i,n){const s=ht.toKey(e.identifier);const r=this.extensionVisKey(s,i);if(this._debugVisualizationProviders.has(r)){throw new Error(`A debug visualization provider with id '${i}' is already registered`)}this._debugVisualizationTrees.set(r,n);this._debugServiceProxy.$registerDebugVisualizerTree(r,!!n.editItem);return ye(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(r);this._debugVisualizationTrees.delete(i)})}async $getVisualizerTreeItemChildren(e,i){const n=this._debugVisualizationElements.get(i)?.item;if(!n){return[]}const s=await this._debugVisualizationTrees.get(e)?.getChildren?.(n);return s?.map(r=>this.convertVisualizerTreeItem(e,r))||[]}async $editVisualizerTreeItem(e,i){const n=this._debugVisualizationElements.get(e);if(!n){return void 0}const s=await this._debugVisualizationTrees.get(n.provider)?.editItem?.(n.item,i);return this.convertVisualizerTreeItem(n.provider,s||n.item)}$disposeVisualizedTree(e){const i=this._debugVisualizationElements.get(e);if(!i){return}const n=[i.children];for(const s of n){if(s){for(const r of s){n.push(this._debugVisualizationElements.get(r)?.children);this._debugVisualizationElements.delete(r)}}}}convertVisualizerTreeItem(e,i){let n=this._debugVisualizationTreeItemIds.get(i);if(!n){n=this._debugVisualizationTreeItemIdsCounter++;this._debugVisualizationTreeItemIds.set(i,n);this._debugVisualizationElements.set(n,{provider:e,item:i})}return yy.from(i,n)}asDebugSourceUri(e,i){const n=e;if(typeof n.sourceReference==="number"&&n.sourceReference>0){let s=`debug:${encodeURIComponent(n.path||"")}`;let r="?";if(i){s+=`${r}session=${encodeURIComponent(i.id)}`;r="&"}s+=`${r}ref=${n.sourceReference}`;return b.parse(s)}else if(n.path){return b.file(n.path)}else{throw new Error(`cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.`)}}registerAllDebugTypes(e){const i=[];for(const n of e.getAllExtensionDescriptions()){if(n.contributes){const s=n.contributes["debuggers"];if(s&&s.length>0){for(const r of s){if(_U(r)){i.push(r.type)}}}}}this._debugServiceProxy.$registerDebugTypes(i)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];this._breakpoints.forEach(i=>e.push(i));return e}async $resolveDebugVisualizer(e,i){const n=this._visualizers.get(e);if(!n){throw new Error(`No debug visualizer found with id '${e}'`)}let{v:s,provider:r,extensionId:o}=n;if(!s.visualization){s=await r.resolveDebugVisualization?.(s,i)||s;n.v=s}if(!s.visualization){throw new Error(`No visualization returned from resolveDebugVisualization in '${r}'`)}return this.serializeVisualization(o,s.visualization)}async $executeDebugVisualizerCommand(e){const i=this._visualizers.get(e);if(!i){throw new Error(`No debug visualizer found with id '${e}'`)}const n=i.v.visualization;if(n&&"command"in n){this._commands.executeCommand(n.command,...n.arguments||[])}}hydrateVisualizationContext(e){const i=this._debugSessions.get(e.sessionId);return i&&{session:i.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,i,n,s){const r=this.hydrateVisualizationContext(n);const o=this.extensionVisKey(e,i);const a=this._debugVisualizationProviders.get(o);if(!r||!a){return[]}const l=await a.provideDebugVisualization(r,s);if(!l){return[]}return l.map(c=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:c,provider:a,extensionId:e});const d=c.iconPath?this.getIconPathOrClass(c.iconPath):void 0;return{id:u,name:c.name,iconClass:d?.iconClass,iconPath:d?.iconPath,visualization:this.serializeVisualization(e,c.visualization)}})}$disposeDebugVisualizers(e){for(const i of e){this._visualizers.delete(i)}}registerDebugVisualizationProvider(e,i,n){if(!e.contributes?.debugVisualizers?.some(o=>o.id===i)){throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${i})`)}const s=ht.toKey(e.identifier);const r=this.extensionVisKey(s,i);if(this._debugVisualizationProviders.has(r)){throw new Error(`A debug visualization provider with id '${i}' is already registered`)}this._debugVisualizationProviders.set(r,n);this._debugServiceProxy.$registerDebugVisualizer(s,i);return ye(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(s,i);this._debugVisualizationProviders.delete(i)})}addBreakpoints(e){const i=e.filter(r=>{const o=r.id;if(!this._breakpoints.has(o)){this._breakpoints.set(o,r);return true}return false});this.fireBreakpointChanges(i,[],[]);const n=[];const s=new Map;for(const r of i){if(r instanceof Ma){let o=s.get(r.location.uri.toString());if(!o){o={type:"sourceMulti",uri:r.location.uri,lines:[]};s.set(r.location.uri.toString(),o);n.push(o)}o.lines.push({id:r.id,enabled:r.enabled,condition:r.condition,hitCondition:r.hitCondition,logMessage:r.logMessage,line:r.location.range.start.line,character:r.location.range.start.character,mode:r.mode})}else if(r instanceof Oa){n.push({type:"function",id:r.id,enabled:r.enabled,hitCondition:r.hitCondition,logMessage:r.logMessage,condition:r.condition,functionName:r.functionName,mode:r.mode})}}return this._debugServiceProxy.$registerBreakpoints(n)}removeBreakpoints(e){const i=e.filter(o=>this._breakpoints.delete(o.id));this.fireBreakpointChanges([],i,[]);const n=i.filter(o=>o instanceof Ma).map(o=>o.id);const s=i.filter(o=>o instanceof Oa).map(o=>o.id);const r=i.filter(o=>o instanceof Xg).map(o=>o.id);return this._debugServiceProxy.$unregisterBreakpoints(n,s,r)}startDebugging(e,i,n){const s=n.testRun&&this._testing.getMetadataForRun(n.testRun);return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,i,{parentSessionID:n.parentSession?n.parentSession.id:void 0,lifecycleManagedByParent:n.lifecycleManagedByParent,repl:n.consoleMode===rm.MergeWithParent?"mergeWithParent":"separate",noDebug:n.noDebug,compact:n.compact,suppressSaveBeforeStart:n.suppressSaveBeforeStart,testRun:s&&{runId:s.runId,taskId:s.taskId},suppressDebugStatusbar:n.suppressDebugStatusbar??n.debugUI?.simple,suppressDebugToolbar:n.suppressDebugToolbar??n.debugUI?.simple,suppressDebugView:n.suppressDebugView??n.debugUI?.simple})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,i,n){if(!i){return new Ve(()=>{})}const s=this._configProviderHandleCounter++;this._configProviders.push({type:e,handle:s,provider:i});this._debugServiceProxy.$registerDebugConfigurationProvider(e,n,!!i.provideDebugConfigurations,!!i.resolveDebugConfiguration,!!i.resolveDebugConfigurationWithSubstitutedVariables,s);return new Ve(()=>{this._configProviders=this._configProviders.filter(r=>r.provider!==i);this._debugServiceProxy.$unregisterDebugConfigurationProvider(s)})}registerDebugAdapterDescriptorFactory(e,i,n){if(!n){return new Ve(()=>{})}if(!this.definesDebugType(e,i)){throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${i}' debugger.`)}if(this.getAdapterDescriptorFactoryByType(i)){throw new Error(`a DebugAdapterDescriptorFactory can only be registered once per a type.`)}const s=this._adapterFactoryHandleCounter++;this._adapterFactories.push({type:i,handle:s,factory:n});this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(i,s);return new Ve(()=>{this._adapterFactories=this._adapterFactories.filter(r=>r.factory!==n);this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(s)})}registerDebugAdapterTrackerFactory(e,i){if(!i){return new Ve(()=>{})}const n=this._trackerFactoryHandleCounter++;this._trackerFactories.push({type:e,handle:n,factory:i});return new Ve(()=>{this._trackerFactories=this._trackerFactories.filter(s=>s.factory!==i)})}async $runInTerminal(e,i){return Promise.resolve(void 0)}async $substituteVariables(e,i){let n;const s=await this.getFolder(e);if(s){n={uri:s.uri,name:s.name,index:s.index}}const r=await this._variableResolver.getResolver();return r.resolveAsync(n,i)}createDebugAdapter(e,i){if(e instanceof _h){return new HU(e.implementation)}return void 0}createSignService(){return void 0}async $startDASession(e,i){const n=this;const s=await this.getSession(i);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(s.type),s).then(r=>{if(!r){throw new Error(`Couldn't find a debug adapter descriptor for debug type '${s.type}' (extension might have failed to activate)`)}const o=this.createDebugAdapter(r,s);if(!o){throw new Error(`Couldn't create a debug adapter for type '${s.type}'.`)}const a=o;this._debugAdapters.set(e,a);return this.getDebugAdapterTrackers(s).then(l=>{if(l){this._debugAdaptersTrackers.set(e,l)}a.onMessage(async c=>{if(c.type==="request"&&c.command==="handshake"){const u=c;const d={type:"response",seq:0,command:u.command,request_seq:u.seq,success:true};if(!this._signService){this._signService=this.createSignService()}try{if(this._signService){const f=await this._signService.sign(u.arguments.value);d.body={signature:f};a.sendResponse(d)}else{throw new Error("no signer")}}catch(f){d.success=false;d.message=f.message;a.sendResponse(d)}}else{if(l&&l.onDidSendMessage){l.onDidSendMessage(c)}try{c=xU(c,true)}catch(u){const d=c.type+"_"+(c.command??c.event??"");this._telemetryProxy.$publicLog2("debugProtocolMessageError",{type:d,from:s.type});throw u}n._debugServiceProxy.$acceptDAMessage(e,c)}});a.onError(c=>{if(l&&l.onError){l.onError(c)}this._debugServiceProxy.$acceptDAError(e,c.name,c.message,c.stack)});a.onExit(c=>{if(l&&l.onExit){l.onExit(c??void 0,void 0)}this._debugServiceProxy.$acceptDAExit(e,c??void 0,void 0)});if(l&&l.onWillStartSession){l.onWillStartSession()}return a.startSession()})})}$sendDAMessage(e,i){i=SU(i);const n=this._debugAdaptersTrackers.get(e);if(n&&n.onWillReceiveMessage){n.onWillReceiveMessage(i)}const s=this._debugAdapters.get(e);s?.sendMessage(i)}$stopDASession(e){const i=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e);if(i&&i.onWillStopSession){i.onWillStopSession()}const n=this._debugAdapters.get(e);this._debugAdapters.delete(e);if(n){return n.stopSession()}else{return Promise.resolve(void 0)}}$acceptBreakpointsDelta(e){const i=[];const n=[];const s=[];if(e.added){for(const r of e.added){const o=r.id;if(o&&!this._breakpoints.has(o)){let a;if(r.type==="function"){a=new Oa(r.functionName,r.enabled,r.condition,r.hitCondition,r.logMessage,r.mode)}else if(r.type==="data"){a=new Xg(r.label,r.dataId,r.canPersist,r.enabled,r.hitCondition,r.condition,r.logMessage,r.mode)}else{const l=b.revive(r.uri);a=new Ma(new Tn(l,new je(r.line,r.character)),r.enabled,r.condition,r.hitCondition,r.logMessage,r.mode)}EM(a,o);this._breakpoints.set(o,a);i.push(a)}}}if(e.removed){for(const r of e.removed){const o=this._breakpoints.get(r);if(o){this._breakpoints.delete(r);n.push(o)}}}if(e.changed){for(const r of e.changed){if(r.id){const o=this._breakpoints.get(r.id);if(o){if(o instanceof Oa&&r.type==="function"){const a=o;a.enabled=r.enabled;a.condition=r.condition;a.hitCondition=r.hitCondition;a.logMessage=r.logMessage;a.functionName=r.functionName}else if(o instanceof Ma&&r.type==="source"){const a=o;a.enabled=r.enabled;a.condition=r.condition;a.hitCondition=r.hitCondition;a.logMessage=r.logMessage;a.location=new Tn(b.revive(r.uri),new je(r.line,r.character))}s.push(o)}}}}this.fireBreakpointChanges(i,n,s)}async $acceptStackFrameFocus(e){let i;if(e){const n=await this.getSession(e.sessionId);if(e.kind==="thread"){i=new nA(n.api,e.threadId)}else{i=new iA(n.api,e.threadId,e.frameId)}}this._activeStackItem=i;this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(e,i,n){return Hi(async()=>{const s=this.getConfigProviderByHandle(e);if(!s){throw new Error("no DebugConfigurationProvider found")}if(!s.provideDebugConfigurations){throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations")}const r=await this.getFolder(i);return s.provideDebugConfigurations(r,n)}).then(s=>{if(!s){throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations")}return s})}$resolveDebugConfiguration(e,i,n,s){return Hi(async()=>{const r=this.getConfigProviderByHandle(e);if(!r){throw new Error("no DebugConfigurationProvider found")}if(!r.resolveDebugConfiguration){throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration")}const o=await this.getFolder(i);return r.resolveDebugConfiguration(o,n,s)})}$resolveDebugConfigurationWithSubstitutedVariables(e,i,n,s){return Hi(async()=>{const r=this.getConfigProviderByHandle(e);if(!r){throw new Error("no DebugConfigurationProvider found")}if(!r.resolveDebugConfigurationWithSubstitutedVariables){throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables")}const o=await this.getFolder(i);return r.resolveDebugConfigurationWithSubstitutedVariables(o,n,s)})}async $provideDebugAdapter(e,i){const n=this.getAdapterDescriptorFactoryByHandle(e);if(!n){return Promise.reject(new Error("no adapter descriptor factory found for handle"))}const s=await this.getSession(i);return this.getAdapterDescriptor(n,s).then(r=>{if(!r){throw new Error(`Couldn't find a debug adapter descriptor for debug type '${s.type}'`)}return this.convertToDto(r)})}async $acceptDebugSessionStarted(e){const i=await this.getSession(e);this._onDidStartDebugSession.fire(i.api)}async $acceptDebugSessionTerminated(e){const i=await this.getSession(e);if(i){this._onDidTerminateDebugSession.fire(i.api);this._debugSessions.delete(i.id)}}async $acceptDebugSessionActiveChanged(e){this._activeDebugSession=e?await this.getSession(e):void 0;this._onDidChangeActiveDebugSession.fire(this._activeDebugSession?.api)}async $acceptDebugSessionNameChanged(e,i){const n=await this.getSession(e);n?._acceptNameChanged(i)}async $acceptDebugSessionCustomEvent(e,i){const n=await this.getSession(e);const s={session:n.api,event:i.event,body:i.body};this._onDidReceiveDebugSessionCustomEvent.fire(s)}convertToDto(e){if(e instanceof Zg){return this.convertExecutableToDto(e)}else if(e instanceof mh){return this.convertServerToDto(e)}else if(e instanceof em){return this.convertPipeServerToDto(e)}else if(e instanceof _h){return this.convertImplementationToDto(e)}else{throw new Error("convertToDto unexpected type")}}convertExecutableToDto(e){return{type:"executable",command:e.command,args:e.args,options:e.options}}convertServerToDto(e){return{type:"server",port:e.port,host:e.host}}convertPipeServerToDto(e){return{type:"pipeServer",path:e.path}}convertImplementationToDto(e){return{type:"implementation"}}getAdapterDescriptorFactoryByType(e){const i=this._adapterFactories.filter(n=>n.type===e);if(i.length>0){return i[0].factory}return void 0}getAdapterDescriptorFactoryByHandle(e){const i=this._adapterFactories.filter(n=>n.handle===e);if(i.length>0){return i[0].factory}return void 0}getConfigProviderByHandle(e){const i=this._configProviders.filter(n=>n.handle===e);if(i.length>0){return i[0].provider}return void 0}definesDebugType(e,i){if(e.contributes){const n=e.contributes["debuggers"];if(n&&n.length>0){for(const s of n){if(s.label&&s.type){if(s.type===i){return true}}}}}return false}getDebugAdapterTrackers(e){const i=e.configuration;const n=i.type;const s=this._trackerFactories.filter(r=>r.type===n||r.type==="*").map(r=>Hi(()=>r.factory.createDebugAdapterTracker(e.api)).then(o=>o,o=>null));return Promise.race([Promise.all(s).then(r=>{const o=zt(r);if(o.length>0){return new $U(o)}return void 0}),new Promise(r=>setTimeout(()=>r(void 0),1e3))]).catch(r=>{return void 0})}async getAdapterDescriptor(e,i){const n=i.configuration.debugServer;if(typeof n==="number"){return Promise.resolve(new mh(n))}if(e){const r=await this._extensionService.getExtensionRegistry();return Hi(()=>e.createDebugAdapterDescriptor(i.api,this.daExecutableFromPackage(i,r))).then(o=>{if(o){return o}return void 0})}const s=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(i,s))}daExecutableFromPackage(e,i){return void 0}fireBreakpointChanges(e,i,n){if(e.length>0||i.length>0||n.length>0){this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:i,changed:n}))}}async getSession(e){if(e){if(typeof e==="string"){const i=this._debugSessions.get(e);if(i){return i}}else{let i=this._debugSessions.get(e.id);if(!i){const n=await this.getFolder(e.folderUri);const s=e.parent?this._debugSessions.get(e.parent):void 0;i=new FU(this._debugServiceProxy,e.id,e.type,e.name,n,e.configuration,s?.api);this._debugSessions.set(i.id,i);this._debugServiceProxy.$sessionCached(i.id)}return i}}throw new Error("cannot find session")}getFolder(e){if(e){const i=b.revive(e);return this._workspaceService.resolveWorkspaceFolder(i)}return Promise.resolve(void 0)}extensionVisKey(e,i){return`${e}\0${i}`}serializeVisualization(e,i){if(!i){return void 0}if("title"in i&&"command"in i){return{type:_g.Command}}if("treeId"in i){return{type:_g.Tree,id:`${e}\0${i.treeId}`}}throw new Error("Unsupported debug visualization type")}getIconPathOrClass(e){const i=this.getIconUris(e);let n;let s;if("id"in i){s=Kt.asClassName(i)}else{n=i}return{iconPath:n,iconClass:s}}getIconUris(e){if(e instanceof _n){return{id:e.id}}const i=typeof e==="object"&&"dark"in e?e.dark:e;const n=typeof e==="object"&&"light"in e?e.light:e;return{dark:typeof i==="string"?b.file(i):i,light:typeof n==="string"?b.file(n):n}}};T0=W([P(0,st),P(1,ur),P(2,ea),P(3,jr),P(4,wf),P(5,av),P(6,Zo),P(7,ov)],T0);class FU{constructor(e,i,n,s,r,o,a){this._debugServiceProxy=e;this._id=i;this._type=n;this._name=s;this._workspaceFolder=r;this._configuration=o;this._parentSession=a}get api(){const e=this;return this.apiSession??=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(i){e._name=i;e._debugServiceProxy.$setDebugSessionName(e._id,i)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(i,n){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,i,n)},getDebugProtocolBreakpoint(i){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,i.id)}})}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class UU{constructor(e){this.value=Object.freeze({append(i){e.$appendDebugConsole(i)},appendLine(i){this.append(i+"\n")}})}}class $U{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(i=>i.onWillReceiveMessage?i.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(i=>i.onDidSendMessage?i.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(i=>i.onError?i.onError(e):void 0)}onExit(e,i){this.trackers.forEach(n=>n.onExit?n.onExit(e,i):void 0)}}class HU extends mU{constructor(e){super();this.implementation=e;e.onDidSendMessage(i=>{this.acceptMessage(i)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){this.implementation.dispose();return Promise.resolve(void 0)}}let P0=class uq extends T0{constructor(e,i,n,s,r,o,a,l){super(e,i,n,s,r,o,a,l)}};P0=W([P(0,st),P(1,ur),P(2,ea),P(3,jr),P(4,wf),P(5,av),P(6,Zo),P(7,ov)],P0);function BU(t){return"uri"in t&&"ranges"in t&&"preview"in t}function WU(t){return t.folderOptions.map(e=>({folder:e.folder,excludes:e.excludes.map(i=>typeof i==="string"?i:i.pattern),includes:e.includes,useGlobalIgnoreFiles:e.useIgnoreFiles.global,useIgnoreFiles:e.useIgnoreFiles.local,useParentIgnoreFiles:e.useIgnoreFiles.parent,followSymlinks:e.followSymlinks,maxResults:t.maxResults,session:t.session}))}class d5{constructor(e){this.provider=e}provideFileSearchResults(e,i,n){const s=async()=>{const r=WU(i);return Promise.all(r.map(o=>this.provider.provideFileSearchResults({pattern:e},o,n)))};return s().then(r=>zt(r).flat())}}function VU(t){return t.folderOptions.map(e=>({folder:e.folder,excludes:e.excludes.map(i=>typeof i==="string"?i:i.pattern),includes:e.includes,useGlobalIgnoreFiles:e.useIgnoreFiles.global,useIgnoreFiles:e.useIgnoreFiles.local,useParentIgnoreFiles:e.useIgnoreFiles.parent,followSymlinks:e.followSymlinks,maxResults:t.maxResults,previewOptions:zU(t.previewOptions),maxFileSize:t.maxFileSize,encoding:e.encoding,afterContext:t.surroundingContext,beforeContext:t.surroundingContext}))}function zU(t){return{matchLines:t?.matchLines??Iy.matchLines,charsPerLine:t?.charsPerLine??Iy.charsPerLine}}function qU(t){if(BU(t)){const e=Zn(t.ranges).map((i,n)=>{const s=Zn(t.preview.matches);const r=s[n];return{sourceRange:i,previewRange:r}});return new Do(t.uri,e,t.preview.text)}else{return new mx(t.uri,t.text,t.lineNumber)}}class jU{constructor(e){this.provider=e}provideTextSearchResults(e,i,n,s){const r=l=>{if(!GU(l)){return}n.report(qU(l))};const o=async()=>{return zt(await Promise.all(VU(i).map(l=>this.provider.provideTextSearchResults(e,l,{report:c=>r(c)},s)))).reduce((l,c)=>({limitHit:l.limitHit||c.limitHit}),{limitHit:false})};const a=o();return a.then(l=>{return{limitHit:l.limitHit,message:zt(Zn(l.message))}})}}function GU(t){if(KU(t)){if(Array.isArray(t.ranges)){if(!Array.isArray(t.preview.matches)){console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type.");return false}if(t.preview.matches.length!==t.ranges.length){console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length.");return false}}else{if(Array.isArray(t.preview.matches)){console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length.");return false}}}return true}function KU(t){return!!t.preview}class h5 extends Xs{constructor(e,i,n=()=>false){const s=new P4(n,()=>false);super(s);const r=new It;e.forEach((o,a)=>{const l=o.folder.with({query:"",fragment:""});if(r.has(l)){r.get(l).push({fq:o,i:a})}else{r.set(l,[{fq:o,i:a}])}});r.forEach((o,a)=>{const l=new Map;for(const c of o){const u=i(c.fq,c.i);l.set(this.encodeKey(c.fq.folder),u)}super.set(a,l)})}findQueryFragmentAwareSubstr(e){const i=super.findSubstr(e.with({query:"",fragment:""}));if(!i){return void 0}const n=this.encodeKey(e);return i.get(n)}forEachFolderQueryInfo(e){return this.forEach(i=>i.forEach(n=>e(n)))}encodeKey(e){let i="";if(e.query){i+=e.query}if(e.fragment){i+="#"+e.fragment}return i}}class QU{constructor(e,i,n){this.config=e;this.provider=i;this.sessionLifecycle=n;this.isLimitHit=false;this.resultCount=0;this.isCanceled=false;this.filePattern=e.filePattern;const s=e.ignoreGlobCase?{ignoreCase:true}:void 0;this.includePattern=e.includePattern&&zc(e.includePattern,s);this.maxResults=e.maxResults||void 0;this.exists=e.exists;this.activeCancellationTokens=new Set;this.globalExcludePattern=e.excludePattern&&zc(e.excludePattern,s)}cancel(){this.isCanceled=true;this.activeCancellationTokens.forEach(e=>e.cancel());this.activeCancellationTokens=new Set}search(e){const i=this.config.folderQueries||[];return new Promise((n,s)=>{const r=o=>{this.resultCount++;e(o)};if(this.isCanceled){return n({limitHit:this.isLimitHit})}if(this.config.extraFileResources){this.config.extraFileResources.forEach(o=>{const a=o.toString();const l=kn(a);if(this.globalExcludePattern&&this.globalExcludePattern(a,l)){return}this.matchFile(r,{base:o,basename:l})})}this.doSearch(i,r).then(o=>{n({limitHit:this.isLimitHit,stats:o||void 0})},o=>{s(new Error(xu(o)))})})}async doSearch(e,i){const n=new Tt;const s=e.map(u=>this.getSearchOptionsForFolder(u));const r=this.provider instanceof d5?this.sessionLifecycle?.tokenSource.token:this.sessionLifecycle?.obj;const o={folderOptions:s,maxResults:this.config.maxResults??DA,session:r};const a=u=>{const d=new AA(this.config,u);const f=!d.hasSiblingExcludeClauses();return{queryTester:d,noSiblingsClauses:f,folder:u.folder,tree:this.initDirectoryTree()}};const l=new h5(e,a);let c;try{this.activeCancellationTokens.add(n);c=Wr.create();const u=await this.provider.provideFileSearchResults(this.config.filePattern||"",o,n.token);const d=c.elapsed();const f=Wr.create();if(this.isCanceled&&!this.isLimitHit){return null}if(u){u.forEach(p=>{const m=l.findQueryFragmentAwareSubstr(p);const v=mt.relative(m.folder.path,p.path);if(m.noSiblingsClauses){const y=kn(p.path);this.matchFile(i,{base:m.folder,relativePath:v,basename:y});return}this.addDirectoryEntries(m.tree,m.folder,v,i)})}if(this.isCanceled&&!this.isLimitHit){return null}l.forEachFolderQueryInfo(p=>{this.matchDirectoryTree(p.tree,p.queryTester,i)});return{providerTime:d,postProcessTime:f.elapsed()}}finally{n.dispose();this.activeCancellationTokens.delete(n)}}getSearchOptionsForFolder(e){const i=Tc(this.config.includePattern,e.includePattern);let n=e.excludePattern?.map(r=>({folder:r.folder,patterns:Tc(this.config.excludePattern,r.pattern)}));if(!n?.length){n=[{folder:void 0,patterns:Tc(this.config.excludePattern,void 0)}]}const s=LA(n);return{folder:e.folder,excludes:s,includes:i,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};e.pathToEntries["."]=e.rootEntries;return e}addDirectoryEntries({pathToEntries:e},i,n,s){if(this.filePattern&&Nv(n,this.filePattern,this.config.ignoreGlobCase)){const o=kn(this.filePattern);this.matchFile(s,{base:i,relativePath:this.filePattern,basename:o})}function r(o){const a=kn(o);const l=lc(o);let c=e[l];if(!c){c=e[l]=[];r(l)}c.push({base:i,relativePath:o,basename:a})}r(n)}matchDirectoryTree({rootEntries:e,pathToEntries:i},n,s){const r=this;const o=this.filePattern;const a=this.config.ignoreGlobCase;function l(c){const u=JM(()=>c.map(d=>d.basename));for(let d=0,f=c.length;d<f;d++){const p=c[d];const{relativePath:m,basename:v}=p;if(n.matchesExcludesSync(m,v,!Nv(o,v,a)?u:void 0)){continue}const y=i[m];if(y){l(y)}else{if(Nv(m,o,a)){continue}r.matchFile(s,p)}if(r.isLimitHit){break}}}l(e)}matchFile(e,i){if(!this.includePattern||i.relativePath&&this.includePattern(i.relativePath,i.basename)){if(this.exists||this.maxResults&&this.resultCount>=this.maxResults){this.isLimitHit=true;this.cancel()}if(!this.isLimitHit){e(i)}}}}class JU{constructor(){this._obj=new Object;this.tokenSource=new Tt}get obj(){if(this._obj){return this._obj}throw new Error("Session object has been dereferenced.")}cancel(){this.tokenSource.cancel();this._obj=void 0}}class Nx{constructor(){this.sessions=new Map}static{this.BATCH_SIZE=512}fileSearch(e,i,n,s){const r=this.getSessionTokenSource(e.cacheKey);const o=new QU(e,i,r);let a=0;const l=c=>{a+=c.length;n(c.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(o,Nx.BATCH_SIZE,l,s).then(c=>{return{limitHit:c.limitHit,stats:c.stats?{fromCache:false,type:"fileSearchProvider",resultCount:a,detailStats:c.stats}:void 0,messages:[]}})}clearCache(e){this.sessions.get(e)?.cancel();this.sessions.delete(e)}getSessionTokenSource(e){if(!e){return void 0}if(!this.sessions.has(e)){this.sessions.set(e,new JU)}return this.sessions.get(e)}rawMatchToSearchItem(e){if(e.relativePath){return{resource:Mi(e.base,e.relativePath)}}else{return{resource:e.base}}}doSearch(e,i,n,s){const r=s.onCancellationRequested(()=>{e.cancel()});const o=l=>{if(l){a.push(l);if(i>0&&a.length>=i){n(a);a=[]}}};let a=[];return e.search(o).then(l=>{if(a.length){n(a)}r.dispose();return l},l=>{if(a.length){n(a)}r.dispose();return Promise.reject(l)})}}class mI{constructor(e,i,n){this.queryProviderPair=e;this.fileUtils=i;this.processType=n;this.collector=null;this.isLimitHit=false;this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,i,n){const s=this.query.folderQueries||[];const r=new Tt(i);return new Promise((o,a)=>{this.collector=new XU(e);let l=false;const c=(u,d)=>{if(u instanceof Dy){return}if(l){return}if(!this.isLimitHit){const f=this.resultSize(u);if(u instanceof Do&&typeof this.query.maxResults==="number"&&this.resultCount+f>this.query.maxResults){this.isLimitHit=true;l=true;r.cancel();u=this.trimResultToSize(u,this.query.maxResults-this.resultCount)}const p=this.resultSize(u);this.resultCount+=p;const m=u instanceof Do;if(p>0||!m){this.collector.add(u,d)}}};this.doSearch(s,c,r.token,n).then(u=>{r.dispose();this.collector.flush();o({limitHit:this.isLimitHit||u?.limitHit,messages:this.getMessagesFromResults(u),stats:{type:this.processType}})},u=>{r.dispose();const d=xu(u);a(new Error(d))})})}getMessagesFromResults(e){if(!e?.message){return[]}if(Array.isArray(e.message)){return e.message}return[e.message]}resultSize(e){if(e instanceof Do){return Array.isArray(e.ranges)?e.ranges.length:1}else{return 0}}trimResultToSize(e,i){return new Do(e.uri,e.ranges.slice(0,i),e.previewText)}async doSearch(e,i,n,s){const r=new h5(e,(d,f)=>{const p=new AA(this.query,d);return{queryTester:p,folder:d.folder,folderIdx:f}},()=>true);const o=[];const a={report:d=>{if(d instanceof Dy){s?.(d)}else{if(d.uri===void 0){throw Error("Text search result URI is undefined. Please check provider implementation.")}const f=r.findQueryFragmentAwareSubstr(d.uri);const p=f.folder.scheme===ne.file?QM(()=>{return this.fileUtils.readdir(lf(d.uri))}):void 0;const m=v4(f.folder,d.uri);if(m){const v=f.queryTester.includedInQuery(m,kn(m),p);if(Uo(v)){o.push(v.then(y=>{if(y){i(d,f.folderIdx)}}))}else if(v){i(d,f.folderIdx)}}}}};const l=e.map(d=>this.getSearchOptionsForFolder(d));const c={folderOptions:l,maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults??DA,previewOptions:this.query.previewOptions??Iy,surroundingContext:this.query.surroundingContext??0};if("usePCRE2"in this.query){c.usePCRE2=this.query.usePCRE2}let u;if(this.queryProviderPair.query.type===il.aiText){u=await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,c,a,n)}else{u=await this.queryProviderPair.provider.provideTextSearchResults(YU(this.queryProviderPair.query.contentPattern),c,a,n)}if(o.length){await Promise.all(o)}return u}getSearchOptionsForFolder(e){const i=Tc(this.query.includePattern,e.includePattern);let n=e.excludePattern?.map(o=>({folder:o.folder,patterns:Tc(this.query.excludePattern,o.pattern)}));if(!n||n.length===0){n=[{folder:void 0,patterns:Tc(this.query.excludePattern,void 0)}]}const s=LA(n);const r={folder:b.from(e.folder),excludes:s,includes:i,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks,encoding:(e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding))??"",ignoreGlobCase:this.query.ignoreGlobCase||e.ignoreGlobCase};return r}}function YU(t){return{isCaseSensitive:t.isCaseSensitive||false,isRegExp:t.isRegExp||false,isWordMatch:t.isWordMatch||false,isMultiline:t.isMultiline||false,pattern:t.pattern}}class XU{constructor(e){this._onResult=e;this._currentFolderIdx=-1;this._currentFileMatch=null;this._batchedCollector=new __(512,i=>this.sendItems(i))}add(e,i){if(this._currentFileMatch&&(this._currentFolderIdx!==i||!Fc(this._currentUri,e.uri))){this.pushToCollector();this._currentFileMatch=null}if(!this._currentFileMatch){this._currentFolderIdx=i;this._currentUri=e.uri;this._currentFileMatch={resource:e.uri,results:[]}}this._currentFileMatch.results.push(ZU(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector();this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function ZU(t){if(t instanceof Do){return{previewText:t.previewText,rangeLocations:t.ranges.map(e=>({preview:{startLineNumber:e.previewRange.start.line,startColumn:e.previewRange.start.character,endLineNumber:e.previewRange.end.line,endColumn:e.previewRange.end.character},source:{startLineNumber:e.sourceRange.start.line,startColumn:e.sourceRange.start.character,endLineNumber:e.sourceRange.end.line,endColumn:e.sourceRange.end.character}}))}}else{return{text:t.text,lineNumber:t.lineNumber}}}class __{static{this.TIMEOUT=4e3}static{this.START_BATCH_AFTER_COUNT=50}constructor(e,i){this.maxBatchSize=e;this.cb=i;this.totalNumberCompleted=0;this.batch=[];this.batchSize=0}addItem(e,i){if(!e){return}this.addItemToBatch(e,i)}addItems(e,i){if(!e){return}this.addItemsToBatch(e,i)}addItemToBatch(e,i){this.batch.push(e);this.batchSize+=i;this.onUpdate()}addItemsToBatch(e,i){this.batch=this.batch.concat(e);this.batchSize+=i;this.onUpdate()}onUpdate(){if(this.totalNumberCompleted<__.START_BATCH_AFTER_COUNT){this.flush()}else if(this.batchSize>=this.maxBatchSize){this.flush()}else if(!this.timeoutHandle){this.timeoutHandle=setTimeout(()=>{this.flush()},__.TIMEOUT)}}flush(){if(this.batchSize){this.totalNumberCompleted+=this.batchSize;this.cb(this.batch);this.batch=[];this.batchSize=0;if(this.timeoutHandle){clearTimeout(this.timeoutHandle);this.timeoutHandle=void 0}}}}const f5=te("IExtHostSearch");let A0=class dq{constructor(e,i,n){this.extHostRpc=e;this._uriTransformer=i;this._logService=n;this._proxy=this.extHostRpc.getProxy(ee.MainThreadSearch);this._handlePool=0;this._textSearchProvider=new Map;this._textSearchUsedSchemes=new Set;this._aiTextSearchProvider=new Map;this._aiTextSearchUsedSchemes=new Set;this._fileSearchProvider=new Map;this._fileSearchUsedSchemes=new Set;this._fileSearchManager=new Nx}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProviderOld(e,i){if(this._textSearchUsedSchemes.has(e)){throw new Error(`a text search provider for the scheme '${e}' is already registered`)}this._textSearchUsedSchemes.add(e);const n=this._handlePool++;this._textSearchProvider.set(n,new jU(i));this._proxy.$registerTextSearchProvider(n,this._transformScheme(e));return ye(()=>{this._textSearchUsedSchemes.delete(e);this._textSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}registerTextSearchProvider(e,i){if(this._textSearchUsedSchemes.has(e)){throw new Error(`a text search provider for the scheme '${e}' is already registered`)}this._textSearchUsedSchemes.add(e);const n=this._handlePool++;this._textSearchProvider.set(n,i);this._proxy.$registerTextSearchProvider(n,this._transformScheme(e));return ye(()=>{this._textSearchUsedSchemes.delete(e);this._textSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}registerAITextSearchProvider(e,i){if(this._aiTextSearchUsedSchemes.has(e)){throw new Error(`an AI text search provider for the scheme '${e}'is already registered`)}this._aiTextSearchUsedSchemes.add(e);const n=this._handlePool++;this._aiTextSearchProvider.set(n,i);this._proxy.$registerAITextSearchProvider(n,this._transformScheme(e));return ye(()=>{this._aiTextSearchUsedSchemes.delete(e);this._aiTextSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}registerFileSearchProviderOld(e,i){if(this._fileSearchUsedSchemes.has(e)){throw new Error(`a file search provider for the scheme '${e}' is already registered`)}this._fileSearchUsedSchemes.add(e);const n=this._handlePool++;this._fileSearchProvider.set(n,new d5(i));this._proxy.$registerFileSearchProvider(n,this._transformScheme(e));return ye(()=>{this._fileSearchUsedSchemes.delete(e);this._fileSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}registerFileSearchProvider(e,i){if(this._fileSearchUsedSchemes.has(e)){throw new Error(`a file search provider for the scheme '${e}' is already registered`)}this._fileSearchUsedSchemes.add(e);const n=this._handlePool++;this._fileSearchProvider.set(n,i);this._proxy.$registerFileSearchProvider(n,this._transformScheme(e));return ye(()=>{this._fileSearchUsedSchemes.delete(e);this._fileSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}$provideFileSearchResults(e,i,n,s){const r=i1(n);const o=this._fileSearchProvider.get(e);if(o){return this._fileSearchManager.fileSearch(r,o,a=>{this._proxy.$handleFileMatch(e,i,a.map(l=>l.resource))},s)}else{throw new Error("unknown provider: "+e)}}async doInternalFileSearchWithCustomCallback(e,i,n){return{messages:[]}}$clearCache(e){this._fileSearchManager.clearCache(e);return Promise.resolve(void 0)}$provideTextSearchResults(e,i,n,s){const r=this._textSearchProvider.get(e);if(!r||!r.provideTextSearchResults){throw new Error(`Unknown Text Search Provider ${e}`)}const o=i1(n);const a=this.createTextSearchManager(o,r);return a.search(l=>this._proxy.$handleTextMatch(e,i,l),s)}$provideAITextSearchResults(e,i,n,s){const r=this._aiTextSearchProvider.get(e);if(!r||!r.provideAITextSearchResults){throw new Error(`Unknown AI Text Search Provider ${e}`)}const o=i1(n);const a=this.createAITextSearchManager(o,r);return a.search(l=>this._proxy.$handleTextMatch(e,i,l),s,l=>this._proxy.$handleKeywordResult(e,i,l))}$enableExtensionHostSearch(){}async $getAIName(e){const i=this._aiTextSearchProvider.get(e);if(!i||!i.provideAITextSearchResults){return void 0}return i.name??"AI"}createTextSearchManager(e,i){return new mI({query:e,provider:i},{readdir:n=>Promise.resolve([]),toCanonicalName:n=>n},"textSearchProvider")}createAITextSearchManager(e,i){return new mI({query:e,provider:i},{readdir:n=>Promise.resolve([]),toCanonicalName:n=>n},"aiTextSearchProvider")}};A0=W([P(0,st),P(1,P_),P(2,et)],A0);function i1(t){return{...t,...{folderQueries:t.folderQueries&&t.folderQueries.map(e$),extraFileResources:t.extraFileResources&&t.extraFileResources.map(e=>b.revive(e))}}}function e$(t){return Wi(t)}const p5=te("IExtHostTerminalShellIntegration");let R0=class hq extends me{constructor(e,i){super();this._extHostTerminalService=i;this._activeShellIntegrations=new Map;this._onDidChangeTerminalShellIntegration=new L;this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event;this._onDidStartTerminalShellExecution=new L;this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event;this._onDidEndTerminalShellExecution=new L;this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event;this._proxy=e.getProxy(ee.MainThreadTerminalShellIntegration);this._register(ye(()=>{for(const[n,s]of this._activeShellIntegrations){s.dispose()}this._activeShellIntegrations.clear()}))}$shellIntegrationChange(e,i){const n=this._extHostTerminalService.getTerminalById(e);if(!n){return}const s=n.value;let r=this._activeShellIntegrations.get(e);if(!r){r=new t$(n.value,i,this._onDidStartTerminalShellExecution);this._activeShellIntegrations.set(e,r);r.store.add(n.onWillDispose(()=>this._activeShellIntegrations.get(e)?.dispose()));r.store.add(r.onDidRequestShellExecution(o=>this._proxy.$executeCommand(e,o)));r.store.add(r.onDidRequestEndExecution(o=>this._onDidEndTerminalShellExecution.fire(o)));r.store.add(r.onDidRequestChangeShellIntegration(o=>this._onDidChangeTerminalShellIntegration.fire(o)));n.shellIntegration=r.value}this._onDidChangeTerminalShellIntegration.fire({terminal:s,shellIntegration:r.value})}$shellExecutionStart(e,i,n,s,r,o){if(!this._activeShellIntegrations.has(e)){this.$shellIntegrationChange(e,i)}const a={value:n,confidence:s,isTrusted:r};this._activeShellIntegrations.get(e)?.startShellExecution(a,this._convertCwdToUri(o))}$shellExecutionEnd(e,i,n,s,r){const o={value:i,confidence:n,isTrusted:s};this._activeShellIntegrations.get(e)?.endShellExecution(o,r)}$shellExecutionData(e,i){this._activeShellIntegrations.get(e)?.emitData(i)}$shellEnvChange(e,i,n,s){this._activeShellIntegrations.get(e)?.setEnv(i,n,s)}$cwdChange(e,i){this._activeShellIntegrations.get(e)?.setCwd(this._convertCwdToUri(i))}$closeTerminal(e){this._activeShellIntegrations.get(e)?.dispose();this._activeShellIntegrations.delete(e)}_convertCwdToUri(e){return e?b.file(e):void 0}};R0=W([P(0,st),P(1,Du)],R0);class t$ extends me{get currentExecution(){return this._currentExecution}constructor(e,i,n){super();this._terminal=e;this._onDidStartTerminalShellExecution=n;this._pendingExecutions=[];this.store=this._register(new pe);this._onDidRequestChangeShellIntegration=this._register(new L);this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event;this._onDidRequestShellExecution=this._register(new L);this.onDidRequestShellExecution=this._onDidRequestShellExecution.event;this._onDidRequestEndExecution=this._register(new L);this.onDidRequestEndExecution=this._onDidRequestEndExecution.event;this._onDidRequestNewExecution=this._register(new L);this.onDidRequestNewExecution=this._onDidRequestNewExecution.event;const s=this;this.value={get cwd(){return s._cwd},get env(){if(!s._env){return void 0}return Object.freeze({isTrusted:s._env.isTrusted,value:Object.freeze({...s._env.value})})},executeCommand(r,o){if(!i){throw new Error("This terminal does not support the executeCommand API.")}let a=r;if(o){for(const u of o){const d=!u.match(/["'`]/)&&u.match(/\s/);if(d){a+=` "${u}"`}else{a+=` ${u}`}}}s._onDidRequestShellExecution.fire(a);const l={value:a,confidence:fh.High,isTrusted:true};const c=s.requestNewShellExecution(l,s._cwd).value;return c}}}requestNewShellExecution(e,i){const n=new _I(e,i??this._cwd);const s=Ep(e.value);if(s.length>1){this._currentExecutionProperties={isMultiLine:true,unresolvedCommandLines:Ep(e.value)}}this._pendingExecutions.push(n);this._onDidRequestNewExecution.fire(e.value);return n}startShellExecution(e,i){if(this._pendingEndingExecution){this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._pendingEndingExecution.value,exitCode:void 0});this._pendingEndingExecution=void 0}if(this._currentExecution){if(this._currentExecutionProperties?.isMultiLine&&this._currentExecutionProperties.unresolvedCommandLines){const s=vI(this._currentExecutionProperties.unresolvedCommandLines,e);if(s){this._currentExecutionProperties.unresolvedCommandLines=s.unresolvedCommandLines;return}}this._currentExecution.endExecution(void 0);this._currentExecution.flush();this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0})}let n;if(e.confidence===fh.High){for(const[s,r]of this._pendingExecutions.entries()){if(r.value.commandLine.value===e.value){n=r;this._currentExecutionProperties={isMultiLine:false,unresolvedCommandLines:void 0};n=r;this._pendingExecutions.splice(s,1);break}else{const o=vI(Ep(r.value.commandLine.value),e);if(o){this._currentExecutionProperties={isMultiLine:true,unresolvedCommandLines:o.unresolvedCommandLines};n=r;this._pendingExecutions.splice(s,1);break}}}}else{n=this._pendingExecutions.shift()}if(!n){n=new _I(e,i??this._cwd)}this._currentExecution=n;this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}emitData(e){this.currentExecution?.emitData(e)}endShellExecution(e,i){if(this._currentExecutionProperties?.isMultiLine){if(this._currentExecutionProperties.unresolvedCommandLines&&this._currentExecutionProperties.unresolvedCommandLines.length>0){return}}if(this._currentExecution){const n=this._currentExecutionProperties?.isMultiLine?this._currentExecution.value.commandLine:e;this._currentExecution.endExecution(n);const s=this._currentExecution;this._pendingEndingExecution=s;this._currentExecution=void 0;s.flush().then(()=>{if(this._pendingEndingExecution===s){this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:s.value,exitCode:i});this._pendingEndingExecution=void 0}})}}setEnv(e,i,n){const s={};for(let r=0;r<e.length;r++){s[e[r]]=i[r]}this._env={value:s,isTrusted:n};this._fireChangeEvent()}setCwd(e){let i=false;if(b.isUri(this._cwd)){i=!b.isUri(e)||this._cwd.toString()!==e.toString()}else if(this._cwd!==e){i=true}if(i){this._cwd=e;this._fireChangeEvent()}}_fireChangeEvent(){this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value})}}class _I{constructor(e,i){this._commandLine=e;this.cwd=i;this._isEnded=false;const n=this;this.value={get commandLine(){return n._commandLine},get cwd(){return n.cwd},read(){return n._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._isEnded){return Zi.EMPTY}this._dataStream=new i$}return this._dataStream.createIterable()}emitData(e){if(!this._isEnded){this._dataStream?.emitData(e)}}endExecution(e){if(e){this._commandLine=e}this._dataStream?.endExecution();this._isEnded=true}async flush(){if(this._dataStream){await this._dataStream.flush();this._dataStream.dispose();this._dataStream=void 0}}}class i$ extends me{constructor(){super(...arguments);this._iterables=[];this._emitters=[]}createIterable(){if(!this._barrier){this._barrier=new Es}const e=this._barrier;const i=new Zi(async n=>{this._emitters.push(n);await e.wait()});this._iterables.push(i);return i}emitData(e){for(const i of this._emitters){i.emitOne(e)}}endExecution(){this._barrier?.open()}async flush(){await Promise.all(this._iterables.map(e=>e.toPromise()))}}function Ep(t){return t.split("\n").map(e=>e.trim()).filter(e=>e.length>0)}function vI(t,e){if(t.length===0){return false}const i=[...t];const n=Ep(e.value);if(i&&i.length>0){while(i.length>0){if(i[0]!==n[0]){break}i.shift();n.shift()}if(n.length===0){return{unresolvedCommandLines:i}}}return false}var po;(function(t){t[t["CR"]=13]="CR";t[t["LF"]=10]="LF";t[t["COLON"]=58]="COLON";t[t["SPACE"]=32]="SPACE"})(po||(po={}));class n1{constructor(e){this.dataBuffer="";this.eventTypeBuffer="";this.buffer=[];this.endedOnCR=false;this.onEventHandler=e;this.decoder=new TextDecoder("utf-8")}getLastEventId(){return this.lastEventIdBuffer}getReconnectionTime(){return this.reconnectionTime}feed(e){if(e.length===0){return}let i=0;if(this.endedOnCR&&e[0]===po.LF){i++}this.endedOnCR=false;while(i<e.length){const n=e.indexOf(po.CR,i);const s=e.indexOf(po.LF,i);const r=n===-1?s:s===-1?n:Math.min(n,s);if(r===-1){break}let o="";for(const a of this.buffer){o+=this.decoder.decode(a,{stream:true})}o+=this.decoder.decode(e.subarray(i,r));this.processLine(o);this.buffer.length=0;i=r+(e[r]===po.CR&&e[r+1]===po.LF?2:1)}if(i<e.length){this.buffer.push(e.subarray(i))}else{this.endedOnCR=e[e.length-1]===po.CR}}processLine(e){if(!e.length){this.dispatchEvent();return}if(e.startsWith(":")){return}let i;let n;const s=e.indexOf(":");if(s===-1){i=e;n=""}else{i=e.substring(0,s);n=e.substring(s+1);if(n.startsWith(" ")){n=n.substring(1)}}this.processField(i,n)}processField(e,i){switch(e){case"event":this.eventTypeBuffer=i;break;case"data":this.dataBuffer+=i;this.dataBuffer+="\n";break;case"id":if(!i.includes("\0")){this.currentEventId=this.lastEventIdBuffer=i}else{this.currentEventId=void 0}break;case"retry":if(/^\d+$/.test(i)){this.reconnectionTime=parseInt(i,10)}break}}dispatchEvent(){if(this.dataBuffer===""){this.dataBuffer="";this.eventTypeBuffer="";return}if(this.dataBuffer.endsWith("\n")){this.dataBuffer=this.dataBuffer.substring(0,this.dataBuffer.length-1)}const e={type:this.eventTypeBuffer||"message",data:this.dataBuffer};if(this.currentEventId!==void 0){e.id=this.currentEventId}if(this.reconnectionTime!==void 0){e.retry=this.reconnectionTime}this.onEventHandler(e);this.reset()}reset(){this.dataBuffer="";this.eventTypeBuffer="";this.currentEventId=void 0}}class Mx{validateOrThrow(e){const i=this.validate(e);if(i.error){throw new Error(i.error.message)}return i.content}}class lv extends Mx{constructor(e){super();this.type=e}validate(e){if(typeof e!==this.type){return{content:void 0,error:{message:`Expected ${this.type}, but got ${typeof e}`}}}return{content:e,error:void 0}}getJSONSchema(){return{type:this.type}}}const n$=new lv("string");function Of(){return n$}const s$=new lv("number");function r$(){return s$}new lv("boolean");const o$=new lv("object");function s1(){return o$}class L0{constructor(e){this.validator=e}}function Bl(t){return new L0(t)}class a$ extends Mx{constructor(e){super();this.properties=e}validate(e){if(typeof e!=="object"||e===null){return{content:void 0,error:{message:"Expected object"}}}const i={};for(const n in this.properties){const s=this.properties[n];const r=e[n];const o=s instanceof L0;const a=o?s.validator:s;if(o&&r===void 0){continue}const{content:l,error:c}=a.validate(r);if(c){return{content:void 0,error:{message:`Error in property '${n}': ${c.message}`}}}i[n]=l}return{content:i,error:void 0}}getJSONSchema(){const e=[];const i={};for(const[s,r]of Object.entries(this.properties)){const o=r instanceof L0;const a=o?r.validator:r;i[s]=a.getJSONSchema();if(!o){e.push(s)}}const n={type:"object",properties:i,...e.length>0?{required:e}:{}};return n}}function Ff(t){return new a$(t)}class l$ extends Mx{constructor(e){super();this.validator=e}validate(e){if(!Array.isArray(e)){return{content:void 0,error:{message:"Expected array"}}}const i=[];for(let n=0;n<e.length;n++){const{content:s,error:r}=this.validator.validate(e[n]);if(r){return{content:void 0,error:{message:`Error in element ${n}: ${r.message}`}}}i.push(s)}return{content:i,error:void 0}}getJSONSchema(){return{type:"array",items:this.validator.getJSONSchema()}}}function wI(t){return new l$(t)}const N0=te("IExtHostMpcService");const c$=Ff({label:Of(),version:Bl(Of()),metadata:Bl(Ff({capabilities:Bl(s1()),serverInfo:Bl(s1()),tools:Bl(wI(Ff({availability:r$(),definition:s1()})))})),authentication:Bl(Ff({providerId:Of(),scopes:wI(Of())}))});let M0=class fq extends me{constructor(e,i,n,s,r){super();this._logService=i;this._extHostInitData=n;this._workspaceService=s;this._variableResolver=r;this._initialProviderPromises=new Set;this._sseEventSources=this._register(new af);this._unresolvedMcpServers=new Map;this._onDidChangeMcpServerDefinitions=this._register(new L);this.onDidChangeMcpServerDefinitions=this._onDidChangeMcpServerDefinitions.event;this._mcpServerDefinitions=[];this._proxy=e.getProxy(ee.MainThreadMcp)}get mcpServerDefinitions(){return this._mcpServerDefinitions}$onDidChangeMcpServerDefinitions(e){this._mcpServerDefinitions=e.map(i=>tc.to(i));this._onDidChangeMcpServerDefinitions.fire()}$startMcp(e,i){this._startMcp(e,Vc.fromSerialized(i.launch),i.defaultCwd&&b.revive(i.defaultCwd),i.errorOnUserInteraction)}_startMcp(e,i,n,s){if(i.type===Ro.HTTP){this._sseEventSources.set(e,new h$(e,i,this._proxy,this._logService,s));return}throw new Error("not implemented")}async $substituteVariables(e,i){const n=b.revive(e);const s=n&&await this._workspaceService.resolveWorkspaceFolder(n);const r=await this._variableResolver.getResolver();return r.resolveAsync(s&&{uri:s.uri,name:s.name,index:s.index},i)}$stopMcp(e){this._sseEventSources.get(e)?.close().then(()=>this._didClose(e))}_didClose(e){this._sseEventSources.deleteAndDispose(e)}$sendMessage(e,i){this._sseEventSources.get(e)?.send(i)}async $waitForInitialCollectionProviders(){await Promise.all(this._initialProviderPromises)}async $resolveMcpLaunch(e,i){const n=this._unresolvedMcpServers.get(e);if(!n){return}const s=n.servers.find(o=>o.label===i);if(!s){return}if(!n.provider.resolveMcpServerDefinition){return tc.from(s)}const r=await n.provider.resolveMcpServerDefinition(s,Ze.None);return r?tc.from(r):void 0}registerMcpConfigurationProvider(e,i,n){const s=new pe;const r=e.contributes?.mcpServerDefinitionProviders?.find(c=>c.id===i);if(!r){throw new Error(`MCP configuration providers must be registered in the contributes.mcpServerDefinitionProviders array within your package.json, but "${i}" was not`)}const o={id:gN(e.identifier,i),isTrustedByDefault:true,label:r?.label??e.displayName??e.name,scope:jt.WORKSPACE,canResolveLaunch:typeof n.resolveMcpServerDefinition==="function",extensionId:e.identifier.value,configTarget:this._extHostInitData.remote.isRemote?ri.USER_REMOTE:ri.USER};const a=async()=>{const c=await n.provideMcpServerDefinitions(Ze.None);this._unresolvedMcpServers.set(o.id,{servers:c??[],provider:n});const u=[];for(const d of c??[]){let f=ht.toKey(e.identifier)+"/"+d.label;if(u.some(v=>v.id===f)){let v=2;while(u.some(y=>y.id===f+v)){v++}f=f+v}c$.validateOrThrow(d);if(d.authentication){O(e,"mcpToolDefinitions")}let p;const m=d;if(it(e,"mcpToolDefinitions")&&m.metadata){p={capabilities:m.metadata.capabilities,instructions:m.metadata.instructions,serverInfo:m.metadata.serverInfo,tools:m.metadata.tools?.map(v=>({availability:v.availability===bm.Dynamic?vg.Dynamic:vg.Initial,definition:v.definition}))}}u.push({id:f,label:d.label,cacheNonce:d.version||"$$NONE",staticMetadata:p,launch:tc.from(d)})}this._proxy.$upsertMcpCollection(o,u)};s.add(ye(()=>{this._unresolvedMcpServers.delete(o.id);this._proxy.$deleteMcpCollection(o.id)}));if(n.onDidChangeMcpServerDefinitions){s.add(n.onDidChangeMcpServerDefinitions(a))}if(n.onDidChangeServerDefinitions){s.add(n.onDidChangeServerDefinitions(a))}if(n.onDidChange){s.add(n.onDidChange(a))}const l=new Promise(c=>{setTimeout(()=>a().finally(()=>{this._initialProviderPromises.delete(l);c()}),0)});this._initialProviderPromises.add(l);return s}};M0=W([P(0,st),P(1,et),P(2,wi),P(3,ur),P(4,av)],M0);var dn;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Http"]=1]="Http";t[t["SSE"]=2]="SSE"})(dn||(dn={}));const u$=5;const d$=[301,302,303,307,308];class h$ extends me{constructor(e,i,n,s,r){super();this._id=e;this._launch=i;this._proxy=n;this._logService=s;this._errorOnUserInteraction=r;this._requestSequencer=new e8;this._postEndpoint=new Bn;this._mode={value:dn.Unknown};this._cts=new Tt;this._abortCtrl=new AbortController;this._didSendClose=false;this._register(ye(()=>{this._abortCtrl.abort();this._cts.dispose(true)}));this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Running})}async send(e){try{if(this._mode.value===dn.Unknown){await this._requestSequencer.queue(()=>this._send(e))}else{await this._send(e)}}catch(i){const n=`Error sending message to ${this._launch.uri}: ${String(i)}`;this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Error,message:n})}}async close(){if(this._mode.value===dn.Http&&this._mode.sessionId&&!this._didSendClose){this._didSendClose=true;try{await this._closeSession(this._mode.sessionId)}catch{}}this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Stopped})}async _closeSession(e){const i={...Object.fromEntries(this._launch.headers),"Mcp-Session-Id":e};try{await this._addAuthHeader(i,{errorOnUserInteraction:true})}catch(n){this._log(xe.Debug,`Skipping session close: authentication no longer available`);return}await this._fetch(this._launch.uri.toString(true),{method:"DELETE",headers:i})}_send(e){if(this._mode.value===dn.SSE){return this._sendLegacySSE(this._mode.endpoint,e)}else{return this._sendStreamableHttp(e,this._mode.value===dn.Http?this._mode.sessionId:void 0)}}async _sendStreamableHttp(e,i){const n=new TextEncoder().encode(e);const s={...Object.fromEntries(this._launch.headers),"Content-Type":"application/json","Content-Length":String(n.length),Accept:"text/event-stream, application/json"};if(i){s["Mcp-Session-Id"]=i}await this._addAuthHeader(s);const r=await this._fetchWithAuthRetry(this._launch.uri.toString(true),{method:"POST",headers:s,body:n},s);const o=this._mode.value===dn.Unknown;const a=r.headers.get("Mcp-Session-Id");if(a){this._mode={value:dn.Http,sessionId:a}}if(this._mode.value===dn.Unknown&&r.status>=400&&r.status<500&&!r1(r.status)){this._log(xe.Info,`${r.status} status sending message to ${this._launch.uri}, will attempt to fall back to legacy SSE`);this._sseFallbackWithMessage(e);return}if(r.status>=300){const l=this._mode.value===dn.Http&&!!this._mode.sessionId&&(r.status===400||r.status===404);this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Error,message:`${r.status} status sending message to ${this._launch.uri}: ${await this._getErrText(r)}`+(l?`; will retry with new session ID`:""),shouldRetry:l});return}if(this._mode.value===dn.Unknown){this._mode={value:dn.Http,sessionId:void 0}}if(o){this._attachStreamableBackchannel()}await this._handleSuccessfulStreamableHttp(r,e)}async _sseFallbackWithMessage(e){const i=await this._attachSSE();if(i){this._mode={value:dn.SSE,endpoint:i};await this._sendLegacySSE(i,e)}}async _handleSuccessfulStreamableHttp(e,i){if(e.status===202){return}const n=e.headers.get("Content-Type")?.toLowerCase()||"";if(n.startsWith("text/event-stream")){const s=new n1(r=>{if(r.type==="message"){this._proxy.$onDidReceiveMessage(this._id,r.data)}else if(r.type==="endpoint"){this._log(xe.Warning,`Received SSE endpoint from a POST to ${this._launch.uri}, will fall back to legacy SSE`);this._sseFallbackWithMessage(i);throw new Vi}});try{await this._doSSE(s,e)}catch(r){this._log(xe.Warning,`Error reading SSE stream: ${String(r)}`)}}else if(n.startsWith("application/json")){this._proxy.$onDidReceiveMessage(this._id,await e.text())}else{const s=await e.text();if(f$(s)){this._proxy.$onDidReceiveMessage(this._id,s)}else{this._log(xe.Warning,`Unexpected ${e.status} response for request: ${s}`)}}}async _attachStreamableBackchannel(){let e;let i;for(let n=0;!this._store.isDisposed;n++){if(i!==void 0){await Ts(Math.max(0,i-Date.now()),this._cts.token);i=void 0}else{await Ts(Math.min(n*1e3,3e4),this._cts.token)}let s;try{const o={...Object.fromEntries(this._launch.headers),"Accept":"text/event-stream"};await this._addAuthHeader(o);if(this._mode.value===dn.Http&&this._mode.sessionId!==void 0){o["Mcp-Session-Id"]=this._mode.sessionId}if(e){o["Last-Event-ID"]=e}s=await this._fetchWithAuthRetry(this._launch.uri.toString(true),{method:"GET",headers:o},o)}catch(o){this._log(xe.Info,`Error connecting to ${this._launch.uri} for async notifications, will retry`);continue}if(s.status>=400){this._log(xe.Debug,`${s.status} status connecting to ${this._launch.uri} for async notifications; they will be disabled: ${await this._getErrText(s)}`);return}if(s.headers.get("content-type")?.toLowerCase().includes("text/event-stream")){n=0}const r=new n1(o=>{if(o.retry){i=Date.now()+o.retry}if(o.type==="message"&&o.data){this._proxy.$onDidReceiveMessage(this._id,o.data)}if(o.id){e=o.id}});try{await this._doSSE(r,s)}catch(o){this._log(xe.Info,`Error reading from async stream, we will reconnect: ${o}`)}}}async _attachSSE(){const e=new Bn;const i={...Object.fromEntries(this._launch.headers),"Accept":"text/event-stream"};await this._addAuthHeader(i);let n;try{n=await this._fetchWithAuthRetry(this._launch.uri.toString(true),{method:"GET",headers:i},i);if(n.status>=300){this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Error,message:`${n.status} status connecting to ${this._launch.uri} as SSE: ${await this._getErrText(n)}`});return}}catch(r){this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Error,message:`Error connecting to ${this._launch.uri} as SSE: ${r}`});return}const s=new n1(r=>{if(r.type==="message"){this._proxy.$onDidReceiveMessage(this._id,r.data)}else if(r.type==="endpoint"){e.complete(new URL(r.data,this._launch.uri.toString(true)).toString())}});this._register(ye(()=>e.cancel()));this._doSSE(s,n).catch(r=>{this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Error,message:`Error reading SSE stream: ${String(r)}`})});return e.p}async _sendLegacySSE(e,i){const n=new TextEncoder().encode(i);const s={...Object.fromEntries(this._launch.headers),"Content-Type":"application/json","Content-Length":String(n.length)};await this._addAuthHeader(s);const r=await this._fetch(e,{method:"POST",headers:s,body:n});if(r.status>=300){this._log(xe.Warning,`${r.status} status sending message to ${this._postEndpoint}: ${await this._getErrText(r)}`)}}async _doSSE(e,i){if(!i.body){return}const n=i.body.getReader();let s;do{try{s=await DS(n.read(),this._cts.token)}catch(r){n.cancel();if(this._store.isDisposed){return}else{throw r}}if(s.value){e.feed(s.value)}}while(!s.done)}async _addAuthHeader(e,i){const n=i?.errorOnUserInteraction??this._errorOnUserInteraction;if(this._authMetadata){try{const s={authorizationServer:this._authMetadata.authorizationServer.toJSON(),authorizationServerMetadata:this._authMetadata.serverMetadata,resourceMetadata:this._authMetadata.resourceMetadata,scopes:this._authMetadata.scopes};const r=await this._proxy.$getTokenFromServerMetadata(this._id,s,{errorOnUserInteraction:n,forceNewRegistration:i?.forceNewRegistration});if(r){e["Authorization"]=`Bearer ${r}`}}catch(s){if(wg.is(s)){this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Stopped,reason:"needs-user-interaction"});throw new Vi}this._log(xe.Warning,`Error getting token from server metadata: ${String(s)}`)}}if(this._launch.authentication){try{this._log(xe.Debug,`Using provided authentication config: providerId=${this._launch.authentication.providerId}, scopes=${this._launch.authentication.scopes.join(", ")}`);const s=await this._proxy.$getTokenForProviderId(this._id,this._launch.authentication.providerId,this._launch.authentication.scopes,{errorOnUserInteraction:n,forceNewRegistration:i?.forceNewRegistration});if(s){e["Authorization"]=`Bearer ${s}`;this._log(xe.Info,"Successfully obtained token from provided authentication config")}}catch(s){if(wg.is(s)){this._proxy.$onDidChangeState(this._id,{state:cs.Kind.Stopped,reason:"needs-user-interaction"});throw new Vi}this._log(xe.Warning,`Error getting token from provided authentication config: ${String(s)}`)}}return e}_log(e,i){if(!this._store.isDisposed){this._proxy.$onDidPublishLog(this._id,e,i)}}async _getErrText(e){try{return await e.text()}catch{return e.statusText}}async _fetchWithAuthRetry(e,i,n){const s=()=>this._fetch(e,i);let r=await s();if(r1(r.status)){if(!this._authMetadata){this._authMetadata=await p$(e,r.headers,{sameOriginHeaders:{...Object.fromEntries(this._launch.headers),"MCP-Protocol-Version":ww.LATEST_PROTOCOL_VERSION},fetch:(o,a)=>this._fetch(o,a),log:(o,a)=>this._log(o,a)});this._proxy.$logMcpAuthSetup(this._authMetadata.telemetry);await this._addAuthHeader(n);if(n["Authorization"]){i.headers=n;r=await s()}}else{if(this._authMetadata.update(r.headers)){await this._addAuthHeader(n);if(n["Authorization"]){i.headers=n;r=await s()}}}}if(n["Authorization"]&&r1(r.status)){const o=await this._getErrText(r);this._log(xe.Info,`Received ${r.status} status with Authorization header, retrying with new auth registration. Error details: ${o||"no additional details"}`);await this._addAuthHeader(n,{forceNewRegistration:true});r=await s()}return r}async _fetch(e,i){i.headers["user-agent"]=`${Mr.nameLong}/${Mr.version}`;if(u0(this._logService.getLevel(),xe.Trace)){const r={...i,headers:{...i.headers}};if(r.body){r.body=new TextDecoder().decode(r.body)}if(r.headers?.Authorization){r.headers.Authorization="***"}this._log(xe.Trace,`Fetching ${e} with options: ${JSON.stringify(r)}`)}let n=e;let s;for(let r=0;r<u$;r++){s=await this._fetchInternal(n,{...i,signal:this._abortCtrl.signal,redirect:"manual"});if(!d$.includes(s.status)){break}const o=s.headers.get("location");if(!o){break}const a=new URL(o,n).toString();this._log(xe.Trace,`Redirect (${s.status}) from ${n} to ${a}`);n=a;if(s.status===303||(s.status===301||s.status===302)&&i.method==="POST"){i.method="GET";delete i.body}}if(u0(this._logService.getLevel(),xe.Trace)){const r={};s.headers.forEach((o,a)=>{r[a]=o});this._log(xe.Trace,`Fetched ${n}: ${JSON.stringify({status:s.status,headers:r})}`)}return s}_fetchInternal(e,i){return fetch(e,i)}}function f$(t){try{JSON.parse(t);return true}catch(e){return false}}function r1(t){return t===401||t===403}class bI{constructor(e,i,n,s,r,o){this.authorizationServer=e;this.serverMetadata=i;this.resourceMetadata=n;this.telemetry=r;this._log=o;this._scopes=s}get scopes(){return this._scopes}update(e){const i=this._parseScopesFromResponse(e);if(!rF(i,this._scopes)){this._log(xe.Info,`Scopes changed from ${JSON.stringify(this._scopes)} to ${JSON.stringify(i)}, updating`);this._scopes=i;return true}return false}_parseScopesFromResponse(e){const i=e.get("WWW-Authenticate");if(!i){return void 0}const n=qA(i);for(const s of n){if(s.scheme==="Bearer"&&s.params["scope"]){const r=s.params["scope"].split(Ex).filter(o=>o.trim().length);if(r.length){this._log(xe.Info,`Found scope challenge in WWW-Authenticate header: ${s.params["scope"]}`);return r}}}return void 0}}async function p$(t,e,i){const{sameOriginHeaders:n,fetch:s,log:r}=i;let o=ud.None;let a;const{resourceMetadataChallenge:l,scopesChallenge:c}=g$(e.get("WWW-Authenticate")??void 0,r);let u;let d;let f=c;try{const{metadata:y,discoveryUrl:k,errors:S}=await oF(t,l,{sameOriginHeaders:n,fetch:(R,K)=>s(R,K)});for(const R of S){r(xe.Warning,`Error fetching resource metadata: ${R}`)}r(xe.Info,`Discovered resource metadata at ${k}`);o=l?ud.Header:ud.WellKnown;u=y.authorization_servers?.[0];if(!u){r(xe.Warning,`No authorization_servers found in resource metadata ${k} - Is this resource metadata configured correctly?`)}else{r(xe.Info,`Using auth server metadata url: ${u}`);a=dd.ResourceMetadata}f??=y.scopes_supported;d=y}catch(y){r(xe.Warning,`Could not fetch resource metadata: ${String(y)}`)}const p=new URL(t).origin;let m={};if(!u){u=p;if(n){m=n}}try{r(xe.Debug,`Fetching auth server metadata for: ${u} ...`);const{metadata:y,discoveryUrl:k,errors:S}=await cF(u,{additionalHeaders:m,fetch:(R,K)=>s(R,K)});for(const R of S){r(xe.Warning,`Error fetching authorization server metadata: ${R}`)}r(xe.Info,`Discovered authorization server metadata at ${k}`);a??=dd.WellKnown;return new bI(b.parse(u),y,d,f,{resourceMetadataSource:o,serverMetadataSource:a},r)}catch(y){r(xe.Warning,`Error populating auth server metadata for ${u}: ${String(y)}`)}const v=nF(new URL(p));r(xe.Info,"Using default auth metadata");return new bI(b.parse(p),v,d,f,{resourceMetadataSource:o,serverMetadataSource:dd.Default},r)}function g$(t,e){if(!t){return{}}let i;let n;const s=qA(t);for(const r of s){if(r.scheme==="Bearer"){if(!i&&r.params["resource_metadata"]){i=r.params["resource_metadata"];e(xe.Debug,`Found resource_metadata challenge in WWW-Authenticate header: ${i}`)}if(!n&&r.params["scope"]){const o=r.params["scope"].split(Ex).filter(a=>a.trim().length);if(o.length){e(xe.Debug,`Found scope challenge in WWW-Authenticate header: ${r.params["scope"]}`);n=o}}if(i&&n){break}}}return{resourceMetadataChallenge:i,scopesChallenge:n}}const g5=te("IExtHostDataChannels");class m${constructor(){this._channels=new Map}createDataChannel(e,i){O(e,"dataChannels");let n=this._channels.get(i);if(!n){n=new _$(i);this._channels.set(i,n)}return n}$onDidReceiveData(e,i){const n=this._channels.get(e);if(n){n._fireDidReceiveData(i)}}}class _$ extends me{constructor(e){super();this.channelId=e;this._onDidReceiveData=new L;this.onDidReceiveData=this._onDidReceiveData.event;this._register(this._onDidReceiveData)}_fireDidReceiveData(e){this._onDidReceiveData.fire({data:e})}toString(){return`DataChannel(${this.channelId})`}}xt(Tx,r0,bt.Delayed);xt(Ko,c_,bt.Delayed);xt(_f,c0,bt.Delayed);xt(Zo,jy,bt.Eager);xt(nv,Zy,bt.Eager);xt(kx,s0,bt.Eager);xt(jr,Ny,bt.Eager);xt(Z_,Fy,bt.Eager);xt(ov,D0,bt.Eager);xt(u5,P0,bt.Eager);xt(n5,f0,bt.Eager);xt(Iu,g0,bt.Eager);xt(Px,o0,bt.Eager);xt(bu,U8,bt.Eager);xt(i5,h0,bt.Delayed);xt(f5,A0,bt.Eager);xt(wx,UA,bt.Eager);xt(o5,E0,bt.Eager);xt(Du,Ky,bt.Eager);xt(p5,R0,bt.Eager);xt(yx,Wy,bt.Eager);xt(tv,Jy,bt.Eager);xt(iv,Xy,bt.Eager);xt(ur,Ay,bt.Eager);xt(Ix,JA,bt.Eager);xt(wf,C0,bt.Eager);xt(av,I0,bt.Eager);xt(N0,M0,bt.Eager);xt(g5,m$,bt.Eager);function m5(t,e,i,n,s,r){if(Array.isArray(t)){let o=0;for(const a of t){const l=m5(a,e,i,n,s,r);if(l===10){return l}if(l>o){o=l}}return o}else if(typeof t==="string"){if(t==="*"){return 5}else if(t===i){return 10}else{return 0}}else if(t){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:u}=t;if(u&&s){e=s}let d=0;if(l){if(l===e.scheme){d=10}else if(l==="*"){d=5}else{return 0}}if(o){if(o===i){d=10}else if(o==="*"){d=Math.max(d,5)}else{return 0}}if(u){if(u===r){d=10}else if(u==="*"&&r!==void 0){d=Math.max(d,5)}else{return 0}}if(a){let f;if(typeof a==="string"){f=a}else{f={...a,base:Mc(a.base)}}if(f===e.fsPath||dc(f,e.fsPath)){d=10}else{return 0}}return d}else{return 0}}function _5(t){if(typeof t==="string"){return false}else if(Array.isArray(t)){return t.some(_5)}else{return!!t.notebookType}}var O0;(function(t){t[t["None"]=0]="None";t[t["Indent"]=1]="Indent";t[t["IndentOutdent"]=2]="IndentOutdent";t[t["Outdent"]=3]="Outdent"})(O0||(O0={}));var F0;(function(t){t[t["Complete"]=100]="Complete";t[t["Partial"]=50]="Partial";t[t["None"]=0]="None"})(F0||(F0={}));var Ct;(function(t){t["instructions"]="instructions";t["prompt"]="prompt";t["agent"]="agent";t["skill"]="skill";t["hook"]="hook"})(Ct||(Ct={}));class v${constructor(e){this._relatedInformationProviders=new Map;this._nextHandle=0;this._proxy=e.getProxy(ee.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,i,n){if(this._relatedInformationProviders.size===0){throw new Error("No related information providers registered")}const s=this._relatedInformationProviders.get(e);if(!s){throw new Error("related information provider not found")}const r=await s.provideRelatedInformation(i,n)??[];return r}getRelatedInformation(e,i,n){return this._proxy.$getAiRelatedInformation(i,n)}registerRelatedInformationProvider(e,i,n){const s=this._nextHandle;this._nextHandle++;this._relatedInformationProviders.set(s,n);this._proxy.$registerAiRelatedInformationProvider(s,i);return new Ve(()=>{this._proxy.$unregisterAiRelatedInformationProvider(s);this._relatedInformationProviders.delete(s)})}}class w${constructor(e){this._settingsSearchProviders=new Map;this._nextHandle=0;this._proxy=e.getProxy(ee.MainThreadAiSettingsSearch)}async $startSearch(e,i,n,s){if(this._settingsSearchProviders.size===0){throw new Error("No related information providers registered")}const r=this._settingsSearchProviders.get(e);if(!r){throw new Error("Settings search provider not found")}const o=new BS(a=>{this._proxy.$handleSearchResult(e,xy.fromSettingsSearchResult(a))});return r.provideSettingsSearchResults(i,n,o,s)}registerSettingsSearchProvider(e,i){const n=this._nextHandle;this._nextHandle++;this._settingsSearchProviders.set(n,i);this._proxy.$registerAiSettingsSearchProvider(n);return new Ve(()=>{this._proxy.$unregisterAiSettingsSearchProvider(n);this._settingsSearchProviders.delete(n)})}}var tf;(function(t){t[t["Full"]=1]="Full";t[t["Delta"]=2]="Delta"})(tf||(tf={}));function v5(t){for(let e=0,i=t.length;e<i;e+=4){const n=t[e+0];const s=t[e+1];const r=t[e+2];const o=t[e+3];t[e+0]=o;t[e+1]=r;t[e+2]=s;t[e+3]=n}}function b$(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.length*4);if(!e4()){v5(e)}return ae.wrap(e)}function y$(t){const e=t.buffer;if(!e4()){v5(e)}if(e.byteOffset%4===0){return new Uint32Array(e.buffer,e.byteOffset,e.length/4)}else{const i=new Uint8Array(e.byteLength);i.set(e);return new Uint32Array(i.buffer,i.byteOffset,i.length/4)}}function U0(t){const e=new Uint32Array(S$(t));let i=0;e[i++]=t.id;if(t.type==="full"){e[i++]=tf.Full;e[i++]=t.data.length;e.set(t.data,i);i+=t.data.length}else{e[i++]=tf.Delta;e[i++]=t.deltas.length;for(const n of t.deltas){e[i++]=n.start;e[i++]=n.deleteCount;if(n.data){e[i++]=n.data.length;e.set(n.data,i);i+=n.data.length}else{e[i++]=0}}}return b$(e)}function S$(t){let e=0;e+=1+1;if(t.type==="full"){e+=1+t.data.length}else{e+=1;e+=(1+1+1)*t.deltas.length;for(const i of t.deltas){if(i.data){e+=i.data.length}}}return e}function yI(t){const e=y$(t);let i=0;const n=e[i++];const s=e[i++];if(s===tf.Full){const a=e[i++];const l=e.subarray(i,i+a);i+=a;return{id:n,type:"full",data:l}}const r=e[i++];const o=[];for(let a=0;a<r;a++){const l=e[i++];const c=e[i++];const u=e[i++];let d;if(u>0){d=e.subarray(i,i+u);i+=u}o[a]={start:l,deleteCount:c,data:d}}return{id:n,type:"delta",deltas:o}}const x$=[new Pe("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[z.Uri,z.Position],new De("A promise that resolves to an array of DocumentHighlight-instances.",ss(su.to))),new Pe("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[z.Uri],new De("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(t,e)=>{if(_S(t)){return void 0}class i extends sh{constructor(){super(...arguments);this.containerName=""}static to(s){const r=new i(s.name,es.to(s.kind),s.containerName||"",new Tn(e[0],V.to(s.range)));r.detail=s.detail;r.range=r.location.range;r.selectionRange=V.to(s.selectionRange);r.children=s.children?s.children.map(i.to):[];return r}}return t.map(i.to)})),new Pe("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[z.Uri,new z("options","Formatting options",t=>true,t=>t)],new De("A promise that resolves to an array of TextEdits.",ss(vi.to))),new Pe("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[z.Uri,z.Range,new z("options","Formatting options",t=>true,t=>t)],new De("A promise that resolves to an array of TextEdits.",ss(vi.to))),new Pe("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[z.Uri,z.Position,new z("ch","Trigger character",t=>typeof t==="string",t=>t),new z("options","Formatting options",t=>true,t=>t)],new De("A promise that resolves to an array of TextEdits.",ss(vi.to))),new Pe("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location or LocationLink instances.",io)),new Pe("vscode.experimental.executeDefinitionProvider_recursive","_executeDefinitionProvider_recursive","Execute all definition providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location or LocationLink instances.",io)),new Pe("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location or LocationLink instances.",io)),new Pe("vscode.experimental.executeTypeDefinitionProvider_recursive","_executeTypeDefinitionProvider_recursive","Execute all type definition providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location or LocationLink instances.",io)),new Pe("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location or LocationLink instances.",io)),new Pe("vscode.experimental.executeDeclarationProvider_recursive","_executeDeclarationProvider_recursive","Execute all declaration providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location or LocationLink instances.",io)),new Pe("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location or LocationLink instances.",io)),new Pe("vscode.experimental.executeImplementationProvider_recursive","_executeImplementationProvider_recursive","Execute all implementation providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location or LocationLink instances.",io)),new Pe("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location-instances.",ss(wn.to))),new Pe("vscode.experimental.executeReferenceProvider","_executeReferenceProvider_recursive","Execute all reference providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Location-instances.",ss(wn.to))),new Pe("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Hover-instances.",ss(Oh.to))),new Pe("vscode.experimental.executeHoverProvider_recursive","_executeHoverProvider_recursive","Execute all hover providers.",[z.Uri,z.Position],new De("A promise that resolves to an array of Hover-instances.",ss(Oh.to))),new Pe("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[z.Uri,new z("position","A position in a text document",t=>Array.isArray(t)&&t.every(e=>je.isPosition(e)),t=>t.map(ut.from))],new De("A promise that resolves to an array of ranges.",t=>{return t.map(e=>{let i;for(const n of e.reverse()){i=new ch(V.to(n),i)}return i})})),new Pe("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[z.String.with("query","Search string")],new De("A promise that resolves to an array of SymbolInformation-instances.",t=>{return t.map(pl.to)})),new Pe("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[z.Uri,z.Position],new De("A promise that resolves to an array of CallHierarchyItem-instances",t=>t.map(gl.to))),new Pe("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[z.CallHierarchyItem],new De("A promise that resolves to an array of CallHierarchyIncomingCall-instances",t=>t.map(Wb.to))),new Pe("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[z.CallHierarchyItem],new De("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",t=>t.map(Vb.to))),new Pe("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[z.Uri,z.Position],new De("A promise that resolves to a range and placeholder text.",t=>{if(!t){return void 0}return{range:V.to(t.range),placeholder:t.text}})),new Pe("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[z.Uri,z.Position,z.String.with("newName","The new symbol name")],new De("A promise that resolves to a WorkspaceEdit.",t=>{if(!t){return void 0}if(t.rejectReason){throw new Error(t.rejectReason)}return Pn.to(t)})),new Pe("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[z.Uri,z.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new De("A promise that resolves to an array of DocumentLink-instances.",t=>t.map(Xa.to))),new Pe("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[z.Uri],new De("A promise that resolves to SemanticTokensLegend.",t=>{if(!t){return void 0}return new lb(t.tokenTypes,t.tokenModifiers)})),new Pe("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[z.Uri],new De("A promise that resolves to SemanticTokens.",t=>{if(!t){return void 0}const e=yI(t);if(e.type!=="full"){return void 0}return new Zc(e.data,void 0)})),new Pe("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[z.Uri,z.Range.optional()],new De("A promise that resolves to SemanticTokensLegend.",t=>{if(!t){return void 0}return new lb(t.tokenTypes,t.tokenModifiers)})),new Pe("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[z.Uri,z.Range],new De("A promise that resolves to SemanticTokens.",t=>{if(!t){return void 0}const e=yI(t);if(e.type!=="full"){return void 0}return new Zc(e.data,void 0)})),new Pe("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[z.Uri,z.Position,z.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),z.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new De("A promise that resolves to a CompletionList-instance.",(t,e,i)=>{if(!t){return new jc([])}const n=t.suggestions.map(s=>Qb.to(s,i));return new jc(n,t.incomplete)})),new Pe("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[z.Uri,z.Position,z.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new De("A promise that resolves to SignatureHelp.",t=>{if(t){return Fh.to(t)}return void 0})),new Pe("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[z.Uri,z.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new De("A promise that resolves to an array of CodeLens-instances.",(t,e,i)=>{return ss(n=>{return new Hg(V.to(n.range),n.command&&i.fromInternal(n.command))})(t)})),new Pe("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[z.Uri,new z("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",t=>Fe.isRange(t),t=>or.isSelection(t)?Ms.from(t):V.from(t)),z.String.with("kind","Code action kind to return code actions for").optional(),z.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new De("A promise that resolves to an array of Command-instances.",(t,e,i)=>{return ss(n=>{if(n._isSynthetic){if(!n.command){throw new Error("Synthetic code actions must have a command")}return i.fromInternal(n.command)}else{const s=new lh(n.title,n.kind?new $t(n.kind):void 0);if(n.edit){s.edit=Pn.to(n.edit)}if(n.command){s.command=i.fromInternal(n.command)}s.isPreferred=n.isPreferred;return s}})(t)})),new Pe("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[z.Uri],new De("A promise that resolves to an array of ColorInformation objects.",t=>{if(t){return t.map(e=>new jg(V.to(e.range),ru.to(e.color)))}return[]})),new Pe("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new z("color","The color to show and insert",t=>t instanceof Qc,ru.from),new z("context","Context object with uri and range",t=>true,t=>({uri:t.uri,range:V.from(t.range)}))],new De("A promise that resolves to an array of ColorPresentation objects.",t=>{if(t){return t.map(Am.to)}return[]})),new Pe("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[z.Uri,z.Range],new De("A promise that resolves to an array of Inlay objects",(t,e,i)=>{return t.map(Jb.to.bind(void 0,i))})),new Pe("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[z.Uri],new De("A promise that resolves to an array of FoldingRange objects",(t,e)=>{if(t){return t.map(Nm.to)}return void 0})),new Pe("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new De("A promise that resolves to an array of NotebookContentProvider static info objects.",ss(t=>{return{viewType:t.viewType,displayName:t.displayName,options:{transientOutputs:t.options.transientOutputs,transientCellMetadata:t.options.transientCellMetadata,transientDocumentMetadata:t.options.transientDocumentMetadata},filenamePattern:t.filenamePattern.map(e=>Om.to(e))}}))),new Pe("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[z.Uri,z.Range,new z("context","An InlineValueContext",t=>t&&typeof t.frameId==="number"&&t.stoppedLocation instanceof Fe,t=>Cm.from(t))],new De("A promise that resolves to an array of InlineValue objects",t=>{return t.map(Em.to)})),new Pe("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new z("uriOrString","Uri-instance or string (only http/https)",t=>b.isUri(t)||typeof t==="string"&&HL(t,ne.http,ne.https),t=>t),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",t=>t===void 0||typeof t==="number"||typeof t==="object",t=>!t?t:typeof t==="number"?[_i.from(t),void 0]:[_i.from(t.viewColumn),Rd.from(t)]).optional(),z.String.with("label","").optional()],De.Void),new Pe("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[z.Uri.with("resource","Resource to open"),z.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",t=>t===void 0||typeof t==="number"||typeof t==="object",t=>!t?t:typeof t==="number"?[_i.from(t),void 0]:[_i.from(t.viewColumn),Rd.from(t)]).optional()],De.Void),new Pe("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[z.Uri.with("left","Left-hand side resource of the diff editor"),z.Uri.with("right","Right-hand side resource of the diff editor"),z.String.with("title","Human readable title for the diff editor").optional(),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",t=>t===void 0||typeof t==="object",t=>t&&[_i.from(t.viewColumn),Rd.from(t)]).optional()],De.Void),new Pe("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[z.String.with("title","Human readable title for the changes editor"),new z("resourceList","List of resources to compare",t=>{for(const e of t){if(e.length!==3){return false}const[i,n,s]=e;if(!b.isUri(i)||!b.isUri(n)&&n!==void 0&&n!==null||!b.isUri(s)&&s!==void 0&&s!==null){return false}}return true},t=>t)],De.Void),new Pe("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[z.Uri,z.Position],new De("A promise that resolves to an array of TypeHierarchyItem-instances",t=>t.map(Za.to))),new Pe("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[z.TypeHierarchyItem],new De("A promise that resolves to an array of TypeHierarchyItem-instances",t=>t.map(Za.to))),new Pe("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[z.TypeHierarchyItem],new De("A promise that resolves to an array of TypeHierarchyItem-instances",t=>t.map(Za.to))),new Pe("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[z.TestItem],De.Void),new Pe("vscode.startContinuousTestRun","testing.startContinuousRunFromExtension","Starts running the given tests with continuous run mode.",[z.TestProfile,z.Arr(z.TestItem)],De.Void),new Pe("vscode.stopContinuousTestRun","testing.stopContinuousRunFromExtension","Stops running the given tests with continuous run mode.",[z.Arr(z.TestItem)],De.Void),new Pe("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[z.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],De.Void),new Pe("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[z.String.with("name","The context key name"),new z("value","The context key value",()=>true,t=>t)],De.Void),new Pe("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new z("Run arguments","",t=>true,t=>{if(!t){return void 0}return{initialRange:t.initialRange?V.from(t.initialRange):void 0,initialSelection:or.isSelection(t.initialSelection)?Ms.from(t.initialSelection):void 0,message:t.message,attachments:t.attachments,autoSend:t.autoSend,position:t.position?ut.from(t.position):void 0,resolveOnResponse:t.resolveOnResponse}})],De.Void),new Pe("vscode.extensionPromptFileProvider","_listExtensionPromptFiles","Get all extension-contributed prompt files (custom agents, instructions, and prompt files).",[],new De("A promise that resolves to an array of objects containing uri and type.",t=>{if(!t){return[]}return t.map(e=>({uri:b.revive(e.uri),type:e.type}))}))];class E${static register(e){x$.forEach(e.registerApiCommand,e);this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(false,"_validateWhenClauses",c6)}}function ss(t){return e=>{if(Array.isArray(e)){return e.map(t)}return void 0}}function io(t){if(!Array.isArray(t)){return void 0}const e=[];for(const i of t){if(s9(i)){e.push(Mh.to(i))}else{e.push(wn.to(i))}}return e}let $0=class pq{constructor(e,i){this._proxy=e.getProxy(ee.MainThreadBulkEdits);this._versionInformationProvider={getTextDocumentVersion:n=>i.getDocument(n)?.version,getNotebookDocumentVersion:()=>void 0}}applyWorkspaceEdit(e,i,n){const s=new ji(Pn.from(e,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(s,void 0,n?.isRefactoring??false)}};$0=W([P(0,st)],$0);function C$(t){return!!t&&b.isUri(t.sessionResource)&&t.$mid===nt.ChatViewContext}var SI;(function(t){t[t["Info"]=0]="Info";t[t["Warning"]=1]="Warning";t[t["Error"]=2]="Error"})(SI||(SI={}));var xI;(function(t){t[t["Complete"]=1]="Complete";t[t["Partial"]=2]="Partial";t[t["Omitted"]=3]="Omitted"})(xI||(xI={}));var EI;(function(t){t[t["NoReason"]=0]="NoReason";t[t["FilteredContentRetry"]=1]="FilteredContentRetry";t[t["CopyrightContentRetry"]=2]="CopyrightContentRetry"})(EI||(EI={}));var CI;(function(t){t["Pending"]="pending";t["Accepted"]="accepted";t["Rejected"]="rejected"})(CI||(CI={}));var wa;(function(t){t[t["Denied"]=0]="Denied";t[t["ConfirmationNotNeeded"]=1]="ConfirmationNotNeeded";t[t["Setting"]=2]="Setting";t[t["LmServicePerTool"]=3]="LmServicePerTool";t[t["UserAction"]=4]="UserAction";t[t["Skipped"]=5]="Skipped"})(wa||(wa={}));var kI;(function(t){let e;(function(f){f[f["Streaming"]=0]="Streaming";f[f["WaitingForConfirmation"]=1]="WaitingForConfirmation";f[f["Executing"]=2]="Executing";f[f["WaitingForPostApproval"]=3]="WaitingForPostApproval";f[f["Completed"]=4]="Completed";f[f["Cancelled"]=5]="Cancelled"})(e=t.StateKind||(t.StateKind={}));function i(f,p){if(f.kind==="toolInvocationSerialized"){if(f.isConfirmed===void 0||typeof f.isConfirmed==="boolean"){return{type:f.isConfirmed?wa.UserAction:wa.Denied}}return f.isConfirmed}const m=f.state.read(p);if(m.type===e.Streaming||m.type===e.WaitingForConfirmation){return void 0}if(m.type===e.Cancelled){return{type:m.reason}}return m.confirmed}t.executionConfirmedOrDenied=i;function n(f,p){const m=i(f);if(m){return Promise.resolve(m)}const v=new pe;return new Promise(y=>{if(p){v.add(p.onCancellationRequested(()=>{y({type:wa.Denied})}))}v.add(ag(k=>{const S=i(f,k);if(S){v.dispose();y(S)}}))}).finally(()=>{v.dispose()})}t.awaitConfirmation=n;function s(f,p){const m=f.state.read(p);if(m.type===e.Completed){return m.postConfirmed||{type:wa.ConfirmationNotNeeded}}if(m.type===e.Cancelled){return{type:m.reason}}return void 0}function r(f,p){const m=f?.state.get();if(m?.type===e.WaitingForConfirmation||m?.type===e.WaitingForPostApproval){m.confirm(p);return true}return false}t.confirmWith=r;function o(f,p){const m=s(f);if(m){return Promise.resolve(m)}const v=new pe;return new Promise(y=>{if(p){v.add(p.onCancellationRequested(()=>{y({type:wa.Denied})}))}v.add(ag(k=>{const S=s(f,k);if(S){v.dispose();y(S)}}))}).finally(()=>{v.dispose()})}t.awaitPostConfirmation=o;function a(f,p){if(f.kind==="toolInvocationSerialized"){return f.resultDetails}const m=f.state.read(p);if(m.type===e.Completed||m.type===e.WaitingForPostApproval){return m.resultDetails}return void 0}t.resultDetails=a;function l(f,p){if(f.kind==="toolInvocationSerialized"){return true}const m=f.state.read(p);return m.type===e.Completed||m.type===e.Cancelled}t.isComplete=l;function c(f,p){if(f.kind==="toolInvocationSerialized"){return false}const m=f.state.read(p);return m.type===e.Streaming}t.isStreaming=c;function u(f,p){if(f.kind==="toolInvocationSerialized"){return void 0}const m=f.state.read(p);if(m.type===e.Streaming){return void 0}return m.parameters}t.getParameters=u;function d(f,p){if(f.kind==="toolInvocationSerialized"){return void 0}const m=f.state.read(p);if(m.type===e.Streaming){return void 0}return m.confirmationMessages}t.getConfirmationMessages=d})(kI||(kI={}));var v_;(function(t){t[t["Down"]=0]="Down";t[t["Up"]=1]="Up"})(v_||(v_={}));var DI;(function(t){t["IncorrectCode"]="incorrectCode";t["DidNotFollowInstructions"]="didNotFollowInstructions";t["IncompleteCode"]="incompleteCode";t["MissingContext"]="missingContext";t["PoorlyWrittenOrFormatted"]="poorlyWrittenOrFormatted";t["RefusedAValidRequest"]="refusedAValidRequest";t["OffensiveOrUnsafe"]="offensiveOrUnsafe";t["Other"]="other";t["WillReportIssue"]="willReportIssue"})(DI||(DI={}));var II;(function(t){t[t["Action"]=1]="Action";t[t["Toolbar"]=2]="Toolbar"})(II||(II={}));var TI;(function(t){t[t["Pending"]=0]="Pending";t[t["Complete"]=1]="Complete";t[t["Cancelled"]=2]="Cancelled";t[t["Failed"]=3]="Failed";t[t["NeedsInput"]=4]="NeedsInput"})(TI||(TI={}));var PI;(function(t){function e(r){return r.kind==="sent"}t.isSent=e;function i(r){return r.kind==="rejected"}t.isRejected=i;function n(r){return r.kind==="queued"}t.isQueued=n;function s(r){if(r.kind!=="sent"){throw new Error(`Expected ChatSendResult to be 'sent', but was '${r.kind}'`)}}t.assertSent=s})(PI||(PI={}));var AI;(function(t){t["Queued"]="queued";t["Steering"]="steering"})(AI||(AI={}));class H0{constructor(e,i,n,s,r,o,a){this._extension=e;this._request=i;this._proxy=n;this._commandsConverter=s;this._sessionDisposables=r;this._pendingCarouselResolvers=o;this._token=a;this._stopWatch=Wr.create(false);this._isClosed=false}close(){this._isClosed=true}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let n=function(l){if(e._isClosed){const c=new Error("Response stream has been closed");Error.captureStackTrace(c,l);throw c}},o=function(l,c){const u=s.push(c!==void 0?[l,c]:l);if(u===1){queueMicrotask(()=>{const d=r;r=[];e._proxy.$handleProgressChunk(e._request.requestId,s).finally(()=>{d.forEach(f=>f())});s.length=0})}if(c!==void 0){return new Promise(d=>{r.push(d)})}return};const e=this;this._stopWatch.reset();let i=0;const s=[];let r=[];const a=(l,c)=>{if(typeof this._firstProgress==="undefined"&&(l.kind==="markdownContent"||l.kind==="markdownVuln"||l.kind==="beginToolInvocation")){this._firstProgress=this._stopWatch.elapsed()}if(c){const u=i++;const d=o(l,u);const f={report:p=>{d.then(()=>{if(rn.isMarkdownString(p.value)){o(zh.from(p),u)}else{o(tl.from(p),u)}})}};Promise.all([d,c(f)]).then(([p,m])=>{o(dy.from(m),u)})}else{o(l)}};this._apiObject=Object.freeze({clearToPreviousToolInvocation(l){n(this.markdown);o({kind:"clearToPreviousToolInvocation",reason:l});return this},markdown(l){n(this.markdown);const c=new V_(l);const u=Hh.from(c);a(u);return this},markdownWithVulnerabilities(l,c){n(this.markdown);if(c){O(e._extension,"chatParticipantAdditions")}const u=new Th(l,c);const d=Wm.from(u);a(d);return this},codeblockUri(l,c){n(this.codeblockUri);O(e._extension,"chatParticipantAdditions");const u=new G_(l,c);const d=Bm.from(u);a(d);return this},filetree(l,c){n(this.filetree);const u=new z_(l,c);const d=Bh.from(u);a(d);return this},anchor(l,c){const u=new Ph(l,c);return this.push(u)},button(l){n(this.anchor);const c=new j_(l);const u=qh.from(c,e._commandsConverter,e._sessionDisposables);a(u);return this},progress(l,c){n(this.progress);const u=new bp(l,c);const d=c?jm.from(u):Wh.from(u);a(d,c);return this},thinkingProgress(l){n(this.thinkingProgress);O(e._extension,"chatParticipantAdditions");const c=new kc(l.text??"",l.id,l.metadata);const u=Vh.from(c);a(u);return this},hookProgress(l,c,u){n(this.hookProgress);O(e._extension,"chatParticipantAdditions");const d=new q_(l,c,u);const f=qm.from(d);a(f);return this},warning(l){n(this.progress);O(e._extension,"chatParticipantAdditions");const c=new Ah(l);const u=zh.from(c);a(u);return this},reference(l,c){return this.reference2(l,c)},reference2(l,c,u){n(this.reference);if(typeof l==="object"&&"variableName"in l){O(e._extension,"chatParticipantAdditions")}if(typeof l==="object"&&"variableName"in l&&!l.value){const d=e._request.variables.variables.find(f=>f.name===l.variableName);if(d){let f;if(d.references?.length){f=d.references.map(p=>({kind:"reference",reference:{variableName:l.variableName,value:p.reference}}))}else{const p=new Ya(l,c,u);const m=tl.from(p);f=[m]}f.forEach(p=>a(p));return this}}else{const d=new Ya(l,c,u);const f=tl.from(d);a(f)}return this},codeCitation(l,c,u){n(this.codeCitation);O(e._extension,"chatParticipantAdditions");const d=new gm(l,c,u);const f=Ym.from(d);a(f)},textEdit(l,c){n(this.textEdit);O(e._extension,"chatParticipantAdditions");const u=new Lh(l,c);u.isDone=c===true?true:void 0;const d=Gm.from(u);a(d);return this},notebookEdit(l,c){n(this.notebookEdit);O(e._extension,"chatParticipantAdditions");const u=new mm(l,c);const d=Qm.from(u);a(d);return this},workspaceEdit(l){n(this.workspaceEdit);O(e._extension,"chatParticipantAdditions");const c=new fx(l);const u=Jm.from(c);a(u);return this},async externalEdit(l,c){n(this.externalEdit);const u=Array.isArray(l)?l:[l];const d=i++;const f=Pi();await o({kind:"externalEdits",start:true,resources:u,undoStopId:f},d);try{await c();return f}finally{await o({kind:"externalEdits",start:false,resources:u,undoStopId:f},d)}},confirmation(l,c,u,d){n(this.confirmation);O(e._extension,"chatParticipantAdditions");const f=new pm(l,c,u,d);const p=Vm.from(f);a(p);return this},async questionCarousel(l,c=true){n(this.questionCarousel);O(e._extension,"chatParticipantAdditions");const u=Pi();const d=new Rh(l,c);const f=zm.from(d);f.resolveId=u;const p=new Bn;if(!e._pendingCarouselResolvers.has(e._request.requestId)){e._pendingCarouselResolvers.set(e._request.requestId,new Map)}e._pendingCarouselResolvers.get(e._request.requestId).set(u,p);a(f);return w4(p.p,e._token)},beginToolInvocation(l,c,u){n(this.beginToolInvocation);O(e._extension,"chatParticipantAdditions");const d={kind:"beginToolInvocation",toolCallId:l,toolName:c,streamData:u?{partialInput:u.partialInput}:void 0,subagentInvocationId:u?.subagentInvocationId};a(d);return this},updateToolInvocation(l,c){n(this.updateToolInvocation);O(e._extension,"chatParticipantAdditions");const u={kind:"updateToolInvocation",toolCallId:l,streamData:{partialInput:c.partialInput}};a(u);return this},push(l){n(this.push);if(l instanceof Lh||l instanceof mm||l instanceof Th||l instanceof Ah||l instanceof pm||l instanceof Rh||l instanceof gm||l instanceof K_||l instanceof dx||l instanceof xb||l instanceof kc||l instanceof hx||l instanceof bp){O(e._extension,"chatParticipantAdditions")}if(l instanceof Ya){this.reference2(l.value,l.iconPath,l.options)}else if(l instanceof bp){const c=l.task?jm.from(l):Wh.from(l);a(c,l.task)}else if(l instanceof kc){const c=Vh.from(l);a(c)}else if(l instanceof Ph){const c=pu.from(l);if(l.resolve){O(e._extension,"chatParticipantAdditions");c.resolveId=Pi();const u=new Tt;l.resolve(u.token).then(()=>{const d=pu.from(l);e._proxy.$handleAnchorResolve(e._request.requestId,c.resolveId,d)}).then(()=>u.dispose(),()=>u.dispose());e._sessionDisposables.add(ye(()=>u.dispose(true)))}a(c)}else if(l instanceof xb){const c=this.externalEdit(l.uris,l.callback);c.then(u=>l.didGetApplied(u));return this}else{const c=jh.from(l,e._commandsConverter,e._sessionDisposables);a(c)}return this}})}return this._apiObject}}class ic extends me{static{this._idPool=0}static{this._participantDetectionProviderIdPool=0}static{this._contributionsProviderIdPool=0}constructor(e,i,n,s,r,o,a,l){super();this._logService=i;this._commands=n;this._documents=s;this._editorsAndDocuments=r;this._languageModels=o;this._diagnostics=a;this._tools=l;this._agents=new Map;this._participantDetectionProviders=new Map;this._promptFileProviders=new Map;this._sessionDisposables=this._register(new lR);this._completionDisposables=this._register(new af);this._inFlightRequests=new Set;this._pendingCarouselResolvers=new Map;this._onDidChangeChatRequestTools=this._register(new L);this.onDidChangeChatRequestTools=this._onDidChangeChatRequestTools.event;this._onDidDisposeChatSession=this._register(new L);this.onDidDisposeChatSession=this._onDidDisposeChatSession.event;this._proxy=e.getProxy(ee.MainThreadChatAgents2);n.registerArgumentProcessor({processArgument:c=>{if(C$(c)){return null}return c}})}async transferActiveChat(e){await this._proxy.$transferActiveChatSession(e)}createChatAgent(e,i,n){const s=ic._idPool++;const r=new RI(e,i,this._proxy,s,n);this._agents.set(s,r);this._proxy.$registerAgent(s,e.identifier,i,{},void 0);return r.apiAgent}createDynamicChatAgent(e,i,n,s){const r=ic._idPool++;const o=new RI(e,i,this._proxy,r,s);this._agents.set(r,o);this._proxy.$registerAgent(r,e.identifier,i,{isSticky:true},n);return o.apiAgent}registerChatParticipantDetectionProvider(e,i){const n=ic._participantDetectionProviderIdPool++;this._participantDetectionProviders.set(n,new k$(e,i));this._proxy.$registerChatParticipantDetectionProvider(n);return ye(()=>{this._participantDetectionProviders.delete(n);this._proxy.$unregisterChatParticipantDetectionProvider(n)})}registerPromptFileProvider(e,i,n){const s=ic._contributionsProviderIdPool++;this._promptFileProviders.set(s,{extension:e,provider:n});this._proxy.$registerPromptFileProvider(s,i,e.identifier);const r=new pe;let o;switch(i){case Ct.agent:o=n.onDidChangeCustomAgents;break;case Ct.instructions:o=n.onDidChangeInstructions;break;case Ct.prompt:o=n.onDidChangePromptFiles;break;case Ct.skill:o=n.onDidChangeSkills;break}if(o){r.add(o(()=>{this._proxy.$onDidChangePromptFiles(s)}))}r.add(ye(()=>{this._promptFileProviders.delete(s);this._proxy.$unregisterPromptFileProvider(s)}));return r}async $providePromptFiles(e,i,n,s){const r=this._promptFileProviders.get(e);if(!r){return void 0}const o=r.provider;let a;switch(i){case Ct.agent:a=await o.provideCustomAgents(n,s)??void 0;break;case Ct.instructions:a=await o.provideInstructions(n,s)??void 0;break;case Ct.prompt:a=await o.providePromptFiles(n,s)??void 0;break;case Ct.skill:a=await o.provideSkills(n,s)??void 0;break}return a}async $detectChatParticipant(e,i,n,s,r){const o=this._participantDetectionProviders.get(e);if(!o){return void 0}const{request:a,location:l,history:c}=await this._createRequest(i,n,o.extension);const u=await this.getModelForRequest(a,o.extension);const d=await this.getToolsForRequest(o.extension,a.userSelectedTools,u.id,r);const f=Gh.to(a,l,u,this.getDiagnosticsWhenEnabled(o.extension),d,o.extension,this._logService);return o.provider.provideParticipantDetection(f,{history:c,yieldRequested:false},{participants:s.participants,location:Kh.to(s.location)},r)}async _createRequest(e,i,n){const s=Wi(e);const r=await this.prepareHistoryTurns(n,s.agentId,i);let o;if(s.locationData?.type===ki.EditorInline){const a=this._documents.getDocument(s.locationData.document);const l=this._editorsAndDocuments.getEditor(s.locationData.id);o=new vA(l.value,a,Ms.to(s.locationData.selection),V.to(s.locationData.wholeRange))}else if(s.locationData?.type===ki.Notebook){const a=this._documents.getDocument(s.locationData.sessionInputUri);o=new wA(a)}else;return{request:s,location:o,history:r}}async getModelForRequest(e,i){let n;if(e.userSelectedModelId){n=await this._languageModels.getLanguageModelByIdentifier(i,e.userSelectedModelId)}if(!n){n=await this._languageModels.getDefaultLanguageModel(i);if(!n){throw new Error("Language model unavailable")}}return n}async $setRequestTools(e,i){const n=[...this._inFlightRequests].find(r=>r.requestId===e);if(!n){return}n.extRequest.tools.clear();const s=await this.getToolsForRequest(n.extension,i,n.extRequest.model.id,Ze.None);for(const[r,o]of s){n.extRequest.tools.set(r,o)}this._onDidChangeChatRequestTools.fire(n.extRequest)}$setYieldRequested(e){const i=[...this._inFlightRequests].find(n=>n.requestId===e);if(i){i.yieldRequested=true}}async $invokeAgent(e,i,n,s){const r=this._agents.get(e);if(!r){throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`)}let o;let a;try{const{request:l,location:c,history:u}=await this._createRequest(i,n,r.extension);let d=this._sessionDisposables.get(l.sessionResource);if(!d){d=new pe;this._sessionDisposables.set(l.sessionResource,d)}o=new H0(r.extension,l,this._proxy,this._commands.converter,d,this._pendingCarouselResolvers,s);const f=await this.getModelForRequest(l,r.extension);const p=await this.getToolsForRequest(r.extension,l.userSelectedTools,f.id,s);const m=Gh.to(l,c,f,this.getDiagnosticsWhenEnabled(r.extension),p,r.extension,this._logService);a={requestId:i.requestId,extRequest:m,extension:r.extension,hooks:l.hooks,yieldRequested:false};this._inFlightRequests.add(a);let v;if(n.chatSessionContext){v={chatSessionItem:{resource:b.revive(n.chatSessionContext.chatSessionResource),label:n.chatSessionContext.isUntitled?"Untitled Session":"Session"},isUntitled:n.chatSessionContext.isUntitled}}const y={history:u,chatSessionContext:v,get yieldRequested(){return a?.yieldRequested??false}};const k=r.invoke(m,y,o.apiObject,s);return await D$(1e3,Promise.resolve(k).then(S=>{if(S?.metadata){try{JSON.stringify(S.metadata)}catch(K){const q=`result.metadata MUST be JSON.stringify-able. Got error: ${K.message}`;this._logService.error(`[${r.extension.identifier.value}] [@${r.id}] ${q}`,r.extension);return{errorDetails:{message:q},timings:o?.timings,nextQuestion:S.nextQuestion}}}let R;if(S?.errorDetails){R={...S.errorDetails,responseIsIncomplete:true}}if(R?.responseIsRedacted||R?.isQuotaExceeded||R?.isRateLimited||R?.confirmationButtons||R?.code){O(r.extension,"chatParticipantPrivate")}return{errorDetails:R,timings:o?.timings,metadata:S?.metadata,nextQuestion:S?.nextQuestion,details:S?.details,usage:S?.usage}}),s)}catch(l){this._logService.error(l,r.extension);if(l instanceof Ci&&l.cause){l=l.cause}const c=l instanceof Error&&l.name==="ChatQuotaExceeded";const u=l instanceof Error&&l.name==="ChatRateLimited";return{errorDetails:{message:xu(l),responseIsIncomplete:true,isQuotaExceeded:c,isRateLimited:u}}}finally{if(a){this._inFlightRequests.delete(a)}const l=this._pendingCarouselResolvers.get(i.requestId);if(l){for(const c of l.values()){c.complete(void 0)}this._pendingCarouselResolvers.delete(i.requestId)}o?.close()}}getDiagnosticsWhenEnabled(e){if(!it(e,"chatReferenceDiagnostic")){return[]}return this._diagnostics.getDiagnostics()}async getToolsForRequest(e,i,n,s){if(!i){return new Map}const r=new Map;for(const o of this._tools.getTools(e)){if(typeof i[o.name]==="boolean"){r.set(o,i[o.name])}}return r}async prepareHistoryTurns(e,i,n){const s=[];for(const r of n.history){const o=Ic.to(r.result);const a=i===r.request.agentId||LI(r.request.agentId)&&LI(i)?o:{...o,metadata:void 0};const l=[];const c=[];for(const p of r.request.variables.variables){if(p.kind==="tool"){c.push(ml.to(p))}else if(p.kind==="toolset"){c.push(...p.value.map(ml.to))}else{const m=Xm.to(p,this.getDiagnosticsWhenEnabled(e),this._logService);if(m){l.push(m)}}}const u=it(e,"chatParticipantPrivate")?r.request.editedFileEvents:void 0;const d=new _m(r.request.message,r.request.command,l,r.request.agentId,c,u,r.request.requestId);s.push(d);const f=zt(r.response.map(p=>jh.toContent(p,this._commands.converter)));s.push(new _A(f,a,r.request.agentId,r.request.command))}return s}$releaseSession(e){const i=b.revive(e);this._sessionDisposables.deleteAndDispose(i);const n=Yd.parseLocalSessionId(i);if(n){this._onDidDisposeChatSession.fire(n)}}async $provideFollowups(e,i,n,s,r){const o=this._agents.get(i);if(!o){return Promise.resolve([])}const a=Wi(e);const l=await this.prepareHistoryTurns(o.extension,o.id,s);const c=Ic.to(n);return(await o.provideFollowups(c,{history:l,yieldRequested:false},r)).filter(u=>{const d=!u.participant||qi.some(this._agents.values(),f=>f.id===u.participant&&ht.equals(f.extension.identifier,o.extension.identifier));if(!d){this._logService.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${u.participant}`)}return d}).map(u=>$m.from(u,a))}$acceptFeedback(e,i,n){const s=this._agents.get(e);if(!s){return}const r=Ic.to(i);let o;switch(n.direction){case v_.Down:o=Ih.Unhelpful;break;case v_.Up:o=Ih.Helpful;break}const a={result:r,kind:o,unhelpfulReason:it(s.extension,"chatParticipantAdditions")?n.reason:void 0};s.acceptFeedback(Object.freeze(a))}$handleQuestionCarouselAnswer(e,i,n){const s=this._pendingCarouselResolvers.get(e);if(!s){return}const r=s.get(i);if(r){r.complete(n);s.delete(i)}if(s.size===0){this._pendingCarouselResolvers.delete(e)}}$acceptAction(e,i,n){const s=this._agents.get(e);if(!s){return}if(n.action.kind==="vote"){return}const r=py.to(i,n,this._commands.converter);if(r){s.acceptAction(Object.freeze(r))}}async $invokeCompletionProvider(e,i,n){const s=this._agents.get(e);if(!s){return[]}let r=this._completionDisposables.get(e);if(r){r.clear()}else{r=new pe;this._completionDisposables.set(e,r)}const o=await s.invokeCompletionProvider(i,n);return o.map(a=>fy.from(a,this._commands.converter,r))}async $provideChatTitle(e,i,n){const s=this._agents.get(e);if(!s){return}const r=await this.prepareHistoryTurns(s.extension,s.id,{history:i});return await s.provideTitle({history:r,yieldRequested:false},n)}async $provideChatSummary(e,i,n){const s=this._agents.get(e);if(!s){return}const r=await this.prepareHistoryTurns(s.extension,s.id,{history:i});return await s.provideSummary({history:r,yieldRequested:false},n)}}class k${constructor(e,i){this.extension=e;this.provider=i}}class RI{constructor(e,i,n,s,r){this.extension=e;this.id=i;this._proxy=n;this._handle=s;this._requestHandler=r;this._onDidReceiveFeedback=new L;this._onDidPerformAction=new L;this._pauseStateEmitter=new L}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}setChatRequestPauseState(e){this._pauseStateEmitter.fire(e)}async invokeCompletionProvider(e,i){if(!this._agentVariableProvider){return[]}return await this._agentVariableProvider.provider.provideCompletionItems(e,i)??[]}async provideFollowups(e,i,n){if(!this._followupProvider){return[]}const s=await this._followupProvider.provideFollowups(e,i,n);if(!s){return[]}return s.filter(r=>!(r&&"commandId"in r)).filter(r=>!(r&&"message"in r))}async provideTitle(e,i){if(!this._titleProvider){return}return await this._titleProvider.provideChatTitle(e,i)??void 0}async provideSummary(e,i){if(!this._summarizer){return}return await this._summarizer.provideChatSummary(e,i)??void 0}get apiAgent(){let e=false;let i=false;const n=()=>{if(e){return}if(i){return}i=true;queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{icon:!this._iconPath?void 0:this._iconPath instanceof b?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0,iconDark:!this._iconPath?void 0:"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof _n?this._iconPath:void 0,hasFollowups:this._followupProvider!==void 0,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix==="string"?this._helpTextPrefix:we.from(this._helpTextPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix==="string"?this._helpTextPostfix:we.from(this._helpTextPostfix),supportIssueReporting:this._supportIssueReporting,additionalWelcomeMessage:!this._additionalWelcomeMessage||typeof this._additionalWelcomeMessage==="string"?this._additionalWelcomeMessage:we.from(this._additionalWelcomeMessage)});i=false})};const s=this;return{get id(){return s.id},get iconPath(){return s._iconPath},set iconPath(r){s._iconPath=r;n()},get requestHandler(){return s._requestHandler},set requestHandler(r){FT(typeof r==="function","Invalid request handler");s._requestHandler=r},get followupProvider(){return s._followupProvider},set followupProvider(r){s._followupProvider=r;n()},get helpTextPrefix(){O(s.extension,"defaultChatParticipant");return s._helpTextPrefix},set helpTextPrefix(r){O(s.extension,"defaultChatParticipant");s._helpTextPrefix=r;n()},get helpTextPostfix(){O(s.extension,"defaultChatParticipant");return s._helpTextPostfix},set helpTextPostfix(r){O(s.extension,"defaultChatParticipant");s._helpTextPostfix=r;n()},get supportIssueReporting(){O(s.extension,"chatParticipantPrivate");return s._supportIssueReporting},set supportIssueReporting(r){O(s.extension,"chatParticipantPrivate");s._supportIssueReporting=r;n()},get onDidReceiveFeedback(){return s._onDidReceiveFeedback.event},set participantVariableProvider(r){O(s.extension,"chatParticipantAdditions");s._agentVariableProvider=r;if(r){if(!r.triggerCharacters.length){throw new Error("triggerCharacters are required")}s._proxy.$registerAgentCompletionsProvider(s._handle,s.id,r.triggerCharacters)}else{s._proxy.$unregisterAgentCompletionsProvider(s._handle,s.id)}},get participantVariableProvider(){O(s.extension,"chatParticipantAdditions");return s._agentVariableProvider},set additionalWelcomeMessage(r){O(s.extension,"defaultChatParticipant");s._additionalWelcomeMessage=r;n()},get additionalWelcomeMessage(){O(s.extension,"defaultChatParticipant");return s._additionalWelcomeMessage},set titleProvider(r){O(s.extension,"defaultChatParticipant");s._titleProvider=r;n()},get titleProvider(){O(s.extension,"defaultChatParticipant");return s._titleProvider},set summarizer(r){O(s.extension,"defaultChatParticipant");s._summarizer=r},get summarizer(){O(s.extension,"defaultChatParticipant");return s._summarizer},get onDidChangePauseState(){O(s.extension,"chatParticipantAdditions");return s._pauseStateEmitter.event},onDidPerformAction:!it(this.extension,"chatParticipantAdditions")?void 0:this._onDidPerformAction.event,dispose(){e=true;s._followupProvider=void 0;s._onDidReceiveFeedback.dispose();s._proxy.$unregisterAgent(s._handle)}}}invoke(e,i,n,s){return this._requestHandler(e,i,n,s)}}function D$(t,e,i){return new Promise((n,s)=>{const r=i.onCancellationRequested(async()=>{r.dispose();await Ts(t);n(void 0)});e.then(n,s).finally(()=>r.dispose())})}function LI(t){return t.startsWith("github.copilot")}class I${constructor(e,i){this.webviews=i;this._renderers=new Map;this._proxy=e.getProxy(ee.MainThreadChatOutputRenderer)}registerChatOutputRenderer(e,i,n){if(this._renderers.has(i)){throw new Error(`Chat output renderer already registered for: ${i}`)}this._renderers.set(i,{extension:e,renderer:n});this._proxy.$registerChatOutputRenderer(i,e.identifier,e.extensionLocation);return new Ve(()=>{this._renderers.delete(i);this._proxy.$unregisterChatOutputRenderer(i)})}async $renderChatOutput(e,i,n,s,r){const o=this._renderers.get(e);if(!o){throw new Error(`No chat output renderer registered for: ${e}`)}const a=this.webviews.createNewWebview(s,{},o.extension);const l=Object.freeze({webview:a,onDidDispose:a._onDidDispose});return o.renderer.renderChatOutput(Object.freeze({mime:i,value:n.buffer}),l,{},r)}}var B0;class T${#e;#t;#i;#n;#o;#r;#l;#a;#c;#u;#s;constructor(e,i,n){this.resource=e;this.#e=i;this.#s=n}get label(){return this.#e}set label(e){if(this.#e!==e){this.#e=e;this.#s()}}get iconPath(){return this.#t}set iconPath(e){if(this.#t!==e){this.#t=e;this.#s()}}get description(){return this.#i}set description(e){if(this.#i!==e){this.#i=e;this.#s()}}get badge(){return this.#n}set badge(e){if(this.#n!==e){this.#n=e;this.#s()}}get status(){return this.#o}set status(e){if(this.#o!==e){this.#o=e;this.#s()}}get archived(){return this.#r}set archived(e){if(this.#r!==e){this.#r=e;this.#s()}}get tooltip(){return this.#l}set tooltip(e){if(this.#l!==e){this.#l=e;this.#s()}}get timing(){return this.#a}set timing(e){if(this.#a!==e){this.#a=e;this.#s()}}get changes(){return this.#c}set changes(e){if(this.#c!==e){this.#c=e;this.#s()}}get metadata(){return this.#u}set metadata(e){if(!Gi(this.#u,e)){this.#u=e;this.#s()}}}class P${#e=new It;#t;constructor(e){this.#t=e}get size(){return this.#e.size}replace(e){if(e.length===0&&this.#e.size===0){return}this.#e.clear();for(const i of e){this.#e.set(i.resource,i)}this.#t()}forEach(e,i){for(const[n,s]of this.#e){e.call(i,s,this)}}add(e){this.#e.set(e.resource,e);this.#t()}delete(e){this.#e.delete(e);this.#t()}get(e){return this.#e.get(e)}[Symbol.iterator](){return this.#e.entries()}}class A${constructor(e,i,n,s,r,o){this.session=e;this.extension=i;this.proxy=s;this.commandsConverter=r;this.sessionDisposables=o;this._pendingCarouselResolvers=new Map;this._stream=new H0(i,n,s,r,o,this._pendingCarouselResolvers,Ze.None)}get activeResponseStream(){return this._stream}getActiveRequestStream(e){return new H0(this.extension,e,this.proxy,this.commandsConverter,this.sessionDisposables,this._pendingCarouselResolvers,Ze.None)}}let W0=class gq extends me{static{B0=this}static{this._sessionHandlePool=0}constructor(e,i,n,s){super();this.commands=e;this._languageModels=i;this._extHostRpc=n;this._logService=s;this._itemProviderHandlePool=0;this._chatSessionItemProviders=new Map;this._itemControllerHandlePool=0;this._chatSessionItemControllers=new Map;this._contentProviderHandlePool=0;this._chatSessionContentProviders=new Map;this._sessionItems=new It;this._extHostChatSessions=new It;this._providerOptionGroups=new Map;this._proxy=this._extHostRpc.getProxy(ee.MainThreadChatSessions);e.registerArgumentProcessor({processArgument:r=>{if(r&&r.$mid===nt.AgentSessionContext){const o=r.session.resource||r.sessionId;const a=this._sessionItems.get(o);if(a){return a}else{this._logService.warn(`No chat session found for ID: ${o}`);return r}}return r}})}registerChatSessionItemProvider(e,i,n){const s=this._itemProviderHandlePool++;const r=new pe;this._chatSessionItemProviders.set(s,{provider:n,extension:e,disposable:r,sessionType:i});this._proxy.$registerChatSessionItemProvider(s,i);if(n.onDidChangeChatSessionItems){r.add(n.onDidChangeChatSessionItems(()=>{this._logService.trace(`ExtHostChatSessions. Firing $onDidChangeChatSessionItems for ${i}`);this._proxy.$onDidChangeChatSessionItems(s)}))}if(n.onDidCommitChatSessionItem){r.add(n.onDidCommitChatSessionItem(o=>{const{original:a,modified:l}=o;this._proxy.$onDidCommitChatSessionItem(s,a.resource,l.resource)}))}return{dispose:()=>{this._chatSessionItemProviders.delete(s);r.dispose();this._proxy.$unregisterChatSessionItemProvider(s)}}}createChatSessionItemController(e,i,n){const s=this._itemControllerHandlePool++;const r=new pe;let o=false;let a=0;let l=void 0;const c=r.add(new L);const u=r.add(new L);const d=()=>{if(typeof l==="undefined"){c.fire()}};const f=new P$(()=>{d()});const p=Object.freeze({id:i,refreshHandler:async m=>{if(o){throw new Error("ChatSessionItemController has been disposed")}const v=++a;l=v;try{this._logService.trace(`ExtHostChatSessions. Controller(${i}).refresh()`);await n(m)}finally{if(l===v){l=void 0}}},items:f,onDidChangeChatSessionItemState:u.event,createChatSessionItem:(m,v)=>{if(o){throw new Error("ChatSessionItemController has been disposed")}return new T$(m,v,()=>{d()})},dispose:()=>{o=true;r.dispose()}});this._chatSessionItemControllers.set(s,{controller:p,extension:e,disposable:r,sessionType:i,onDidChangeChatSessionItemStateEmitter:u});r.add(this.registerChatSessionItemProvider(e,i,{onDidChangeChatSessionItems:c.event,onDidCommitChatSessionItem:wt.None,provideChatSessionItems:async m=>{await p.refreshHandler(m);return Array.from(p.items,v=>v[1])}}));r.add(ye(()=>{this._chatSessionItemControllers.delete(s);this._proxy.$unregisterChatSessionItemProvider(s)}));return p}registerChatSessionContentProvider(e,i,n,s,r){const o=this._contentProviderHandlePool++;const a=new pe;this._chatSessionContentProviders.set(o,{provider:s,extension:e,capabilities:r,disposable:a});this._proxy.$registerChatSessionContentProvider(o,i);if(s.onDidChangeChatSessionOptions){a.add(s.onDidChangeChatSessionOptions(l=>{this._proxy.$onDidChangeChatSessionOptions(o,l.resource,l.updates)}))}if(s.onDidChangeChatSessionProviderOptions){a.add(s.onDidChangeChatSessionProviderOptions(()=>{this._proxy.$onDidChangeChatSessionProviderOptions(o)}))}return new Ve(()=>{this._chatSessionContentProviders.delete(o);a.dispose();this._proxy.$unregisterChatSessionContentProvider(o)})}convertChatSessionStatus(e){if(e===void 0){return void 0}switch(e){case 0:return Ed.Failed;case 1:return Ed.Completed;case 2:return Ed.InProgress;default:return void 0}}convertChatSessionItem(e){const i=e.timing;const n=i?.created??i?.startTime??0;const s=i?.lastRequestStarted??i?.startTime;const r=i?.lastRequestEnded??i?.endTime;return{resource:e.resource,label:e.label,description:e.description?we.from(e.description):void 0,badge:e.badge?we.from(e.badge):void 0,status:this.convertChatSessionStatus(e.status),archived:e.archived,tooltip:we.fromStrict(e.tooltip),timing:{created:n,lastRequestStarted:s,lastRequestEnded:r},changes:e.changes instanceof Array?e.changes:void 0,metadata:e.metadata}}async $provideChatSessionItems(e,i){const n=this._chatSessionItemProviders.get(e);if(!n){this._logService.error(`No provider registered for handle ${e}`);return[]}this._logService.trace(`ExtHostChatSessions:$provideChatSessionItems(${n.sessionType})`);const s=await n.provider.provideChatSessionItems(i)??[];if(i.isCancellationRequested){return[]}const r=[];for(const o of s){this._sessionItems.set(o.resource,o);r.push(this.convertChatSessionItem(o))}return r}async $provideChatSessionContent(e,i,n){const s=this._chatSessionContentProviders.get(e);if(!s){throw new Error(`No provider for handle ${e}`)}const r=b.revive(i);const o=await s.provider.provideChatSessionContent(r,n);if(n.isCancellationRequested){throw new Vi}const a=new pe;const l=B0._sessionHandlePool++;const c=r.toString();const u=new A$(o,s.extension,{sessionResource:r,requestId:"ongoing",agentId:c,message:"",variables:{variables:[]},location:ki.Chat},{$handleProgressChunk:(p,m)=>{return this._proxy.$handleProgressChunk(e,r,p,m)},$handleAnchorResolve:(p,m,v)=>{this._proxy.$handleAnchorResolve(e,r,p,m,v)}},this.commands.converter,a);const d=a.add(new Tt);this._extHostChatSessions.set(r,{sessionObj:u,disposeCts:d});if(o.activeResponseCallback){Promise.resolve(o.activeResponseCallback(u.activeResponseStream.apiObject,d.token)).finally(()=>{this._proxy.$handleProgressComplete(e,r,"ongoing")})}const{capabilities:f}=s;return{id:l+"",resource:b.revive(r),hasActiveResponseCallback:!!o.activeResponseCallback,hasRequestHandler:!!o.requestHandler,supportsInterruption:!!f?.supportsInterruptions,options:o.options,history:o.history.map(p=>{if(p instanceof _m){return this.convertRequestTurn(p)}else{return this.convertResponseTurn(p,a)}})}}async $provideHandleOptionsChange(e,i,n,s){const r=b.revive(i);const o=this._chatSessionContentProviders.get(e);if(!o){this._logService.warn(`No provider for handle ${e}`);return}if(!o.provider.provideHandleOptionsChange){this._logService.debug(`Provider for handle ${e} does not implement provideHandleOptionsChange`);return}try{const a=n.map(l=>({optionId:l.optionId,value:l.value===void 0?void 0:typeof l.value==="string"?l.value:l.value.id}));await o.provider.provideHandleOptionsChange(r,a,s)}catch(a){this._logService.error(`Error calling provideHandleOptionsChange for handle ${e}, sessionResource ${r}:`,a)}}async $provideChatSessionProviderOptions(e,i){const n=this._chatSessionContentProviders.get(e);if(!n){this._logService.warn(`No provider for handle ${e} when requesting chat session options`);return}const s=n.provider;if(!s.provideChatSessionProviderOptions){return}try{const{optionGroups:r}=await s.provideChatSessionProviderOptions(i);if(!r){return}this._providerOptionGroups.set(e,r);return{optionGroups:r}}catch(r){this._logService.error(`Error calling provideChatSessionProviderOptions for handle ${e}:`,r);return}}async $interruptChatSessionActiveResponse(e,i,n){const s=this._extHostChatSessions.get(b.revive(i));s?.disposeCts.cancel()}async $disposeChatSessionContent(e,i){const n=this._extHostChatSessions.get(b.revive(i));if(!n){this._logService.warn(`No chat session found for resource: ${i}`);return}n.disposeCts.cancel();n.sessionObj.sessionDisposables.dispose();this._extHostChatSessions.delete(b.revive(i))}async $invokeChatSessionRequestHandler(e,i,n,s,r){const o=this._extHostChatSessions.get(b.revive(i));if(!o||!o.sessionObj.session.requestHandler){return{}}const a=Gh.to(n,void 0,await this.getModelForRequest(n,o.sessionObj.extension),[],new Map,o.sessionObj.extension,this._logService);const l=o.sessionObj.getActiveRequestStream(n);await o.sessionObj.session.requestHandler(a,{history:s,yieldRequested:false},l.apiObject,r);return{}}async getModelForRequest(e,i){let n;if(e.userSelectedModelId){n=await this._languageModels.getLanguageModelByIdentifier(i,e.userSelectedModelId)}if(!n){n=await this._languageModels.getDefaultLanguageModel(i);if(!n){throw new Error("Language model unavailable")}}return n}convertRequestTurn(e){const i=e.references.map(n=>this.convertReferenceToVariable(n));return{type:"request",id:e.id,prompt:e.prompt,participant:e.participant,command:e.command,variableData:i.length>0?{variables:i}:void 0}}convertReferenceToVariable(e){const i=e.value&&typeof e.value==="object"&&"uri"in e.value&&"range"in e.value?Rs.from(e.value):e.value;const n=e.range?{start:e.range[0],endExclusive:e.range[1]}:void 0;if(i&&i instanceof gx&&Array.isArray(i.diagnostics)&&i.diagnostics.length&&i.diagnostics[0][1].length){const o=fl.from(i.diagnostics[0][1][0]);const a={filterRange:{startLineNumber:o.startLineNumber,startColumn:o.startColumn,endLineNumber:o.endLineNumber,endColumn:o.endColumn},filterSeverity:o.severity,filterUri:i.diagnostics[0][0],problemMessage:i.diagnostics[0][1][0].message};return X1.toEntry(a)}if(Tn.isLocation(e.value)&&e.name.startsWith(`sym:`)){const o=Rs.from(e.value);return{id:e.id,name:e.name,fullName:e.name.substring(4),value:{uri:e.value.uri,range:o.range},symbolKind:G.Property,icon:G1.toIcon(G.Property),kind:"symbol",range:n}}if(b.isUri(i)&&e.name.startsWith(`prompt:`)&&e.id.startsWith(ja.PromptFile)&&e.id.endsWith(i.toString())){return{id:e.id,name:`prompt:${ts(i)}`,value:i,kind:"promptFile",modelDescription:"Prompt instructions file",isRoot:true,automaticallyAdded:false,range:n}}const s=b.isUri(i)||i&&typeof i==="object"&&"uri"in i;const r=s&&b.isUri(i)&&i.path.endsWith("/");return{id:e.id,name:e.name,value:i,modelDescription:e.modelDescription,range:n,kind:r?"directory":s?"file":"generic"}}convertResponseTurn(e,i){const n=zt(e.response.map(s=>jh.from(s,this.commands.converter,i)));return{type:"response",parts:n,participant:e.participant}}async $invokeOptionGroupSearch(e,i,n,s){const r=this._providerOptionGroups.get(e);if(!r){this._logService.warn(`No option groups found for provider handle ${e}`);return[]}const o=r.find(a=>a.id===i);if(!o||!o.onSearch){this._logService.warn(`No onSearch callback found for option group ${i}`);return[]}try{const a=await o.onSearch(n,s);return a??[]}catch(a){this._logService.error(`Error calling onSearch for option group ${i}:`,a);return[]}}$onDidChangeChatSessionItemState(e,i,n){const s=this._chatSessionItemControllers.get(e);if(!s){this._logService.warn(`No controller found for handle ${e}`);return}const r=b.revive(i);const o=s.controller.items.get(r);if(!o){this._logService.warn(`No item found for session resource ${r.toString()}`);return}o.archived=n;s.onDidChangeChatSessionItemStateEmitter.fire(o)}};W0=B0=W([P(2,st),P(3,et)],W0);class R${constructor(e){this._items=new Map;this._proxy=e.getProxy(ee.MainThreadChatStatus)}createChatStatusItem(e,i){const n=L$(e.identifier,i);if(this._items.has(n)){throw new Error(`Chat status item '${i}' already exists`)}const s={id:n,title:"",description:"",detail:""};let r=false;let o=false;const a=()=>{if(r){throw new Error("Chat status item is disposed")}if(!o){return}this._proxy.$setEntry(i,s)};const l=Object.freeze({id:i,get title(){return s.title},set title(c){s.title=c;a()},get description(){return s.description},set description(c){s.description=c;a()},get detail(){return s.detail},set detail(c){s.detail=c;a()},show:()=>{o=true;a()},hide:()=>{o=false;this._proxy.$disposeEntry(i)},dispose:()=>{r=true;this._proxy.$disposeEntry(i);this._items.delete(n)}});this._items.set(n,l);return l}}function L$(t,e){return`${ht.toKey(t)}.${e}`}class N${constructor(e){const i=e.getProxy(ee.MainThreadClipboard);this.value=Object.freeze({readText(){return i.$readText()},writeText(n){return i.$writeText(n)}})}}const w5="vscode-cdn.net";const M$=`vscode-resource.${w5}`;const V0=`'self' https://*.${w5}`;function Od(t,e){if(t.scheme===ne.http||t.scheme===ne.https){return t}if(e&&e.authority&&e.isRemote&&t.scheme===ne.file){t=b.from({scheme:ne.vscodeRemote,authority:e.authority,path:t.path})}return b.from({scheme:ne.https,authority:`${t.scheme}+${O$(t.authority)}.${M$}`,path:t.path,fragment:t.fragment,query:t.query})}function O$(t){return t.replace(/./g,e=>{const i=e.charCodeAt(0);if(i>=M.a&&i<=M.z||i>=M.A&&i<=M.Z||i>=M.Digit0&&i<=M.Digit9){return e}return"-"+i.toString(16).padStart(4,"0")})}class F${constructor(e,i,n){this._proxy=e;this._editors=i;this._remoteInfo=n;this._handlePool=0;this._disposables=new pe;this._insets=new Map;this._disposables.add(i.onDidChangeVisibleTextEditors(()=>{const s=i.getVisibleTextEditors();for(const r of this._insets.values()){if(s.indexOf(r.editor)<0){r.inset.dispose()}}}))}dispose(){this._insets.forEach(e=>e.inset.dispose());this._disposables.dispose()}createWebviewEditorInset(e,i,n,s,r){let o;for(const p of this._editors.getVisibleTextEditors(true)){if(p.value===e){o=p;break}}if(!o){throw new Error("not a visible editor")}const a=this;const l=this._handlePool++;const c=new L;const u=new L;const d=new class{constructor(){this._html="";this._options=Object.create(null)}asWebviewUri(p){return Od(p,a._remoteInfo)}get cspSource(){return V0}set options(p){this._options=p;a._proxy.$setOptions(l,p)}get options(){return this._options}set html(p){this._html=p;a._proxy.$setHtml(l,p)}get html(){return this._html}get onDidReceiveMessage(){return c.event}postMessage(p){return a._proxy.$postMessage(l,p)}};const f=new class{constructor(){this.editor=e;this.line=i;this.height=n;this.webview=d;this.onDidDispose=u.event}dispose(){if(a._insets.delete(l)){a._proxy.$disposeEditorInset(l);u.fire();u.dispose();c.dispose()}}};this._proxy.$createEditorInset(l,o.id,o.value.document.uri,i+1,n,s||{},r.identifier,r.extensionLocation);this._insets.set(l,{editor:e,inset:f,onDidReceiveMessage:c});return f}$onDidDispose(e){const i=this._insets.get(e);if(i){i.inset.dispose()}}$onDidReceiveMessage(e,i){const n=this._insets.get(e);n?.onDidReceiveMessage.fire(i)}}class Ox{static{this._providerHandlePool=0}constructor(e){this.providers=new Map;this._proxy=e.getProxy(ee.MainThreadCodeMapper)}async $mapCode(e,i,n){const s=this.providers.get(e);if(!s){throw new Error(`Received request to map code for unknown provider handle ${e}`)}const r={textEdit:(l,c)=>{c=Zn(c);this._proxy.$handleProgress(i.requestId,{uri:l,edits:c.map(vi.from)})},notebookEdit:(l,c)=>{c=Zn(c);this._proxy.$handleProgress(i.requestId,{uri:l,edits:c.map(Km.from)})}};const o={location:i.location,chatRequestId:i.chatRequestId,chatRequestModel:i.chatRequestModel,chatSessionId:i.chatSessionResource?Yd.parseLocalSessionId(b.revive(i.chatSessionResource)):void 0,codeBlocks:i.codeBlocks.map(l=>{return{code:l.code,resource:b.revive(l.resource),markdownBeforeBlock:l.markdownBeforeBlock}})};const a=await s.provideMappedEdits(o,r,n);return a??null}registerMappedEditsProvider(e,i){const n=Ox._providerHandlePool++;this._proxy.$registerCodeMapperProvider(n,e.displayName??e.name);this.providers.set(n,i);return{dispose:()=>{return this._proxy.$unregisterCodeMapperProvider(n)}}}}function U$(t,e,i){const n=t.getProxy(ee.MainThreadComments);class s{static{this.handlePool=0}constructor(){this._commentControllers=new Map;this._commentControllersByExtension=new $o;e.registerArgumentProcessor({processArgument:m=>{if(m&&m.$mid===nt.CommentController){const v=this._commentControllers.get(m.handle);if(!v){return m}return v.value}else if(m&&m.$mid===nt.CommentThread){const v=m;const y=this._commentControllers.get(v.commentControlHandle);if(!y){return v}const k=y.getCommentThread(v.commentThreadHandle);if(!k){return v}return k.value}else if(m&&(m.$mid===nt.CommentThreadReply||m.$mid===nt.CommentThreadInstance)){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v){return m}const y=v.getCommentThread(m.thread.commentThreadHandle);if(!y){return m}if(m.$mid===nt.CommentThreadInstance){return y.value}return{thread:y.value,text:m.text}}else if(m&&m.$mid===nt.CommentNode){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v){return m}const y=v.getCommentThread(m.thread.commentThreadHandle);if(!y){return m}const k=m.commentUniqueId;const S=y.getCommentByUniqueId(k);if(!S){return m}return S}else if(m&&m.$mid===nt.CommentThreadNode){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v){return m}const y=v.getCommentThread(m.thread.commentThreadHandle);if(!y){return m}const k=m.text;const S=m.commentUniqueId;const R=y.getCommentByUniqueId(S);if(!R){return m}if(typeof R.body==="string"){R.body=k}else{R.body=new rn(k)}return R}return m}})}createCommentController(m,v,y){const k=s.handlePool++;const S=new o(m,k,v,y);this._commentControllers.set(S.handle,S);const R=this._commentControllersByExtension.get(m.identifier)||[];R.push(S);this._commentControllersByExtension.set(m.identifier,R);return S.value}async $createCommentThreadTemplate(m,v,y,k){const S=this._commentControllers.get(m);if(!S){return}S.$createCommentThreadTemplate(v,y,k)}async $setActiveComment(m,v){const y=this._commentControllers.get(m);if(!y){return}y.$setActiveComment(v??void 0)}async $updateCommentThreadTemplate(m,v,y){const k=this._commentControllers.get(m);if(!k){return}k.$updateCommentThreadTemplate(v,y)}$deleteCommentThread(m,v){const y=this._commentControllers.get(m);y?.$deleteCommentThread(v)}async $updateCommentThread(m,v,y){const k=this._commentControllers.get(m);k?.$updateCommentThread(v,y)}async $provideCommentingRanges(m,v,y){const k=this._commentControllers.get(m);if(!k||!k.commentingRangeProvider){return Promise.resolve(void 0)}const S=await i.ensureDocumentData(b.revive(v));return Hi(async()=>{const R=await k.commentingRangeProvider?.provideCommentingRanges(S.document,y);let K;if(Array.isArray(R)){K={ranges:R,fileComments:false}}else if(R){K={ranges:R.ranges||[],fileComments:R.enableFileComments||false}}else{K=R??void 0}return K}).then(R=>{let K=void 0;if(R){K={ranges:R.ranges.map(q=>V.from(q)),fileComments:R.fileComments}}return K})}$toggleReaction(m,v,y,k,S){const R=this._commentControllers.get(m);if(!R||!R.reactionHandler){return Promise.resolve(void 0)}return Hi(()=>{const K=R.getCommentThread(v);if(K){const q=K.getCommentByUniqueId(k.uniqueIdInThread);if(R!==void 0&&q){if(R.reactionHandler){return R.reactionHandler(q,c(S))}}}return Promise.resolve(void 0)})}}class r{static{this._handlePool=0}set threadId(m){this._id=m}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(m){if(m===void 0!==(this._range===void 0)||(!m||!this._range||!m.isEqual(this._range))){this._range=m;this.modifications.range=m;this._onDidUpdateCommentThread.fire()}}get range(){return this._range}set canReply(m){if(this._canReply!==m){this._canReply=m;this.modifications.canReply=m;this._onDidUpdateCommentThread.fire()}}get canReply(){return this._canReply}get label(){return this._label}set label(m){this._label=m;this.modifications.label=m;this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(m){this._contextValue=m;this.modifications.contextValue=m;this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(m){this._comments=m;this.modifications.comments=m;this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(m){if(this._collapseState===m){return}this._collapseState=m;this.modifications.collapsibleState=m;this._onDidUpdateCommentThread.fire()}get state(){return this._state}set state(m){this._state=m;if(typeof m==="object"){O(this.extensionDescription,"commentThreadApplicability");this.modifications.state=m.resolved;this.modifications.applicability=m.applicability}else{this.modifications.state=m}this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(m,v,y,k,S,R,K,q,se){this._commentControllerHandle=v;this._id=y;this._uri=k;this._range=S;this._comments=R;this.extensionDescription=K;this._isTemplate=q;this.handle=r._handlePool++;this.commentHandle=0;this.modifications=Object.create(null);this._onDidUpdateCommentThread=new L;this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event;this._canReply=true;this._commentsMap=new Map;this._acceptInputDisposables=new $r;this._acceptInputDisposables.value=new pe;if(this._id===void 0){this._id=`${m}.${this.handle}`}n.$createCommentThread(v,this.handle,this._id,this._uri,V.from(this._range),this._comments.map(Q=>a(this,Q,this._commentsMap,this.extensionDescription)),K.identifier,this._isTemplate,se);this._localDisposables=[];this._isDiposed=false;this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()}));this._localDisposables.push({dispose:()=>{n.$deleteCommentThread(v,this.handle)}});const j=this;this.value={get uri(){return j.uri},get range(){return j.range},set range(Q){j.range=Q},get comments(){return j.comments},set comments(Q){j.comments=Q},get collapsibleState(){return j.collapsibleState},set collapsibleState(Q){j.collapsibleState=Q},get canReply(){return j.canReply},set canReply(Q){j.canReply=Q},get contextValue(){return j.contextValue},set contextValue(Q){j.contextValue=Q},get label(){return j.label},set label(Q){j.label=Q},get state(){return j.state},set state(Q){j.state=Q},reveal:(Q,le)=>j.reveal(Q,le),hide:()=>j.hide(),dispose:()=>{j.dispose()}}}updateIsTemplate(){if(this._isTemplate){this._isTemplate=false;this.modifications.isTemplate=false}}eventuallyUpdateCommentThread(){if(this._isDiposed){return}this.updateIsTemplate();if(!this._acceptInputDisposables.value){this._acceptInputDisposables.value=new pe}const m=y=>Object.prototype.hasOwnProperty.call(this.modifications,y);const v={};if(m("range")){v.range=V.from(this._range)}if(m("label")){v.label=this.label}if(m("contextValue")){v.contextValue=this.contextValue??null}if(m("comments")){v.comments=this._comments.map(y=>a(this,y,this._commentsMap,this.extensionDescription))}if(m("collapsibleState")){v.collapseState=u(this._collapseState)}if(m("canReply")){v.canReply=this.canReply}if(m("state")){v.state=d(this._state)}if(m("applicability")){v.applicability=f(this._state)}if(m("isTemplate")){v.isTemplate=this._isTemplate}this.modifications={};n.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,v)}getCommentByUniqueId(m){for(const v of this._commentsMap){const y=v[0];const k=v[1];if(m===k){return y}}return}async reveal(m,v){O(this.extensionDescription,"commentReveal");let y;if(m&&m.body!==void 0){y=m}else{v=v??m}let k=y?this._commentsMap.get(y):void 0;k??=this._commentsMap.get(this._comments[0]);let S=true;let R=false;if(v?.focus===xh.Reply){R=true;S=false}else if(v?.focus===xh.Comment){S=false}return n.$revealCommentThread(this._commentControllerHandle,this.handle,k,{preserveFocus:S,focusReply:R})}async hide(){return n.$hideCommentThread(this._commentControllerHandle,this.handle)}dispose(){this._isDiposed=true;this._acceptInputDisposables.dispose();this._localDisposables.forEach(m=>m.dispose())}}class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(m){this._commentingRangeProvider=m;if(m?.resourceHints){O(this._extension,"commentingRangeHint")}n.$updateCommentingRanges(this.handle,m?.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(m){this._reactionHandler=m;n.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!m})}get options(){return this._options}set options(m){this._options=m;n.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){O(this._extension,"activeComment");return this._activeComment}get activeCommentThread(){O(this._extension,"activeComment");return this._activeThread?.value}constructor(m,v,y,k){this._extension=m;this._handle=v;this._id=y;this._label=k;this._threads=new Map;n.$registerCommentController(this.handle,y,k,this._extension.identifier.value);const S=this;this.value=Object.freeze({id:S.id,label:S.label,get options(){return S.options},set options(R){S.options=R},get commentingRangeProvider(){return S.commentingRangeProvider},set commentingRangeProvider(R){S.commentingRangeProvider=R},get reactionHandler(){return S.reactionHandler},set reactionHandler(R){S.reactionHandler=R},get activeCommentThread(){return S.activeCommentThread},createCommentThread(R,K,q){return S.createCommentThread(R,K,q).value},dispose:()=>{S.dispose()}});this._localDisposables=[];this._localDisposables.push({dispose:()=>{n.$unregisterCommentController(this.handle)}})}createCommentThread(m,v,y){const k=new r(this.id,this.handle,void 0,m,v,y,this._extension,false);this._threads.set(k.handle,k);return k}$setActiveComment(m){if(!m){this._activeComment=void 0;this._activeThread=void 0;return}const v=this._threads.get(m.commentThreadHandle);if(v){this._activeComment=m.uniqueIdInThread?v.getCommentByUniqueId(m.uniqueIdInThread):void 0;this._activeThread=v}}$createCommentThreadTemplate(m,v,y){const k=new r(this.id,this.handle,void 0,b.revive(m),V.to(v),[],this._extension,true,y);k.collapsibleState=Gl.Expanded;this._threads.set(k.handle,k);return k}$updateCommentThreadTemplate(m,v){const y=this._threads.get(m);if(y){y.range=V.to(v)}}$updateCommentThread(m,v){const y=this._threads.get(m);if(!y){return}const k=S=>Object.prototype.hasOwnProperty.call(v,S);if(k("collapseState")){y.collapsibleState=u(v.collapseState)}}$deleteCommentThread(m){const v=this._threads.get(m);v?.dispose();this._threads.delete(m)}getCommentThread(m){return this._threads.get(m)}dispose(){this._threads.forEach(m=>{m.dispose()});this._localDisposables.forEach(m=>m.dispose())}}function a(p,m,v,y){let k=v.get(m);if(!k){k=++p.commentHandle;v.set(m,k)}if(m.state!==void 0){O(y,"commentsDraftState")}if(m.reactions?.some(S=>S.reactors!==void 0)){O(y,"commentReactor")}return{mode:m.mode,contextValue:m.contextValue,uniqueIdInThread:k,body:typeof m.body==="string"?m.body:we.from(m.body),userName:m.author.name,userIconPath:m.author.iconPath,label:m.label,commentReactions:m.reactions?m.reactions.map(S=>l(S)):void 0,state:m.state,timestamp:m.timestamp?.toJSON()}}function l(p){return{label:p.label,iconPath:p.iconPath?J_(p.iconPath):void 0,count:p.count,hasReacted:p.authorHasReacted,reactors:p.reactors&&p.reactors.length>0&&typeof p.reactors[0]!=="string"?p.reactors.map(m=>m.name):p.reactors}}function c(p){return{label:p.label||"",count:p.count||0,iconPath:p.iconPath?b.revive(p.iconPath):"",authorHasReacted:p.hasReacted||false,reactors:p.reactors?.map(m=>({name:m}))}}function u(p){if(p!==void 0){switch(p){case bh.Expanded:return Gl.Expanded;case bh.Collapsed:return Gl.Collapsed}}return Gl.Collapsed}function d(p){let m;if(typeof p==="object"){m=p.resolved}else{m=p}if(m!==void 0){switch(m){case yh.Unresolved:return bd.Unresolved;case yh.Resolved:return bd.Resolved}}return bd.Unresolved}function f(p){let m=void 0;if(typeof p==="object"){m=p.applicability}if(m!==void 0){switch(m){case Sh.Current:return yd.Current;case Sh.Outdated:return yd.Outdated}}return yd.Current}return new s}var Uf={exports:{}};var o1={};var NI;function $$(){if(NI)return Uf.exports;NI=1;(function(t,e){e=t.exports=tt;var i;if(typeof process==="object"&&o1&&o1.NODE_DEBUG&&/\bsemver\b/i.test(o1.NODE_DEBUG))i=function(){var C=Array.prototype.slice.call(arguments,0);C.unshift("SEMVER");console.log.apply(console,C)};else i=function(){};e.SEMVER_SPEC_VERSION="2.0.0";var n=256;var s=Number.MAX_SAFE_INTEGER||9007199254740991;var r=16;var o=e.re=[];var a=e.src=[];var l=0;var c=l++;a[c]="0|[1-9]\\d*";var u=l++;a[u]="[0-9]+";var d=l++;a[d]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var f=l++;a[f]="("+a[c]+")\\.("+a[c]+")\\.("+a[c]+")";var p=l++;a[p]="("+a[u]+")\\.("+a[u]+")\\.("+a[u]+")";var m=l++;a[m]="(?:"+a[c]+"|"+a[d]+")";var v=l++;a[v]="(?:"+a[u]+"|"+a[d]+")";var y=l++;a[y]="(?:-("+a[m]+"(?:\\."+a[m]+")*))";var k=l++;a[k]="(?:-?("+a[v]+"(?:\\."+a[v]+")*))";var S=l++;a[S]="[0-9A-Za-z-]+";var R=l++;a[R]="(?:\\+("+a[S]+"(?:\\."+a[S]+")*))";var K=l++;var q="v?"+a[f]+a[y]+"?"+a[R]+"?";a[K]="^"+q+"$";var se="[v=\\s]*"+a[p]+a[k]+"?"+a[R]+"?";var j=l++;a[j]="^"+se+"$";var Q=l++;a[Q]="((?:<|>)?=?)";var le=l++;a[le]=a[u]+"|x|X|\\*";var Re=l++;a[Re]=a[c]+"|x|X|\\*";var Ne=l++;a[Ne]="[v=\\s]*("+a[Re]+")(?:\\.("+a[Re]+")(?:\\.("+a[Re]+")(?:"+a[y]+")?"+a[R]+"?)?)?";var He=l++;a[He]="[v=\\s]*("+a[le]+")(?:\\.("+a[le]+")(?:\\.("+a[le]+")(?:"+a[k]+")?"+a[R]+"?)?)?";var Z=l++;a[Z]="^"+a[Q]+"\\s*"+a[Ne]+"$";var Y=l++;a[Y]="^"+a[Q]+"\\s*"+a[He]+"$";var J=l++;a[J]="(?:^|[^\\d])(\\d{1,"+r+"})(?:\\.(\\d{1,"+r+"}))?(?:\\.(\\d{1,"+r+"}))?(?:$|[^\\d])";var re=l++;a[re]="(?:~>?)";var ce=l++;a[ce]="(\\s*)"+a[re]+"\\s+";o[ce]=new RegExp(a[ce],"g");var Le="$1~";var qe=l++;a[qe]="^"+a[re]+a[Ne]+"$";var ze=l++;a[ze]="^"+a[re]+a[He]+"$";var ct=l++;a[ct]="(?:\\^)";var Lt=l++;a[Lt]="(\\s*)"+a[ct]+"\\s+";o[Lt]=new RegExp(a[Lt],"g");var Ke="$1^";var Ht=l++;a[Ht]="^"+a[ct]+a[Ne]+"$";var bi=l++;a[bi]="^"+a[ct]+a[He]+"$";var ti=l++;a[ti]="^"+a[Q]+"\\s*("+se+")$|^$";var Us=l++;a[Us]="^"+a[Q]+"\\s*("+q+")$|^$";var is=l++;a[is]="(\\s*)"+a[Q]+"\\s*("+se+"|"+a[Ne]+")";o[is]=new RegExp(a[is],"g");var Qi="$1$2$3";var Pu=l++;a[Pu]="^\\s*("+a[Ne]+")\\s+-\\s+("+a[Ne]+")\\s*$";var bf=l++;a[bf]="^\\s*("+a[He]+")\\s+-\\s+("+a[He]+")\\s*$";var Gr=l++;a[Gr]="(<|>)?=?\\s*\\*";for(var Vn=0;Vn<l;Vn++){i(Vn,a[Vn]);if(!o[Vn])o[Vn]=new RegExp(a[Vn])}e.parse=Be;function Be(C,U){if(C instanceof tt)return C;if(typeof C!=="string")return null;if(C.length>n)return null;var H=U?o[j]:o[K];if(!H.test(C))return null;try{return new tt(C,U)}catch(de){return null}}e.valid=uv;function uv(C,U){var H=Be(C,U);return H?H.version:null}e.clean=dv;function dv(C,U){var H=Be(C.trim().replace(/^[=v]+/,""),U);return H?H.version:null}e.SemVer=tt;function tt(C,U){if(C instanceof tt){if(C.loose===U)return C;else C=C.version}else if(typeof C!=="string"){throw new TypeError("Invalid Version: "+C)}if(C.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof tt))return new tt(C,U);i("SemVer",C,U);this.loose=U;var H=C.trim().match(U?o[j]:o[K]);if(!H)throw new TypeError("Invalid Version: "+C);this.raw=C;this.major=+H[1];this.minor=+H[2];this.patch=+H[3];if(this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");if(!H[4])this.prerelease=[];else this.prerelease=H[4].split(".").map(function(de){if(/^[0-9]+$/.test(de)){var X=+de;if(X>=0&&X<s)return X}return de});this.build=H[5]?H[5].split("."):[];this.format()}tt.prototype.format=function(){this.version=this.major+"."+this.minor+"."+this.patch;if(this.prerelease.length)this.version+="-"+this.prerelease.join(".");return this.version};tt.prototype.toString=function(){return this.version};tt.prototype.compare=function(C){i("SemVer.compare",this.version,this.loose,C);if(!(C instanceof tt))C=new tt(C,this.loose);return this.compareMain(C)||this.comparePre(C)};tt.prototype.compareMain=function(C){if(!(C instanceof tt))C=new tt(C,this.loose);return Kr(this.major,C.major)||Kr(this.minor,C.minor)||Kr(this.patch,C.patch)};tt.prototype.comparePre=function(C){if(!(C instanceof tt))C=new tt(C,this.loose);if(this.prerelease.length&&!C.prerelease.length)return-1;else if(!this.prerelease.length&&C.prerelease.length)return 1;else if(!this.prerelease.length&&!C.prerelease.length)return 0;var U=0;do{var H=this.prerelease[U];var de=C.prerelease[U];i("prerelease compare",U,H,de);if(H===void 0&&de===void 0)return 0;else if(de===void 0)return 1;else if(H===void 0)return-1;else if(H===de)continue;else return Kr(H,de)}while(++U)};tt.prototype.inc=function(C,U){switch(C){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",U);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",U);break;case"prepatch":this.prerelease.length=0;this.inc("patch",U);this.inc("pre",U);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",U);this.inc("pre",U);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{var H=this.prerelease.length;while(--H>=0){if(typeof this.prerelease[H]==="number"){this.prerelease[H]++;H=-2}}if(H===-1)this.prerelease.push(0)}if(U){if(this.prerelease[0]===U){if(isNaN(this.prerelease[1]))this.prerelease=[U,0]}else this.prerelease=[U,0]}break;default:throw new Error("invalid increment argument: "+C)}this.format();this.raw=this.version;return this};e.inc=ta;function ta(C,U,H,de){if(typeof H==="string"){de=H;H=void 0}try{return new tt(C,H).inc(U,de).version}catch(X){return null}}e.diff=yf;function yf(C,U){if(Ru(C,U)){return null}else{var H=Be(C);var de=Be(U);if(H.prerelease.length||de.prerelease.length){for(var X in H){if(X==="major"||X==="minor"||X==="patch"){if(H[X]!==de[X]){return"pre"+X}}}return"prerelease"}for(var X in H){if(X==="major"||X==="minor"||X==="patch"){if(H[X]!==de[X]){return X}}}}}e.compareIdentifiers=Kr;var Sf=/^[0-9]+$/;function Kr(C,U){var H=Sf.test(C);var de=Sf.test(U);if(H&&de){C=+C;U=+U}return H&&!de?-1:de&&!H?1:C<U?-1:C>U?1:0}e.rcompareIdentifiers=hv;function hv(C,U){return Kr(U,C)}e.major=fv;function fv(C,U){return new tt(C,U).major}e.minor=xf;function xf(C,U){return new tt(C,U).minor}e.patch=pv;function pv(C,U){return new tt(C,U).patch}e.compare=bn;function bn(C,U,H){return new tt(C,H).compare(new tt(U,H))}e.compareLoose=Au;function Au(C,U){return bn(C,U,true)}e.rcompare=gv;function gv(C,U,H){return bn(U,C,H)}e.sort=mv;function mv(C,U){return C.sort(function(H,de){return e.compare(H,de,U)})}e.rsort=Qr;function Qr(C,U){return C.sort(function(H,de){return e.rcompare(H,de,U)})}e.gt=Dl;function Dl(C,U,H){return bn(C,U,H)>0}e.lt=Il;function Il(C,U,H){return bn(C,U,H)<0}e.eq=Ru;function Ru(C,U,H){return bn(C,U,H)===0}e.neq=Jr;function Jr(C,U,H){return bn(C,U,H)!==0}e.gte=ia;function ia(C,U,H){return bn(C,U,H)>=0}e.lte=yn;function yn(C,U,H){return bn(C,U,H)<=0}e.cmp=dr;function dr(C,U,H,de){var X;switch(U){case"===":if(typeof C==="object")C=C.version;if(typeof H==="object")H=H.version;X=C===H;break;case"!==":if(typeof C==="object")C=C.version;if(typeof H==="object")H=H.version;X=C!==H;break;case"":case"=":case"==":X=Ru(C,H,de);break;case"!=":X=Jr(C,H,de);break;case">":X=Dl(C,H,de);break;case">=":X=ia(C,H,de);break;case"<":X=Il(C,H,de);break;case"<=":X=yn(C,H,de);break;default:throw new TypeError("Invalid operator: "+U)}return X}e.Comparator=on;function on(C,U){if(C instanceof on){if(C.loose===U)return C;else C=C.value}if(!(this instanceof on))return new on(C,U);i("comparator",C,U);this.loose=U;this.parse(C);if(this.semver===na)this.value="";else this.value=this.operator+this.semver.version;i("comp",this)}var na={};on.prototype.parse=function(C){var U=this.loose?o[ti]:o[Us];var H=C.match(U);if(!H)throw new TypeError("Invalid comparator: "+C);this.operator=H[1];if(this.operator==="=")this.operator="";if(!H[2])this.semver=na;else this.semver=new tt(H[2],this.loose)};on.prototype.toString=function(){return this.value};on.prototype.test=function(C){i("Comparator.test",C,this.loose);if(this.semver===na)return true;if(typeof C==="string")C=new tt(C,this.loose);return dr(C,this.operator,this.semver,this.loose)};on.prototype.intersects=function(C,U){if(!(C instanceof on)){throw new TypeError("a Comparator is required")}var H;if(this.operator===""){H=new Qt(C.value,U);return fe(this.value,H,U)}else if(C.operator===""){H=new Qt(this.value,U);return fe(C.semver,H,U)}var de=(this.operator===">="||this.operator===">")&&(C.operator===">="||C.operator===">");var X=(this.operator==="<="||this.operator==="<")&&(C.operator==="<="||C.operator==="<");var Ie=this.semver.version===C.semver.version;var We=(this.operator===">="||this.operator==="<=")&&(C.operator===">="||C.operator==="<=");var Ye=dr(this.semver,"<",C.semver,U)&&((this.operator===">="||this.operator===">")&&(C.operator==="<="||C.operator==="<"));var dt=dr(this.semver,">",C.semver,U)&&((this.operator==="<="||this.operator==="<")&&(C.operator===">="||C.operator===">"));return de||X||Ie&&We||Ye||dt};e.Range=Qt;function Qt(C,U){if(C instanceof Qt){if(C.loose===U){return C}else{return new Qt(C.raw,U)}}if(C instanceof on){return new Qt(C.value,U)}if(!(this instanceof Qt))return new Qt(C,U);this.loose=U;this.raw=C;this.set=C.split(/\s*\|\|\s*/).map(function(H){return this.parseRange(H.trim())},this).filter(function(H){return H.length});if(!this.set.length){throw new TypeError("Invalid SemVer Range: "+C)}this.format()}Qt.prototype.format=function(){this.range=this.set.map(function(C){return C.join(" ").trim()}).join("||").trim();return this.range};Qt.prototype.toString=function(){return this.range};Qt.prototype.parseRange=function(C){var U=this.loose;C=C.trim();i("range",C,U);var H=U?o[bf]:o[Pu];C=C.replace(H,$s);i("hyphen replace",C);C=C.replace(o[is],Qi);i("comparator trim",C,o[is]);C=C.replace(o[ce],Le);C=C.replace(o[Lt],Ke);C=C.split(/\s+/).join(" ");var de=U?o[ti]:o[Us];var X=C.split(" ").map(function(Ie){return _v(Ie,U)}).join(" ").split(/\s+/);if(this.loose){X=X.filter(function(Ie){return!!Ie.match(de)})}X=X.map(function(Ie){return new on(Ie,U)});return X};Qt.prototype.intersects=function(C,U){if(!(C instanceof Qt)){throw new TypeError("a Range is required")}return this.set.some(function(H){return H.every(function(de){return C.set.some(function(X){return X.every(function(Ie){return de.intersects(Ie,U)})})})})};e.toComparators=Ef;function Ef(C,U){return new Qt(C,U).set.map(function(H){return H.map(function(de){return de.value}).join(" ").trim().split(" ")})}function _v(C,U){i("comp",C);C=bv(C,U);i("caret",C);C=vv(C,U);i("tildes",C);C=Cf(C,U);i("xrange",C);C=x(C,U);i("stars",C);return C}function ui(C){return!C||C.toLowerCase()==="x"||C==="*"}function vv(C,U){return C.trim().split(/\s+/).map(function(H){return wv(H,U)}).join(" ")}function wv(C,U){var H=U?o[ze]:o[qe];return C.replace(H,function(de,X,Ie,We,Ye){i("tilde",C,de,X,Ie,We,Ye);var dt;if(ui(X))dt="";else if(ui(Ie))dt=">="+X+".0.0 <"+(+X+1)+".0.0";else if(ui(We))dt=">="+X+"."+Ie+".0 <"+X+"."+(+Ie+1)+".0";else if(Ye){i("replaceTilde pr",Ye);if(Ye.charAt(0)!=="-")Ye="-"+Ye;dt=">="+X+"."+Ie+"."+We+Ye+" <"+X+"."+(+Ie+1)+".0"}else dt=">="+X+"."+Ie+"."+We+" <"+X+"."+(+Ie+1)+".0";i("tilde return",dt);return dt})}function bv(C,U){return C.trim().split(/\s+/).map(function(H){return Lu(H,U)}).join(" ")}function Lu(C,U){i("caret",C,U);var H=U?o[bi]:o[Ht];return C.replace(H,function(de,X,Ie,We,Ye){i("caret",C,de,X,Ie,We,Ye);var dt;if(ui(X))dt="";else if(ui(Ie))dt=">="+X+".0.0 <"+(+X+1)+".0.0";else if(ui(We)){if(X==="0")dt=">="+X+"."+Ie+".0 <"+X+"."+(+Ie+1)+".0";else dt=">="+X+"."+Ie+".0 <"+(+X+1)+".0.0"}else if(Ye){i("replaceCaret pr",Ye);if(Ye.charAt(0)!=="-")Ye="-"+Ye;if(X==="0"){if(Ie==="0")dt=">="+X+"."+Ie+"."+We+Ye+" <"+X+"."+Ie+"."+(+We+1);else dt=">="+X+"."+Ie+"."+We+Ye+" <"+X+"."+(+Ie+1)+".0"}else dt=">="+X+"."+Ie+"."+We+Ye+" <"+(+X+1)+".0.0"}else{i("no pr");if(X==="0"){if(Ie==="0")dt=">="+X+"."+Ie+"."+We+" <"+X+"."+Ie+"."+(+We+1);else dt=">="+X+"."+Ie+"."+We+" <"+X+"."+(+Ie+1)+".0"}else dt=">="+X+"."+Ie+"."+We+" <"+(+X+1)+".0.0"}i("caret return",dt);return dt})}function Cf(C,U){i("replaceXRanges",C,U);return C.split(/\s+/).map(function(H){return yv(H,U)}).join(" ")}function yv(C,U){C=C.trim();var H=U?o[Y]:o[Z];return C.replace(H,function(de,X,Ie,We,Ye,dt){i("xRange",C,de,X,Ie,We,Ye,dt);var zn=ui(Ie);var qn=zn||ui(We);var Ji=qn||ui(Ye);var _=Ji;if(X==="="&&_)X="";if(zn){if(X===">"||X==="<"){de="<0.0.0"}else{de="*"}}else if(X&&_){if(qn)We=0;if(Ji)Ye=0;if(X===">"){X=">=";if(qn){Ie=+Ie+1;We=0;Ye=0}else if(Ji){We=+We+1;Ye=0}}else if(X==="<="){X="<";if(qn)Ie=+Ie+1;else We=+We+1}de=X+Ie+"."+We+"."+Ye}else if(qn){de=">="+Ie+".0.0 <"+(+Ie+1)+".0.0"}else if(Ji){de=">="+Ie+"."+We+".0 <"+Ie+"."+(+We+1)+".0"}i("xRange return",de);return de})}function x(C,U){i("replaceStars",C,U);return C.trim().replace(o[Gr],"")}function $s(C,U,H,de,X,Ie,We,Ye,dt,zn,qn,Ji,_){if(ui(H))U="";else if(ui(de))U=">="+H+".0.0";else if(ui(X))U=">="+H+"."+de+".0";else U=">="+U;if(ui(dt))Ye="";else if(ui(zn))Ye="<"+(+dt+1)+".0.0";else if(ui(qn))Ye="<"+dt+"."+(+zn+1)+".0";else if(Ji)Ye="<="+dt+"."+zn+"."+qn+"-"+Ji;else Ye="<="+Ye;return(U+" "+Ye).trim()}Qt.prototype.test=function(C){if(!C)return false;if(typeof C==="string")C=new tt(C,this.loose);for(var U=0;U<this.set.length;U++){if(Nu(this.set[U],C))return true}return false};function Nu(C,U){for(var H=0;H<C.length;H++){if(!C[H].test(U))return false}if(U.prerelease.length){for(var H=0;H<C.length;H++){i(C[H].semver);if(C[H].semver===na)continue;if(C[H].semver.prerelease.length>0){var de=C[H].semver;if(de.major===U.major&&de.minor===U.minor&&de.patch===U.patch)return true}}return false}return true}e.satisfies=fe;function fe(C,U,H){try{U=new Qt(U,H)}catch(de){return false}return U.test(C)}e.maxSatisfying=pt;function pt(C,U,H){var de=null;var X=null;try{var Ie=new Qt(U,H)}catch(We){return null}C.forEach(function(We){if(Ie.test(We)){if(!de||X.compare(We)===-1){de=We;X=new tt(de,H)}}});return de}e.minSatisfying=Sv;function Sv(C,U,H){var de=null;var X=null;try{var Ie=new Qt(U,H)}catch(We){return null}C.forEach(function(We){if(Ie.test(We)){if(!de||X.compare(We)===1){de=We;X=new tt(de,H)}}});return de}e.validRange=xv;function xv(C,U){try{return new Qt(C,U).range||"*"}catch(H){return null}}e.ltr=Ev;function Ev(C,U,H){return Yr(C,U,"<",H)}e.gtr=Cv;function Cv(C,U,H){return Yr(C,U,">",H)}e.outside=Yr;function Yr(C,U,H,de){C=new tt(C,de);U=new Qt(U,de);var X,Ie,We,Ye,dt;switch(H){case">":X=Dl;Ie=yn;We=Il;Ye=">";dt=">=";break;case"<":X=Il;Ie=ia;We=Dl;Ye="<";dt="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(fe(C,U,de)){return false}for(var zn=0;zn<U.set.length;++zn){var qn=U.set[zn];var Ji=null;var _=null;qn.forEach(function(w){if(w.semver===na){w=new on(">=0.0.0")}Ji=Ji||w;_=_||w;if(X(w.semver,Ji.semver,de)){Ji=w}else if(We(w.semver,_.semver,de)){_=w}});if(Ji.operator===Ye||Ji.operator===dt){return false}if((!_.operator||_.operator===Ye)&&Ie(C,_.semver)){return false}else if(_.operator===dt&&We(C,_.semver)){return false}}return true}e.prerelease=kv;function kv(C,U){var H=Be(C,U);return H&&H.prerelease.length?H.prerelease:null}e.intersects=Dv;function Dv(C,U,H){C=new Qt(C,H);U=new Qt(U,H);return C.intersects(U)}e.coerce=Iv;function Iv(C){if(C instanceof tt)return C;if(typeof C!=="string")return null;var U=C.match(o[J]);if(U==null)return null;return Be((U[1]||"0")+"."+(U[2]||"0")+"."+(U[3]||"0"))}})(Uf,Uf.exports);return Uf.exports}$$();const b5=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/;const H$=/^-(\d{4})(\d{2})(\d{2})(\d{2})?(\d{2})?$/;function B$(t){t=t.trim();return t==="*"||b5.test(t)}function y5(t){if(!B$(t)){return null}t=t.trim();if(t==="*"){return{hasCaret:false,hasGreaterEquals:false,majorBase:0,majorMustEqual:false,minorBase:0,minorMustEqual:false,patchBase:0,patchMustEqual:false,preRelease:null}}const e=t.match(b5);if(!e){return null}return{hasCaret:e[1]==="^",hasGreaterEquals:e[1]===">=",majorBase:e[2]==="x"?0:parseInt(e[2],10),majorMustEqual:e[2]==="x"?false:true,minorBase:e[4]==="x"?0:parseInt(e[4],10),minorMustEqual:e[4]==="x"?false:true,patchBase:e[6]==="x"?0:parseInt(e[6],10),patchMustEqual:e[6]==="x"?false:true,preRelease:e[8]||null}}function S5(t){if(!t){return null}const e=t.majorBase;const i=t.majorMustEqual;const n=t.minorBase;let s=t.minorMustEqual;const r=t.patchBase;let o=t.patchMustEqual;if(t.hasCaret){if(e===0){o=false}else{s=false;o=false}}let a=0;if(t.preRelease){const l=H$.exec(t.preRelease);if(l){const[,c,u,d,f,p]=l;a=Date.UTC(Number(c),Number(u)-1,Number(d),Number(f)||0,Number(p)||0)}}return{majorBase:e,majorMustEqual:i,minorBase:n,minorMustEqual:s,patchBase:r,patchMustEqual:o,isMinimum:t.hasGreaterEquals,notBefore:a}}class W${constructor(){this.buffers=[]}add(e){let i=this.buffers.indexOf(e);if(i<0){i=this.buffers.length;this.buffers.push(e)}return i}}function V$(t,e){if(e.serializeBuffersForPostMessage){const i=new W$;const n=(o,a)=>{if(a instanceof ArrayBuffer){const l=i.add(a);return{$$vscode_array_buffer_reference$$:true,index:l}}else if(ArrayBuffer.isView(a)){const l=z$(a);if(l){const c=i.add(a.buffer);return{$$vscode_array_buffer_reference$$:true,index:c,view:{type:l,byteLength:a.byteLength,byteOffset:a.byteOffset}}}}return a};const s=JSON.stringify(t,n);const r=i.buffers.map(o=>{const a=new Uint8Array(o);return ae.wrap(a)});return{message:s,buffers:r}}else{return{message:JSON.stringify(t),buffers:[]}}}function z$(t){switch(t.constructor.name){case"Int8Array":return Zt.Int8Array;case"Uint8Array":return Zt.Uint8Array;case"Uint8ClampedArray":return Zt.Uint8ClampedArray;case"Int16Array":return Zt.Int16Array;case"Uint16Array":return Zt.Uint16Array;case"Int32Array":return Zt.Int32Array;case"Uint32Array":return Zt.Uint32Array;case"Float32Array":return Zt.Float32Array;case"Float64Array":return Zt.Float64Array;case"BigInt64Array":return Zt.BigInt64Array;case"BigUint64Array":return Zt.BigUint64Array}return void 0}function q$(t,e){const i=e.map(r=>{const o=new ArrayBuffer(r.byteLength);const a=new Uint8Array(o);a.set(r.buffer);return o});const n=!e.length?void 0:(r,o)=>{if(o&&typeof o==="object"&&o.$$vscode_array_buffer_reference$$){const a=o;const{index:l}=a;const c=i[l];if(a.view){switch(a.view.type){case Zt.Int8Array:return new Int8Array(c,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case Zt.Uint8Array:return new Uint8Array(c,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case Zt.Uint8ClampedArray:return new Uint8ClampedArray(c,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case Zt.Int16Array:return new Int16Array(c,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case Zt.Uint16Array:return new Uint16Array(c,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case Zt.Int32Array:return new Int32Array(c,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case Zt.Uint32Array:return new Uint32Array(c,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case Zt.Float32Array:return new Float32Array(c,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case Zt.Float64Array:return new Float64Array(c,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case Zt.BigInt64Array:return new BigInt64Array(c,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case Zt.BigUint64Array:return new BigUint64Array(c,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}}return c}return o};const s=JSON.parse(t,n);return{message:s,arrayBuffers:i}}class j${#e;#t;#i;#n;#o;#r;#l;#a;#c;#u;#s;#h;constructor(e,i,n,s,r,o,a){this.#l="";this.#c=false;this.#u=false;this._onMessageEmitter=new L;this.onDidReceiveMessage=this._onMessageEmitter.event;this.#d=new L;this._onDidDispose=this.#d.event;this.#e=e;this.#t=i;this.#a=n;this.#n=s;this.#o=r;this.#r=o;this.#s=mu(o);this.#h=G$(o);this.#i=a}#d;dispose(){this.#c=true;this.#d.fire();this.#d.dispose();this._onMessageEmitter.dispose()}asWebviewUri(e){this.#u=true;return Od(e,this.#n)}get cspSource(){const e=this.#r.extensionLocation;if(e.scheme===ne.https||e.scheme===ne.http){let i=e.toString();if(!i.endsWith("/")){i+="/"}return i+" "+V0}return V0}get html(){this.assertNotDisposed();return this.#l}set html(e){this.assertNotDisposed();if(this.#l!==e){this.#l=e;if(this.#h&&!this.#u&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)){this.#u=true;this.#i.report("Webview vscode-resource: uris",this.#r,`Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri`)}this.#t.$setHtml(this.#e,this.rewriteOldResourceUrlsIfNeeded(e))}}get options(){this.assertNotDisposed();return this.#a}set options(e){this.assertNotDisposed();if(!Gi(this.#a,e)){this.#t.$setOptions(this.#e,x5(this.#r,this.#o,e))}this.#a=e}async postMessage(e){if(this.#c){return false}const i=V$(e,{serializeBuffersForPostMessage:this.#s});return this.#t.$postMessage(this.#e,i.message,...i.buffers)}assertNotDisposed(){if(this.#c){throw new Error("Webview is disposed")}}rewriteOldResourceUrlsIfNeeded(e){if(!this.#h){return e}const i=this.#r.extensionLocation?.scheme===ne.vscodeRemote;const n=this.#r.extensionLocation.scheme===ne.vscodeRemote?this.#r.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,r,o,a,l,c)=>{const u=b.from({scheme:a||"file",path:decodeURIComponent(l)});const d=Od(u,{isRemote:i,authority:n}).toString();return`${r}${d}${c}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,r,o,a,l,c)=>{const u=b.from({scheme:a||"file",path:decodeURIComponent(l)});const d=Od(u,{isRemote:i,authority:n}).toString();return`${r}${d}${c}`})}}function mu(t){try{const e=S5(y5(t.engines.vscode));return!!e&&e.majorBase>=1&&e.minorBase>=57}catch{return false}}function G$(t){try{const e=S5(y5(t.engines.vscode));if(!e){return false}return e.majorBase<1||e.majorBase===1&&e.minorBase<60}catch{return false}}class K$ extends me{constructor(e,i,n,s,r){super();this.remoteInfo=i;this.workspace=n;this._logService=s;this._deprecationService=r;this._webviews=new Map;this._webviewProxy=e.getProxy(ee.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values()){e.dispose()}this._webviews.clear()}$onMessage(e,i,n){const s=this.getWebview(e);if(s){const{message:r}=q$(i,n.value);s._onMessageEmitter.fire(r)}}$onMissingCsp(e,i){this._logService.warn(`${i} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,i,n){const s=new j$(e,this._webviewProxy,Q$(i),this.remoteInfo,this.workspace,n,this._deprecationService);this._webviews.set(e,s);const r=s._onDidDispose(()=>{r.dispose();this.deleteWebview(e)});return s}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function w_(t){return{id:t.identifier,location:t.extensionLocation}}function x5(t,e,i){return{enableCommandUris:i.enableCommandUris,enableScripts:i.enableScripts,enableForms:i.enableForms,portMapping:i.portMapping,localResourceRoots:i.localResourceRoots||J$(t,e)}}function Q$(t){return{enableCommandUris:t.enableCommandUris,enableScripts:t.enableScripts,enableForms:t.enableForms,portMapping:t.portMapping,localResourceRoots:t.localResourceRoots?.map(e=>b.from(e))}}function J$(t,e){return[...(e?.getWorkspaceFolders()||[]).map(i=>i.uri),t.extensionLocation]}class Wn{static{this.enableDebugLogging=false}constructor(e){this.id=e;this._data=new Map;this._idPool=1}add(e){const i=this._idPool++;this._data.set(i,e);this.logDebugInfo();return i}get(e,i){return this._data.has(e)?this._data.get(e)[i]:void 0}delete(e){this._data.delete(e);this.logDebugInfo()}logDebugInfo(){if(!Wn.enableDebugLogging){return}console.log(`${this.id} cache size - ${this._data.size}`)}}class Y${constructor(e,i){this.document=e;this._storagePath=i;this._backupCounter=1;this._edits=new Wn("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,i){await this.getEdit(e).undo();if(!i){this.disposeBackup()}}async redo(e,i){await this.getEdit(e).redo();if(!i){this.disposeBackup()}}disposeEdits(e){for(const i of e){this._edits.delete(i)}}getNewBackupUri(){if(!this._storagePath){throw new Error("Backup requires a valid storage path")}const e=nH(this.document.uri)+this._backupCounter++;return Mi(this._storagePath,e)}updateBackup(e){this._backup?.delete();this._backup=e}disposeBackup(){this._backup?.delete();this._backup=void 0}getEdit(e){const i=this._edits.get(e,0);if(!i){throw new Error("No edit found")}return i}}class X${constructor(){this._documents=new Map}get(e,i){return this._documents.get(this.key(e,i))}add(e,i,n){const s=this.key(e,i.uri);if(this._documents.has(s)){throw new Error(`Document already exists for viewType:${e} resource:${i.uri}`)}const r=new Y$(i,n);this._documents.set(s,r);return r}delete(e,i){const n=this.key(e,i);this._documents.delete(n)}key(e,i){return`${e}@@@${i}`}}var To;(function(t){t[t["Text"]=0]="Text";t[t["Custom"]=1]="Custom"})(To||(To={}));class Z${constructor(){this._providers=new Map}addTextProvider(e,i,n){return this.add(e,{type:To.Text,extension:i,provider:n})}addCustomProvider(e,i,n){return this.add(e,{type:To.Custom,extension:i,provider:n})}get(e){return this._providers.get(e)}add(e,i){if(this._providers.has(e)){throw new Error(`Provider for viewType:${e} already registered`)}this._providers.set(e,i);return new Ve(()=>this._providers.delete(e))}}class eH{constructor(e,i,n,s,r){this._extHostDocuments=i;this._extensionStoragePaths=n;this._extHostWebview=s;this._extHostWebviewPanels=r;this._editorProviders=new Z$;this._documents=new X$;this._proxy=e.getProxy(ee.MainThreadCustomEditors)}registerCustomEditorProvider(e,i,n,s){const r=new pe;if(tH(n)){r.add(this._editorProviders.addTextProvider(i,e,n));this._proxy.$registerTextEditorProvider(w_(e),i,s.webviewOptions||{},{supportsMove:!!n.moveCustomTextEditor},mu(e))}else{r.add(this._editorProviders.addCustomProvider(i,e,n));if($f(n)){r.add(n.onDidChangeCustomDocument(o=>{const a=this.getCustomDocumentEntry(i,o.document.uri);if(iH(o)){const l=a.addEdit(o);this._proxy.$onDidEdit(o.document.uri,i,l,o.label)}else{this._proxy.$onContentChange(o.document.uri,i)}}))}this._proxy.$registerCustomEditorProvider(w_(e),i,s.webviewOptions||{},!!s.supportsMultipleEditorsPerDocument,mu(e))}return Ve.from(r,new Ve(()=>{this._proxy.$unregisterEditorProvider(i)}))}async $createCustomDocument(e,i,n,s,r){const o=this._editorProviders.get(i);if(!o){throw new Error(`No provider found for '${i}'`)}if(o.type!==To.Custom){throw new Error(`Invalid provide type for '${i}'`)}const a=b.revive(e);const l=await o.provider.openCustomDocument(a,{backupId:n,untitledDocumentData:s?.buffer},r);let c;if($f(o.provider)&&this._extensionStoragePaths){c=this._extensionStoragePaths.workspaceValue(o.extension)??this._extensionStoragePaths.globalValue(o.extension)}this._documents.add(i,l,c);return{editable:$f(o.provider)}}async $disposeCustomDocument(e,i){const n=this._editorProviders.get(i);if(!n){throw new Error(`No provider found for '${i}'`)}if(n.type!==To.Custom){throw new Error(`Invalid provider type for '${i}'`)}const s=b.revive(e);const{document:r}=this.getCustomDocumentEntry(i,s);this._documents.delete(i,s);r.dispose()}async $resolveCustomEditor(e,i,n,s,r,o){const a=this._editorProviders.get(n);if(!a){throw new Error(`No provider found for '${n}'`)}const l=_i.to(r);const c=this._extHostWebview.createNewWebview(i,s.contentOptions,a.extension);const u=this._extHostWebviewPanels.createNewWebviewPanel(i,n,s.title,l,s.options,c,s.active);const d=b.revive(e);switch(a.type){case To.Custom:{const{document:f}=this.getCustomDocumentEntry(n,d);return a.provider.resolveCustomEditor(f,u,o)}case To.Text:{const f=this._extHostDocuments.getDocument(d);return a.provider.resolveCustomTextEditor(f,u,o)}default:{throw new Error("Unknown webview provider type")}}}$disposeEdits(e,i,n){const s=this.getCustomDocumentEntry(i,e);s.disposeEdits(n)}async $onMoveCustomEditor(e,i,n){const s=this._editorProviders.get(n);if(!s){throw new Error(`No provider found for '${n}'`)}if(!s.provider.moveCustomTextEditor){throw new Error(`Provider does not implement move '${n}'`)}const r=this._extHostWebviewPanels.getWebviewPanel(e);if(!r){throw new Error(`No webview found`)}const o=b.revive(i);const a=this._extHostDocuments.getDocument(o);await s.provider.moveCustomTextEditor(a,r,Ze.None)}async $undo(e,i,n,s){const r=this.getCustomDocumentEntry(i,e);return r.undo(n,s)}async $redo(e,i,n,s){const r=this.getCustomDocumentEntry(i,e);return r.redo(n,s)}async $revert(e,i,n){const s=this.getCustomDocumentEntry(i,e);const r=this.getCustomEditorProvider(i);await r.revertCustomDocument(s.document,n);s.disposeBackup()}async $onSave(e,i,n){const s=this.getCustomDocumentEntry(i,e);const r=this.getCustomEditorProvider(i);await r.saveCustomDocument(s.document,n);s.disposeBackup()}async $onSaveAs(e,i,n,s){const r=this.getCustomDocumentEntry(i,e);const o=this.getCustomEditorProvider(i);return o.saveCustomDocumentAs(r.document,b.revive(n),s)}async $backup(e,i,n){const s=this.getCustomDocumentEntry(i,e);const r=this.getCustomEditorProvider(i);const o=await r.backupCustomDocument(s.document,{destination:s.getNewBackupUri()},n);s.updateBackup(o);return o.id}getCustomDocumentEntry(e,i){const n=this._documents.get(e,b.revive(i));if(!n){throw new Error("No custom document found")}return n}getCustomEditorProvider(e){const i=this._editorProviders.get(e);const n=i?.provider;if(!n||!$f(n)){throw new Error("Custom document is not editable")}return n}}function $f(t){return!!t.onDidChangeCustomDocument}function tH(t){return typeof t.resolveCustomTextEditor==="function"}function iH(t){return typeof t.undo==="function"&&typeof t.redo==="function"}function nH(t){const e=t.scheme===ne.file||t.scheme===ne.untitled?t.fsPath:t.toString();return Wc(e)+""}var ha;class b_{#e;#t;#i;constructor(e,i,n,s,r,o,a,l){this._name=e;this._owner=i;this._maxDiagnosticsTotal=n;this._maxDiagnosticsPerFile=s;this._modelVersionIdProvider=r;this._isDisposed=false;this._maxDiagnosticsTotal=Math.max(s,n);this.#i=new It(c=>o.getComparisonKey(c));this.#e=a;this.#t=l}dispose(){if(!this._isDisposed){this.#t.fire([...this.#i.keys()]);this.#e?.$clear(this._owner);this.#i.clear();this._isDisposed=true}}get name(){this._checkDisposed();return this._name}set(e,i){if(!e){this.clear();return}this._checkDisposed();let n=[];if(b.isUri(e)){if(!i){this.delete(e);return}this.#i.set(e,zt(i));n=[e]}else if(Array.isArray(e)){n=[];let o;e=[...e].sort(b_._compareIndexedTuplesByUri);for(const a of e){const[l,c]=a;if(!o||l.toString()!==o.toString()){if(o&&this.#i.get(o).length===0){this.#i.delete(o)}o=l;n.push(l);this.#i.set(l,[])}if(!c){const u=this.#i.get(l);if(u){u.length=0}}else{const u=this.#i.get(l);u?.push(...zt(c))}}}this.#t.fire(n);if(!this.#e){return}const s=[];let r=0;for(const o of n){let a=[];const l=this.#i.get(o);if(l){if(l.length>this._maxDiagnosticsPerFile){a=[];const c=[Oi.Error,Oi.Warning,Oi.Information,Oi.Hint];e:for(let u=0;u<4;u++){for(const d of l){if(d.severity===c[u]){const f=a.push({...fl.from(d),modelVersionId:this._modelVersionIdProvider(o)});if(f===this._maxDiagnosticsPerFile){break e}}}}a.push({severity:fn.Info,message:h(2692,"Not showing {0} further errors and warnings.",l.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else{a=l.map(c=>({...fl.from(c),modelVersionId:this._modelVersionIdProvider(o)}))}}s.push([o,a]);r+=a.length;if(r>this._maxDiagnosticsTotal){break}}this.#e.$changeMany(this._owner,s)}delete(e){this._checkDisposed();this.#t.fire([e]);this.#i.delete(e);this.#e?.$changeMany(this._owner,[[e,void 0]])}clear(){this._checkDisposed();this.#t.fire([...this.#i.keys()]);this.#i.clear();this.#e?.$clear(this._owner)}forEach(e,i){this._checkDisposed();for(const[n,s]of this){e.call(i,n,s,this)}}*[Symbol.iterator](){this._checkDisposed();for(const e of this.#i.keys()){yield[e,this.get(e)]}}get(e){this._checkDisposed();const i=this.#i.get(e);if(Array.isArray(i)){return Object.freeze(i.slice(0))}return[]}has(e){this._checkDisposed();return Array.isArray(this.#i.get(e))}_checkDisposed(){if(this._isDisposed){throw new Error("illegal state - object is disposed")}}static _compareIndexedTuplesByUri(e,i){if(e[0].toString()<i[0].toString()){return-1}else if(e[0].toString()>i[0].toString()){return 1}else{return 0}}}let z0=class mq{static{ha=this}static{this._idPool=0}static{this._maxDiagnosticsPerFile=1e3}static{this._maxDiagnosticsTotal=1.1*this._maxDiagnosticsPerFile}static _mapper(e){const i=new It;for(const n of e){i.set(n,n)}return{uris:Object.freeze(Array.from(i.values()))}}constructor(e,i,n,s){this._logService=i;this._fileSystemInfoService=n;this._extHostDocumentsAndEditors=s;this._collections=new Map;this._onDidChangeDiagnostics=new NR({merge:r=>r.flat(),delay:50});this.onDidChangeDiagnostics=wt.map(this._onDidChangeDiagnostics.event,ha._mapper);this._proxy=e.getProxy(ee.MainThreadDiagnostics)}createDiagnosticCollection(e,i){const{_collections:n,_proxy:s,_onDidChangeDiagnostics:r,_logService:o,_fileSystemInfoService:a,_extHostDocumentsAndEditors:l}=this;const c=new class{$changeMany(f,p){s.$changeMany(f,p);o.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,f,p.length===0?"CLEARING":p)}$clear(f){s.$clear(f);o.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,f)}dispose(){s.dispose()}};let u;if(!i){i="_generated_diagnostic_collection_name_#"+ha._idPool++;u=i}else if(!n.has(i)){u=i}else{this._logService.warn(`DiagnosticCollection with name '${i}' does already exist.`);do{u=i+ha._idPool++}while(n.has(u))}const d=new class extends b_{constructor(){super(i,u,ha._maxDiagnosticsTotal,ha._maxDiagnosticsPerFile,f=>l.getDocument(f)?.version,a.extUri,c,r);n.set(u,this)}dispose(){super.dispose();n.delete(u)}};return d}getDiagnostics(e){if(e){return this._getDiagnostics(e)}else{const i=new Map;const n=[];for(const s of this._collections.values()){s.forEach((r,o)=>{let a=i.get(r.toString());if(typeof a==="undefined"){a=n.length;i.set(r.toString(),a);n.push([r,[]])}n[a][1]=n[a][1].concat(...o)})}return n}}_getDiagnostics(e){let i=[];for(const n of this._collections.values()){if(n.has(e)){i=i.concat(n.get(e))}}return i}$acceptMarkersChange(e){if(!this._mirrorCollection){const i="_generated_mirror";const n=new b_(i,i,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,s=>void 0,this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(i,n);this._mirrorCollection=n}for(const[i,n]of e){this._mirrorCollection.set(b.revive(i),n.map(fl.to))}}};z0=ha=W([P(1,et),P(2,bu)],z0);class sH{constructor(e){this._proxy=e.getProxy(ee.MainThreadDialogs)}showOpenDialog(e){return this._proxy.$showOpenDialog(e).then(i=>{return i?i.map(n=>b.revive(n)):void 0})}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(i=>{return i?b.revive(i):void 0})}}class Fx{static{this._handlePool=0}constructor(e,i,n){this._documentsAndEditors=i;this._logService=n;this._documentContentProviders=new Map;this._proxy=e.getProxy(ee.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,i){if(Object.keys(ne).indexOf(e)>=0){throw new Error(`scheme '${e}' already registered`)}const n=Fx._handlePool++;this._documentContentProviders.set(n,i);this._proxy.$registerTextContentProvider(n,e);let s;if(typeof i.onDidChange==="function"){let r;s=i.onDidChange(async o=>{if(o.scheme!==e){this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(o)){return}if(r){await r}const a=this.$provideTextDocumentContent(n,o).then(async l=>{if(!l&&typeof l!=="string"){return}const c=this._documentsAndEditors.getDocument(o);if(!c){return}const u=u4(l);if(!c.equalLines(u)){return this._proxy.$onVirtualDocumentChange(o,l)}}).catch(Ti).finally(()=>{if(r===a){r=void 0}});r=a})}return new Ve(()=>{if(this._documentContentProviders.delete(n)){this._proxy.$unregisterTextContentProvider(n)}if(s){s.dispose();s=void 0}})}$provideTextDocumentContent(e,i){const n=this._documentContentProviders.get(e);if(!n){return Promise.reject(new Error(`unsupported uri-scheme: ${i.scheme}`))}return Promise.resolve(n.provideTextDocumentContent(b.revive(i),Ze.None))}}class rH{constructor(e,i,n,s={timeout:1500,errors:3}){this._logService=e;this._documents=i;this._mainThreadBulkEdits=n;this._thresholds=s;this._callbacks=new Go;this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(i,n,s)=>{const r=this._callbacks.push([i,n,e]);const o={dispose:r};if(Array.isArray(s)){s.push(o)}return o}}async $participateInSave(e,i){const n=b.revive(e);let s=false;const r=setTimeout(()=>s=true,this._thresholds.timeout);const o=[];try{for(const a of[...this._callbacks]){if(s){break}const l=this._documents.getDocument(n);const c=await this._deliverEventAsyncAndBlameBadListeners(a,{document:l,reason:Rm.to(i)});o.push(c)}}finally{clearTimeout(r)}return o}_deliverEventAsyncAndBlameBadListeners([e,i,n],s){const r=this._badListeners.get(e);if(typeof r==="number"&&r>this._thresholds.errors){return Promise.resolve(false)}return this._deliverEventAsync(n,e,i,s).then(()=>{return true},o=>{this._logService.error(`onWillSaveTextDocument-listener from extension '${n.identifier.value}' threw ERROR`);this._logService.error(o);if(!(o instanceof Error)||o.message!=="concurrent_edits"){const a=this._badListeners.get(e);this._badListeners.set(e,!a?1:a+1);if(typeof a==="number"&&a>this._thresholds.errors){this._logService.info(`onWillSaveTextDocument-listener from extension '${n.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}}return false})}_deliverEventAsync(e,i,n,s){const r=[];const o=Date.now();const{document:a,reason:l}=s;const{version:c}=a;const u=Object.freeze({document:a,reason:l,waitUntil(d){if(Object.isFrozen(r)){throw mS("waitUntil can not be called async")}r.push(Promise.resolve(d))}});try{i.apply(n,[u])}catch(d){return Promise.reject(d)}return new Promise((d,f)=>{const p=setTimeout(()=>f(new Error("timeout")),this._thresholds.timeout);return Promise.all(r).then(m=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-o}ms`);clearTimeout(p);d(m)}).catch(m=>{clearTimeout(p);f(m)})}).then(d=>{const f={edits:[]};for(const p of d){if(Array.isArray(p)&&p.every(m=>m instanceof Wo)){for(const{newText:m,newEol:v,range:y}of p){f.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:y&&V.from(y),text:m,eol:v&&ou.from(v)}})}}}if(f.edits.length===0){return void 0}if(c===a.version){return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new ji(f))}return Promise.reject(new Error("concurrent_edits"))})}}class oH{constructor(e,i){this._onDidAddDocument=new L;this._onDidRemoveDocument=new L;this._onDidChangeDocument=new L;this._onDidChangeDocumentWithReason=new L;this._onDidSaveDocument=new L;this.onDidAddDocument=this._onDidAddDocument.event;this.onDidRemoveDocument=this._onDidRemoveDocument.event;this.onDidChangeDocument=this._onDidChangeDocument.event;this.onDidChangeDocumentWithReason=this._onDidChangeDocumentWithReason.event;this.onDidSaveDocument=this._onDidSaveDocument.event;this._toDispose=new pe;this._documentLoader=new Map;this._proxy=e.getProxy(ee.MainThreadDocuments);this._documentsAndEditors=i;this._documentsAndEditors.onDidRemoveDocuments(n=>{for(const s of n){this._onDidRemoveDocument.fire(s.document)}},void 0,this._toDispose);this._documentsAndEditors.onDidAddDocuments(n=>{for(const s of n){this._onDidAddDocument.fire(s.document)}},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e){return void 0}const i=this._documentsAndEditors.getDocument(e);if(i){return i}return void 0}getDocument(e){const i=this.getDocumentData(e);if(!i?.document){throw new Error(`Unable to retrieve document from URI '${e}'`)}return i.document}ensureDocumentData(e,i){const n=this._documentsAndEditors.getDocument(e);if(n&&(!i?.encoding||n.document.encoding===i.encoding)){return Promise.resolve(n)}let s=this._documentLoader.get(e.toString());if(!s){s=this._proxy.$tryOpenDocument(e,i).then(r=>{this._documentLoader.delete(e.toString());const o=b.revive(r);return Lc(this._documentsAndEditors.getDocument(o))},r=>{this._documentLoader.delete(e.toString());return Promise.reject(r)});this._documentLoader.set(e.toString(),s)}else{if(i?.encoding){s=s.then(r=>{if(r.document.encoding!==i.encoding){return this.ensureDocumentData(e,i)}return r})}}return s}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(i=>b.revive(i))}$acceptModelLanguageChanged(e,i){const n=b.revive(e);const s=this._documentsAndEditors.getDocument(n);if(!s){throw new Error("unknown document")}this._onDidRemoveDocument.fire(s.document);s._acceptLanguageId(i);this._onDidAddDocument.fire(s.document)}$acceptModelSaved(e){const i=b.revive(e);const n=this._documentsAndEditors.getDocument(i);if(!n){throw new Error("unknown document")}this.$acceptDirtyStateChanged(e,false);this._onDidSaveDocument.fire(n.document)}$acceptDirtyStateChanged(e,i){const n=b.revive(e);const s=this._documentsAndEditors.getDocument(n);if(!s){throw new Error("unknown document")}s._acceptIsDirty(i);this._onDidChangeDocument.fire({document:s.document,contentChanges:[],reason:void 0});this._onDidChangeDocumentWithReason.fire({document:s.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptEncodingChanged(e,i){const n=b.revive(e);const s=this._documentsAndEditors.getDocument(n);if(!s){throw new Error("unknown document")}s._acceptEncoding(i);this._onDidChangeDocument.fire({document:s.document,contentChanges:[],reason:void 0});this._onDidChangeDocumentWithReason.fire({document:s.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptModelChanged(e,i,n){const s=b.revive(e);const r=this._documentsAndEditors.getDocument(s);if(!r){throw new Error("unknown document")}r._acceptIsDirty(n);r.onEvents(i);let o=void 0;if(i.isUndoing){o=hh.Undo}else if(i.isRedoing){o=hh.Redo}this._onDidChangeDocument.fire(H1({document:r.document,contentChanges:i.changes.map(a=>{return{range:V.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text}}),reason:o}));this._onDidChangeDocumentWithReason.fire(H1({document:r.document,contentChanges:i.changes.map(a=>{return{range:V.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text}}),reason:o,detailedReason:i.detailedReason?{source:i.detailedReason.source,metadata:i.detailedReason}:void 0}))}setWordDefinitionFor(e,i){XF(e,i)}}class aH{constructor(e){this._provider=new Map;this._onDidChange=new L;this.onDidChange=this._onDidChange.event;this._allKnownModels=new Set;this._handlePool=0;this._proxy=e.getProxy(ee.MainThreadEmbeddings)}registerEmbeddingsProvider(e,i,n){if(this._allKnownModels.has(i)){throw new Error("An embeddings provider for this model is already registered")}const s=this._handlePool++;this._proxy.$registerEmbeddingProvider(s,i);this._provider.set(s,{id:i,provider:n});return ye(()=>{this._allKnownModels.delete(i);this._proxy.$unregisterEmbeddingProvider(s);this._provider.delete(s)})}async computeEmbeddings(e,i,n){n??=Ze.None;let s=false;if(typeof i==="string"){i=[i];s=true}const r=await this._proxy.$computeEmbeddings(e,i,n);if(r.length!==i.length){throw new Error}if(s){if(r.length!==1){throw new Error}return r[0]}return r}async $provideEmbeddings(e,i,n){const s=this._provider.get(e);if(!s){return[]}const r=await s.provider.provideEmbeddings(i,n);if(!r){return[]}return r}get embeddingsModels(){return Array.from(this._allKnownModels)}$acceptEmbeddingModels(e){this._allKnownModels=new Set(e);this._onDidChange.fire()}}class lH{constructor(e){this._AiEmbeddingVectorProviders=new Map;this._nextHandle=0;this._proxy=e.getProxy(ee.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,i,n){if(this._AiEmbeddingVectorProviders.size===0){throw new Error("No embedding vector providers registered")}const s=this._AiEmbeddingVectorProviders.get(e);if(!s){throw new Error("Embedding vector provider not found")}const r=await s.provideEmbeddingVector(i,n);if(!r){throw new Error("Embedding vector provider returned undefined")}return r}registerEmbeddingVectorProvider(e,i,n){const s=this._nextHandle;this._nextHandle++;this._AiEmbeddingVectorProviders.set(s,n);this._proxy.$registerAiEmbeddingVectorProvider(i,s);return new Ve(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(s);this._AiEmbeddingVectorProviders.delete(s)})}}var Ee;(function(t){t[t["Invalid"]=0]="Invalid";t[t["Start"]=1]="Start";t[t["H"]=2]="H";t[t["HT"]=3]="HT";t[t["HTT"]=4]="HTT";t[t["HTTP"]=5]="HTTP";t[t["F"]=6]="F";t[t["FI"]=7]="FI";t[t["FIL"]=8]="FIL";t[t["BeforeColon"]=9]="BeforeColon";t[t["AfterColon"]=10]="AfterColon";t[t["AlmostThere"]=11]="AlmostThere";t[t["End"]=12]="End";t[t["Accept"]=13]="Accept";t[t["LastKnownState"]=14]="LastKnownState"})(Ee||(Ee={}));class cH{constructor(e,i,n){const s=new Uint8Array(e*i);for(let r=0,o=e*i;r<o;r++){s[r]=n}this._data=s;this.rows=e;this.cols=i}get(e,i){return this._data[e*this.cols+i]}set(e,i,n){this._data[e*this.cols+i]=n}}class E5{constructor(e){let i=0;let n=Ee.Invalid;for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];if(l>i){i=l}if(a>n){n=a}if(c>n){n=c}}i++;n++;const s=new cH(n,i,Ee.Invalid);for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];s.set(a,l,c)}this._states=s;this._maxCharCode=i}nextState(e,i){if(i<0||i>=this._maxCharCode){return Ee.Invalid}return this._states.get(e,i)}}let a1=null;function uH(){if(a1===null){a1=new E5([[Ee.Start,M.h,Ee.H],[Ee.Start,M.H,Ee.H],[Ee.Start,M.f,Ee.F],[Ee.Start,M.F,Ee.F],[Ee.H,M.t,Ee.HT],[Ee.H,M.T,Ee.HT],[Ee.HT,M.t,Ee.HTT],[Ee.HT,M.T,Ee.HTT],[Ee.HTT,M.p,Ee.HTTP],[Ee.HTT,M.P,Ee.HTTP],[Ee.HTTP,M.s,Ee.BeforeColon],[Ee.HTTP,M.S,Ee.BeforeColon],[Ee.HTTP,M.Colon,Ee.AfterColon],[Ee.F,M.i,Ee.FI],[Ee.F,M.I,Ee.FI],[Ee.FI,M.l,Ee.FIL],[Ee.FI,M.L,Ee.FIL],[Ee.FIL,M.e,Ee.BeforeColon],[Ee.FIL,M.E,Ee.BeforeColon],[Ee.BeforeColon,M.Colon,Ee.AfterColon],[Ee.AfterColon,M.Slash,Ee.AlmostThere],[Ee.AlmostThere,M.Slash,Ee.End]])}return a1}var qt;(function(t){t[t["None"]=0]="None";t[t["ForceTermination"]=1]="ForceTermination";t[t["CannotEndIn"]=2]="CannotEndIn"})(qt||(qt={}));let qu=null;function dH(){if(qu===null){qu=new rv(qt.None);const t=` 	<>'"|`;for(let i=0;i<t.length;i++){qu.set(t.charCodeAt(i),qt.ForceTermination)}const e=".,;:";for(let i=0;i<e.length;i++){qu.set(e.charCodeAt(i),qt.CannotEndIn)}}return qu}class y_{static _createLink(e,i,n,s,r){let o=r-1;do{const a=i.charCodeAt(o);const l=e.get(a);if(l!==qt.CannotEndIn){break}o--}while(o>s);if(s>0){const a=i.charCodeAt(s-1);const l=i.charCodeAt(o);if(a===M.OpenParen&&l===M.CloseParen||a===M.OpenSquareBracket&&l===M.CloseSquareBracket||a===M.OpenCurlyBrace&&l===M.CloseCurlyBrace){o--}}return{range:{startLineNumber:n,startColumn:s+1,endLineNumber:n,endColumn:o+2},url:i.substring(s,o+1)}}static computeLinks(e,i=uH()){const n=dH();const s=[];for(let r=1,o=e.getLineCount();r<=o;r++){const a=e.getLineContent(r);const l=a.length;let c=0;let u=0;let d=0;let f=Ee.Start;let p=false;let m=false;let v=false;let y=false;while(c<l){let k=false;const S=a.charCodeAt(c);if(f===Ee.Accept){let R;switch(S){case M.OpenParen:p=true;R=qt.None;break;case M.CloseParen:R=p?qt.None:qt.ForceTermination;break;case M.OpenSquareBracket:v=true;m=true;R=qt.None;break;case M.CloseSquareBracket:v=false;R=m?qt.None:qt.ForceTermination;break;case M.OpenCurlyBrace:y=true;R=qt.None;break;case M.CloseCurlyBrace:R=y?qt.None:qt.ForceTermination;break;case M.SingleQuote:case M.DoubleQuote:case M.BackTick:if(d===S){R=qt.ForceTermination}else if(d===M.SingleQuote||d===M.DoubleQuote||d===M.BackTick){R=qt.None}else{R=qt.ForceTermination}break;case M.Asterisk:R=d===M.Asterisk?qt.ForceTermination:qt.None;break;case M.Space:R=v?qt.None:qt.ForceTermination;break;default:R=n.get(S)}if(R===qt.ForceTermination){s.push(y_._createLink(n,a,r,u,c));k=true}}else if(f===Ee.End){let R;if(S===M.OpenSquareBracket){m=true;R=qt.None}else{R=n.get(S)}if(R===qt.ForceTermination){k=true}else{f=Ee.Accept}}else{f=i.nextState(f,S);if(f===Ee.Invalid){k=true}}if(k){f=Ee.Start;p=false;m=false;y=false;u=c+1;d=S}c++}if(f===Ee.Accept){s.push(y_._createLink(n,a,r,u,l))}}return s}}class hH{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0;this._schemes.push(e)}delete(e){const i=this._schemes.indexOf(e);if(i>=0){this._schemes.splice(i,1);this._stateMachine=void 0}}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort();const i=[];let n;let s;let r=Ee.LastKnownState;let o=Ee.LastKnownState;for(const a of e){let l=!n?0:kL(n,a);if(l===0){s=Ee.Start}else{s=o}for(;l<a.length;l++){if(l+1===a.length){r=o;o=Ee.BeforeColon}else{o+=1}i.push([s,a.toUpperCase().charCodeAt(l),o]);i.push([s,a.toLowerCase().charCodeAt(l),o]);s=o}n=a;o=r}i.push([Ee.BeforeColon,M.Colon,Ee.AfterColon]);i.push([Ee.AfterColon,M.Slash,Ee.End]);this._stateMachine=new E5(i)}}provideDocumentLinks(e){this._initStateMachine();const i=[];const n=y_.computeLinks({getLineContent(s){return e.lineAt(s-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const s of n){const r=Xa.to(s);if(r.target){i.push(r)}}return i}}class S_{constructor(e,i){this._extHostLanguageFeatures=i;this._linkProvider=new hH;this._fsProvider=new Map;this._registeredSchemes=new Set;this._watches=new Map;this._handlePool=0;this._proxy=e.getProxy(ee.MainThreadFileSystem)}dispose(){this._linkProviderRegistration?.dispose()}registerFileSystemProvider(e,i,n,s={}){S_._validateFileSystemProvider(n);if(this._registeredSchemes.has(i)){throw new Error(`a provider for the scheme '${i}' is already registered`)}if(!this._linkProviderRegistration){this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider)}const r=this._handlePool++;this._linkProvider.add(i);this._registeredSchemes.add(i);this._fsProvider.set(r,n);let o=ws.FileReadWrite;if(s.isCaseSensitive){o+=ws.PathCaseSensitive}if(s.isReadonly){o+=ws.Readonly}if(typeof n.copy==="function"){o+=ws.FileFolderCopy}if(typeof n.open==="function"&&typeof n.close==="function"&&typeof n.read==="function"&&typeof n.write==="function"){O(e,"fsChunks");o+=ws.FileOpenReadWriteClose}let a;if(s.isReadonly&&Qo(s.isReadonly)&&s.isReadonly.value!==""){a={value:s.isReadonly.value,isTrusted:s.isReadonly.isTrusted,supportThemeIcons:s.isReadonly.supportThemeIcons,supportHtml:s.isReadonly.supportHtml,baseUri:s.isReadonly.baseUri,uris:s.isReadonly.uris}}this._proxy.$registerFileSystemProvider(r,i,o,a).catch(c=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${i}`);console.error(c)});const l=n.onDidChangeFile(c=>{const u=[];for(const d of c){const{uri:f,type:p}=d;if(f.scheme!==i){continue}let m;switch(p){case Sc.Changed:m=pd.UPDATED;break;case Sc.Created:m=pd.ADDED;break;case Sc.Deleted:m=pd.DELETED;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:m})}this._proxy.$onFileSystemChange(r,u)});return ye(()=>{l.dispose();this._linkProvider.delete(i);this._registeredSchemes.delete(i);this._fsProvider.delete(r);this._proxy.$unregisterProvider(r)})}static _validateFileSystemProvider(e){if(!e){throw new Error("MISSING provider")}if(typeof e.watch!=="function"){throw new Error("Provider does NOT implement watch")}if(typeof e.stat!=="function"){throw new Error("Provider does NOT implement stat")}if(typeof e.readDirectory!=="function"){throw new Error("Provider does NOT implement readDirectory")}if(typeof e.createDirectory!=="function"){throw new Error("Provider does NOT implement createDirectory")}if(typeof e.readFile!=="function"){throw new Error("Provider does NOT implement readFile")}if(typeof e.writeFile!=="function"){throw new Error("Provider does NOT implement writeFile")}if(typeof e.delete!=="function"){throw new Error("Provider does NOT implement delete")}if(typeof e.rename!=="function"){throw new Error("Provider does NOT implement rename")}}static _asIStat(e){const{type:i,ctime:n,mtime:s,size:r,permissions:o}=e;return{type:i,ctime:n,mtime:s,size:r,permissions:o}}$stat(e,i){return Promise.resolve(this._getFsProvider(e).stat(b.revive(i))).then(n=>S_._asIStat(n))}$readdir(e,i){return Promise.resolve(this._getFsProvider(e).readDirectory(b.revive(i)))}$readFile(e,i){return Promise.resolve(this._getFsProvider(e).readFile(b.revive(i))).then(n=>ae.wrap(n))}$writeFile(e,i,n,s){return Promise.resolve(this._getFsProvider(e).writeFile(b.revive(i),n.buffer,s))}$delete(e,i,n){return Promise.resolve(this._getFsProvider(e).delete(b.revive(i),n))}$rename(e,i,n,s){return Promise.resolve(this._getFsProvider(e).rename(b.revive(i),b.revive(n),s))}$copy(e,i,n,s){const r=this._getFsProvider(e);if(!r.copy){throw new Error('FileSystemProvider does not implement "copy"')}return Promise.resolve(r.copy(b.revive(i),b.revive(n),s))}$mkdir(e,i){return Promise.resolve(this._getFsProvider(e).createDirectory(b.revive(i)))}$watch(e,i,n,s){const r=this._getFsProvider(e).watch(b.revive(n),s);this._watches.set(i,r)}$unwatch(e,i){const n=this._watches.get(i);if(n){n.dispose();this._watches.delete(i)}}$open(e,i,n){const s=this._getFsProvider(e);if(!s.open){throw new Error('FileSystemProvider does not implement "open"')}return Promise.resolve(s.open(b.revive(i),n))}$close(e,i){const n=this._getFsProvider(e);if(!n.close){throw new Error('FileSystemProvider does not implement "close"')}return Promise.resolve(n.close(i))}$read(e,i,n,s){const r=this._getFsProvider(e);if(!r.read){throw new Error('FileSystemProvider does not implement "read"')}const o=ae.alloc(s);return Promise.resolve(r.read(i,n,o.buffer,0,s)).then(a=>{return o.slice(0,a)})}$write(e,i,n,s){const r=this._getFsProvider(e);if(!r.write){throw new Error('FileSystemProvider does not implement "write"')}return Promise.resolve(r.write(i,n,s.buffer,0,s.byteLength))}_getFsProvider(e){const i=this._fsProvider.get(e);if(!i){const n=new Error;n.name="ENOPRO";n.message=`no provider`;throw n}return i}}class C5 extends me{static{this.MAX_RESTARTS=5}constructor(e,i,n,s){super();this.onFileChanges=e;this.onLogMessage=i;this.verboseLogging=n;this.options=s;this.watcherDisposables=this._register(new $r);this.requests=void 0;this.restartCounter=0}init(){const e=new pe;this.watcherDisposables.value=e;this.watcher=this.createWatcher(e);this.watcher.setVerboseLogging(this.verboseLogging);e.add(this.watcher.onDidChangeFile(i=>this.onFileChanges(i)));e.add(this.watcher.onDidLogMessage(i=>this.onLogMessage(i)));e.add(this.watcher.onDidError(i=>this.onError(i.error,i.request)))}onError(e,i){if(this.canRestart(e,i)){if(this.restartCounter<C5.MAX_RESTARTS&&this.requests){this.error(`restarting watcher after unexpected error: ${e}`);this.restart(this.requests)}else{this.error(`gave up attempting to restart watcher after unexpected error: ${e}`)}}else{this.error(e)}}canRestart(e,i){if(!this.options.restartOnError){return false}if(i){return false}if(e.indexOf("No space left on device")!==-1||e.indexOf("EMFILE")!==-1){return false}return true}restart(e){this.restartCounter++;this.init();this.watch(e)}async watch(e){this.requests=e;await this.watcher?.watch(e)}async setVerboseLogging(e){this.verboseLogging=e;await this.watcher?.setVerboseLogging(e)}error(e){this.onLogMessage({type:"error",message:`[File Watcher (${this.options.type})] ${e}`})}trace(e){this.onLogMessage({type:"trace",message:`[File Watcher (${this.options.type})] ${e}`})}dispose(){this.watcher=void 0;return super.dispose()}}function fH(t,e){if(typeof e==="string"&&!e.startsWith(Pa)&&!Fp(e)){return{base:t,pattern:e}}return e}class pH{get ignoreCreateEvents(){return Boolean(this._config&1)}get ignoreChangeEvents(){return Boolean(this._config&2)}get ignoreDeleteEvents(){return Boolean(this._config&4)}constructor(e,i,n,s,r,o,a,l){this.session=Math.random();this._onDidCreate=new L;this._onDidChange=new L;this._onDidDelete=new L;this._config=0;if(l.ignoreCreateEvents){this._config+=1}if(l.ignoreChangeEvents){this._config+=2}if(l.ignoreDeleteEvents){this._config+=4}const c=typeof a==="string"?!((n.getCapabilities(ne.file)??0)&ws.PathCaseSensitive):n.extUri.ignorePathCasing(b.revive(a.baseUri));const u=zc(a,{ignoreCase:c});const d=typeof a==="string";const f=o(p=>{if(typeof p.session==="number"&&p.session!==this.session){return}if(!l.ignoreCreateEvents){for(const m of p.created){const v=b.revive(m);if(u(v.fsPath)&&(!d||s.getWorkspaceFolder(v))){this._onDidCreate.fire(v)}}}if(!l.ignoreChangeEvents){for(const m of p.changed){const v=b.revive(m);if(u(v.fsPath)&&(!d||s.getWorkspaceFolder(v))){this._onDidChange.fire(v)}}}if(!l.ignoreDeleteEvents){for(const m of p.deleted){const v=b.revive(m);if(u(v.fsPath)&&(!d||s.getWorkspaceFolder(v))){this._onDidDelete.fire(v)}}}});this._disposable=Ve.from(this.ensureWatching(e,s,i,r,a,l,false),this._onDidCreate,this._onDidChange,this._onDidDelete,f)}ensureWatching(e,i,n,s,r,o,a){const l=Ve.from();if(typeof r==="string"){return l}if(o.ignoreChangeEvents&&o.ignoreCreateEvents&&o.ignoreDeleteEvents){return l}const c=e.getProxy(ee.MainThreadFileSystemEventService);let u=false;if(r.pattern.includes(Pa)||r.pattern.includes(yw)){u=true}const d=[];let f=void 0;let p;if(a){if(o.ignoreChangeEvents||o.ignoreCreateEvents||o.ignoreDeleteEvents){p=ao.UPDATED|ao.ADDED|ao.DELETED;if(o.ignoreChangeEvents){p&=~ao.UPDATED}if(o.ignoreCreateEvents){p&=~ao.ADDED}if(o.ignoreDeleteEvents){p&=~ao.DELETED}}}else{if(u&&d.length===0){const m=i.getWorkspaceFolder(b.revive(r.baseUri));const v=n.getConfiguration("files",m).get("watcherExclude");if(v){for(const y in v){if(y&&v[y]===true){d.push(y)}}}}else if(!u){const m=i.getWorkspaceFolder(b.revive(r.baseUri));if(m){const v=n.getConfiguration("files",m).get("watcherExclude");if(v){for(const y in v){if(y&&v[y]===true){const k=`${N1(y,"/")}/${Pa}`;if(!f){f=[]}f.push(fH(m.uri.fsPath,k))}}}if(!f||f.length===0){return l}}}}c.$watch(s.identifier.value,this.session,r.baseUri,{recursive:u,excludes:d,includes:f,filter:p},Boolean(a));return Ve.from({dispose:()=>c.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class gH{get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}constructor(e){this._events=e;this._created=new $i(()=>this._events.created.map(b.revive));this._changed=new $i(()=>this._events.changed.map(b.revive));this._deleted=new $i(()=>this._events.deleted.map(b.revive));this.session=this._events.session}}class mH{constructor(e,i,n){this._mainContext=e;this._logService=i;this._extHostDocumentsAndEditors=n;this._onFileSystemEvent=new L;this._onDidRenameFile=new L;this._onDidCreateFile=new L;this._onDidDeleteFile=new L;this._onWillRenameFile=new ld;this._onWillCreateFile=new ld;this._onWillDeleteFile=new ld;this.onDidRenameFile=this._onDidRenameFile.event;this.onDidCreateFile=this._onDidCreateFile.event;this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,i,n,s,r,o){return new pH(this._mainContext,i,n,e,s,this._onFileSystemEvent.event,gn.from(r),o)}$onFileEvent(e){this._onFileSystemEvent.fire(new gH(e))}$onDidRunFileOperation(e,i){switch(e){case Vs.MOVE:this._onDidRenameFile.fire(Object.freeze({files:i.map(n=>({oldUri:b.revive(n.source),newUri:b.revive(n.target)}))}));break;case Vs.DELETE:this._onDidDeleteFile.fire(Object.freeze({files:i.map(n=>b.revive(n.target))}));break;case Vs.CREATE:case Vs.COPY:this._onDidCreateFile.fire(Object.freeze({files:i.map(n=>b.revive(n.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,i){return(n,s,r)=>{const o=function a(l){n.call(s,l)};o.extension=e;return i.event(o,void 0,r)}}async $onWillRunFileOperation(e,i,n,s){switch(e){case Vs.MOVE:return await this._fireWillEvent(this._onWillRenameFile,{files:i.map(r=>({oldUri:b.revive(r.source),newUri:b.revive(r.target)}))},n,s);case Vs.DELETE:return await this._fireWillEvent(this._onWillDeleteFile,{files:i.map(r=>b.revive(r.target))},n,s);case Vs.CREATE:case Vs.COPY:return await this._fireWillEvent(this._onWillCreateFile,{files:i.map(r=>b.revive(r.target))},n,s)}return void 0}async _fireWillEvent(e,i,n,s){const r=new Set;const o=[];await e.fireAsync(i,s,async(l,c)=>{const u=Date.now();const d=await Promise.resolve(l);if(d instanceof cl){o.push([c.extension,d]);r.add(c.extension.displayName??c.extension.identifier.value)}if(Date.now()-u>n){this._logService.warn("SLOW file-participant",c.extension.identifier)}});if(s.isCancellationRequested){return void 0}if(o.length===0){return void 0}const a={edits:[]};for(const[,l]of o){const{edits:c}=Pn.from(l,{getTextDocumentVersion:u=>this._extHostDocumentsAndEditors.getDocument(u)?.version,getNotebookDocumentVersion:()=>void 0});a.edits=a.edits.concat(c)}return{edit:a,extensionNames:Array.from(r)}}}class _H{constructor(e,i,n,s,r){this._extHostNotebooks=i;this._textDocumentsAndEditors=n;this._commands=s;const o=new Pe("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new z("showOptions","Show Options",a=>true,a=>a),new z("resource","Interactive resource Uri",a=>true,a=>a),new z("controllerId","Notebook controller Id",a=>true,a=>a),new z("title","Interactive editor title",a=>true,a=>a)],new De("Notebook and input URI",a=>{r.debug("[ExtHostInteractive] open iw with notebook editor id",a.notebookEditorId);if(a.notebookEditorId!==void 0){const l=this._extHostNotebooks.getEditorById(a.notebookEditorId);r.debug("[ExtHostInteractive] notebook editor found",l.id);return{notebookUri:b.revive(a.notebookUri),inputUri:b.revive(a.inputUri),notebookEditor:l.apiEditor}}r.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",a.notebookUri,a.inputUri);return{notebookUri:b.revive(a.notebookUri),inputUri:b.revive(a.inputUri)}}));this._commands.registerApiCommand(o)}$willAddInteractiveDocument(e,i,n,s){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:i,lines:[""],languageId:n,uri:e,isDirty:false,versionId:1,encoding:"utf8"}]})}$willRemoveInteractiveDocument(e,i){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class vH{constructor(e){this._handlePool=0;this._proxy=e.getProxy(ee.MainThreadLabelService)}$registerResourceLabelFormatter(e){const i=this._handlePool++;this._proxy.$registerResourceLabelFormatter(i,e);return ye(()=>{this._proxy.$unregisterResourceLabelFormatter(i)})}}var go;(function(t){t[t["LTR"]=0]="LTR";t[t["RTL"]=1]="RTL"})(go||(go={}));class Rn extends _t{constructor(e,i,n,s){super(e,i,n,s);this.selectionStartLineNumber=e;this.selectionStartColumn=i;this.positionLineNumber=n;this.positionColumn=s}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return Rn.selectionsEqual(this,e)}static selectionsEqual(e,i){return e.selectionStartLineNumber===i.selectionStartLineNumber&&e.selectionStartColumn===i.selectionStartColumn&&e.positionLineNumber===i.positionLineNumber&&e.positionColumn===i.positionColumn}getDirection(){if(this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn){return go.LTR}return go.RTL}setEndPosition(e,i){if(this.getDirection()===go.LTR){return new Rn(this.startLineNumber,this.startColumn,e,i)}return new Rn(e,i,this.startLineNumber,this.startColumn)}getPosition(){return new $n(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new $n(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,i){if(this.getDirection()===go.LTR){return new Rn(e,i,this.endLineNumber,this.endColumn)}return new Rn(this.endLineNumber,this.endColumn,e,i)}static fromPositions(e,i=e){return new Rn(e.lineNumber,e.column,i.lineNumber,i.column)}static fromRange(e,i){if(i===go.LTR){return new Rn(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)}else{return new Rn(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}}static liftSelection(e){return new Rn(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,i){if(e&&!i||!e&&i){return false}if(!e&&!i){return true}if(e.length!==i.length){return false}for(let n=0,s=e.length;n<s;n++){if(!this.selectionsEqual(e[n],i[n])){return false}}return true}static isISelection(e){return!!e&&typeof e.selectionStartLineNumber==="number"&&typeof e.selectionStartColumn==="number"&&typeof e.positionLineNumber==="number"&&typeof e.positionColumn==="number"}static createWithDirection(e,i,n,s,r){if(r===go.LTR){return new Rn(e,i,n,s)}return new Rn(n,s,e,i)}}class x_{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentSymbols(e,i){const n=this._documents.getDocument(e);const s=await this._provider.provideDocumentSymbols(n,i);if(_S(s)){return void 0}else if(s[0]instanceof oh){return s.map(Bb.from)}else{return x_._asDocumentSymbolTree(s)}}static _asDocumentSymbolTree(e){e=e.slice(0).sort((s,r)=>{let o=s.location.range.start.compareTo(r.location.range.start);if(o===0){o=r.location.range.end.compareTo(s.location.range.end)}return o});const i=[];const n=[];for(const s of e){const r={name:s.name||"!!MISSING: name!!",kind:es.from(s.kind),tags:s.tags?.map(qr.from)||[],detail:"",containerName:s.containerName,range:V.from(s.location.range),selectionRange:V.from(s.location.range),children:[]};while(true){if(n.length===0){n.push(r);i.push(r);break}const o=n[n.length-1];if(_t.containsRange(o.range,r.range)&&!_t.equalsRange(o.range,r.range)){o.children?.push(r);n.push(r);break}n.pop()}}return i}}class Hf{constructor(e,i,n,s,r,o){this._documents=e;this._commands=i;this._provider=n;this._extension=s;this._extTelemetry=r;this._logService=o;this._cache=new Wn("CodeLens");this._disposables=new Map}async provideCodeLenses(e,i){const n=this._documents.getDocument(e);const s=await this._provider.provideCodeLenses(n,i);if(!s||i.isCancellationRequested){return void 0}const r=this._cache.add(s);const o=new pe;this._disposables.set(r,o);const a={cacheId:r,lenses:[]};for(let l=0;l<s.length;l++){if(!Fe.isRange(s[l].range)){console.warn("INVALID code lens, range is not defined",this._extension.identifier.value);continue}a.lenses.push({cacheId:[r,l],range:V.from(s[l].range),command:this._commands.toInternal(s[l].command,o)})}return a}async resolveCodeLens(e,i){const n=e.cacheId&&this._cache.get(...e.cacheId);if(!n){return void 0}let s;if(typeof this._provider.resolveCodeLens!=="function"||n.isResolved){s=n}else{s=await this._provider.resolveCodeLens(n,i)}if(!s){s=n}if(i.isCancellationRequested){return void 0}const r=e.cacheId&&this._disposables.get(e.cacheId[0]);if(!r){return void 0}if(!s.command){const o=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,o);this._logService.error(o);return void 0}e.command=this._commands.toInternal(s.command,r);return e}releaseCodeLenses(e){this._disposables.get(e)?.dispose();this._disposables.delete(e);this._cache.delete(e)}}function cv(t){if(Array.isArray(t)){return t.map(Mh.from)}else if(t){return[Mh.from(t)]}return[]}class MI{constructor(e,i){this._documents=e;this._provider=i}async provideDefinition(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.provideDefinition(s,r,n);return cv(o)}}class OI{constructor(e,i){this._documents=e;this._provider=i}async provideDeclaration(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.provideDeclaration(s,r,n);return cv(o)}}class FI{constructor(e,i){this._documents=e;this._provider=i}async provideImplementation(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.provideImplementation(s,r,n);return cv(o)}}class UI{constructor(e,i){this._documents=e;this._provider=i}async provideTypeDefinition(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.provideTypeDefinition(s,r,n);return cv(o)}}class Fd{static{this.HOVER_MAP_MAX_SIZE=10}constructor(e,i){this._documents=e;this._provider=i;this._hoverCounter=0;this._hoverMap=new Map}async provideHover(e,i,n,s){const r=this._documents.getDocument(e);const o=ut.to(i);let a;if(n&&n.verbosityRequest){const d=n.verbosityRequest.previousHover.id;const f=this._hoverMap.get(d);if(!f){throw new Error(`Hover with id ${d} not found`)}const p={verbosityDelta:n.verbosityRequest.verbosityDelta,previousHover:f};a=await this._provider.provideHover(r,o,s,p)}else{a=await this._provider.provideHover(r,o,s)}if(!a||_S(a.contents)){return void 0}if(!a.range){a.range=r.getWordRangeAtPosition(o)}if(!a.range){a.range=new Fe(o,o)}const l=Oh.from(a);const c=this._hoverCounter;if(this._hoverMap.size===Fd.HOVER_MAP_MAX_SIZE){const d=Math.min(...this._hoverMap.keys());this._hoverMap.delete(d)}this._hoverMap.set(c,a);this._hoverCounter+=1;const u={...l,id:c};return u}releaseHover(e){this._hoverMap.delete(e)}}class $I{constructor(e,i){this._documents=e;this._provider=i}async provideEvaluatableExpression(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.provideEvaluatableExpression(s,r,n);if(o){return zb.from(o)}return void 0}}class HI{constructor(e,i){this._documents=e;this._provider=i}async provideInlineValues(e,i,n,s){const r=this._documents.getDocument(e);const o=await this._provider.provideInlineValues(r,V.to(i),Cm.to(n),s);if(Array.isArray(o)){return o.map(a=>Em.from(a))}return void 0}}class BI{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentHighlights(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.provideDocumentHighlights(s,r,n);if(Array.isArray(o)){return o.map(su.from)}return void 0}}class WI{constructor(e,i,n){this._documents=e;this._provider=i;this._logService=n}async provideMultiDocumentHighlights(e,i,n,s){const r=this._documents.getDocument(e);const o=n.map(c=>{try{return this._documents.getDocument(c)}catch(u){this._logService.error("Error: Unable to retrieve document from URI: "+c+". Error message: "+u);return void 0}}).filter(c=>c!==void 0);const a=ut.to(i);const l=await this._provider.provideMultiDocumentHighlights(r,a,o,s);if(Array.isArray(l)){return l.map(qb.from)}return void 0}}class VI{constructor(e,i){this._documents=e;this._provider=i}async provideLinkedEditingRanges(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.provideLinkedEditingRanges(s,r,n);if(o&&Array.isArray(o.ranges)){return{ranges:zt(o.ranges.map(V.from)),wordPattern:o.wordPattern}}return void 0}}class zI{constructor(e,i){this._documents=e;this._provider=i}async provideReferences(e,i,n,s){const r=this._documents.getDocument(e);const o=ut.to(i);const a=await this._provider.provideReferences(r,o,n,s);if(Array.isArray(a)){return a.map(wn.from)}return void 0}}class Po{static{this._maxCodeActionsPerFile=1e3}constructor(e,i,n,s,r,o,a){this._documents=e;this._commands=i;this._diagnostics=n;this._provider=s;this._logService=r;this._extension=o;this._apiDeprecation=a;this._cache=new Wn("CodeAction");this._disposables=new Map}async provideCodeActions(e,i,n,s){const r=this._documents.getDocument(e);const o=Rn.isISelection(i)?Ms.to(i):V.to(i);const a=[];for(const p of this._diagnostics.getDiagnostics(e)){if(o.intersection(p.range)){const m=a.push(p);if(m>Po._maxCodeActionsPerFile){break}}}const l={diagnostics:a,only:n.only?new $t(n.only):void 0,triggerKind:ry.to(n.trigger)};const c=await this._provider.provideCodeActions(r,o,l,s);if(!rf(c)||s.isCancellationRequested){return void 0}const u=this._cache.add(c);const d=new pe;this._disposables.set(u,d);const f=[];for(let p=0;p<c.length;p++){const m=c[p];if(!m){continue}if(Po._isCommand(m)&&!(m instanceof lh)){this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,`Return 'CodeAction' instances instead.`);f.push({_isSynthetic:true,title:m.title,command:this._commands.toInternal(m,d)})}else{const v=m;if(l.only){if(!v.kind){this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`)}else if(!l.only.contains(v.kind)){this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action is of kind '${v.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`)}}const y=v.ranges??[];f.push({cacheId:[u,p],title:v.title,command:v.command&&this._commands.toInternal(v.command,d),diagnostics:v.diagnostics&&v.diagnostics.map(fl.from),edit:v.edit&&Pn.from(v.edit,void 0),kind:v.kind&&v.kind.value,isPreferred:v.isPreferred,isAI:it(this._extension,"codeActionAI")?v.isAI:false,ranges:it(this._extension,"codeActionRanges")?zt(y.map(V.from)):void 0,disabled:v.disabled?.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(e,i){const[n,s]=e;const r=this._cache.get(n,s);if(!r||Po._isCommand(r)){return{}}if(!this._provider.resolveCodeAction){return{}}const o=await this._provider.resolveCodeAction(r,i)??r;let a;if(o.edit){a=Pn.from(o.edit,void 0)}let l;if(o.command){const c=this._disposables.get(n);if(c){l=this._commands.toInternal(o.command,c)}}return{edit:a,command:l}}releaseCodeActions(e){this._disposables.get(e)?.dispose();this._disposables.delete(e);this._cache.delete(e)}static _isCommand(e){return typeof e.command==="string"&&typeof e.title==="string"}}class ju{constructor(e,i,n,s,r){this._proxy=e;this._documents=i;this._provider=n;this._handle=s;this._extension=r;this._editsCache=new Wn("DocumentPasteEdit.edits")}async prepareDocumentPaste(e,i,n,s){if(!this._provider.prepareDocumentPaste){return}this._cachedPrepare=void 0;const r=this._documents.getDocument(e);const o=i.map(d=>V.to(d));const a=hu.toDataTransfer(n,()=>{throw new W5});await this._provider.prepareDocumentPaste(r,o,a,s);if(s.isCancellationRequested){return}const l=Array.from(a).filter(([,d])=>!(d instanceof Yg));const c=new Map;const u=await Promise.all(Array.from(l,async([d,f])=>{const p=Pi();c.set(p,f);return[d,await el.from(d,f,p)]}));this._cachedPrepare=c;return{items:u}}async providePasteEdits(e,i,n,s,r,o){if(!this._provider.provideDocumentPasteEdits){return[]}const a=this._documents.getDocument(i);const l=n.map(p=>V.to(p));const c=s.items.map(([p,m])=>{const v=this._cachedPrepare?.get(m.id);if(v){return[p,v]}return[p,el.to(p,m,async y=>{return(await this._proxy.$resolvePasteFileData(this._handle,e,y)).buffer})]});const u=new Yc(c);const d=await this._provider.provideDocumentPasteEdits(a,l,u,{only:r.only?new Xn(r.only):void 0,triggerKind:r.triggerKind},o);if(!d||o.isCancellationRequested){return[]}const f=this._editsCache.add(d);return d.map((p,m)=>({_cacheId:[f,m],title:p.title??h(2695,"Paste using '{0}' extension",this._extension.displayName||this._extension.name),kind:p.kind,yieldTo:p.yieldTo?.map(v=>v.value),insertText:typeof p.insertText==="string"?p.insertText:{snippet:p.insertText.value},additionalEdit:p.additionalEdit?Pn.from(p.additionalEdit,void 0):void 0}))}async resolvePasteEdit(e,i){const[n,s]=e;const r=this._editsCache.get(n,s);if(!r||!this._provider.resolveDocumentPasteEdit){return{}}const o=await this._provider.resolveDocumentPasteEdit(r,i)??r;return{insertText:o.insertText,additionalEdit:o.additionalEdit?Pn.from(o.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._editsCache.delete(e)}}class qI{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentFormattingEdits(e,i,n){const s=this._documents.getDocument(e);const r=await this._provider.provideDocumentFormattingEdits(s,i,n);if(Array.isArray(r)){return r.map(vi.from)}return void 0}}class l1{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentRangeFormattingEdits(e,i,n,s){const r=this._documents.getDocument(e);const o=V.to(i);const a=await this._provider.provideDocumentRangeFormattingEdits(r,o,n,s);if(Array.isArray(a)){return a.map(vi.from)}return void 0}async provideDocumentRangesFormattingEdits(e,i,n,s){FT(typeof this._provider.provideDocumentRangesFormattingEdits==="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const r=this._documents.getDocument(e);const o=i.map(V.to);const a=await this._provider.provideDocumentRangesFormattingEdits(r,o,n,s);if(Array.isArray(a)){return a.map(vi.from)}return void 0}}class jI{constructor(e,i){this._documents=e;this._provider=i;this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,i,n,s,r){const o=this._documents.getDocument(e);const a=ut.to(i);const l=await this._provider.provideOnTypeFormattingEdits(o,a,n,s,r);if(Array.isArray(l)){return l.map(vi.from)}return void 0}}class Bf{constructor(e,i){this._provider=e;this._logService=i;this._cache=new Wn("WorkspaceSymbols")}async provideWorkspaceSymbols(e,i){const n=await this._provider.provideWorkspaceSymbols(e,i);if(!rf(n)){return{symbols:[]}}const s=this._cache.add(n);const r={cacheId:s,symbols:[]};for(let o=0;o<n.length;o++){const a=n[o];if(!a||!a.name){this._logService.warn("INVALID SymbolInformation",a);continue}r.symbols.push({...pl.from(a),cacheId:[s,o]})}return r}async resolveWorkspaceSymbol(e,i){if(typeof this._provider.resolveWorkspaceSymbol!=="function"){return e}if(!e.cacheId){return e}const n=this._cache.get(...e.cacheId);if(n){const s=await this._provider.resolveWorkspaceSymbol(n,i);return s&&ol(e,pl.from(s),true)}return void 0}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class Ua{static supportsResolving(e){return typeof e.prepareRename==="function"}constructor(e,i,n){this._documents=e;this._provider=i;this._logService=n}async provideRenameEdits(e,i,n,s){const r=this._documents.getDocument(e);const o=ut.to(i);try{const a=await this._provider.provideRenameEdits(r,o,n,s);if(!a){return void 0}return Pn.from(a)}catch(a){const l=Ua._asMessage(a);if(l){return{rejectReason:l,edits:void 0}}else{return Promise.reject(a)}}}async resolveRenameLocation(e,i,n){if(typeof this._provider.prepareRename!=="function"){return Promise.resolve(void 0)}const s=this._documents.getDocument(e);const r=ut.to(i);try{const o=await this._provider.prepareRename(s,r,n);let a;let l;if(Fe.isRange(o)){a=o;l=s.getText(o)}else if(Gt(o)){a=o.range;l=o.placeholder}if(!a||!l){return void 0}if(a.start.line>r.line||a.end.line<r.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return void 0}return{range:V.from(a),text:l}}catch(o){const a=Ua._asMessage(o);if(a){return{rejectReason:a,range:void 0,text:void 0}}else{return Promise.reject(o)}}}static _asMessage(e){if(typeof e==="string"){return e}else if(e instanceof Error&&typeof e.message==="string"){return e.message}else{return void 0}}}class Ac{static{this.languageTriggerKindToVSCodeTriggerKind={[sg.Invoke]:wh.Invoke,[sg.Automatic]:wh.Automatic}}constructor(e,i,n){this._documents=e;this._provider=i;this._logService=n}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(e,i,n,s){const r=this._documents.getDocument(e);const o=V.to(i);try{const a=Ac.languageTriggerKindToVSCodeTriggerKind[n];const l=await this._provider.provideNewSymbolNames(r,o,a,s);if(!l){return void 0}return l.map(c=>typeof c==="string"?{newSymbolName:c}:{newSymbolName:c.newSymbolName,tags:c.tags})}catch(a){this._logService.error(Ac._asMessage(a)??JSON.stringify(a,null,"	"));return void 0}}static _asMessage(e){if(typeof e==="string"){return e}else if(e instanceof Error&&typeof e.message==="string"){return e.message}else{return void 0}}}class c1{constructor(e,i){this.resultId=e;this.tokens=i}}class En{constructor(e,i){this._documents=e;this._provider=i;this._nextResultId=1;this._previousResults=new Map}async provideDocumentSemanticTokens(e,i,n){const s=this._documents.getDocument(e);const r=i!==0?this._previousResults.get(i):null;let o=typeof r?.resultId==="string"&&typeof this._provider.provideDocumentSemanticTokensEdits==="function"?await this._provider.provideDocumentSemanticTokensEdits(s,r.resultId,n):await this._provider.provideDocumentSemanticTokens(s,n);if(r){this._previousResults.delete(i)}if(!o){return null}o=En._fixProvidedSemanticTokens(o);return this._send(En._convertToEdits(r,o),o)}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){if(En._isSemanticTokens(e)){if(En._isCorrectSemanticTokens(e)){return e}return new Zc(new Uint32Array(e.data),e.resultId)}else if(En._isSemanticTokensEdits(e)){if(En._isCorrectSemanticTokensEdits(e)){return e}return new _p(e.edits.map(i=>new sA(i.start,i.deleteCount,i.data?new Uint32Array(i.data):i.data)),e.resultId)}return e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const i of e.edits){if(!(i.data instanceof Uint32Array)){return false}}return true}static _convertToEdits(e,i){if(!En._isSemanticTokens(i)){return i}if(!e||!e.tokens){return i}const n=e.tokens;const s=n.length;const r=i.data;const o=r.length;let a=0;const l=Math.min(s,o);while(a<l&&n[a]===r[a]){a++}if(a===s&&a===o){return new _p([],i.resultId)}let c=0;const u=l-a;while(c<u&&n[s-c-1]===r[o-c-1]){c++}return new _p([{start:a,deleteCount:s-a-c,data:r.subarray(a,o-c)}],i.resultId)}_send(e,i){if(En._isSemanticTokens(e)){const n=this._nextResultId++;this._previousResults.set(n,new c1(e.resultId,e.data));return U0({id:n,type:"full",data:e.data})}if(En._isSemanticTokensEdits(e)){const n=this._nextResultId++;if(En._isSemanticTokens(i)){this._previousResults.set(n,new c1(i.resultId,i.data))}else{this._previousResults.set(n,new c1(e.resultId))}return U0({id:n,type:"delta",deltas:(e.edits||[]).map(s=>({start:s.start,deleteCount:s.deleteCount,data:s.data}))})}return null}}class GI{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentRangeSemanticTokens(e,i,n){const s=this._documents.getDocument(e);const r=await this._provider.provideDocumentRangeSemanticTokens(s,V.to(i),n);if(!r){return null}return this._send(r)}_send(e){return U0({id:0,type:"full",data:e.data})}}class ba{static supportsResolving(e){return typeof e.resolveCompletionItem==="function"}constructor(e,i,n,s,r){this._documents=e;this._commands=i;this._provider=n;this._apiDeprecation=s;this._extension=r;this._cache=new Wn("CompletionItem");this._disposables=new Map}async provideCompletionItems(e,i,n,s){const r=this._documents.getDocument(e);const o=ut.to(i);const a=r.getWordRangeAtPosition(o)||new Fe(o,o);const l=a.with({end:o});const c=new Wr;const u=await this._provider.provideCompletionItems(r,o,s,Gb.to(n));if(!u){return void 0}if(s.isCancellationRequested){return void 0}const d=Array.isArray(u)?new jc(u):u;const f=ba.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]);const p=new pe;this._disposables.set(f,p);const m=[];const v={x:f,[zl.completions]:m,[zl.defaultRanges]:{replace:V.from(a),insert:V.from(l)},[zl.isIncomplete]:d.isIncomplete||void 0,[zl.duration]:c.elapsed()};for(let y=0;y<d.items.length;y++){const k=d.items[y];const S=this._convertCompletionItem(k,[f,y],l,a);m.push(S)}return v}async resolveCompletionItem(e,i){if(typeof this._provider.resolveCompletionItem!=="function"){return void 0}const n=this._cache.get(...e);if(!n){return void 0}const s=this._convertCompletionItem(n,e);const r=await this._provider.resolveCompletionItem(n,i);if(!r){return void 0}const o=this._convertCompletionItem(r,e);if(s[Ue.insertText]!==o[Ue.insertText]||s[Ue.insertTextRules]!==o[Ue.insertTextRules]){this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve")}if(s[Ue.commandIdent]!==o[Ue.commandIdent]||s[Ue.commandId]!==o[Ue.commandId]||!Gi(s[Ue.commandArguments],o[Ue.commandArguments])){this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve")}return{...s,[Ue.documentation]:o[Ue.documentation],[Ue.detail]:o[Ue.detail],[Ue.additionalTextEdits]:o[Ue.additionalTextEdits],[Ue.insertText]:o[Ue.insertText],[Ue.insertTextRules]:o[Ue.insertTextRules],[Ue.commandIdent]:o[Ue.commandIdent],[Ue.commandId]:o[Ue.commandId],[Ue.commandArguments]:o[Ue.commandArguments]}}releaseCompletionItems(e){this._disposables.get(e)?.dispose();this._disposables.delete(e);this._cache.delete(e)}_convertCompletionItem(e,i,n,s){const r=this._disposables.get(i[0]);if(!r){throw Error("DisposableStore is missing...")}const o=this._commands.toInternal(e.command,r);const a={x:i,[Ue.label]:e.label,[Ue.kind]:e.kind!==void 0?Dm.from(e.kind):void 0,[Ue.kindModifier]:e.tags&&e.tags.map(km.from),[Ue.detail]:e.detail,[Ue.documentation]:typeof e.documentation==="undefined"?void 0:we.fromStrict(e.documentation),[Ue.sortText]:e.sortText!==e.label?e.sortText:void 0,[Ue.filterText]:e.filterText!==e.label?e.filterText:void 0,[Ue.preselect]:e.preselect||void 0,[Ue.insertTextRules]:e.keepWhitespace?qa.KeepWhitespace:qa.None,[Ue.commitCharacters]:e.commitCharacters?.join(""),[Ue.additionalTextEdits]:e.additionalTextEdits&&e.additionalTextEdits.map(vi.from),[Ue.commandIdent]:o?.$ident,[Ue.commandId]:o?.id,[Ue.commandArguments]:o?.$ident?void 0:o?.arguments};if(e.textEdit){this._apiDeprecation.report("CompletionItem.textEdit",this._extension,`Use 'CompletionItem.insertText' and 'CompletionItem.range' instead.`);a[Ue.insertText]=e.textEdit.newText}else if(typeof e.insertText==="string"){a[Ue.insertText]=e.insertText}else if(e.insertText instanceof ll){a[Ue.insertText]=e.insertText.value;a[Ue.insertTextRules]|=qa.InsertAsSnippet}let l;if(e.textEdit){l=e.textEdit.range}else if(e.range){l=e.range}if(Fe.isRange(l)){a[Ue.range]=V.from(l)}else if(l&&(!n?.isEqual(l.inserting)||!s?.isEqual(l.replacing))){a[Ue.range]={insert:V.from(l.inserting),replace:V.from(l.replacing)}}return a}}class no{constructor(e,i,n,s){this._extension=e;this._documents=i;this._provider=n;this._commands=s;this._references=new wH;this.languageTriggerKindToVSCodeTriggerKind={[eg.Automatic]:vh.Automatic,[eg.Explicit]:vh.Invoke};this._isAdditionsProposedApiEnabled=it(this._extension,"inlineCompletionsAdditions")}get supportsHandleEvents(){return it(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem==="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem==="function"||typeof this._provider.handleDidRejectCompletionItem==="function"||typeof this._provider.handleEndOfLifetime==="function")}get supportsSetModelId(){return it(this._extension,"inlineCompletionsAdditions")&&typeof this._provider.setCurrentModelId==="function"}get modelInfo(){if(!this._isAdditionsProposedApiEnabled){return void 0}return this._provider.modelInfo?{models:this._provider.modelInfo.models,currentModelId:this._provider.modelInfo.currentModelId}:void 0}setCurrentModelId(e){if(!this._isAdditionsProposedApiEnabled){return}this._provider.setCurrentModelId?.(e)}async provideInlineCompletions(e,i,n,s){const r=this._documents.getDocument(e);const o=ut.to(i);const a=await this._provider.provideInlineCompletionItems(r,o,{selectedCompletionInfo:n.selectedSuggestionInfo?{range:V.to(n.selectedSuggestionInfo.range),text:n.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[n.triggerKind],requestUuid:n.requestUuid,requestIssuedDateTime:n.requestIssuedDateTime,earliestShownDateTime:n.earliestShownDateTime,changeHint:n.changeHint},s);if(!a){return void 0}const{resultItems:l,list:c}=Array.isArray(a)?{resultItems:a,list:void 0}:{resultItems:a.items,list:a};const u=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[];const d=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let f=void 0;const p=this._references.createReferenceId({dispose(){f?.dispose()},items:l,list:c});const m={pid:p,languageId:r.languageId,items:l.map((v,y)=>{let k=void 0;if(v.command){if(!f){f=new pe}k=this._commands.toInternal(v.command,f)}let S=void 0;if(v.action){if(!f){f=new pe}S=this._commands.toInternal(v.action,f)}const R=v.insertText;return{insertText:R===void 0?void 0:typeof R==="string"?R:{snippet:R.value},range:v.range?V.from(v.range):void 0,showRange:this._isAdditionsProposedApiEnabled&&v.showRange?V.from(v.showRange):void 0,command:k,gutterMenuLinkAction:S,idx:y,completeBracketPairs:this._isAdditionsProposedApiEnabled?v.completeBracketPairs:false,isInlineEdit:this._isAdditionsProposedApiEnabled?v.isInlineEdit:false,showInlineEditMenu:this._isAdditionsProposedApiEnabled?v.showInlineEditMenu:false,hint:v.displayLocation&&this._isAdditionsProposedApiEnabled?{range:V.from(v.displayLocation.range),content:v.displayLocation.label,style:v.displayLocation.kind?by.from(v.displayLocation.kind):uc.Code}:void 0,warning:v.warning&&this._isAdditionsProposedApiEnabled?{message:we.from(v.warning.message),icon:v.warning.icon?Fr.fromThemeIcon(v.warning.icon):void 0}:void 0,correlationId:this._isAdditionsProposedApiEnabled?v.correlationId:void 0,suggestionId:void 0,uri:this._isAdditionsProposedApiEnabled&&v.uri?v.uri:void 0,supportsRename:this._isAdditionsProposedApiEnabled?v.supportsRename:false,jumpToPosition:this._isAdditionsProposedApiEnabled&&v.jumpToPosition?ut.from(v.jumpToPosition):void 0}}),commands:u.map(v=>{if(!f){f=new pe}return Kb.from(v,this._commands,f)}),suppressSuggestions:false,enableForwardStability:d};return m}disposeCompletions(e,i){const n=this._references.get(e);if(this._provider.handleListEndOfLifetime&&this._isAdditionsProposedApiEnabled&&n?.list){let r=function(o){switch(o.kind){case"lostRace":return{kind:kr.LostRace};case"tokenCancellation":return{kind:kr.TokenCancellation};case"other":return{kind:kr.Other};case"empty":return{kind:kr.Empty};case"notTaken":return{kind:kr.NotTaken};default:return{kind:kr.Other}}};this._provider.handleListEndOfLifetime(n.list,r(i))}const s=this._references.disposeReferenceId(e);s?.dispose()}handleDidShowCompletionItem(e,i,n){const s=this._references.get(e)?.items[i];if(s){if(this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled){this._provider.handleDidShowCompletionItem(s,n)}}}handlePartialAccept(e,i,n,s){const r=this._references.get(e)?.items[i];if(r){if(this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled){this._provider.handleDidPartiallyAcceptCompletionItem(r,n);this._provider.handleDidPartiallyAcceptCompletionItem(r,_y.to(s))}}}handleEndOfLifetime(e,i,n){const s=this._references.get(e)?.items[i];if(s){if(this._provider.handleEndOfLifetime&&this._isAdditionsProposedApiEnabled){const r=wy.to(n,o=>this._references.get(o.pid)?.items[o.idx]);this._provider.handleEndOfLifetime(s,r)}}}handleRejection(e,i){const n=this._references.get(e)?.items[i];if(n){if(this._provider.handleDidRejectCompletionItem&&this._isAdditionsProposedApiEnabled){this._provider.handleDidRejectCompletionItem(n)}}}}class wH{constructor(){this._references=new Map;this._idPool=1}createReferenceId(e){const i=this._idPool++;this._references.set(i,e);return i}disposeReferenceId(e){const i=this._references.get(e);this._references.delete(e);return i}get(e){return this._references.get(e)}}class u1{constructor(e,i){this._documents=e;this._provider=i;this._cache=new Wn("SignatureHelp")}async provideSignatureHelp(e,i,n,s){const r=this._documents.getDocument(e);const o=ut.to(i);const a=this.reviveContext(n);const l=await this._provider.provideSignatureHelp(r,o,s,a);if(l){const c=this._cache.add([l]);return{...Fh.from(l),id:c}}return void 0}reviveContext(e){let i=void 0;if(e.activeSignatureHelp){const n=Fh.to(e.activeSignatureHelp);const s=this._cache.get(e.activeSignatureHelp.id,0);if(s){i=s;i.activeSignature=n.activeSignature;i.activeParameter=n.activeParameter}else{i=n}}return{...e,activeSignatureHelp:i}}releaseSignatureHelp(e){this._cache.delete(e)}}class Wf{constructor(e,i,n,s,r){this._documents=e;this._commands=i;this._provider=n;this._logService=s;this._extension=r;this._cache=new Wn("InlayHints");this._disposables=new Map}async provideInlayHints(e,i,n){const s=this._documents.getDocument(e);const r=V.to(i);const o=await this._provider.provideInlayHints(s,r,n);if(!Array.isArray(o)||o.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(i)}`);return void 0}if(n.isCancellationRequested){return void 0}const a=this._cache.add(o);this._disposables.set(a,new pe);const l={hints:[],cacheId:a};for(let c=0;c<o.length;c++){if(this._isValidInlayHint(o[c],r)){l.hints.push(this._convertInlayHint(o[c],[a,c]))}}this._logService.trace(`[InlayHints] ${l.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(i)}`);return l}async resolveInlayHint(e,i){if(typeof this._provider.resolveInlayHint!=="function"){return void 0}const n=this._cache.get(...e);if(!n){return void 0}const s=await this._provider.resolveInlayHint(n,i);if(!s){return void 0}if(!this._isValidInlayHint(s)){return void 0}return this._convertInlayHint(s,e)}releaseHints(e){this._disposables.get(e)?.dispose();this._disposables.delete(e);this._cache.delete(e)}_isValidInlayHint(e,i){if(e.label.length===0||Array.isArray(e.label)&&e.label.every(n=>n.value.length===0)){console.log("INVALID inlay hint, empty label",e);return false}if(i&&!i.contains(e.position)){return false}return true}_convertInlayHint(e,i){const n=this._disposables.get(i[0]);if(!n){throw Error("DisposableStore is missing...")}const s={label:"",cacheId:i,tooltip:we.fromStrict(e.tooltip),position:ut.from(e.position),textEdits:e.textEdits&&e.textEdits.map(vi.from),kind:e.kind&&Pm.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label==="string"){s.label=e.label}else{const r=[];s.label=r;for(const o of e.label){if(!o.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const a={label:o.value,tooltip:we.fromStrict(o.tooltip)};if(Tn.isLocation(o.location)){a.location=wn.from(o.location)}if(o.command){a.command=this._commands.toInternal(o.command,n)}r.push(a)}}return s}}class Ao{constructor(e,i){this._documents=e;this._provider=i;this._cache=new Wn("DocumentLink")}async provideLinks(e,i){const n=this._documents.getDocument(e);const s=await this._provider.provideDocumentLinks(n,i);if(!Array.isArray(s)||s.length===0){return void 0}if(i.isCancellationRequested){return void 0}if(typeof this._provider.resolveDocumentLink!=="function"){return{links:s.filter(Ao._validateLink).map(Xa.from)}}else{const r=this._cache.add(s);const o={links:[],cacheId:r};for(let a=0;a<s.length;a++){if(!Ao._validateLink(s[a])){continue}const l=Xa.from(s[a]);l.cacheId=[r,a];o.links.push(l)}return o}}static _validateLink(e){if(e.target&&e.target.path.length>5e4){console.warn("DROPPING link because it is too long");return false}return true}async resolveLink(e,i){if(typeof this._provider.resolveDocumentLink!=="function"){return void 0}const n=this._cache.get(...e);if(!n){return void 0}const s=await this._provider.resolveDocumentLink(n,i);if(!s||!Ao._validateLink(s)){return void 0}return Xa.from(s)}releaseLinks(e){this._cache.delete(e)}}class d1{constructor(e,i){this._documents=e;this._provider=i}async provideColors(e,i){const n=this._documents.getDocument(e);const s=await this._provider.provideDocumentColors(n,i);if(!Array.isArray(s)){return[]}const r=s.map(o=>{return{color:ru.from(o.color),range:V.from(o.range)}});return r}async provideColorPresentations(e,i,n){const s=this._documents.getDocument(e);const r=V.to(i.range);const o=ru.to(i.color);const a=await this._provider.provideColorPresentations(o,{document:s,range:r},n);if(!Array.isArray(a)){return void 0}return a.map(Am.from)}}class KI{constructor(e,i){this._documents=e;this._provider=i}async provideFoldingRanges(e,i,n){const s=this._documents.getDocument(e);const r=await this._provider.provideFoldingRanges(s,i,n);if(!Array.isArray(r)){return void 0}return r.map(Nm.from)}}class QI{constructor(e,i,n){this._documents=e;this._provider=i;this._logService=n}async provideSelectionRanges(e,i,n){const s=this._documents.getDocument(e);const r=i.map(ut.to);const o=await this._provider.provideSelectionRanges(s,r,n);if(!rf(o)){return[]}if(o.length!==r.length){this._logService.warn("BAD selection ranges, provider must return ranges for each position");return[]}const a=[];for(let l=0;l<r.length;l++){const c=[];a.push(c);let u=r[l];let d=o[l];while(true){if(!d.range.contains(u)){throw new Error("INVALID selection range, must contain the previous range")}c.push(Xb.from(d));if(!d.parent){break}u=d.range;d=d.parent}}return a}}class Gu{constructor(e,i){this._documents=e;this._provider=i;this._idPool=new Rx("");this._cache=new Map}async prepareSession(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.prepareCallHierarchy(s,r,n);if(!o){return void 0}const a=this._idPool.nextId();this._cache.set(a,new Map);if(Array.isArray(o)){return o.map(l=>this._cacheAndConvertItem(a,l))}else{return[this._cacheAndConvertItem(a,o)]}}async provideCallsTo(e,i,n){const s=this._itemFromCache(e,i);if(!s){throw new Error("missing call hierarchy item")}const r=await this._provider.provideCallHierarchyIncomingCalls(s,n);if(!r){return void 0}return r.map(o=>{return{from:this._cacheAndConvertItem(e,o.from),fromRanges:o.fromRanges.map(a=>V.from(a))}})}async provideCallsFrom(e,i,n){const s=this._itemFromCache(e,i);if(!s){throw new Error("missing call hierarchy item")}const r=await this._provider.provideCallHierarchyOutgoingCalls(s,n);if(!r){return void 0}return r.map(o=>{return{to:this._cacheAndConvertItem(e,o.to),fromRanges:o.fromRanges.map(a=>V.from(a))}})}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,i){const n=this._cache.get(e);const s=gl.from(i,e,n.size.toString(36));n.set(s._itemId,i);return s}_itemFromCache(e,i){const n=this._cache.get(e);return n?.get(i)}}class Ku{constructor(e,i){this._documents=e;this._provider=i;this._idPool=new Rx("");this._cache=new Map}async prepareSession(e,i,n){const s=this._documents.getDocument(e);const r=ut.to(i);const o=await this._provider.prepareTypeHierarchy(s,r,n);if(!o){return void 0}const a=this._idPool.nextId();this._cache.set(a,new Map);if(Array.isArray(o)){return o.map(l=>this._cacheAndConvertItem(a,l))}else{return[this._cacheAndConvertItem(a,o)]}}async provideSupertypes(e,i,n){const s=this._itemFromCache(e,i);if(!s){throw new Error("missing type hierarchy item")}const r=await this._provider.provideTypeHierarchySupertypes(s,n);if(!r){return void 0}return r.map(o=>{return this._cacheAndConvertItem(e,o)})}async provideSubtypes(e,i,n){const s=this._itemFromCache(e,i);if(!s){throw new Error("missing type hierarchy item")}const r=await this._provider.provideTypeHierarchySubtypes(s,n);if(!r){return void 0}return r.map(o=>{return this._cacheAndConvertItem(e,o)})}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,i){const n=this._cache.get(e);const s=Za.from(i,e,n.size.toString(36));n.set(s._itemId,i);return s}_itemFromCache(e,i){const n=this._cache.get(e);return n?.get(i)}}class Vf{constructor(e,i,n,s,r){this._proxy=e;this._documents=i;this._provider=n;this._handle=s;this._extension=r;this._cache=new Wn("DocumentDropEdit")}async provideDocumentOnDropEdits(e,i,n,s,r){const o=this._documents.getDocument(i);const a=ut.to(n);const l=hu.toDataTransfer(s,async f=>{return(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,f)).buffer});const c=await this._provider.provideDocumentDropEdits(o,a,l,r);if(!c){return void 0}const u=Zn(c);const d=this._cache.add(u);return u.map((f,p)=>({_cacheId:[d,p],title:f.title??h(2696,"Drop using '{0}' extension",this._extension.displayName||this._extension.name),kind:f.kind?.value,yieldTo:f.yieldTo?.map(m=>m.value),insertText:typeof f.insertText==="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?Pn.from(f.additionalEdit,void 0):void 0}))}async resolveDropEdit(e,i){const[n,s]=e;const r=this._cache.get(n,s);if(!r||!this._provider.resolveDocumentDropEdit){return{}}const o=await this._provider.resolveDocumentDropEdit(r,i)??r;const a=o.additionalEdit?Pn.from(o.additionalEdit,void 0):void 0;return{additionalEdit:a}}releaseDropEdits(e){this._cache.delete(e)}}class Qu{constructor(e,i){this.adapter=e;this.extension=i}}class hi extends me{static{this._handlePool=0}get inlineCompletionsUnificationState(){return this._inlineCompletionsUnificationState}constructor(e,i,n,s,r,o,a,l){super();this._uriTransformer=i;this._documents=n;this._commands=s;this._diagnostics=r;this._logService=o;this._apiDeprecation=a;this._extensionTelemetry=l;this._adapter=new Map;this._onDidChangeInlineCompletionsUnificationState=this._register(new L);this.onDidChangeInlineCompletionsUnificationState=this._onDidChangeInlineCompletionsUnificationState.event;this._proxy=e.getProxy(ee.MainThreadLanguageFeatures);this._inlineCompletionsUnificationState={codeUnification:false,modelUnification:false,extensionUnification:false,expAssignments:[]}}_transformDocumentSelector(e,i){return hl.from(e,this._uriTransformer,i)}_createDisposable(e){return new Ve(()=>{this._adapter.delete(e);this._proxy.$unregister(e)})}_nextHandle(){return hi._handlePool++}async _withAdapter(e,i,n,s,r,o=false){const a=this._adapter.get(e);if(!a||!(a.adapter instanceof i)){return s}const l=Date.now();if(!o){this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${n.toString().replace(/[\r\n]/g,"")}'`)}const c=n(a.adapter,a.extension);Promise.resolve(c).catch(u=>{if(!Ls(u)){this._logService.error(`[${a.extension.identifier.value}] provider FAILED`);this._logService.error(u);this._extensionTelemetry.onExtensionError(a.extension.identifier,u)}}).finally(()=>{if(!o){this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-l}ms`)}});if(Ze.isCancellationToken(r)){return DS(c,r)}return c}_addNewAdapter(e,i){const n=this._nextHandle();this._adapter.set(n,new Qu(e,i));return n}static _extLabel(e){return e.displayName||e.name}static _extId(e){return e.identifier.value}registerDocumentSymbolProvider(e,i,n,s){const r=this._addNewAdapter(new x_(this._documents,n),e);const o=s&&s.label||hi._extLabel(e);this._proxy.$registerDocumentSymbolProvider(r,this._transformDocumentSelector(i,e),o);return this._createDisposable(r)}$provideDocumentSymbols(e,i,n){return this._withAdapter(e,x_,s=>s.provideDocumentSymbols(b.revive(i),n),void 0,n)}registerCodeLensProvider(e,i,n){const s=this._nextHandle();const r=typeof n.onDidChangeCodeLenses==="function"?this._nextHandle():void 0;this._adapter.set(s,new Qu(new Hf(this._documents,this._commands.converter,n,e,this._extensionTelemetry,this._logService),e));this._proxy.$registerCodeLensSupport(s,this._transformDocumentSelector(i,e),r);let o=this._createDisposable(s);if(r!==void 0){const a=n.onDidChangeCodeLenses(l=>this._proxy.$emitCodeLensEvent(r));o=Ve.from(o,a)}return o}$provideCodeLenses(e,i,n){return this._withAdapter(e,Hf,s=>s.provideCodeLenses(b.revive(i),n),void 0,n,i.scheme==="output")}$resolveCodeLens(e,i,n){return this._withAdapter(e,Hf,s=>s.resolveCodeLens(i,n),void 0,void 0,true)}$releaseCodeLenses(e,i){this._withAdapter(e,Hf,n=>Promise.resolve(n.releaseCodeLenses(i)),void 0,void 0,true)}registerDefinitionProvider(e,i,n){const s=this._addNewAdapter(new MI(this._documents,n),e);this._proxy.$registerDefinitionSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideDefinition(e,i,n,s){return this._withAdapter(e,MI,r=>r.provideDefinition(b.revive(i),n,s),[],s)}registerDeclarationProvider(e,i,n){const s=this._addNewAdapter(new OI(this._documents,n),e);this._proxy.$registerDeclarationSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideDeclaration(e,i,n,s){return this._withAdapter(e,OI,r=>r.provideDeclaration(b.revive(i),n,s),[],s)}registerImplementationProvider(e,i,n){const s=this._addNewAdapter(new FI(this._documents,n),e);this._proxy.$registerImplementationSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideImplementation(e,i,n,s){return this._withAdapter(e,FI,r=>r.provideImplementation(b.revive(i),n,s),[],s)}registerTypeDefinitionProvider(e,i,n){const s=this._addNewAdapter(new UI(this._documents,n),e);this._proxy.$registerTypeDefinitionSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideTypeDefinition(e,i,n,s){return this._withAdapter(e,UI,r=>r.provideTypeDefinition(b.revive(i),n,s),[],s)}registerHoverProvider(e,i,n,s){const r=this._addNewAdapter(new Fd(this._documents,n),e);this._proxy.$registerHoverProvider(r,this._transformDocumentSelector(i,e));return this._createDisposable(r)}$provideHover(e,i,n,s,r){return this._withAdapter(e,Fd,o=>o.provideHover(b.revive(i),n,s,r),void 0,r)}$releaseHover(e,i){this._withAdapter(e,Fd,n=>Promise.resolve(n.releaseHover(i)),void 0,void 0)}registerEvaluatableExpressionProvider(e,i,n,s){const r=this._addNewAdapter(new $I(this._documents,n),e);this._proxy.$registerEvaluatableExpressionProvider(r,this._transformDocumentSelector(i,e));return this._createDisposable(r)}$provideEvaluatableExpression(e,i,n,s){return this._withAdapter(e,$I,r=>r.provideEvaluatableExpression(b.revive(i),n,s),void 0,s)}registerInlineValuesProvider(e,i,n,s){const r=typeof n.onDidChangeInlineValues==="function"?this._nextHandle():void 0;const o=this._addNewAdapter(new HI(this._documents,n),e);this._proxy.$registerInlineValuesProvider(o,this._transformDocumentSelector(i,e),r);let a=this._createDisposable(o);if(r!==void 0){const l=n.onDidChangeInlineValues(c=>this._proxy.$emitInlineValuesEvent(r));a=Ve.from(a,l)}return a}$provideInlineValues(e,i,n,s,r){return this._withAdapter(e,HI,o=>o.provideInlineValues(b.revive(i),n,s,r),void 0,r)}registerDocumentHighlightProvider(e,i,n){const s=this._addNewAdapter(new BI(this._documents,n),e);this._proxy.$registerDocumentHighlightProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}registerMultiDocumentHighlightProvider(e,i,n){const s=this._addNewAdapter(new WI(this._documents,n,this._logService),e);this._proxy.$registerMultiDocumentHighlightProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideDocumentHighlights(e,i,n,s){return this._withAdapter(e,BI,r=>r.provideDocumentHighlights(b.revive(i),n,s),void 0,s)}$provideMultiDocumentHighlights(e,i,n,s,r){return this._withAdapter(e,WI,o=>o.provideMultiDocumentHighlights(b.revive(i),n,s.map(a=>b.revive(a)),r),void 0,r)}registerLinkedEditingRangeProvider(e,i,n){const s=this._addNewAdapter(new VI(this._documents,n),e);this._proxy.$registerLinkedEditingRangeProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideLinkedEditingRanges(e,i,n,s){return this._withAdapter(e,VI,async r=>{const o=await r.provideLinkedEditingRanges(b.revive(i),n,s);if(o){return{ranges:o.ranges,wordPattern:o.wordPattern?hi._serializeRegExp(o.wordPattern):void 0}}return void 0},void 0,s)}registerReferenceProvider(e,i,n){const s=this._addNewAdapter(new zI(this._documents,n),e);this._proxy.$registerReferenceSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideReferences(e,i,n,s,r){return this._withAdapter(e,zI,o=>o.provideReferences(b.revive(i),n,s,r),void 0,r)}registerCodeActionProvider(e,i,n,s){const r=new pe;const o=this._addNewAdapter(new Po(this._documents,this._commands.converter,this._diagnostics,n,this._logService,e,this._apiDeprecation),e);this._proxy.$registerCodeActionSupport(o,this._transformDocumentSelector(i,e),{providedKinds:s?.providedCodeActionKinds?.map(a=>a.value),documentation:s?.documentation?.map(a=>({kind:a.kind.value,command:this._commands.converter.toInternal(a.command,r)}))},hi._extLabel(e),hi._extId(e),Boolean(n.resolveCodeAction));r.add(this._createDisposable(o));return r}$provideCodeActions(e,i,n,s,r){return this._withAdapter(e,Po,o=>o.provideCodeActions(b.revive(i),n,s,r),void 0,r)}$resolveCodeAction(e,i,n){return this._withAdapter(e,Po,s=>s.resolveCodeAction(i,n),{},void 0)}$releaseCodeActions(e,i){this._withAdapter(e,Po,n=>Promise.resolve(n.releaseCodeActions(i)),void 0,void 0)}registerDocumentFormattingEditProvider(e,i,n){const s=this._addNewAdapter(new qI(this._documents,n),e);this._proxy.$registerDocumentFormattingSupport(s,this._transformDocumentSelector(i,e),e.identifier,e.displayName||e.name);return this._createDisposable(s)}$provideDocumentFormattingEdits(e,i,n,s){return this._withAdapter(e,qI,r=>r.provideDocumentFormattingEdits(b.revive(i),n,s),void 0,s)}registerDocumentRangeFormattingEditProvider(e,i,n){const s=typeof n.provideDocumentRangesFormattingEdits==="function";const r=this._addNewAdapter(new l1(this._documents,n),e);this._proxy.$registerRangeFormattingSupport(r,this._transformDocumentSelector(i,e),e.identifier,e.displayName||e.name,s);return this._createDisposable(r)}$provideDocumentRangeFormattingEdits(e,i,n,s,r){return this._withAdapter(e,l1,o=>o.provideDocumentRangeFormattingEdits(b.revive(i),n,s,r),void 0,r)}$provideDocumentRangesFormattingEdits(e,i,n,s,r){return this._withAdapter(e,l1,o=>o.provideDocumentRangesFormattingEdits(b.revive(i),n,s,r),void 0,r)}registerOnTypeFormattingEditProvider(e,i,n,s){const r=this._addNewAdapter(new jI(this._documents,n),e);this._proxy.$registerOnTypeFormattingSupport(r,this._transformDocumentSelector(i,e),s,e.identifier);return this._createDisposable(r)}$provideOnTypeFormattingEdits(e,i,n,s,r,o){return this._withAdapter(e,jI,a=>a.provideOnTypeFormattingEdits(b.revive(i),n,s,r,o),void 0,o)}registerWorkspaceSymbolProvider(e,i){const n=this._addNewAdapter(new Bf(i,this._logService),e);this._proxy.$registerNavigateTypeSupport(n,typeof i.resolveWorkspaceSymbol==="function");return this._createDisposable(n)}$provideWorkspaceSymbols(e,i,n){return this._withAdapter(e,Bf,s=>s.provideWorkspaceSymbols(i,n),{symbols:[]},n)}$resolveWorkspaceSymbol(e,i,n){return this._withAdapter(e,Bf,s=>s.resolveWorkspaceSymbol(i,n),void 0,void 0)}$releaseWorkspaceSymbols(e,i){this._withAdapter(e,Bf,n=>n.releaseWorkspaceSymbols(i),void 0,void 0)}registerRenameProvider(e,i,n){const s=this._addNewAdapter(new Ua(this._documents,n,this._logService),e);this._proxy.$registerRenameSupport(s,this._transformDocumentSelector(i,e),Ua.supportsResolving(n));return this._createDisposable(s)}$provideRenameEdits(e,i,n,s,r){return this._withAdapter(e,Ua,o=>o.provideRenameEdits(b.revive(i),n,s,r),void 0,r)}$resolveRenameLocation(e,i,n,s){return this._withAdapter(e,Ua,r=>r.resolveRenameLocation(b.revive(i),n,s),void 0,s)}registerNewSymbolNamesProvider(e,i,n){const s=this._addNewAdapter(new Ac(this._documents,n,this._logService),e);this._proxy.$registerNewSymbolNamesProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$supportsAutomaticNewSymbolNamesTriggerKind(e){return this._withAdapter(e,Ac,i=>i.supportsAutomaticNewSymbolNamesTriggerKind(),false,void 0)}$provideNewSymbolNames(e,i,n,s,r){return this._withAdapter(e,Ac,o=>o.provideNewSymbolNames(b.revive(i),n,s,r),void 0,r)}registerDocumentSemanticTokensProvider(e,i,n,s){const r=this._addNewAdapter(new En(this._documents,n),e);const o=typeof n.onDidChangeSemanticTokens==="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(r,this._transformDocumentSelector(i,e),s,o);let a=this._createDisposable(r);if(o){const l=n.onDidChangeSemanticTokens(c=>this._proxy.$emitDocumentSemanticTokensEvent(o));a=Ve.from(a,l)}return a}$provideDocumentSemanticTokens(e,i,n,s){return this._withAdapter(e,En,r=>r.provideDocumentSemanticTokens(b.revive(i),n,s),null,s)}$releaseDocumentSemanticTokens(e,i){this._withAdapter(e,En,n=>n.releaseDocumentSemanticColoring(i),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,i,n,s){const r=this._addNewAdapter(new GI(this._documents,n),e);const o=typeof n.onDidChangeSemanticTokens==="function"?this._nextHandle():void 0;this._proxy.$registerDocumentRangeSemanticTokensProvider(r,this._transformDocumentSelector(i,e),s,o);let a=this._createDisposable(r);if(o){const l=n.onDidChangeSemanticTokens(c=>this._proxy.$emitDocumentRangeSemanticTokensEvent(o));a=Ve.from(a,l)}return a}$provideDocumentRangeSemanticTokens(e,i,n,s){return this._withAdapter(e,GI,r=>r.provideDocumentRangeSemanticTokens(b.revive(i),n,s),null,s)}registerCompletionItemProvider(e,i,n,s){const r=this._addNewAdapter(new ba(this._documents,this._commands.converter,n,this._apiDeprecation,e),e);this._proxy.$registerCompletionsProvider(r,this._transformDocumentSelector(i,e),s,ba.supportsResolving(n),e.identifier);return this._createDisposable(r)}$provideCompletionItems(e,i,n,s,r){return this._withAdapter(e,ba,o=>o.provideCompletionItems(b.revive(i),n,s,r),void 0,r)}$resolveCompletionItem(e,i,n){return this._withAdapter(e,ba,s=>s.resolveCompletionItem(i,n),void 0,n)}$releaseCompletionItems(e,i){this._withAdapter(e,ba,n=>n.releaseCompletionItems(i),void 0,void 0)}registerInlineCompletionsProvider(e,i,n,s){const r=new no(e,this._documents,n,this._commands.converter);const o=this._addNewAdapter(r,e);let a=this._createDisposable(o);const l=it(e,"inlineCompletionsAdditions")&&typeof n.onDidChange==="function";if(l){const u=n.onDidChange(d=>this._proxy.$emitInlineCompletionsChange(o,d?{data:d.data}:void 0));a=Ve.from(a,u)}const c=it(e,"inlineCompletionsAdditions")&&typeof n.onDidChangeModelInfo==="function";if(c){const u=n.onDidChangeModelInfo(d=>this._proxy.$emitInlineCompletionModelInfoChange(o,r.modelInfo));a=Ve.from(a,u)}this._proxy.$registerInlineCompletionsSupport(o,this._transformDocumentSelector(i,e),r.supportsHandleEvents,ht.toKey(e.identifier.value),e.version,s?.groupId?ht.toKey(s.groupId):void 0,s?.yieldTo?.map(u=>ht.toKey(u))||[],s?.displayName,s?.debounceDelayMs,s?.excludes?.map(u=>ht.toKey(u))||[],l,r.supportsSetModelId,r.modelInfo,c);return a}$provideInlineCompletions(e,i,n,s,r){return this._withAdapter(e,no,o=>o.provideInlineCompletions(b.revive(i),n,s,r),void 0,void 0)}$handleInlineCompletionDidShow(e,i,n,s){this._withAdapter(e,no,async r=>{r.handleDidShowCompletionItem(i,n,s)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,i,n,s,r){this._withAdapter(e,no,async o=>{o.handlePartialAccept(i,n,s,r)},void 0,void 0)}$handleInlineCompletionEndOfLifetime(e,i,n,s){this._withAdapter(e,no,async r=>{r.handleEndOfLifetime(i,n,s)},void 0,void 0)}$handleInlineCompletionRejection(e,i,n){this._withAdapter(e,no,async s=>{s.handleRejection(i,n)},void 0,void 0)}$freeInlineCompletionsList(e,i,n){this._withAdapter(e,no,async s=>{s.disposeCompletions(i,n)},void 0,void 0)}$acceptInlineCompletionsUnificationState(e){this._inlineCompletionsUnificationState=e;this._onDidChangeInlineCompletionsUnificationState.fire()}$handleInlineCompletionSetCurrentModelId(e,i){this._withAdapter(e,no,async n=>{n.setCurrentModelId(i)},void 0,void 0)}registerSignatureHelpProvider(e,i,n,s){const r=Array.isArray(s)?{triggerCharacters:s,retriggerCharacters:[]}:s;const o=this._addNewAdapter(new u1(this._documents,n),e);this._proxy.$registerSignatureHelpProvider(o,this._transformDocumentSelector(i,e),r);return this._createDisposable(o)}$provideSignatureHelp(e,i,n,s,r){return this._withAdapter(e,u1,o=>o.provideSignatureHelp(b.revive(i),n,s,r),void 0,r)}$releaseSignatureHelp(e,i){this._withAdapter(e,u1,n=>n.releaseSignatureHelp(i),void 0,void 0)}registerInlayHintsProvider(e,i,n){const s=typeof n.onDidChangeInlayHints==="function"?this._nextHandle():void 0;const r=this._addNewAdapter(new Wf(this._documents,this._commands.converter,n,this._logService,e),e);this._proxy.$registerInlayHintsProvider(r,this._transformDocumentSelector(i,e),typeof n.resolveInlayHint==="function",s,hi._extLabel(e));let o=this._createDisposable(r);if(s!==void 0){const a=n.onDidChangeInlayHints(l=>this._proxy.$emitInlayHintsEvent(s));o=Ve.from(o,a)}return o}$provideInlayHints(e,i,n,s){return this._withAdapter(e,Wf,r=>r.provideInlayHints(b.revive(i),n,s),void 0,s)}$resolveInlayHint(e,i,n){return this._withAdapter(e,Wf,s=>s.resolveInlayHint(i,n),void 0,n)}$releaseInlayHints(e,i){this._withAdapter(e,Wf,n=>n.releaseHints(i),void 0,void 0)}registerDocumentLinkProvider(e,i,n){const s=this._addNewAdapter(new Ao(this._documents,n),e);this._proxy.$registerDocumentLinkProvider(s,this._transformDocumentSelector(i,e),typeof n.resolveDocumentLink==="function");return this._createDisposable(s)}$provideDocumentLinks(e,i,n){return this._withAdapter(e,Ao,s=>s.provideLinks(b.revive(i),n),void 0,n,i.scheme==="output")}$resolveDocumentLink(e,i,n){return this._withAdapter(e,Ao,s=>s.resolveLink(i,n),void 0,void 0,true)}$releaseDocumentLinks(e,i){this._withAdapter(e,Ao,n=>n.releaseLinks(i),void 0,void 0,true)}registerColorProvider(e,i,n){const s=this._addNewAdapter(new d1(this._documents,n),e);this._proxy.$registerDocumentColorProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideDocumentColors(e,i,n){return this._withAdapter(e,d1,s=>s.provideColors(b.revive(i),n),[],n)}$provideColorPresentations(e,i,n,s){return this._withAdapter(e,d1,r=>r.provideColorPresentations(b.revive(i),n,s),void 0,s)}registerFoldingRangeProvider(e,i,n){const s=this._nextHandle();const r=typeof n.onDidChangeFoldingRanges==="function"?this._nextHandle():void 0;this._adapter.set(s,new Qu(new KI(this._documents,n),e));this._proxy.$registerFoldingRangeProvider(s,this._transformDocumentSelector(i,e),e.identifier,r);let o=this._createDisposable(s);if(r!==void 0){const a=n.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(r));o=Ve.from(o,a)}return o}$provideFoldingRanges(e,i,n,s){return this._withAdapter(e,KI,r=>r.provideFoldingRanges(b.revive(i),n,s),void 0,s)}registerSelectionRangeProvider(e,i,n){const s=this._addNewAdapter(new QI(this._documents,n,this._logService),e);this._proxy.$registerSelectionRangeProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideSelectionRanges(e,i,n,s){return this._withAdapter(e,QI,r=>r.provideSelectionRanges(b.revive(i),n,s),[],s)}registerCallHierarchyProvider(e,i,n){const s=this._addNewAdapter(new Gu(this._documents,n),e);this._proxy.$registerCallHierarchyProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$prepareCallHierarchy(e,i,n,s){return this._withAdapter(e,Gu,r=>Promise.resolve(r.prepareSession(b.revive(i),n,s)),void 0,s)}$provideCallHierarchyIncomingCalls(e,i,n,s){return this._withAdapter(e,Gu,r=>r.provideCallsTo(i,n,s),void 0,s)}$provideCallHierarchyOutgoingCalls(e,i,n,s){return this._withAdapter(e,Gu,r=>r.provideCallsFrom(i,n,s),void 0,s)}$releaseCallHierarchy(e,i){this._withAdapter(e,Gu,n=>Promise.resolve(n.releaseSession(i)),void 0,void 0)}registerTypeHierarchyProvider(e,i,n){const s=this._addNewAdapter(new Ku(this._documents,n),e);this._proxy.$registerTypeHierarchyProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$prepareTypeHierarchy(e,i,n,s){return this._withAdapter(e,Ku,r=>Promise.resolve(r.prepareSession(b.revive(i),n,s)),void 0,s)}$provideTypeHierarchySupertypes(e,i,n,s){return this._withAdapter(e,Ku,r=>r.provideSupertypes(i,n,s),void 0,s)}$provideTypeHierarchySubtypes(e,i,n,s){return this._withAdapter(e,Ku,r=>r.provideSubtypes(i,n,s),void 0,s)}$releaseTypeHierarchy(e,i){this._withAdapter(e,Ku,n=>Promise.resolve(n.releaseSession(i)),void 0,void 0)}registerDocumentOnDropEditProvider(e,i,n,s){const r=this._nextHandle();this._adapter.set(r,new Qu(new Vf(this._proxy,this._documents,n,r,e),e));this._proxy.$registerDocumentOnDropEditProvider(r,this._transformDocumentSelector(i,e),s?{supportsResolve:!!n.resolveDocumentDropEdit,dropMimeTypes:s.dropMimeTypes,providedDropKinds:s.providedDropEditKinds?.map(o=>o.value)}:void 0);return this._createDisposable(r)}$provideDocumentOnDropEdits(e,i,n,s,r,o){return this._withAdapter(e,Vf,a=>Promise.resolve(a.provideDocumentOnDropEdits(i,b.revive(n),s,r,o)),void 0,void 0)}$resolveDropEdit(e,i,n){return this._withAdapter(e,Vf,s=>s.resolveDropEdit(i,n),{},void 0)}$releaseDocumentOnDropEdits(e,i){this._withAdapter(e,Vf,n=>Promise.resolve(n.releaseDropEdits(i)),void 0,void 0)}registerDocumentPasteEditProvider(e,i,n,s){const r=this._nextHandle();this._adapter.set(r,new Qu(new ju(this._proxy,this._documents,n,r,e),e));this._proxy.$registerPasteEditProvider(r,this._transformDocumentSelector(i,e),{supportsCopy:!!n.prepareDocumentPaste,supportsPaste:!!n.provideDocumentPasteEdits,supportsResolve:!!n.resolveDocumentPasteEdit,providedPasteEditKinds:s.providedPasteEditKinds?.map(o=>o.value),copyMimeTypes:s.copyMimeTypes,pasteMimeTypes:s.pasteMimeTypes});return this._createDisposable(r)}$prepareDocumentPaste(e,i,n,s,r){return this._withAdapter(e,ju,o=>o.prepareDocumentPaste(b.revive(i),n,s,r),void 0,r)}$providePasteEdits(e,i,n,s,r,o,a){return this._withAdapter(e,ju,l=>l.providePasteEdits(i,b.revive(n),s,r,o,a),void 0,a)}$resolvePasteEdit(e,i,n){return this._withAdapter(e,ju,s=>s.resolvePasteEdit(i,n),{},void 0)}$releasePasteEdits(e,i){this._withAdapter(e,ju,n=>Promise.resolve(n.releasePasteEdits(i)),void 0,void 0)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:hi._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:hi._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?hi._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?hi._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:hi._serializeRegExp(e.beforeText),afterText:e.afterText?hi._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?hi._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(hi._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(i=>Kc.toString(i)):void 0}}static _serializeAutoClosingPairs(e){return e.map(hi._serializeAutoClosingPair)}setLanguageConfiguration(e,i,n){const{wordPattern:s}=n;if(s&&c4(s)){throw new Error(`Invalid language configuration: wordPattern '${s}' is not allowed to match the empty string.`)}if(s){this._documents.setWordDefinitionFor(i,s)}else{this._documents.setWordDefinitionFor(i,void 0)}if(n.__electricCharacterSupport){this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,`Do not use.`)}if(n.__characterPairSupport){this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,`Do not use.`)}const r=this._nextHandle();const o={comments:n.comments,brackets:n.brackets,wordPattern:n.wordPattern?hi._serializeRegExp(n.wordPattern):void 0,indentationRules:n.indentationRules?hi._serializeIndentationRule(n.indentationRules):void 0,onEnterRules:n.onEnterRules?hi._serializeOnEnterRules(n.onEnterRules):void 0,__electricCharacterSupport:n.__electricCharacterSupport,__characterPairSupport:n.__characterPairSupport,autoClosingPairs:n.autoClosingPairs?hi._serializeAutoClosingPairs(n.autoClosingPairs):void 0};this._proxy.$setLanguageConfiguration(r,i,o);return this._createDisposable(r)}$setWordDefinitions(e){for(const i of e){this._documents.setWordDefinitionFor(i.languageId,new RegExp(i.regexSource,i.regexFlags))}}}const bH=te("notebookService");const yH=te("codeMapperService");const k5=te("IChatService");const JI="vscode_editFile";const q0="vscode_editFile_internal";const SH={id:q0,displayName:"",modelDescription:"",source:Bo.Internal};let j0=class _q{constructor(e,i,n){this.chatService=e;this.codeMapperService=i;this.notebookService=n}async invoke(e,i,n,s){if(!e.context){throw new Error("toolInvocationToken is required for this tool")}const r=e.parameters;const o=b.revive(r.uri);const a=xw.parse(o)?.notebook||o;const l=this.chatService.getSession(e.context.sessionResource);const c=l.getRequests().at(-1);l.acceptResponseProgress(c,{kind:"markdownContent",content:new Ho("\n````\n")});l.acceptResponseProgress(c,{kind:"codeblockUri",uri:a,isEdit:true});l.acceptResponseProgress(c,{kind:"markdownContent",content:new Ho("\n````\n")});if(this.notebookService.hasSupportedNotebooks(a)&&this.notebookService.getNotebookTextModel(a)){l.acceptResponseProgress(c,{kind:"notebookEdit",edits:[],uri:a})}else{l.acceptResponseProgress(c,{kind:"textEdit",edits:[],uri:a})}const u=l.editingSession;if(!u){throw new Error("This tool must be called from within an editing session")}const d=await this.codeMapperService.mapCode({codeBlocks:[{code:r.code,resource:a,markdownBeforeBlock:r.explanation}],location:"tool",chatRequestId:e.chatRequestId,chatRequestModel:e.modelId,chatSessionResource:e.context.sessionResource},{textEdit:(p,m)=>{l.acceptResponseProgress(c,{kind:"textEdit",uri:p,edits:m})},notebookEdit(p,m){l.acceptResponseProgress(c,{kind:"notebookEdit",uri:p,edits:m})}},s);if(this.notebookService.hasSupportedNotebooks(a)&&this.notebookService.getNotebookTextModel(a)){l.acceptResponseProgress(c,{kind:"notebookEdit",uri:a,edits:[],done:true})}else{l.acceptResponseProgress(c,{kind:"textEdit",uri:a,edits:[],done:true})}if(d?.errorMessage){throw new Error(d.errorMessage)}let f;await new Promise(p=>{let m=false;f=ag(v=>{const y=u.entries.read(v);const k=y?.find(S=>S.modifiedURI.toString()===a.toString());if(k){if(k.isCurrentlyBeingModifiedBy.read(v)){m=true}else if(m){p(true)}}})}).finally(()=>{f.dispose()});return{content:[{kind:"text",value:"The file was edited successfully"}]}}async prepareToolInvocation(e,i){return{presentation:Bc.Hidden}}};j0=W([P(0,k5),P(1,yH),P(2,bH)],j0);const E_=te("ILanguageModelToolsService");const xH="vscode_get_confirmation";const EH={id:xH,displayName:"Confirmation Tool",modelDescription:"A tool that demonstrates different types of confirmations. Takes a title, message, and confirmation type (basic or terminal).",source:Bo.Internal,inputSchema:{type:"object",properties:{title:{type:"string",description:"Title for the confirmation dialog"},message:{type:"string",description:"Message to show in the confirmation dialog"},confirmationType:{type:"string",enum:["basic","terminal"],description:"Type of confirmation to show - basic for simple confirmation, terminal for terminal command confirmation"},terminalCommand:{type:"string",description:'Terminal command to show (only used when confirmationType is "terminal")'}},required:["title","message","confirmationType"],additionalProperties:false}};class CH{async prepareToolInvocation(e,i){const n=e.parameters;if(!n.title||!n.message){throw new Error("Missing required parameters for ConfirmationTool")}const s=n.confirmationType??"basic";let r;if(s==="terminal"){r={kind:"terminal",commandLine:{original:n.terminalCommand??""},language:"bash"}}else{r=void 0}return{confirmationMessages:{title:n.title,message:new Ho(n.message),allowAutoConfirm:true},toolSpecificData:r,presentation:Bc.HiddenAfterComplete}}async invoke(e,i,n,s){return{content:[{kind:"text",value:"yes"}]}}}const kH=te("chatTodoListService");const D5="manage_todo_list";function I5(){const t={type:"object",properties:{todoList:{type:"array",description:"Complete array of all todo items. Must include ALL items - both existing and new.",items:{type:"object",properties:{id:{type:"number",description:"Unique identifier for the todo. Use sequential numbers starting from 1."},title:{type:"string",description:"Concise action-oriented todo label (3-7 words). Displayed in UI."},status:{type:"string",enum:["not-started","in-progress","completed"],description:"not-started: Not begun | in-progress: Currently working (max 1) | completed: Fully finished with no blockers"}},required:["id","title","status"]}}},required:["todoList"]};return{id:D5,toolReferenceName:"todo",legacyToolReferenceFullNames:["todos"],canBeReferencedInPrompt:true,icon:Kt.fromId(_e.checklist.id),displayName:h(6572,"Manage and track todo items for task planning"),userDescription:h(6573,"Manage and track todo items for task planning"),modelDescription:"Manage a structured todo list to track progress and plan tasks throughout your coding session. Use this tool VERY frequently to ensure task visibility and proper planning.\n\nWhen to use this tool:\n- Complex multi-step work requiring planning and tracking\n- When user provides multiple tasks or requests (numbered/comma-separated)\n- After receiving new instructions that require multiple steps\n- BEFORE starting work on any todo (mark as in-progress)\n- IMMEDIATELY after completing each todo (mark completed individually)\n- When breaking down larger tasks into smaller actionable steps\n- To give users visibility into your progress and planning\n\nWhen NOT to use:\n- Single, trivial tasks that can be completed in one step\n- Purely conversational/informational requests\n- When just reading files or performing simple searches\n\nCRITICAL workflow:\n1. Plan tasks by writing todo list with specific, actionable items\n2. Mark ONE todo as in-progress before starting work\n3. Complete the work for that specific todo\n4. Mark that todo as completed IMMEDIATELY\n5. Move to next todo and repeat\n\nTodo states:\n- not-started: Todo not yet begun\n- in-progress: Currently working (limit ONE at a time)\n- completed: Finished successfully\n\nIMPORTANT: Mark todos completed as soon as they are done. Do not batch completions.",source:Bo.Internal,inputSchema:t}}I5();let G0=class vq extends me{constructor(e,i,n){super();this.chatTodoListService=e;this.logService=i;this.telemetryService=n}async invoke(e,i,n,s){const r=e.parameters;let o=e.context?.sessionResource;if(!o&&r.operation==="read"&&r.chatSessionResource){try{o=b.parse(r.chatSessionResource)}catch(a){this.logService.error("ManageTodoListTool: Invalid chatSessionResource URI",a)}}if(!o){return{content:[{kind:"text",value:"Error: No session resource available"}]}}this.logService.debug(`ManageTodoListTool: Invoking with options ${JSON.stringify(r)}`);try{if(r.operation==="read"){return this.handleReadOperation(o)}else{return this.handleWriteOperation(r,o)}}catch(a){const l=`Error: ${a instanceof Error?a.message:"Unknown error"}`;return{content:[{kind:"text",value:l}]}}}async prepareToolInvocation(e,i){const n=e.parameters;const s=e.chatSessionResource;if(!s){return void 0}const r=this.chatTodoListService.getTodos(s);let o;if(n.operation==="read"){o=h(6574,"Read todo list")}else if(n.todoList){o=this.generatePastTenseMessage(r,n.todoList)}const a=n.todoList??r;const l=a.map(c=>({id:c.id.toString(),title:c.title,status:c.status}));return{pastTenseMessage:new Ho(o??h(6575,"Updated todo list")),toolSpecificData:{kind:"todoList",todoList:l}}}generatePastTenseMessage(e,i){if(e.length===0){return i.length===1?h(6576,"Created 1 todo"):h(6577,"Created {0} todos",i.length)}const n=new Map(e.map(a=>[a.id,a]));const s=i.filter(a=>{const l=n.get(a.id);return l&&l.status!=="in-progress"&&a.status==="in-progress"});if(s.length>0){const a=s[0];const l=i.length;const c=i.findIndex(u=>u.id===a.id)+1;return h(6578,"Starting: *{0}* ({1}/{2})",a.title,c,l)}const r=i.filter(a=>{const l=n.get(a.id);return l&&l.status!=="completed"&&a.status==="completed"});if(r.length>0){const a=r[0];const l=i.length;const c=i.findIndex(u=>u.id===a.id)+1;return h(6579,"Completed: *{0}* ({1}/{2})",a.title,c,l)}const o=i.filter(a=>!n.has(a.id));if(o.length>0){return o.length===1?h(6580,"Added 1 todo"):h(6581,"Added {0} todos",o.length)}return h(6582,"Updated todo list")}handleRead(e,i){if(e.length===0){return"No todo list found."}const n=this.formatTodoListAsMarkdownTaskList(e);return`# Todo List

${n}`}handleReadOperation(e){const i=this.chatTodoListService.getTodos(e);const n=this.handleRead(i,e);const s=this.calculateStatusCounts(i);this.telemetryService.publicLog2("todoListToolInvoked",{operation:"read",notStartedCount:s.notStartedCount,inProgressCount:s.inProgressCount,completedCount:s.completedCount});return{content:[{kind:"text",value:n}]}}handleWriteOperation(e,i){if(!e.todoList){return{content:[{kind:"text",value:"Error: todoList is required for write operation"}]}}const n=e.todoList.map(l=>({id:l.id,title:l.title,status:l.status}));const s=this.chatTodoListService.getTodos(i);const r=this.calculateTodoChanges(s,n);this.chatTodoListService.setTodos(i,n);const o=this.calculateStatusCounts(n);const a=[];if(n.length<3){a.push("Warning: Small todo list (<3 items). This task might not need a todo list.")}else if(n.length>10){a.push("Warning: Large todo list (>10 items). Consider keeping the list focused and actionable.")}if(r>3){a.push("Warning: Did you mean to update so many todos at the same time? Consider working on them one by one.")}this.telemetryService.publicLog2("todoListToolInvoked",{operation:"write",notStartedCount:o.notStartedCount,inProgressCount:o.inProgressCount,completedCount:o.completedCount});return{content:[{kind:"text",value:`Successfully wrote todo list${a.length?"\n\n"+a.join("\n"):""}`}],toolMetadata:{warnings:a}}}calculateStatusCounts(e){const i=e.filter(r=>r.status==="not-started").length;const n=e.filter(r=>r.status==="in-progress").length;const s=e.filter(r=>r.status==="completed").length;return{notStartedCount:i,inProgressCount:n,completedCount:s}}formatTodoListAsMarkdownTaskList(e){if(e.length===0){return""}return e.map(i=>{let n;switch(i.status){case"completed":n="[x]";break;case"in-progress":n="[-]";break;case"not-started":default:n="[ ]";break}const s=[`- ${n} ${i.title}`];return s.join("\n")}).join("\n")}calculateTodoChanges(e,i){let n=0;const s=Math.min(e.length,i.length);for(let l=0;l<s;l++){const c=e[l];const u=i[l];if(c.title!==u.title||c.status!==u.status){n++}}const r=Math.max(0,i.length-e.length);const o=Math.max(0,e.length-i.length);const a=r+o+n;return a}};G0=W([P(0,kH),P(1,et),P(2,mf)],G0);const DH=te("ILanguageModelsService");const IH=te("chatAgentService");te("chatAgentNameService");const TH=te("labelService");var mi;(function(t){t["local"]="local";t["user"]="user";t["extension"]="extension"})(mi||(mi={}));var YI;(function(t){t["contribution"]="contribution";t["provider"]="provider"})(YI||(YI={}));var XI;(function(t){t["VSCode"]="vscode";t["GitHubCopilot"]="github-copilot";t["Claude"]="claude";t["Undefined"]="undefined"})(XI||(XI={}));var C_;(function(t){t["agentsMd"]="agentsMd";t["claudeMd"]="claudeMd";t["copilotInstructionsMd"]="copilotInstructionsMd"})(C_||(C_={}));const{basename:PH,dirname:T5}=mt;const AH=".prompt.md";const RH=".instructions.md";const LH=".chatmode.md";const NH=".agent.md";const MH="SKILL.md";const OH="copilot-instructions.md";const FH=".github/prompts";const UH=".github/instructions";const P5=".github/agents";const Ux=".claude/agents";const K0=".claude/rules";var Si;(function(t){t["GitHubWorkspace"]="github-workspace";t["CopilotPersonal"]="copilot-personal";t["ClaudePersonal"]="claude-personal";t["ClaudeWorkspace"]="claude-workspace";t["ClaudeWorkspaceLocal"]="claude-workspace-local";t["AgentsWorkspace"]="agents-workspace";t["AgentsPersonal"]="agents-personal";t["ConfigWorkspace"]="config-workspace";t["ConfigPersonal"]="config-personal";t["ExtensionContribution"]="extension-contribution";t["ExtensionAPI"]="extension-api"})(Si||(Si={}));const $H=[{path:".github/skills",source:Si.GitHubWorkspace,storage:mi.local},{path:".agents/skills",source:Si.AgentsWorkspace,storage:mi.local},{path:".claude/skills",source:Si.ClaudeWorkspace,storage:mi.local},{path:"~/.copilot/skills",source:Si.CopilotPersonal,storage:mi.user},{path:"~/.agents/skills",source:Si.AgentsPersonal,storage:mi.user},{path:"~/.claude/skills",source:Si.ClaudePersonal,storage:mi.user}];const HH=[{path:UH,source:Si.GitHubWorkspace,storage:mi.local},{path:K0,source:Si.ClaudeWorkspace,storage:mi.local},{path:"~/"+K0,source:Si.ClaudePersonal,storage:mi.user}];const BH=[{path:FH,source:Si.GitHubWorkspace,storage:mi.local}];const WH=[{path:P5,source:Si.GitHubWorkspace,storage:mi.local},{path:Ux,source:Si.ClaudeWorkspace,storage:mi.local}];const VH=[{path:".github/hooks",source:Si.GitHubWorkspace,storage:mi.local},{path:".claude/settings.local.json",source:Si.ClaudeWorkspaceLocal,storage:mi.local},{path:".claude/settings.json",source:Si.ClaudeWorkspace,storage:mi.local},{path:"~/.claude/settings.json",source:Si.ClaudePersonal,storage:mi.user}];function zH(t){const e=T5(t.path);return e.endsWith("/"+P5)||e.endsWith("/"+Ux)}function qH(t){const e=T5(t.path);return e.endsWith("/"+Ux)}function A5(t){const e=t.path;return e.includes("/"+K0+"/")}function jH(t){const e=PH(t.path);if(e.endsWith(AH)){return Ct.prompt}if(e.endsWith(RH)||e===OH){return Ct.instructions}if(e.endsWith(LH)||e.endsWith(NH)){return Ct.agent}if(e.toLowerCase()===MH.toLowerCase()){return Ct.skill}if(e.endsWith(".md")&&e!=="README.md"&&zH(t)){return Ct.agent}if(e.endsWith(".md")&&e!=="README.md"&&A5(t)){return Ct.instructions}if(e.toLowerCase().endsWith(".json")){return Ct.hook}return void 0}function ZI(t){return jH(t)!==void 0}function GH(t){switch(t){case Ct.instructions:return HH;case Ct.prompt:return BH;case Ct.agent:return WH;case Ct.skill:return $H;case Ct.hook:return VH;default:throw new Error("Unknown prompt type")}}var Ss;(function(t){t.PROMPT_LOCATIONS_KEY="chat.promptFilesLocations";t.INSTRUCTIONS_LOCATION_KEY="chat.instructionsFilesLocations";t.MODE_LOCATION_KEY="chat.modeFilesLocations";t.AGENTS_LOCATION_KEY="chat.agentFilesLocations";t.SKILLS_LOCATION_KEY="chat.agentSkillsLocations";t.HOOKS_LOCATION_KEY="chat.hookFilesLocations";t.PROMPT_FILES_SUGGEST_KEY="chat.promptFilesRecommendations";t.USE_COPILOT_INSTRUCTION_FILES="github.copilot.chat.codeGeneration.useInstructionFiles";t.USE_AGENT_MD="chat.useAgentsMdFile";t.USE_NESTED_AGENT_MD="chat.useNestedAgentsMdFiles";t.USE_CLAUDE_MD="chat.useClaudeMdFile";t.USE_AGENT_SKILLS="chat.useAgentSkills";t.USE_CHAT_HOOKS="chat.useHooks";t.USE_CLAUDE_HOOKS="chat.useClaudeHooks";t.USE_SKILL_ADHERENCE_PROMPT="chat.experimental.useSkillAdherencePrompt";t.INCLUDE_APPLYING_INSTRUCTIONS="chat.includeApplyingInstructions";t.INCLUDE_REFERENCED_INSTRUCTIONS="chat.includeReferencedInstructions";function e(s,r){const o=KH(r);const a=s.getValue(o);if(a===void 0||a===null||Array.isArray(a)){return void 0}if(typeof a==="object"){const l={};for(const[c,u]of Object.entries(a)){const d=c.trim();const f=eT(u);if(f!==void 0&&d){l[d]=f}}return l}return void 0}t.getLocationsValue=e;function i(s,r){const o=e(s,r);const a=GH(r);if(o&&typeof o==="object"){const l=[];const c=new Set(a.map(u=>u.path));for(const u of a){if(o[u.path]!==false){l.push(u)}}for(const[u,d]of Object.entries(o)){if(d===false||c.has(u)){continue}const f=QH(u)?mi.user:mi.local;l.push({path:u,source:f===mi.local?Si.ConfigPersonal:Si.ConfigWorkspace,storage:f})}return l}return[]}t.promptSourceFolders=i;function n(s,r){const o=s.getValue(t.PROMPT_FILES_SUGGEST_KEY,{resource:r});if(!o||typeof o!=="object"||Array.isArray(o)){return void 0}const a={};for(const[l,c]of Object.entries(o)){const u=l.trim();if(!u){continue}if(typeof c==="boolean"){a[u]=c;continue}if(typeof c==="string"){const f=c.trim();if(f){a[u]=f}continue}const d=eT(c);if(d!==void 0){a[u]=d}}return Object.keys(a).length>0?a:void 0}t.getPromptFilesRecommendationsValue=n})(Ss||(Ss={}));function KH(t){switch(t){case Ct.instructions:return Ss.INSTRUCTIONS_LOCATION_KEY;case Ct.prompt:return Ss.PROMPT_LOCATIONS_KEY;case Ct.agent:return Ss.AGENTS_LOCATION_KEY;case Ct.skill:return Ss.SKILLS_LOCATION_KEY;case Ct.hook:return Ss.HOOKS_LOCATION_KEY;default:throw new Error("Unknown prompt type")}}function eT(t){if(typeof t==="boolean"){return t}if(typeof t==="string"){const e=t.trim().toLowerCase();if(e==="true"){return true}if(e==="false"){return false}return void 0}return void 0}function QH(t){return t.startsWith("~/")}const R5=te("IPromptsService");class hn{static fromTo(e,i){return new hn(e,i)}static equals(e,i){return e.start===i.start&&e.endExclusive===i.endExclusive}static addRange(e,i){let n=0;while(n<i.length&&i[n].endExclusive<e.start){n++}let s=n;while(s<i.length&&i[s].start<=e.endExclusive){s++}if(n===s){i.splice(n,0,e)}else{const r=Math.min(e.start,i[n].start);const o=Math.max(e.endExclusive,i[s-1].endExclusive);i.splice(n,s-n,new hn(r,o))}}static tryCreate(e,i){if(e>i){return void 0}return new hn(e,i)}static ofLength(e){return new hn(0,e)}static ofStartAndLength(e,i){return new hn(e,e+i)}static emptyAt(e){return new hn(e,e)}constructor(e,i){this.start=e;this.endExclusive=i;if(e>i){throw new li(`Invalid range: ${this.toString()}`)}}get isEmpty(){return this.start===this.endExclusive}delta(e){return new hn(this.start+e,this.endExclusive+e)}deltaStart(e){return new hn(this.start+e,this.endExclusive)}deltaEnd(e){return new hn(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new hn(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const i=Math.max(this.start,e.start);const n=Math.min(this.endExclusive,e.endExclusive);if(i<=n){return new hn(i,n)}return void 0}intersectionLength(e){const i=Math.max(this.start,e.start);const n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-i)}intersects(e){const i=Math.max(this.start,e.start);const n=Math.min(this.endExclusive,e.endExclusive);return i<n}intersectsOrTouches(e){const i=Math.max(this.start,e.start);const n=Math.min(this.endExclusive,e.endExclusive);return i<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty){throw new li(`Invalid clipping range: ${this.toString()}`)}return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty){throw new li(`Invalid clipping range: ${this.toString()}`)}if(e<this.start){return this.endExclusive-(this.start-e)%this.length}if(e>=this.endExclusive){return this.start+(e-this.start)%this.length}return e}map(e){const i=[];for(let n=this.start;n<this.endExclusive;n++){i.push(e(n))}return i}forEach(e){for(let i=this.start;i<this.endExclusive;i++){e(i)}}joinRightTouching(e){if(this.endExclusive!==e.start){throw new li(`Invalid join: ${this.toString()} and ${e.toString()}`)}return new hn(this.start,e.endExclusive)}withMargin(e,i){if(i===void 0){i=e}return new hn(this.start-e,this.endExclusive+i)}}function JH(){return{applyingInstructionsCount:0,referencedInstructionsCount:0,agentInstructionsCount:0,listedInstructionsCount:0,totalInstructionsCount:0,claudeRulesCount:0,claudeMdCount:0,claudeAgentsCount:0}}let Q0=class wq{constructor(e,i,n,s,r,o,a,l,c,u,d){this._modeKind=e;this._enabledTools=i;this._enabledSubagents=n;this._promptsService=s;this._logService=r;this._labelService=o;this._configurationService=a;this._workspaceService=l;this._fileService=c;this._telemetryService=u;this._languageModelToolsService=d;this._parseResults=new It}async _parseInstructionsFile(e,i){if(this._parseResults.has(e)){return this._parseResults.get(e)}try{const n=await this._promptsService.parseNew(e,i);this._parseResults.set(e,n);return n}catch(n){this._logService.error(`[InstructionsContextComputer] Failed to parse instruction file: ${e}`,n);return void 0}}async collect(e,i){const n=await this._promptsService.listPromptFiles(Ct.instructions,i);this._logService.trace(`[InstructionsContextComputer] ${n.length} instruction files available.`);const s=JH();const r=this._getContext(e);await this.addApplyingInstructions(n,r,e,s,i);await this._addReferencedInstructions(e,s,i);await this._addAgentInstructions(e,s,i);const o=await this._getInstructionsWithPatternsList(n,e,s,i);if(o){e.add(o);s.listedInstructionsCount++}this.sendTelemetry(s)}sendTelemetry(e){e.totalInstructionsCount=e.agentInstructionsCount+e.referencedInstructionsCount+e.applyingInstructionsCount+e.listedInstructionsCount;this._telemetryService.publicLog2("instructionsCollected",e)}async addApplyingInstructions(e,i,n,s,r){const o=this._configurationService.getValue(Ss.INCLUDE_APPLYING_INSTRUCTIONS);if(!o&&this._modeKind!==Vr.Edit){this._logService.trace(`[InstructionsContextComputer] includeApplyingInstructions is disabled and agent kind is not Edit. No applying instructions will be added.`);return}for(const{uri:a}of e){const l=await this._parseInstructionsFile(a,r);if(!l){this._logService.trace(`[InstructionsContextComputer] Unable to read: ${a}`);continue}const c=l.header?.applyTo;const u=l.header?.paths;const d=A5(a);const f=d?u?.join(", ")??"**":c;if(!f){this._logService.trace(`[InstructionsContextComputer] No 'applyTo' found: ${a}`);continue}if(i.instructions.has(a)){this._logService.trace(`[InstructionsContextComputer] Skipping already processed instruction file: ${a}`);continue}const p=this._matches(i.files,f);if(p){this._logService.trace(`[InstructionsContextComputer] Match for ${a} with ${p.pattern}${p.file?` for file ${p.file}`:""}`);const m=!p.file?h(6370,"Automatically attached as pattern is **"):h(6371,"Automatically attached as pattern {0} matches {1}",f,this._labelService.getUriLabel(p.file,{relative:true}));n.add(Wv(a,ja.Instruction,m,true));s.applyingInstructionsCount++;if(d){s.claudeRulesCount++}}else{this._logService.trace(`[InstructionsContextComputer] No match for ${a} with ${f}`)}}}_getContext(e){const i=new ad;const n=new ad;for(const s of e.asArray()){if(ew(s)){n.add(s.value)}else{const r=Z1.toUri(s);if(r){i.add(r)}}}return{files:i,instructions:n}}async _addAgentInstructions(e,i,n){const s={logInfo:l=>this._logService.trace(`[InstructionsContextComputer] ${l}`)};const r=await this._promptsService.listAgentInstructions(n,s);const o=new tw;const a=new tw;for(const{uri:l,type:c}of r){const u=Wv(l,ja.Instruction,void 0,true);o.add(u);if(c===C_.copilotInstructionsMd){a.add(u)}i.agentInstructionsCount++;if(c===C_.claudeMd){i.claudeMdCount++}s.logInfo(`Agent instruction file added: ${l.toString()}`)}if(a.length>0){await this._addReferencedInstructions(a,i,n);for(const l of a.asArray()){e.add(l)}}for(const l of o.asArray()){e.add(l)}}_getApplyToPattern(e,i){if(e){return e}if(i&&i.length>0){return i.join(", ")}return void 0}_matches(e,i){const n=bg(i,",");const s=r=>{r=r.trim();if(r.length===0){return void 0}if(r==="**"||r==="**/*"||r==="*"){return{pattern:r}}if(!r.startsWith("/")&&!r.startsWith("**/")){r="**/"+r}for(const o of e){if(dc(r,o.path,{ignoreCase:true})){return{pattern:r,file:o}}}return void 0};for(const r of n){const o=s(r);if(o){return o}}return void 0}_getTool(e){if(!this._enabledTools){return void 0}const i=this._languageModelToolsService.getToolByName(e);if(i&&this._enabledTools[i.id]){return{tool:i,variable:`#tool:${this._languageModelToolsService.getFullReferenceName(i)}`}}return void 0}async _getInstructionsWithPatternsList(e,i,n,s){const r=this._getTool("readFile");const o=this._getTool(ug.runSubagent);const a=[];if(r){const d=this._configurationService.getValue(Ss.USE_NESTED_AGENT_MD);const f=d?this._promptsService.listNestedAgentMDs(s):Promise.resolve([]);a.push("<instructions>");a.push("Here is a list of instruction files that contain rules for working with this codebase.");a.push("These files are important for understanding the codebase structure, conventions, and best practices.");a.push("Please make sure to follow the rules specified in these files when working with the codebase.");a.push(`If the file is not already available as attachment, use the ${r.variable} tool to acquire it.`);a.push("Make sure to acquire the instructions before working with the codebase.");let p=false;for(const{uri:k}of e){const S=await this._parseInstructionsFile(k,s);if(S){a.push("<instruction>");if(S.header){const{description:R,applyTo:K,paths:q}=S.header;if(R){a.push(`<description>${R}</description>`)}a.push(`<file>${zf(k)}</file>`);const se=this._getApplyToPattern(K,q);if(se){a.push(`<applyTo>${se}</applyTo>`)}}else{a.push(`<file>${zf(k)}</file>`)}a.push("</instruction>");p=true}}const m=await f;for(const{uri:k}of m){const S=this._labelService.getUriLabel(lf(k),{relative:true});const R=S.trim().length===0?h(6372,"Instructions for the workspace"):h(6373,"Instructions for folder '{0}'",S);a.push("<instruction>");a.push(`<description>${R}</description>`);a.push(`<file>${zf(k)}</file>`);a.push("</instruction>");p=true}if(!p){a.length=0}else{a.push("</instructions>","","")}const v=await this._promptsService.findAgentSkills(s);const y=v?.filter(k=>!k.disableModelInvocation);if(y&&y.length>0){const k=this._configurationService.getValue(Ss.USE_SKILL_ADHERENCE_PROMPT);a.push("<skills>");if(k){a.push("Skills provide specialized capabilities, domain knowledge, and refined workflows for producing high-quality outputs. Each skill folder contains tested instructions for specific domains like testing strategies, API design, or performance optimization. Multiple skills can be combined when a task spans different domains.");a.push(`BLOCKING REQUIREMENT: When a skill applies to the user's request, you MUST load and read the SKILL.md file IMMEDIATELY as your first action, BEFORE generating any other response or taking action on the task. Use ${r.variable} to load the relevant skill(s).`);a.push("NEVER just mention or reference a skill in your response without actually reading it first. If a skill is relevant, load it before proceeding.");a.push("How to determine if a skill applies:");a.push("1. Review the available skills below and match their descriptions against the user's request");a.push("2. If any skill's domain overlaps with the task, load that skill immediately");a.push("3. When multiple skills apply (e.g., a flowchart in documentation), load all relevant skills");a.push("Examples:");a.push(`- "Help me write unit tests for this module" -> Load the testing skill via ${r.variable} FIRST, then proceed`);a.push(`- "Optimize this slow function" -> Load the performance-profiling skill via ${r.variable} FIRST, then proceed`);a.push(`- "Add a discount code field to checkout" -> Load both the checkout-flow and form-validation skills FIRST`);a.push("Available skills:")}else{a.push("Here is a list of skills that contain domain specific knowledge on a variety of topics.");a.push("Each skill comes with a description of the topic and a file path that contains the detailed instructions.");a.push(`When a user asks you to perform a task that falls within the domain of a skill, use the ${r.variable} tool to acquire the full instructions from the file URI.`)}for(const S of y){a.push("<skill>");a.push(`<name>${S.name}</name>`);if(S.description){a.push(`<description>${S.description}</description>`)}a.push(`<file>${zf(S.uri)}</file>`);a.push("</skill>")}a.push("</skills>","","")}}if(o&&this._configurationService.getValue(Xd.SubagentToolCustomAgents)){const d=(()=>{if(!this._enabledSubagents||this._enabledSubagents.includes("*")){return p=>p.visibility.agentInvokable}else{const p=this._enabledSubagents;return m=>p.includes(m.name)}})();const f=await this._promptsService.getCustomAgents(s);if(f.length>0){a.push("<agents>");a.push("Here is a list of agents that can be used when running a subagent.");a.push("Each agent has optionally a description with the agent's purpose and expertise. When asked to run a subagent, choose the most appropriate agent from this list.");a.push(`Use the ${o.variable} tool with the agent name to run the subagent.`);for(const p of f){if(d(p)){a.push("<agent>");a.push(`<name>${p.name}</name>`);if(p.description){a.push(`<description>${p.description}</description>`)}if(p.argumentHint){a.push(`<argumentHint>${p.argumentHint}</argumentHint>`)}a.push("</agent>");if(qH(p.uri)){n.claudeAgentsCount++}}}a.push("</agents>","","")}}if(a.length===0){return void 0}const l=a.join("\n");const c=[];const u=d=>{if(d){let f=l.indexOf(d.variable);while(f>=0){c.push(x9(d.tool,new hn(f,f+d.variable.length)));f=l.indexOf(d.variable,f+1)}}};u(r);u(o);return S9(l,true,c)}async _addReferencedInstructions(e,i,n){const s=this._configurationService.getValue(Ss.INCLUDE_REFERENCED_INSTRUCTIONS);if(!s&&this._modeKind!==Vr.Edit){this._logService.trace(`[InstructionsContextComputer] includeReferencedInstructions is disabled and agent kind is not Edit. No referenced instructions will be added.`);return}const r=new ad;const o=[];for(const l of e.asArray()){if(ew(l)){if(!r.has(l.value)){o.push(l.value);r.add(l.value)}}}let a=o.pop();while(a){const l=await this._parseInstructionsFile(a,n);if(l&&l.body){const c=[];for(const u of l.body.fileReferences){const d=l.body.resolveFilePath(u.content);if(d&&!r.has(d)&&(ZI(d)||this._workspaceService.getWorkspaceFolder(d)!==void 0)){c.push({resource:d});r.add(d)}}if(c.length>0){const u=await this._fileService.resolveAll(c);for(let d=0;d<u.length;d++){const f=u[d];const p=c[d].resource;if(f.success&&f.stat?.isFile){if(ZI(p)){o.push(p)}const m=h(6374,"Referenced by {0}",ts(a));e.add(Wv(p,ja.InstructionReference,m,true));i.referencedInstructionsCount++;this._logService.trace(`[InstructionsContextComputer] ${p.toString()} added, referenced by ${a.toString()}`)}}}}a=o.pop()}}};Q0=W([P(3,R5),P(4,et),P(5,TH),P(6,Xo),P(7,Dx),P(8,$_),P(9,mf),P(10,E_)],Q0);function zf(t){if(t.scheme===ne.file||t.scheme===ne.vscodeRemote){return t.fsPath}return t.toString()}function h1(t){return{content:[{kind:"text",value:t}]}}var Cp;function tT(t){if(!t){return 1e3}const e=/^([\d.]+)\s*[xX]$/i.exec(t.trim());if(!e){return 1}const i=parseFloat(e[1]);return isNaN(i)?1:i}const YH=`Launch a new agent to handle complex, multi-step tasks autonomously. This tool is good at researching complex questions, searching for code, and executing multi-step tasks. When you are searching for a keyword or file and are not confident that you will find the right match in the first few tries, use this agent to perform the search for you.

- Agents do not run async or in the background, you will wait for the agent's result.
- When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.
- Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.
- The agent's outputs should generally be trusted
- Clearly tell the agent whether you expect it to write code or just to do research (search, file reads, web fetches, etc.), since it is not aware of the user's intent`;let J0=class bq extends me{static{Cp=this}static{this.Id="runSubagent"}constructor(e,i,n,s,r,o,a,l,c){super();this.chatAgentService=e;this.chatService=i;this.languageModelToolsService=n;this.languageModelsService=s;this.logService=r;this.toolsService=o;this.configurationService=a;this.promptsService=l;this.instantiationService=c;this._resolvedModels=new Map;this.onDidUpdateToolData=wt.filter(this.configurationService.onDidChangeConfiguration,u=>u.affectsConfiguration(Xd.SubagentToolCustomAgents))}getToolData(){let e=YH;const i={type:"object",properties:{prompt:{type:"string",description:"A detailed description of the task for the agent to perform"},description:{type:"string",description:"A short (3-5 word) description of the task"}},required:["prompt","description"]};if(this.configurationService.getValue(Xd.SubagentToolCustomAgents)){i.properties.agentName={type:"string",description:"Optional name of a specific agent to invoke. If not provided, uses the current agent."};e+=`
- If the user asks for a certain agent, you MUST provide that EXACT agent name (case-sensitive) to invoke that specific agent.`}const n={id:Cp.Id,toolReferenceName:ug.runSubagent,icon:Kt.fromId(_e.organization.id),displayName:h(6583,"Run Subagent"),userDescription:h(6584,"Run a task within an isolated subagent context to enable efficient organization of tasks and context window management."),modelDescription:e,source:Bo.Internal,inputSchema:i};return n}async invoke(e,i,n,s){const r=e.parameters;this.logService.debug(`RunSubagentTool: Invoking with prompt: ${r.prompt.substring(0,100)}...`);if(!e.context){throw new Error("toolInvocationToken is required for this tool")}const o=this.chatService.getSession(e.context.sessionResource);if(!o){throw new Error("Chat model not found for session")}const a=o.getRequests().at(-1);const l=new pe;try{const c=this.chatAgentService.getDefaultAgent(ki.Chat,Vr.Agent);if(!c){return h1("Error: No default agent available")}let u=e.modelId;let d=e.userSelectedTools;let f;let p;let m;const v=r.agentName;if(v){p=await this.getSubAgentByName(v);if(p){const Re=this._resolvedModels.get(e.callId);if(Re){this._resolvedModels.delete(e.callId);u=Re.modeModelId;m=Re.resolvedModelName}else{const Z=this.resolveSubagentModel(p,e.modelId);u=Z.modeModelId;m=Z.resolvedModelName}const Ne=p.tools;if(Ne){const Z=this.languageModelToolsService.toToolAndToolSetEnablementMap(Ne,void 0);d={};for(const[Y,J]of Z){if(!f3(Y)){d[Y.id]=J}}}const He=p.agentInstructions;f=He&&{name:v,content:He.content,toolReferences:this.toolsService.toToolReferences(He.toolReferences),metadata:He.metadata}}else{throw new Error(`Requested agent '${v}' not found. Try again with the correct agent name, or omit the agentName to use the current agent.`)}}else{const Re=this._resolvedModels.get(e.callId);if(Re){this._resolvedModels.delete(e.callId);m=Re.resolvedModelName}else{const Ne=u?this.languageModelsService.lookupLanguageModel(u):void 0;m=Ne?.name}}const y=[];const k=e.callId??`subagent-${Pi()}`;let S=false;const R=Re=>{for(const Ne of Re){if(Ne.kind==="textEdit"||Ne.kind==="notebookEdit"||Ne.kind==="codeblockUri"){if(Ne.kind==="codeblockUri"&&!S){S=true;o.acceptResponseProgress(a,{kind:"markdownContent",content:new Ho("```\n")})}if(Ne.kind==="codeblockUri"){o.acceptResponseProgress(a,{...Ne,subAgentInvocationId:k})}else{o.acceptResponseProgress(a,Ne)}}else if(Ne.kind==="hook"){o.acceptResponseProgress(a,{...Ne,subAgentInvocationId:k})}else if(Ne.kind==="markdownContent"){if(S){o.acceptResponseProgress(a,{kind:"markdownContent",content:new Ho("\n```\n\n")});S=false}y.push(Ne.content.value)}}};if(d){d[Cp.Id]=false;d[D5]=false;d["copilot_askQuestions"]=false}const K=new tw;const q=this.instantiationService.createInstance(Q0,Vr.Agent,d,void 0);await q.collect(K,s);let se;try{const Re=await this.promptsService.getHooks(s);se=Re?.hooks}catch(Re){this.logService.warn("[ChatService] Failed to collect hooks:",Re)}const j={sessionResource:e.context.sessionResource,requestId:e.callId??`subagent-${Date.now()}`,agentId:c.id,message:r.prompt,variables:{variables:K.asArray()},location:ki.Chat,subAgentInvocationId:e.callId,subAgentName:v,userSelectedModelId:u,userSelectedTools:d,modeInstructions:f,hooks:se,hasHooksEnabled:!!se&&Object.values(se).some(Re=>Re.length>0)};l.add(this.languageModelToolsService.onDidInvokeTool(Re=>{if(Re.subagentInvocationId===k){y.length=0}}));const Q=await this.chatAgentService.invokeAgent(c.id,j,R,[],s);if(Q.errorDetails){return h1(`Agent error: ${Q.errorDetails.message}`)}const le=y.join("").replace(/^\n*```\n+```\n*/g,"").trim()||"Agent completed with no output";if(e.toolSpecificData?.kind==="subagent"){e.toolSpecificData.result=le;e.toolSpecificData.modelName=m}return{content:[{kind:"text",value:le}],toolMetadata:{subAgentInvocationId:k,description:r.description,agentName:j.subAgentName,modelName:m}}}catch(c){const u=`Error invoking subagent: ${c instanceof Error?c.message:"Unknown error"}`;this.logService.error(u,c);return h1(u)}finally{l.dispose()}}async getSubAgentByName(e){const i=await this.promptsService.getCustomAgents(Ze.None);return i.find(n=>n.name===e)}resolveSubagentModel(e,i){let n=i;if(e){const r=e.model;if(r){e:for(const o of r){const a=this.languageModelsService.lookupLanguageModelByQualifiedName(o);for(const l of this.languageModelsService.getLanguageModelIds()){const c=this.languageModelsService.lookupLanguageModel(l);if(c&&c?.id===a?.id){n=l;break e}}}}if(n&&n!==i){const o=i?this.languageModelsService.lookupLanguageModel(i):void 0;const a=this.languageModelsService.lookupLanguageModel(n);const l=tT(o?.multiplier);const c=tT(a?.multiplier);if(c>l){this.logService.warn(`[RunSubagentTool] Subagent '${e.name}' requested model '${a?.name}' (multiplier: ${a?.multiplier??"unknown"}) which has a larger multiplier than the main agent model '${o?.name}' (multiplier: ${o?.multiplier??"unknown"}). Falling back to the main agent model.`);n=i}}}const s=n?this.languageModelsService.lookupLanguageModel(n):void 0;return{modeModelId:n,resolvedModelName:s?.name}}async prepareToolInvocation(e,i){const n=e.parameters;const s=n.agentName?await this.getSubAgentByName(n.agentName):void 0;const r=this.resolveSubagentModel(s,e.modelId);this._resolvedModels.set(e.toolCallId,r);return{invocationMessage:n.description,toolSpecificData:{kind:"subagent",description:n.description,agentName:s?.name,prompt:n.prompt,modelName:r.resolvedModelName}}}};J0=Cp=W([P(0,IH),P(1,k5),P(2,E_),P(3,DH),P(4,et),P(5,E_),P(6,Xo),P(7,R5),P(8,yl)],J0);let iT=class yq extends me{static{this.ID="chat.builtinTools"}constructor(e,i){super();const n=i.createInstance(j0);this._register(e.registerTool(SH,n));const s=I5();const r=this._register(i.createInstance(G0));this._register(e.registerTool(s,r));const o=i.createInstance(CH);this._register(e.registerTool(EH,o));const a=this._register(i.createInstance(J0));let l;let c;const u=()=>{l?.dispose();c?.dispose();e.flushToolUpdates();const d=a.getToolData();l=e.registerTool(d,a);c=e.agentToolSet.addTool(d)};u();this._register(a.onDidUpdateToolData(u));this._register({dispose:()=>{l?.dispose();c?.dispose()}})}};iT=W([P(0,E_),P(1,yl)],iT);const XH="vscode_fetchWebPage_internal";const L5=te("commandService");const $x=new class{constructor(){this._commands=new Map;this._onDidRegisterCommand=new L;this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(t,e){if(!t){throw new Error(`invalid command`)}if(typeof t==="string"){if(!e){throw new Error(`invalid command`)}return this.registerCommand({id:t,handler:e})}if(t.metadata&&Array.isArray(t.metadata.args)){const o=[];for(const l of t.metadata.args){o.push(l.constraint)}const a=t.handler;t.handler=function(l,...c){rR(c,o);return a(l,...c)}}const{id:i}=t;let n=this._commands.get(i);if(!n){n=new Go;this._commands.set(i,n)}const s=n.unshift(t);const r=ye(()=>{s();const o=this._commands.get(i);if(o?.isEmpty()){this._commands.delete(i)}});this._onDidRegisterCommand.fire(i);return I1(r)}registerCommandAlias(t,e){return $x.registerCommand(t,(i,...n)=>i.get(L5).executeCommand(e,...n))}getCommand(t){const e=this._commands.get(t);if(!e||e.isEmpty()){return void 0}return qi.first(e)}getCommands(){const t=new Map;for(const e of this._commands.keys()){const i=this.getCommand(e);if(i){t.set(e,i)}}return t}};$x.registerCommand("noop",()=>{});var D;(function(t){t[t["DependsOnKbLayout"]=-1]="DependsOnKbLayout";t[t["Unknown"]=0]="Unknown";t[t["Backspace"]=1]="Backspace";t[t["Tab"]=2]="Tab";t[t["Enter"]=3]="Enter";t[t["Shift"]=4]="Shift";t[t["Ctrl"]=5]="Ctrl";t[t["Alt"]=6]="Alt";t[t["PauseBreak"]=7]="PauseBreak";t[t["CapsLock"]=8]="CapsLock";t[t["Escape"]=9]="Escape";t[t["Space"]=10]="Space";t[t["PageUp"]=11]="PageUp";t[t["PageDown"]=12]="PageDown";t[t["End"]=13]="End";t[t["Home"]=14]="Home";t[t["LeftArrow"]=15]="LeftArrow";t[t["UpArrow"]=16]="UpArrow";t[t["RightArrow"]=17]="RightArrow";t[t["DownArrow"]=18]="DownArrow";t[t["Insert"]=19]="Insert";t[t["Delete"]=20]="Delete";t[t["Digit0"]=21]="Digit0";t[t["Digit1"]=22]="Digit1";t[t["Digit2"]=23]="Digit2";t[t["Digit3"]=24]="Digit3";t[t["Digit4"]=25]="Digit4";t[t["Digit5"]=26]="Digit5";t[t["Digit6"]=27]="Digit6";t[t["Digit7"]=28]="Digit7";t[t["Digit8"]=29]="Digit8";t[t["Digit9"]=30]="Digit9";t[t["KeyA"]=31]="KeyA";t[t["KeyB"]=32]="KeyB";t[t["KeyC"]=33]="KeyC";t[t["KeyD"]=34]="KeyD";t[t["KeyE"]=35]="KeyE";t[t["KeyF"]=36]="KeyF";t[t["KeyG"]=37]="KeyG";t[t["KeyH"]=38]="KeyH";t[t["KeyI"]=39]="KeyI";t[t["KeyJ"]=40]="KeyJ";t[t["KeyK"]=41]="KeyK";t[t["KeyL"]=42]="KeyL";t[t["KeyM"]=43]="KeyM";t[t["KeyN"]=44]="KeyN";t[t["KeyO"]=45]="KeyO";t[t["KeyP"]=46]="KeyP";t[t["KeyQ"]=47]="KeyQ";t[t["KeyR"]=48]="KeyR";t[t["KeyS"]=49]="KeyS";t[t["KeyT"]=50]="KeyT";t[t["KeyU"]=51]="KeyU";t[t["KeyV"]=52]="KeyV";t[t["KeyW"]=53]="KeyW";t[t["KeyX"]=54]="KeyX";t[t["KeyY"]=55]="KeyY";t[t["KeyZ"]=56]="KeyZ";t[t["Meta"]=57]="Meta";t[t["ContextMenu"]=58]="ContextMenu";t[t["F1"]=59]="F1";t[t["F2"]=60]="F2";t[t["F3"]=61]="F3";t[t["F4"]=62]="F4";t[t["F5"]=63]="F5";t[t["F6"]=64]="F6";t[t["F7"]=65]="F7";t[t["F8"]=66]="F8";t[t["F9"]=67]="F9";t[t["F10"]=68]="F10";t[t["F11"]=69]="F11";t[t["F12"]=70]="F12";t[t["F13"]=71]="F13";t[t["F14"]=72]="F14";t[t["F15"]=73]="F15";t[t["F16"]=74]="F16";t[t["F17"]=75]="F17";t[t["F18"]=76]="F18";t[t["F19"]=77]="F19";t[t["F20"]=78]="F20";t[t["F21"]=79]="F21";t[t["F22"]=80]="F22";t[t["F23"]=81]="F23";t[t["F24"]=82]="F24";t[t["NumLock"]=83]="NumLock";t[t["ScrollLock"]=84]="ScrollLock";t[t["Semicolon"]=85]="Semicolon";t[t["Equal"]=86]="Equal";t[t["Comma"]=87]="Comma";t[t["Minus"]=88]="Minus";t[t["Period"]=89]="Period";t[t["Slash"]=90]="Slash";t[t["Backquote"]=91]="Backquote";t[t["BracketLeft"]=92]="BracketLeft";t[t["Backslash"]=93]="Backslash";t[t["BracketRight"]=94]="BracketRight";t[t["Quote"]=95]="Quote";t[t["OEM_8"]=96]="OEM_8";t[t["IntlBackslash"]=97]="IntlBackslash";t[t["Numpad0"]=98]="Numpad0";t[t["Numpad1"]=99]="Numpad1";t[t["Numpad2"]=100]="Numpad2";t[t["Numpad3"]=101]="Numpad3";t[t["Numpad4"]=102]="Numpad4";t[t["Numpad5"]=103]="Numpad5";t[t["Numpad6"]=104]="Numpad6";t[t["Numpad7"]=105]="Numpad7";t[t["Numpad8"]=106]="Numpad8";t[t["Numpad9"]=107]="Numpad9";t[t["NumpadMultiply"]=108]="NumpadMultiply";t[t["NumpadAdd"]=109]="NumpadAdd";t[t["NUMPAD_SEPARATOR"]=110]="NUMPAD_SEPARATOR";t[t["NumpadSubtract"]=111]="NumpadSubtract";t[t["NumpadDecimal"]=112]="NumpadDecimal";t[t["NumpadDivide"]=113]="NumpadDivide";t[t["KEY_IN_COMPOSITION"]=114]="KEY_IN_COMPOSITION";t[t["ABNT_C1"]=115]="ABNT_C1";t[t["ABNT_C2"]=116]="ABNT_C2";t[t["AudioVolumeMute"]=117]="AudioVolumeMute";t[t["AudioVolumeUp"]=118]="AudioVolumeUp";t[t["AudioVolumeDown"]=119]="AudioVolumeDown";t[t["BrowserSearch"]=120]="BrowserSearch";t[t["BrowserHome"]=121]="BrowserHome";t[t["BrowserBack"]=122]="BrowserBack";t[t["BrowserForward"]=123]="BrowserForward";t[t["MediaTrackNext"]=124]="MediaTrackNext";t[t["MediaTrackPrevious"]=125]="MediaTrackPrevious";t[t["MediaStop"]=126]="MediaStop";t[t["MediaPlayPause"]=127]="MediaPlayPause";t[t["LaunchMediaPlayer"]=128]="LaunchMediaPlayer";t[t["LaunchMail"]=129]="LaunchMail";t[t["LaunchApp2"]=130]="LaunchApp2";t[t["Clear"]=131]="Clear";t[t["MAX_VALUE"]=132]="MAX_VALUE"})(D||(D={}));var A;(function(t){t[t["DependsOnKbLayout"]=-1]="DependsOnKbLayout";t[t["None"]=0]="None";t[t["Hyper"]=1]="Hyper";t[t["Super"]=2]="Super";t[t["Fn"]=3]="Fn";t[t["FnLock"]=4]="FnLock";t[t["Suspend"]=5]="Suspend";t[t["Resume"]=6]="Resume";t[t["Turbo"]=7]="Turbo";t[t["Sleep"]=8]="Sleep";t[t["WakeUp"]=9]="WakeUp";t[t["KeyA"]=10]="KeyA";t[t["KeyB"]=11]="KeyB";t[t["KeyC"]=12]="KeyC";t[t["KeyD"]=13]="KeyD";t[t["KeyE"]=14]="KeyE";t[t["KeyF"]=15]="KeyF";t[t["KeyG"]=16]="KeyG";t[t["KeyH"]=17]="KeyH";t[t["KeyI"]=18]="KeyI";t[t["KeyJ"]=19]="KeyJ";t[t["KeyK"]=20]="KeyK";t[t["KeyL"]=21]="KeyL";t[t["KeyM"]=22]="KeyM";t[t["KeyN"]=23]="KeyN";t[t["KeyO"]=24]="KeyO";t[t["KeyP"]=25]="KeyP";t[t["KeyQ"]=26]="KeyQ";t[t["KeyR"]=27]="KeyR";t[t["KeyS"]=28]="KeyS";t[t["KeyT"]=29]="KeyT";t[t["KeyU"]=30]="KeyU";t[t["KeyV"]=31]="KeyV";t[t["KeyW"]=32]="KeyW";t[t["KeyX"]=33]="KeyX";t[t["KeyY"]=34]="KeyY";t[t["KeyZ"]=35]="KeyZ";t[t["Digit1"]=36]="Digit1";t[t["Digit2"]=37]="Digit2";t[t["Digit3"]=38]="Digit3";t[t["Digit4"]=39]="Digit4";t[t["Digit5"]=40]="Digit5";t[t["Digit6"]=41]="Digit6";t[t["Digit7"]=42]="Digit7";t[t["Digit8"]=43]="Digit8";t[t["Digit9"]=44]="Digit9";t[t["Digit0"]=45]="Digit0";t[t["Enter"]=46]="Enter";t[t["Escape"]=47]="Escape";t[t["Backspace"]=48]="Backspace";t[t["Tab"]=49]="Tab";t[t["Space"]=50]="Space";t[t["Minus"]=51]="Minus";t[t["Equal"]=52]="Equal";t[t["BracketLeft"]=53]="BracketLeft";t[t["BracketRight"]=54]="BracketRight";t[t["Backslash"]=55]="Backslash";t[t["IntlHash"]=56]="IntlHash";t[t["Semicolon"]=57]="Semicolon";t[t["Quote"]=58]="Quote";t[t["Backquote"]=59]="Backquote";t[t["Comma"]=60]="Comma";t[t["Period"]=61]="Period";t[t["Slash"]=62]="Slash";t[t["CapsLock"]=63]="CapsLock";t[t["F1"]=64]="F1";t[t["F2"]=65]="F2";t[t["F3"]=66]="F3";t[t["F4"]=67]="F4";t[t["F5"]=68]="F5";t[t["F6"]=69]="F6";t[t["F7"]=70]="F7";t[t["F8"]=71]="F8";t[t["F9"]=72]="F9";t[t["F10"]=73]="F10";t[t["F11"]=74]="F11";t[t["F12"]=75]="F12";t[t["PrintScreen"]=76]="PrintScreen";t[t["ScrollLock"]=77]="ScrollLock";t[t["Pause"]=78]="Pause";t[t["Insert"]=79]="Insert";t[t["Home"]=80]="Home";t[t["PageUp"]=81]="PageUp";t[t["Delete"]=82]="Delete";t[t["End"]=83]="End";t[t["PageDown"]=84]="PageDown";t[t["ArrowRight"]=85]="ArrowRight";t[t["ArrowLeft"]=86]="ArrowLeft";t[t["ArrowDown"]=87]="ArrowDown";t[t["ArrowUp"]=88]="ArrowUp";t[t["NumLock"]=89]="NumLock";t[t["NumpadDivide"]=90]="NumpadDivide";t[t["NumpadMultiply"]=91]="NumpadMultiply";t[t["NumpadSubtract"]=92]="NumpadSubtract";t[t["NumpadAdd"]=93]="NumpadAdd";t[t["NumpadEnter"]=94]="NumpadEnter";t[t["Numpad1"]=95]="Numpad1";t[t["Numpad2"]=96]="Numpad2";t[t["Numpad3"]=97]="Numpad3";t[t["Numpad4"]=98]="Numpad4";t[t["Numpad5"]=99]="Numpad5";t[t["Numpad6"]=100]="Numpad6";t[t["Numpad7"]=101]="Numpad7";t[t["Numpad8"]=102]="Numpad8";t[t["Numpad9"]=103]="Numpad9";t[t["Numpad0"]=104]="Numpad0";t[t["NumpadDecimal"]=105]="NumpadDecimal";t[t["IntlBackslash"]=106]="IntlBackslash";t[t["ContextMenu"]=107]="ContextMenu";t[t["Power"]=108]="Power";t[t["NumpadEqual"]=109]="NumpadEqual";t[t["F13"]=110]="F13";t[t["F14"]=111]="F14";t[t["F15"]=112]="F15";t[t["F16"]=113]="F16";t[t["F17"]=114]="F17";t[t["F18"]=115]="F18";t[t["F19"]=116]="F19";t[t["F20"]=117]="F20";t[t["F21"]=118]="F21";t[t["F22"]=119]="F22";t[t["F23"]=120]="F23";t[t["F24"]=121]="F24";t[t["Open"]=122]="Open";t[t["Help"]=123]="Help";t[t["Select"]=124]="Select";t[t["Again"]=125]="Again";t[t["Undo"]=126]="Undo";t[t["Cut"]=127]="Cut";t[t["Copy"]=128]="Copy";t[t["Paste"]=129]="Paste";t[t["Find"]=130]="Find";t[t["AudioVolumeMute"]=131]="AudioVolumeMute";t[t["AudioVolumeUp"]=132]="AudioVolumeUp";t[t["AudioVolumeDown"]=133]="AudioVolumeDown";t[t["NumpadComma"]=134]="NumpadComma";t[t["IntlRo"]=135]="IntlRo";t[t["KanaMode"]=136]="KanaMode";t[t["IntlYen"]=137]="IntlYen";t[t["Convert"]=138]="Convert";t[t["NonConvert"]=139]="NonConvert";t[t["Lang1"]=140]="Lang1";t[t["Lang2"]=141]="Lang2";t[t["Lang3"]=142]="Lang3";t[t["Lang4"]=143]="Lang4";t[t["Lang5"]=144]="Lang5";t[t["Abort"]=145]="Abort";t[t["Props"]=146]="Props";t[t["NumpadParenLeft"]=147]="NumpadParenLeft";t[t["NumpadParenRight"]=148]="NumpadParenRight";t[t["NumpadBackspace"]=149]="NumpadBackspace";t[t["NumpadMemoryStore"]=150]="NumpadMemoryStore";t[t["NumpadMemoryRecall"]=151]="NumpadMemoryRecall";t[t["NumpadMemoryClear"]=152]="NumpadMemoryClear";t[t["NumpadMemoryAdd"]=153]="NumpadMemoryAdd";t[t["NumpadMemorySubtract"]=154]="NumpadMemorySubtract";t[t["NumpadClear"]=155]="NumpadClear";t[t["NumpadClearEntry"]=156]="NumpadClearEntry";t[t["ControlLeft"]=157]="ControlLeft";t[t["ShiftLeft"]=158]="ShiftLeft";t[t["AltLeft"]=159]="AltLeft";t[t["MetaLeft"]=160]="MetaLeft";t[t["ControlRight"]=161]="ControlRight";t[t["ShiftRight"]=162]="ShiftRight";t[t["AltRight"]=163]="AltRight";t[t["MetaRight"]=164]="MetaRight";t[t["BrightnessUp"]=165]="BrightnessUp";t[t["BrightnessDown"]=166]="BrightnessDown";t[t["MediaPlay"]=167]="MediaPlay";t[t["MediaRecord"]=168]="MediaRecord";t[t["MediaFastForward"]=169]="MediaFastForward";t[t["MediaRewind"]=170]="MediaRewind";t[t["MediaTrackNext"]=171]="MediaTrackNext";t[t["MediaTrackPrevious"]=172]="MediaTrackPrevious";t[t["MediaStop"]=173]="MediaStop";t[t["Eject"]=174]="Eject";t[t["MediaPlayPause"]=175]="MediaPlayPause";t[t["MediaSelect"]=176]="MediaSelect";t[t["LaunchMail"]=177]="LaunchMail";t[t["LaunchApp2"]=178]="LaunchApp2";t[t["LaunchApp1"]=179]="LaunchApp1";t[t["SelectTask"]=180]="SelectTask";t[t["LaunchScreenSaver"]=181]="LaunchScreenSaver";t[t["BrowserSearch"]=182]="BrowserSearch";t[t["BrowserHome"]=183]="BrowserHome";t[t["BrowserBack"]=184]="BrowserBack";t[t["BrowserForward"]=185]="BrowserForward";t[t["BrowserStop"]=186]="BrowserStop";t[t["BrowserRefresh"]=187]="BrowserRefresh";t[t["BrowserFavorites"]=188]="BrowserFavorites";t[t["ZoomToggle"]=189]="ZoomToggle";t[t["MailReply"]=190]="MailReply";t[t["MailForward"]=191]="MailForward";t[t["MailSend"]=192]="MailSend";t[t["MAX_VALUE"]=193]="MAX_VALUE"})(A||(A={}));class Hx{constructor(){this._keyCodeToStr=[];this._strToKeyCode=Object.create(null)}define(e,i){this._keyCodeToStr[e]=i;this._strToKeyCode[i.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||D.Unknown}}const kp=new Hx;const Y0=new Hx;const X0=new Hx;const ZH=new Array(230);const eB=Object.create(null);const tB=Object.create(null);const Z0=[];for(let t=0;t<=A.MAX_VALUE;t++){D.DependsOnKbLayout}for(let t=0;t<=D.MAX_VALUE;t++){Z0[t]=A.DependsOnKbLayout}(function(){const t="";const e=[[1,A.None,"None",D.Unknown,"unknown",0,"VK_UNKNOWN",t,t],[1,A.Hyper,"Hyper",D.Unknown,t,0,t,t,t],[1,A.Super,"Super",D.Unknown,t,0,t,t,t],[1,A.Fn,"Fn",D.Unknown,t,0,t,t,t],[1,A.FnLock,"FnLock",D.Unknown,t,0,t,t,t],[1,A.Suspend,"Suspend",D.Unknown,t,0,t,t,t],[1,A.Resume,"Resume",D.Unknown,t,0,t,t,t],[1,A.Turbo,"Turbo",D.Unknown,t,0,t,t,t],[1,A.Sleep,"Sleep",D.Unknown,t,0,"VK_SLEEP",t,t],[1,A.WakeUp,"WakeUp",D.Unknown,t,0,t,t,t],[0,A.KeyA,"KeyA",D.KeyA,"A",65,"VK_A",t,t],[0,A.KeyB,"KeyB",D.KeyB,"B",66,"VK_B",t,t],[0,A.KeyC,"KeyC",D.KeyC,"C",67,"VK_C",t,t],[0,A.KeyD,"KeyD",D.KeyD,"D",68,"VK_D",t,t],[0,A.KeyE,"KeyE",D.KeyE,"E",69,"VK_E",t,t],[0,A.KeyF,"KeyF",D.KeyF,"F",70,"VK_F",t,t],[0,A.KeyG,"KeyG",D.KeyG,"G",71,"VK_G",t,t],[0,A.KeyH,"KeyH",D.KeyH,"H",72,"VK_H",t,t],[0,A.KeyI,"KeyI",D.KeyI,"I",73,"VK_I",t,t],[0,A.KeyJ,"KeyJ",D.KeyJ,"J",74,"VK_J",t,t],[0,A.KeyK,"KeyK",D.KeyK,"K",75,"VK_K",t,t],[0,A.KeyL,"KeyL",D.KeyL,"L",76,"VK_L",t,t],[0,A.KeyM,"KeyM",D.KeyM,"M",77,"VK_M",t,t],[0,A.KeyN,"KeyN",D.KeyN,"N",78,"VK_N",t,t],[0,A.KeyO,"KeyO",D.KeyO,"O",79,"VK_O",t,t],[0,A.KeyP,"KeyP",D.KeyP,"P",80,"VK_P",t,t],[0,A.KeyQ,"KeyQ",D.KeyQ,"Q",81,"VK_Q",t,t],[0,A.KeyR,"KeyR",D.KeyR,"R",82,"VK_R",t,t],[0,A.KeyS,"KeyS",D.KeyS,"S",83,"VK_S",t,t],[0,A.KeyT,"KeyT",D.KeyT,"T",84,"VK_T",t,t],[0,A.KeyU,"KeyU",D.KeyU,"U",85,"VK_U",t,t],[0,A.KeyV,"KeyV",D.KeyV,"V",86,"VK_V",t,t],[0,A.KeyW,"KeyW",D.KeyW,"W",87,"VK_W",t,t],[0,A.KeyX,"KeyX",D.KeyX,"X",88,"VK_X",t,t],[0,A.KeyY,"KeyY",D.KeyY,"Y",89,"VK_Y",t,t],[0,A.KeyZ,"KeyZ",D.KeyZ,"Z",90,"VK_Z",t,t],[0,A.Digit1,"Digit1",D.Digit1,"1",49,"VK_1",t,t],[0,A.Digit2,"Digit2",D.Digit2,"2",50,"VK_2",t,t],[0,A.Digit3,"Digit3",D.Digit3,"3",51,"VK_3",t,t],[0,A.Digit4,"Digit4",D.Digit4,"4",52,"VK_4",t,t],[0,A.Digit5,"Digit5",D.Digit5,"5",53,"VK_5",t,t],[0,A.Digit6,"Digit6",D.Digit6,"6",54,"VK_6",t,t],[0,A.Digit7,"Digit7",D.Digit7,"7",55,"VK_7",t,t],[0,A.Digit8,"Digit8",D.Digit8,"8",56,"VK_8",t,t],[0,A.Digit9,"Digit9",D.Digit9,"9",57,"VK_9",t,t],[0,A.Digit0,"Digit0",D.Digit0,"0",48,"VK_0",t,t],[1,A.Enter,"Enter",D.Enter,"Enter",13,"VK_RETURN",t,t],[1,A.Escape,"Escape",D.Escape,"Escape",27,"VK_ESCAPE",t,t],[1,A.Backspace,"Backspace",D.Backspace,"Backspace",8,"VK_BACK",t,t],[1,A.Tab,"Tab",D.Tab,"Tab",9,"VK_TAB",t,t],[1,A.Space,"Space",D.Space,"Space",32,"VK_SPACE",t,t],[0,A.Minus,"Minus",D.Minus,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,A.Equal,"Equal",D.Equal,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,A.BracketLeft,"BracketLeft",D.BracketLeft,"[",219,"VK_OEM_4","[","OEM_4"],[0,A.BracketRight,"BracketRight",D.BracketRight,"]",221,"VK_OEM_6","]","OEM_6"],[0,A.Backslash,"Backslash",D.Backslash,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,A.IntlHash,"IntlHash",D.Unknown,t,0,t,t,t],[0,A.Semicolon,"Semicolon",D.Semicolon,";",186,"VK_OEM_1",";","OEM_1"],[0,A.Quote,"Quote",D.Quote,"'",222,"VK_OEM_7","'","OEM_7"],[0,A.Backquote,"Backquote",D.Backquote,"`",192,"VK_OEM_3","`","OEM_3"],[0,A.Comma,"Comma",D.Comma,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,A.Period,"Period",D.Period,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,A.Slash,"Slash",D.Slash,"/",191,"VK_OEM_2","/","OEM_2"],[1,A.CapsLock,"CapsLock",D.CapsLock,"CapsLock",20,"VK_CAPITAL",t,t],[1,A.F1,"F1",D.F1,"F1",112,"VK_F1",t,t],[1,A.F2,"F2",D.F2,"F2",113,"VK_F2",t,t],[1,A.F3,"F3",D.F3,"F3",114,"VK_F3",t,t],[1,A.F4,"F4",D.F4,"F4",115,"VK_F4",t,t],[1,A.F5,"F5",D.F5,"F5",116,"VK_F5",t,t],[1,A.F6,"F6",D.F6,"F6",117,"VK_F6",t,t],[1,A.F7,"F7",D.F7,"F7",118,"VK_F7",t,t],[1,A.F8,"F8",D.F8,"F8",119,"VK_F8",t,t],[1,A.F9,"F9",D.F9,"F9",120,"VK_F9",t,t],[1,A.F10,"F10",D.F10,"F10",121,"VK_F10",t,t],[1,A.F11,"F11",D.F11,"F11",122,"VK_F11",t,t],[1,A.F12,"F12",D.F12,"F12",123,"VK_F12",t,t],[1,A.PrintScreen,"PrintScreen",D.Unknown,t,0,t,t,t],[1,A.ScrollLock,"ScrollLock",D.ScrollLock,"ScrollLock",145,"VK_SCROLL",t,t],[1,A.Pause,"Pause",D.PauseBreak,"PauseBreak",19,"VK_PAUSE",t,t],[1,A.Insert,"Insert",D.Insert,"Insert",45,"VK_INSERT",t,t],[1,A.Home,"Home",D.Home,"Home",36,"VK_HOME",t,t],[1,A.PageUp,"PageUp",D.PageUp,"PageUp",33,"VK_PRIOR",t,t],[1,A.Delete,"Delete",D.Delete,"Delete",46,"VK_DELETE",t,t],[1,A.End,"End",D.End,"End",35,"VK_END",t,t],[1,A.PageDown,"PageDown",D.PageDown,"PageDown",34,"VK_NEXT",t,t],[1,A.ArrowRight,"ArrowRight",D.RightArrow,"RightArrow",39,"VK_RIGHT","Right",t],[1,A.ArrowLeft,"ArrowLeft",D.LeftArrow,"LeftArrow",37,"VK_LEFT","Left",t],[1,A.ArrowDown,"ArrowDown",D.DownArrow,"DownArrow",40,"VK_DOWN","Down",t],[1,A.ArrowUp,"ArrowUp",D.UpArrow,"UpArrow",38,"VK_UP","Up",t],[1,A.NumLock,"NumLock",D.NumLock,"NumLock",144,"VK_NUMLOCK",t,t],[1,A.NumpadDivide,"NumpadDivide",D.NumpadDivide,"NumPad_Divide",111,"VK_DIVIDE",t,t],[1,A.NumpadMultiply,"NumpadMultiply",D.NumpadMultiply,"NumPad_Multiply",106,"VK_MULTIPLY",t,t],[1,A.NumpadSubtract,"NumpadSubtract",D.NumpadSubtract,"NumPad_Subtract",109,"VK_SUBTRACT",t,t],[1,A.NumpadAdd,"NumpadAdd",D.NumpadAdd,"NumPad_Add",107,"VK_ADD",t,t],[1,A.NumpadEnter,"NumpadEnter",D.Enter,t,0,t,t,t],[1,A.Numpad1,"Numpad1",D.Numpad1,"NumPad1",97,"VK_NUMPAD1",t,t],[1,A.Numpad2,"Numpad2",D.Numpad2,"NumPad2",98,"VK_NUMPAD2",t,t],[1,A.Numpad3,"Numpad3",D.Numpad3,"NumPad3",99,"VK_NUMPAD3",t,t],[1,A.Numpad4,"Numpad4",D.Numpad4,"NumPad4",100,"VK_NUMPAD4",t,t],[1,A.Numpad5,"Numpad5",D.Numpad5,"NumPad5",101,"VK_NUMPAD5",t,t],[1,A.Numpad6,"Numpad6",D.Numpad6,"NumPad6",102,"VK_NUMPAD6",t,t],[1,A.Numpad7,"Numpad7",D.Numpad7,"NumPad7",103,"VK_NUMPAD7",t,t],[1,A.Numpad8,"Numpad8",D.Numpad8,"NumPad8",104,"VK_NUMPAD8",t,t],[1,A.Numpad9,"Numpad9",D.Numpad9,"NumPad9",105,"VK_NUMPAD9",t,t],[1,A.Numpad0,"Numpad0",D.Numpad0,"NumPad0",96,"VK_NUMPAD0",t,t],[1,A.NumpadDecimal,"NumpadDecimal",D.NumpadDecimal,"NumPad_Decimal",110,"VK_DECIMAL",t,t],[0,A.IntlBackslash,"IntlBackslash",D.IntlBackslash,"OEM_102",226,"VK_OEM_102",t,t],[1,A.ContextMenu,"ContextMenu",D.ContextMenu,"ContextMenu",93,t,t,t],[1,A.Power,"Power",D.Unknown,t,0,t,t,t],[1,A.NumpadEqual,"NumpadEqual",D.Unknown,t,0,t,t,t],[1,A.F13,"F13",D.F13,"F13",124,"VK_F13",t,t],[1,A.F14,"F14",D.F14,"F14",125,"VK_F14",t,t],[1,A.F15,"F15",D.F15,"F15",126,"VK_F15",t,t],[1,A.F16,"F16",D.F16,"F16",127,"VK_F16",t,t],[1,A.F17,"F17",D.F17,"F17",128,"VK_F17",t,t],[1,A.F18,"F18",D.F18,"F18",129,"VK_F18",t,t],[1,A.F19,"F19",D.F19,"F19",130,"VK_F19",t,t],[1,A.F20,"F20",D.F20,"F20",131,"VK_F20",t,t],[1,A.F21,"F21",D.F21,"F21",132,"VK_F21",t,t],[1,A.F22,"F22",D.F22,"F22",133,"VK_F22",t,t],[1,A.F23,"F23",D.F23,"F23",134,"VK_F23",t,t],[1,A.F24,"F24",D.F24,"F24",135,"VK_F24",t,t],[1,A.Open,"Open",D.Unknown,t,0,t,t,t],[1,A.Help,"Help",D.Unknown,t,0,t,t,t],[1,A.Select,"Select",D.Unknown,t,0,t,t,t],[1,A.Again,"Again",D.Unknown,t,0,t,t,t],[1,A.Undo,"Undo",D.Unknown,t,0,t,t,t],[1,A.Cut,"Cut",D.Unknown,t,0,t,t,t],[1,A.Copy,"Copy",D.Unknown,t,0,t,t,t],[1,A.Paste,"Paste",D.Unknown,t,0,t,t,t],[1,A.Find,"Find",D.Unknown,t,0,t,t,t],[1,A.AudioVolumeMute,"AudioVolumeMute",D.AudioVolumeMute,"AudioVolumeMute",173,"VK_VOLUME_MUTE",t,t],[1,A.AudioVolumeUp,"AudioVolumeUp",D.AudioVolumeUp,"AudioVolumeUp",175,"VK_VOLUME_UP",t,t],[1,A.AudioVolumeDown,"AudioVolumeDown",D.AudioVolumeDown,"AudioVolumeDown",174,"VK_VOLUME_DOWN",t,t],[1,A.NumpadComma,"NumpadComma",D.NUMPAD_SEPARATOR,"NumPad_Separator",108,"VK_SEPARATOR",t,t],[0,A.IntlRo,"IntlRo",D.ABNT_C1,"ABNT_C1",193,"VK_ABNT_C1",t,t],[1,A.KanaMode,"KanaMode",D.Unknown,t,0,t,t,t],[0,A.IntlYen,"IntlYen",D.Unknown,t,0,t,t,t],[1,A.Convert,"Convert",D.Unknown,t,0,t,t,t],[1,A.NonConvert,"NonConvert",D.Unknown,t,0,t,t,t],[1,A.Lang1,"Lang1",D.Unknown,t,0,t,t,t],[1,A.Lang2,"Lang2",D.Unknown,t,0,t,t,t],[1,A.Lang3,"Lang3",D.Unknown,t,0,t,t,t],[1,A.Lang4,"Lang4",D.Unknown,t,0,t,t,t],[1,A.Lang5,"Lang5",D.Unknown,t,0,t,t,t],[1,A.Abort,"Abort",D.Unknown,t,0,t,t,t],[1,A.Props,"Props",D.Unknown,t,0,t,t,t],[1,A.NumpadParenLeft,"NumpadParenLeft",D.Unknown,t,0,t,t,t],[1,A.NumpadParenRight,"NumpadParenRight",D.Unknown,t,0,t,t,t],[1,A.NumpadBackspace,"NumpadBackspace",D.Unknown,t,0,t,t,t],[1,A.NumpadMemoryStore,"NumpadMemoryStore",D.Unknown,t,0,t,t,t],[1,A.NumpadMemoryRecall,"NumpadMemoryRecall",D.Unknown,t,0,t,t,t],[1,A.NumpadMemoryClear,"NumpadMemoryClear",D.Unknown,t,0,t,t,t],[1,A.NumpadMemoryAdd,"NumpadMemoryAdd",D.Unknown,t,0,t,t,t],[1,A.NumpadMemorySubtract,"NumpadMemorySubtract",D.Unknown,t,0,t,t,t],[1,A.NumpadClear,"NumpadClear",D.Clear,"Clear",12,"VK_CLEAR",t,t],[1,A.NumpadClearEntry,"NumpadClearEntry",D.Unknown,t,0,t,t,t],[1,A.None,t,D.Ctrl,"Ctrl",17,"VK_CONTROL",t,t],[1,A.None,t,D.Shift,"Shift",16,"VK_SHIFT",t,t],[1,A.None,t,D.Alt,"Alt",18,"VK_MENU",t,t],[1,A.None,t,D.Meta,"Meta",91,"VK_COMMAND",t,t],[1,A.ControlLeft,"ControlLeft",D.Ctrl,t,0,"VK_LCONTROL",t,t],[1,A.ShiftLeft,"ShiftLeft",D.Shift,t,0,"VK_LSHIFT",t,t],[1,A.AltLeft,"AltLeft",D.Alt,t,0,"VK_LMENU",t,t],[1,A.MetaLeft,"MetaLeft",D.Meta,t,0,"VK_LWIN",t,t],[1,A.ControlRight,"ControlRight",D.Ctrl,t,0,"VK_RCONTROL",t,t],[1,A.ShiftRight,"ShiftRight",D.Shift,t,0,"VK_RSHIFT",t,t],[1,A.AltRight,"AltRight",D.Alt,t,0,"VK_RMENU",t,t],[1,A.MetaRight,"MetaRight",D.Meta,t,0,"VK_RWIN",t,t],[1,A.BrightnessUp,"BrightnessUp",D.Unknown,t,0,t,t,t],[1,A.BrightnessDown,"BrightnessDown",D.Unknown,t,0,t,t,t],[1,A.MediaPlay,"MediaPlay",D.Unknown,t,0,t,t,t],[1,A.MediaRecord,"MediaRecord",D.Unknown,t,0,t,t,t],[1,A.MediaFastForward,"MediaFastForward",D.Unknown,t,0,t,t,t],[1,A.MediaRewind,"MediaRewind",D.Unknown,t,0,t,t,t],[1,A.MediaTrackNext,"MediaTrackNext",D.MediaTrackNext,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",t,t],[1,A.MediaTrackPrevious,"MediaTrackPrevious",D.MediaTrackPrevious,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",t,t],[1,A.MediaStop,"MediaStop",D.MediaStop,"MediaStop",178,"VK_MEDIA_STOP",t,t],[1,A.Eject,"Eject",D.Unknown,t,0,t,t,t],[1,A.MediaPlayPause,"MediaPlayPause",D.MediaPlayPause,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",t,t],[1,A.MediaSelect,"MediaSelect",D.LaunchMediaPlayer,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",t,t],[1,A.LaunchMail,"LaunchMail",D.LaunchMail,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",t,t],[1,A.LaunchApp2,"LaunchApp2",D.LaunchApp2,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",t,t],[1,A.LaunchApp1,"LaunchApp1",D.Unknown,t,0,"VK_MEDIA_LAUNCH_APP1",t,t],[1,A.SelectTask,"SelectTask",D.Unknown,t,0,t,t,t],[1,A.LaunchScreenSaver,"LaunchScreenSaver",D.Unknown,t,0,t,t,t],[1,A.BrowserSearch,"BrowserSearch",D.BrowserSearch,"BrowserSearch",170,"VK_BROWSER_SEARCH",t,t],[1,A.BrowserHome,"BrowserHome",D.BrowserHome,"BrowserHome",172,"VK_BROWSER_HOME",t,t],[1,A.BrowserBack,"BrowserBack",D.BrowserBack,"BrowserBack",166,"VK_BROWSER_BACK",t,t],[1,A.BrowserForward,"BrowserForward",D.BrowserForward,"BrowserForward",167,"VK_BROWSER_FORWARD",t,t],[1,A.BrowserStop,"BrowserStop",D.Unknown,t,0,"VK_BROWSER_STOP",t,t],[1,A.BrowserRefresh,"BrowserRefresh",D.Unknown,t,0,"VK_BROWSER_REFRESH",t,t],[1,A.BrowserFavorites,"BrowserFavorites",D.Unknown,t,0,"VK_BROWSER_FAVORITES",t,t],[1,A.ZoomToggle,"ZoomToggle",D.Unknown,t,0,t,t,t],[1,A.MailReply,"MailReply",D.Unknown,t,0,t,t,t],[1,A.MailForward,"MailForward",D.Unknown,t,0,t,t,t],[1,A.MailSend,"MailSend",D.Unknown,t,0,t,t,t],[1,A.None,t,D.KEY_IN_COMPOSITION,"KeyInComposition",229,t,t,t],[1,A.None,t,D.ABNT_C2,"ABNT_C2",194,"VK_ABNT_C2",t,t],[1,A.None,t,D.OEM_8,"OEM_8",223,"VK_OEM_8",t,t],[1,A.None,t,D.Unknown,t,0,"VK_KANA",t,t],[1,A.None,t,D.Unknown,t,0,"VK_HANGUL",t,t],[1,A.None,t,D.Unknown,t,0,"VK_JUNJA",t,t],[1,A.None,t,D.Unknown,t,0,"VK_FINAL",t,t],[1,A.None,t,D.Unknown,t,0,"VK_HANJA",t,t],[1,A.None,t,D.Unknown,t,0,"VK_KANJI",t,t],[1,A.None,t,D.Unknown,t,0,"VK_CONVERT",t,t],[1,A.None,t,D.Unknown,t,0,"VK_NONCONVERT",t,t],[1,A.None,t,D.Unknown,t,0,"VK_ACCEPT",t,t],[1,A.None,t,D.Unknown,t,0,"VK_MODECHANGE",t,t],[1,A.None,t,D.Unknown,t,0,"VK_SELECT",t,t],[1,A.None,t,D.Unknown,t,0,"VK_PRINT",t,t],[1,A.None,t,D.Unknown,t,0,"VK_EXECUTE",t,t],[1,A.None,t,D.Unknown,t,0,"VK_SNAPSHOT",t,t],[1,A.None,t,D.Unknown,t,0,"VK_HELP",t,t],[1,A.None,t,D.Unknown,t,0,"VK_APPS",t,t],[1,A.None,t,D.Unknown,t,0,"VK_PROCESSKEY",t,t],[1,A.None,t,D.Unknown,t,0,"VK_PACKET",t,t],[1,A.None,t,D.Unknown,t,0,"VK_DBE_SBCSCHAR",t,t],[1,A.None,t,D.Unknown,t,0,"VK_DBE_DBCSCHAR",t,t],[1,A.None,t,D.Unknown,t,0,"VK_ATTN",t,t],[1,A.None,t,D.Unknown,t,0,"VK_CRSEL",t,t],[1,A.None,t,D.Unknown,t,0,"VK_EXSEL",t,t],[1,A.None,t,D.Unknown,t,0,"VK_EREOF",t,t],[1,A.None,t,D.Unknown,t,0,"VK_PLAY",t,t],[1,A.None,t,D.Unknown,t,0,"VK_ZOOM",t,t],[1,A.None,t,D.Unknown,t,0,"VK_NONAME",t,t],[1,A.None,t,D.Unknown,t,0,"VK_PA1",t,t],[1,A.None,t,D.Unknown,t,0,"VK_OEM_CLEAR",t,t]];const i=[];const n=[];for(const s of e){const[r,o,a,l,c,u,d,f,p]=s;if(!n[o]){n[o]=true;eB[a]=o;tB[a.toLowerCase()]=o;if(r){if(l!==D.Unknown&&l!==D.Enter&&!iB(l)){Z0[l]=o}}}if(!i[l]){i[l]=true;if(!c){throw new Error(`String representation missing for key code ${l} around scan code ${a}`)}kp.define(l,c);Y0.define(l,f||c);X0.define(l,p||f||c)}if(u){ZH[u]=l}}Z0[D.Enter]=A.Enter})();var nT;(function(t){function e(a){return kp.keyCodeToStr(a)}t.toString=e;function i(a){return kp.strToKeyCode(a)}t.fromString=i;function n(a){return Y0.keyCodeToStr(a)}t.toUserSettingsUS=n;function s(a){return X0.keyCodeToStr(a)}t.toUserSettingsGeneral=s;function r(a){return Y0.strToKeyCode(a)||X0.strToKeyCode(a)}t.fromUserSettings=r;function o(a){if(a>=D.Numpad0&&a<=D.NumpadDivide){return null}switch(a){case D.UpArrow:return"Up";case D.DownArrow:return"Down";case D.LeftArrow:return"Left";case D.RightArrow:return"Right"}return kp.keyCodeToStr(a)}t.toElectronAccelerator=o})(nT||(nT={}));var sT;(function(t){t[t["CtrlCmd"]=2048]="CtrlCmd";t[t["Shift"]=1024]="Shift";t[t["Alt"]=512]="Alt";t[t["WinCtrl"]=256]="WinCtrl"})(sT||(sT={}));function iB(t){return t===D.Ctrl||t===D.Shift||t===D.Alt||t===D.Meta}var ya;(function(t){t[t["CtrlCmd"]=2048]="CtrlCmd";t[t["Shift"]=1024]="Shift";t[t["Alt"]=512]="Alt";t[t["WinCtrl"]=256]="WinCtrl";t[t["KeyCode"]=255]="KeyCode"})(ya||(ya={}));function rT(t,e){if(typeof t==="number"){if(t===0){return null}const i=(t&65535)>>>0;const n=(t&4294901760)>>>16;if(n!==0){return new Dp([qf(i,e),qf(n,e)])}return new Dp([qf(i,e)])}else{const i=[];for(let n=0;n<t.length;n++){i.push(qf(t[n],e))}return new Dp(i)}}function qf(t,e){const i=t&ya.CtrlCmd?true:false;const n=t&ya.WinCtrl?true:false;const s=e===Hn.Macintosh?n:i;const r=t&ya.Shift?true:false;const o=t&ya.Alt?true:false;const a=e===Hn.Macintosh?i:n;const l=t&ya.KeyCode;return new Bx(s,r,o,a,l)}class Bx{constructor(e,i,n,s,r){this.ctrlKey=e;this.shiftKey=i;this.altKey=n;this.metaKey=s;this.keyCode=r}equals(e){return e instanceof Bx&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){const e=this.ctrlKey?"1":"0";const i=this.shiftKey?"1":"0";const n=this.altKey?"1":"0";const s=this.metaKey?"1":"0";return`K${e}${i}${n}${s}${this.keyCode}`}isModifierKey(){return this.keyCode===D.Unknown||this.keyCode===D.Ctrl||this.keyCode===D.Meta||this.keyCode===D.Alt||this.keyCode===D.Shift}toKeybinding(){return new Dp([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===D.Ctrl||this.shiftKey&&this.keyCode===D.Shift||this.altKey&&this.keyCode===D.Alt||this.metaKey&&this.keyCode===D.Meta}}class Dp{constructor(e){if(e.length===0){throw Ge(`chords`)}this.chords=e}getHashCode(){let e="";for(let i=0,n=this.chords.length;i<n;i++){if(i!==0){e+=";"}e+=this.chords[i].getHashCode()}return e}equals(e){if(e===null){return false}if(this.chords.length!==e.chords.length){return false}for(let i=0;i<this.chords.length;i++){if(!this.chords[i].equals(e.chords[i])){return false}}return true}}var oT;(function(t){t[t["EditorCore"]=0]="EditorCore";t[t["EditorContrib"]=100]="EditorContrib";t[t["WorkbenchContrib"]=200]="WorkbenchContrib";t[t["BuiltinExtension"]=300]="BuiltinExtension";t[t["ExternalExtension"]=400]="ExternalExtension"})(oT||(oT={}));class Wx{constructor(){this._coreKeybindings=new Go;this._extensionKeybindings=[];this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Xu===Hn.Windows){if(e&&e.win){return e.win}}else if(Xu===Hn.Macintosh){if(e&&e.mac){return e.mac}}else{if(e&&e.linux){return e.linux}}return e}registerKeybindingRule(e){const i=Wx.bindToCurrentPlatform(e);const n=new pe;if(i&&i.primary){const s=rT(i.primary,Xu);if(s){n.add(this._registerDefaultKeybinding(s,e.id,e.args,e.weight,0,e.when))}}if(i&&Array.isArray(i.secondary)){for(let s=0,r=i.secondary.length;s<r;s++){const o=i.secondary[s];const a=rT(o,Xu);if(a){n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-s-1,e.when))}}}return n}setExtensionKeybindings(e){const i=[];let n=0;for(const s of e){if(s.keybinding){i[n++]={keybinding:s.keybinding,command:s.id,commandArgs:s.args,when:s.when,weight1:s.weight,weight2:0,extensionId:s.extensionId||null,isBuiltinExtension:s.isBuiltinExtension||false}}}this._extensionKeybindings=i;this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return vS(this.registerKeybindingRule(e),$x.registerCommand(e))}_registerDefaultKeybinding(e,i,n,s,r,o){const a=this._coreKeybindings.push({keybinding:e,command:i,commandArgs:n,when:o,weight1:s,weight2:r,extensionId:null,isBuiltinExtension:false});this._cachedMergedKeybindings=null;return ye(()=>{a();this._cachedMergedKeybindings=null})}getDefaultKeybindings(){if(!this._cachedMergedKeybindings){this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings);this._cachedMergedKeybindings.sort(rB)}return this._cachedMergedKeybindings.slice(0)}}const nB=new Wx;const sB={EditorModes:"platform.keybindingsRegistry"};ei.add(sB.EditorModes,nB);function rB(t,e){if(t.weight1!==e.weight1){return t.weight1-e.weight1}if(t.command&&e.command){if(t.command<e.command){return-1}if(t.command>e.command){return 1}}return t.weight2-e.weight2}var Ip;function oB(t){return t.command!==void 0}class T{static{this._instances=new Map}static{this.CommandPalette=new T("CommandPalette")}static{this.DebugBreakpointsContext=new T("DebugBreakpointsContext")}static{this.DebugCallStackContext=new T("DebugCallStackContext")}static{this.DebugConsoleContext=new T("DebugConsoleContext")}static{this.DebugVariablesContext=new T("DebugVariablesContext")}static{this.NotebookVariablesContext=new T("NotebookVariablesContext")}static{this.DebugHoverContext=new T("DebugHoverContext")}static{this.DebugWatchContext=new T("DebugWatchContext")}static{this.DebugToolBar=new T("DebugToolBar")}static{this.DebugToolBarStop=new T("DebugToolBarStop")}static{this.DebugDisassemblyContext=new T("DebugDisassemblyContext")}static{this.DebugCallStackToolbar=new T("DebugCallStackToolbar")}static{this.DebugCreateConfiguration=new T("DebugCreateConfiguration")}static{this.DebugScopesContext=new T("DebugScopesContext")}static{this.EditorContext=new T("EditorContext")}static{this.SimpleEditorContext=new T("SimpleEditorContext")}static{this.EditorContent=new T("EditorContent")}static{this.EditorLineNumberContext=new T("EditorLineNumberContext")}static{this.EditorContextCopy=new T("EditorContextCopy")}static{this.EditorContextPeek=new T("EditorContextPeek")}static{this.EditorContextShare=new T("EditorContextShare")}static{this.EditorTitle=new T("EditorTitle")}static{this.CompactWindowEditorTitle=new T("CompactWindowEditorTitle")}static{this.EditorTitleRun=new T("EditorTitleRun")}static{this.EditorTitleContext=new T("EditorTitleContext")}static{this.EditorTitleContextShare=new T("EditorTitleContextShare")}static{this.EmptyEditorGroup=new T("EmptyEditorGroup")}static{this.EmptyEditorGroupContext=new T("EmptyEditorGroupContext")}static{this.EditorTabsBarContext=new T("EditorTabsBarContext")}static{this.EditorTabsBarShowTabsSubmenu=new T("EditorTabsBarShowTabsSubmenu")}static{this.EditorTabsBarShowTabsZenModeSubmenu=new T("EditorTabsBarShowTabsZenModeSubmenu")}static{this.EditorActionsPositionSubmenu=new T("EditorActionsPositionSubmenu")}static{this.EditorSplitMoveSubmenu=new T("EditorSplitMoveSubmenu")}static{this.ExplorerContext=new T("ExplorerContext")}static{this.ExplorerContextShare=new T("ExplorerContextShare")}static{this.ExtensionContext=new T("ExtensionContext")}static{this.ExtensionEditorContextMenu=new T("ExtensionEditorContextMenu")}static{this.GlobalActivity=new T("GlobalActivity")}static{this.CommandCenter=new T("CommandCenter")}static{this.CommandCenterCenter=new T("CommandCenterCenter")}static{this.LayoutControlMenuSubmenu=new T("LayoutControlMenuSubmenu")}static{this.LayoutControlMenu=new T("LayoutControlMenu")}static{this.MenubarMainMenu=new T("MenubarMainMenu")}static{this.MenubarAppearanceMenu=new T("MenubarAppearanceMenu")}static{this.MenubarDebugMenu=new T("MenubarDebugMenu")}static{this.MenubarEditMenu=new T("MenubarEditMenu")}static{this.MenubarCopy=new T("MenubarCopy")}static{this.MenubarFileMenu=new T("MenubarFileMenu")}static{this.MenubarGoMenu=new T("MenubarGoMenu")}static{this.MenubarHelpMenu=new T("MenubarHelpMenu")}static{this.MenubarLayoutMenu=new T("MenubarLayoutMenu")}static{this.MenubarNewBreakpointMenu=new T("MenubarNewBreakpointMenu")}static{this.PanelAlignmentMenu=new T("PanelAlignmentMenu")}static{this.PanelPositionMenu=new T("PanelPositionMenu")}static{this.ActivityBarPositionMenu=new T("ActivityBarPositionMenu")}static{this.MenubarPreferencesMenu=new T("MenubarPreferencesMenu")}static{this.MenubarRecentMenu=new T("MenubarRecentMenu")}static{this.MenubarSelectionMenu=new T("MenubarSelectionMenu")}static{this.MenubarShare=new T("MenubarShare")}static{this.MenubarSwitchEditorMenu=new T("MenubarSwitchEditorMenu")}static{this.MenubarSwitchGroupMenu=new T("MenubarSwitchGroupMenu")}static{this.MenubarTerminalMenu=new T("MenubarTerminalMenu")}static{this.MenubarTerminalSuggestStatusMenu=new T("MenubarTerminalSuggestStatusMenu")}static{this.MenubarViewMenu=new T("MenubarViewMenu")}static{this.MenubarHomeMenu=new T("MenubarHomeMenu")}static{this.OpenEditorsContext=new T("OpenEditorsContext")}static{this.OpenEditorsContextShare=new T("OpenEditorsContextShare")}static{this.ProblemsPanelContext=new T("ProblemsPanelContext")}static{this.SCMInputBox=new T("SCMInputBox")}static{this.SCMChangeContext=new T("SCMChangeContext")}static{this.SCMResourceContext=new T("SCMResourceContext")}static{this.SCMResourceContextShare=new T("SCMResourceContextShare")}static{this.SCMResourceFolderContext=new T("SCMResourceFolderContext")}static{this.SCMResourceGroupContext=new T("SCMResourceGroupContext")}static{this.SCMSourceControl=new T("SCMSourceControl")}static{this.SCMSourceControlInline=new T("SCMSourceControlInline")}static{this.SCMSourceControlTitle=new T("SCMSourceControlTitle")}static{this.SCMHistoryTitle=new T("SCMHistoryTitle")}static{this.SCMHistoryItemContext=new T("SCMHistoryItemContext")}static{this.SCMHistoryItemChangeContext=new T("SCMHistoryItemChangeContext")}static{this.SCMHistoryItemRefContext=new T("SCMHistoryItemRefContext")}static{this.SCMArtifactGroupContext=new T("SCMArtifactGroupContext")}static{this.SCMArtifactContext=new T("SCMArtifactContext")}static{this.SCMQuickDiffDecorations=new T("SCMQuickDiffDecorations")}static{this.SCMTitle=new T("SCMTitle")}static{this.SearchContext=new T("SearchContext")}static{this.SearchActionMenu=new T("SearchActionContext")}static{this.StatusBarWindowIndicatorMenu=new T("StatusBarWindowIndicatorMenu")}static{this.StatusBarRemoteIndicatorMenu=new T("StatusBarRemoteIndicatorMenu")}static{this.StickyScrollContext=new T("StickyScrollContext")}static{this.TestItem=new T("TestItem")}static{this.TestItemGutter=new T("TestItemGutter")}static{this.TestProfilesContext=new T("TestProfilesContext")}static{this.TestMessageContext=new T("TestMessageContext")}static{this.TestMessageContent=new T("TestMessageContent")}static{this.TestPeekElement=new T("TestPeekElement")}static{this.TestPeekTitle=new T("TestPeekTitle")}static{this.TestCallStack=new T("TestCallStack")}static{this.TestCoverageFilterItem=new T("TestCoverageFilterItem")}static{this.TouchBarContext=new T("TouchBarContext")}static{this.TitleBar=new T("TitleBar")}static{this.TitleBarContext=new T("TitleBarContext")}static{this.TitleBarTitleContext=new T("TitleBarTitleContext")}static{this.TunnelContext=new T("TunnelContext")}static{this.TunnelPrivacy=new T("TunnelPrivacy")}static{this.TunnelProtocol=new T("TunnelProtocol")}static{this.TunnelPortInline=new T("TunnelInline")}static{this.TunnelTitle=new T("TunnelTitle")}static{this.TunnelLocalAddressInline=new T("TunnelLocalAddressInline")}static{this.TunnelOriginInline=new T("TunnelOriginInline")}static{this.ViewItemContext=new T("ViewItemContext")}static{this.ViewContainerTitle=new T("ViewContainerTitle")}static{this.ViewContainerTitleContext=new T("ViewContainerTitleContext")}static{this.ViewTitle=new T("ViewTitle")}static{this.ViewTitleContext=new T("ViewTitleContext")}static{this.CommentEditorActions=new T("CommentEditorActions")}static{this.CommentThreadTitle=new T("CommentThreadTitle")}static{this.CommentThreadActions=new T("CommentThreadActions")}static{this.CommentThreadAdditionalActions=new T("CommentThreadAdditionalActions")}static{this.CommentThreadTitleContext=new T("CommentThreadTitleContext")}static{this.CommentThreadCommentContext=new T("CommentThreadCommentContext")}static{this.CommentTitle=new T("CommentTitle")}static{this.CommentActions=new T("CommentActions")}static{this.CommentsViewThreadActions=new T("CommentsViewThreadActions")}static{this.InteractiveToolbar=new T("InteractiveToolbar")}static{this.InteractiveCellTitle=new T("InteractiveCellTitle")}static{this.InteractiveCellDelete=new T("InteractiveCellDelete")}static{this.InteractiveCellExecute=new T("InteractiveCellExecute")}static{this.InteractiveInputExecute=new T("InteractiveInputExecute")}static{this.InteractiveInputConfig=new T("InteractiveInputConfig")}static{this.ReplInputExecute=new T("ReplInputExecute")}static{this.IssueReporter=new T("IssueReporter")}static{this.NotebookToolbar=new T("NotebookToolbar")}static{this.NotebookToolbarContext=new T("NotebookToolbarContext")}static{this.NotebookStickyScrollContext=new T("NotebookStickyScrollContext")}static{this.NotebookCellTitle=new T("NotebookCellTitle")}static{this.NotebookCellDelete=new T("NotebookCellDelete")}static{this.NotebookCellInsert=new T("NotebookCellInsert")}static{this.NotebookCellBetween=new T("NotebookCellBetween")}static{this.NotebookCellListTop=new T("NotebookCellTop")}static{this.NotebookCellExecute=new T("NotebookCellExecute")}static{this.NotebookCellExecuteGoTo=new T("NotebookCellExecuteGoTo")}static{this.NotebookCellExecutePrimary=new T("NotebookCellExecutePrimary")}static{this.NotebookDiffCellInputTitle=new T("NotebookDiffCellInputTitle")}static{this.NotebookDiffDocumentMetadata=new T("NotebookDiffDocumentMetadata")}static{this.NotebookDiffCellMetadataTitle=new T("NotebookDiffCellMetadataTitle")}static{this.NotebookDiffCellOutputsTitle=new T("NotebookDiffCellOutputsTitle")}static{this.NotebookOutputToolbar=new T("NotebookOutputToolbar")}static{this.NotebookOutlineFilter=new T("NotebookOutlineFilter")}static{this.NotebookOutlineActionMenu=new T("NotebookOutlineActionMenu")}static{this.NotebookEditorLayoutConfigure=new T("NotebookEditorLayoutConfigure")}static{this.NotebookKernelSource=new T("NotebookKernelSource")}static{this.BulkEditTitle=new T("BulkEditTitle")}static{this.BulkEditContext=new T("BulkEditContext")}static{this.TimelineItemContext=new T("TimelineItemContext")}static{this.TimelineTitle=new T("TimelineTitle")}static{this.TimelineTitleContext=new T("TimelineTitleContext")}static{this.TimelineFilterSubMenu=new T("TimelineFilterSubMenu")}static{this.AccountsContext=new T("AccountsContext")}static{this.SidebarTitle=new T("SidebarTitle")}static{this.PanelTitle=new T("PanelTitle")}static{this.AuxiliaryBarTitle=new T("AuxiliaryBarTitle")}static{this.TerminalInstanceContext=new T("TerminalInstanceContext")}static{this.TerminalEditorInstanceContext=new T("TerminalEditorInstanceContext")}static{this.TerminalNewDropdownContext=new T("TerminalNewDropdownContext")}static{this.TerminalTabContext=new T("TerminalTabContext")}static{this.TerminalTabEmptyAreaContext=new T("TerminalTabEmptyAreaContext")}static{this.TerminalStickyScrollContext=new T("TerminalStickyScrollContext")}static{this.WebviewContext=new T("WebviewContext")}static{this.InlineCompletionsActions=new T("InlineCompletionsActions")}static{this.InlineEditsActions=new T("InlineEditsActions")}static{this.NewFile=new T("NewFile")}static{this.MergeInput1Toolbar=new T("MergeToolbar1Toolbar")}static{this.MergeInput2Toolbar=new T("MergeToolbar2Toolbar")}static{this.MergeBaseToolbar=new T("MergeBaseToolbar")}static{this.MergeInputResultToolbar=new T("MergeToolbarResultToolbar")}static{this.InlineSuggestionToolbar=new T("InlineSuggestionToolbar")}static{this.InlineEditToolbar=new T("InlineEditToolbar")}static{this.ChatContext=new T("ChatContext")}static{this.ChatCodeBlock=new T("ChatCodeblock")}static{this.ChatCompareBlock=new T("ChatCompareBlock")}static{this.ChatMessageTitle=new T("ChatMessageTitle")}static{this.ChatWelcomeContext=new T("ChatWelcomeContext")}static{this.ChatMessageFooter=new T("ChatMessageFooter")}static{this.ChatExecute=new T("ChatExecute")}static{this.ChatExecuteQueue=new T("ChatExecuteQueue")}static{this.ChatInput=new T("ChatInput")}static{this.ChatInputSide=new T("ChatInputSide")}static{this.ChatModePicker=new T("ChatModePicker")}static{this.ChatEditingWidgetToolbar=new T("ChatEditingWidgetToolbar")}static{this.ChatEditingSessionChangesToolbar=new T("ChatEditingSessionChangesToolbar")}static{this.ChatEditingEditorContent=new T("ChatEditingEditorContent")}static{this.ChatEditingEditorHunk=new T("ChatEditingEditorHunk")}static{this.ChatEditingDeletedNotebookCell=new T("ChatEditingDeletedNotebookCell")}static{this.ChatInputAttachmentToolbar=new T("ChatInputAttachmentToolbar")}static{this.ChatEditingWidgetModifiedFilesToolbar=new T("ChatEditingWidgetModifiedFilesToolbar")}static{this.ChatInputResourceAttachmentContext=new T("ChatInputResourceAttachmentContext")}static{this.ChatInputSymbolAttachmentContext=new T("ChatInputSymbolAttachmentContext")}static{this.ChatInlineResourceAnchorContext=new T("ChatInlineResourceAnchorContext")}static{this.ChatInlineSymbolAnchorContext=new T("ChatInlineSymbolAnchorContext")}static{this.ChatMessageCheckpoint=new T("ChatMessageCheckpoint")}static{this.ChatMessageRestoreCheckpoint=new T("ChatMessageRestoreCheckpoint")}static{this.ChatNewMenu=new T("ChatNewMenu")}static{this.ChatEditingCodeBlockContext=new T("ChatEditingCodeBlockContext")}static{this.ChatTitleBarMenu=new T("ChatTitleBarMenu")}static{this.ChatAttachmentsContext=new T("ChatAttachmentsContext")}static{this.ChatToolOutputResourceToolbar=new T("ChatToolOutputResourceToolbar")}static{this.ChatTextEditorMenu=new T("ChatTextEditorMenu")}static{this.ChatToolOutputResourceContext=new T("ChatToolOutputResourceContext")}static{this.ChatMultiDiffContext=new T("ChatMultiDiffContext")}static{this.ChatConfirmationMenu=new T("ChatConfirmationMenu")}static{this.ChatEditorInlineGutter=new T("ChatEditorInlineGutter")}static{this.ChatEditorInlineExecute=new T("ChatEditorInputExecute")}static{this.ChatEditorInlineInputSide=new T("ChatEditorInputSide")}static{this.InlineChatEditorAffordance=new T("InlineChatEditorAffordance")}static{this.AccessibleView=new T("AccessibleView")}static{this.MultiDiffEditorContent=new T("MultiDiffEditorContent")}static{this.MultiDiffEditorFileToolbar=new T("MultiDiffEditorFileToolbar")}static{this.DiffEditorHunkToolbar=new T("DiffEditorHunkToolbar")}static{this.DiffEditorSelectionToolbar=new T("DiffEditorSelectionToolbar")}static{this.BrowserNavigationToolbar=new T("BrowserNavigationToolbar")}static{this.BrowserActionsToolbar=new T("BrowserActionsToolbar")}static{this.AgentSessionsViewerFilterSubMenu=new T("AgentSessionsViewerFilterSubMenu")}static{this.AgentSessionsContext=new T("AgentSessionsContext")}static{this.AgentSessionSectionContext=new T("AgentSessionSectionContext")}static{this.AgentSessionsCreateSubMenu=new T("AgentSessionsCreateSubMenu")}static{this.AgentSessionsToolbar=new T("AgentSessionsToolbar")}static{this.AgentSessionItemToolbar=new T("AgentSessionItemToolbar")}static{this.AgentSessionSectionToolbar=new T("AgentSessionSectionToolbar")}static{this.AgentsTitleBarControlMenu=new T("AgentsTitleBarControlMenu")}static{this.ChatViewSessionTitleNavigationToolbar=new T("ChatViewSessionTitleNavigationToolbar")}static{this.ChatViewSessionTitleToolbar=new T("ChatViewSessionTitleToolbar")}static{this.ChatContextUsageActions=new T("ChatContextUsageActions")}static for(e){return T._instances.get(e)??new T(e)}constructor(e){if(T._instances.has(e)){throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`)}T._instances.set(e,this);this.id=e}}class So{static{this._all=new Map}static for(e){let i=this._all.get(e);if(!i){i=new So(e);this._all.set(e,i)}return i}static merge(e){const i=new Set;for(const n of e){if(n instanceof So){i.add(n.id)}}return i}constructor(e){this.id=e;this.has=i=>i===e}}new class{constructor(){this._commands=new Map;this._menuItems=new Map;this._onDidChangeMenu=new MR({merge:So.merge});this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(t){this._commands.set(t.id,t);this._onDidChangeMenu.fire(So.for(T.CommandPalette));return I1(ye(()=>{if(this._commands.delete(t.id)){this._onDidChangeMenu.fire(So.for(T.CommandPalette))}}))}getCommand(t){return this._commands.get(t)}getCommands(){const t=new Map;this._commands.forEach((e,i)=>t.set(i,e));return t}appendMenuItem(t,e){let i=this._menuItems.get(t);if(!i){i=new Go;this._menuItems.set(t,i)}const n=i.push(e);this._onDidChangeMenu.fire(So.for(t));return I1(ye(()=>{n();this._onDidChangeMenu.fire(So.for(t))}))}appendMenuItems(t){const e=new pe;for(const{id:i,item:n}of t){e.add(this.appendMenuItem(i,n))}return e}getMenuItems(t){let e;if(this._menuItems.has(t)){e=[...this._menuItems.get(t)]}else{e=[]}if(t===T.CommandPalette){this._appendImplicitItems(e)}return e}_appendImplicitItems(t){const e=new Set;for(const i of t){if(oB(i)){e.add(i.command.id);if(i.alt){e.add(i.alt.id)}}}this._commands.forEach((i,n)=>{if(!e.has(n)){t.push({command:i})}})}};let aT=Ip=class Sq{static label(e,i){return i?.renderShortTitle&&e.shortTitle?typeof e.shortTitle==="string"?e.shortTitle:e.shortTitle.value:typeof e.title==="string"?e.title:e.title.value}constructor(e,i,n,s,r,o,a){this.hideActions=s;this.menuKeybinding=r;this._commandService=a;this.id=e.id;this.label=Ip.label(e,n);this.tooltip=(typeof e.tooltip==="string"?e.tooltip:e.tooltip?.value)??"";this.enabled=!e.precondition||o.contextMatchesRules(e.precondition);this.checked=void 0;let l;if(e.toggled){const c=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=o.contextMatchesRules(c.condition);if(this.checked&&c.tooltip){this.tooltip=typeof c.tooltip==="string"?c.tooltip:c.tooltip.value}if(this.checked&&Kt.isThemeIcon(c.icon)){l=c.icon}if(this.checked&&c.title){this.label=typeof c.title==="string"?c.title:c.title.value}}if(!l){l=Kt.isThemeIcon(e.icon)?e.icon:void 0}this.item=e;this.alt=i?new Ip(i,void 0,n,s,void 0,o,a):void 0;this._options=n;this.class=l&&Kt.asClassName(l)}run(...e){let i=[];if(this._options?.arg){i=[...i,this._options.arg]}if(this._options?.shouldForwardArgs){i=[...i,...e]}return this._commandService.executeCommand(this.id,...i)}};aT=Ip=W([P(5,Cu),P(6,L5)],aT);var lT;(function(t){t["ExtensionQueryService"]="ExtensionQueryService";t["ExtensionLatestVersionUri"]="ExtensionLatestVersionUriTemplate";t["ExtensionStatisticsUri"]="ExtensionStatisticsUriTemplate";t["PublisherViewUri"]="PublisherViewUriTemplate";t["ExtensionDetailsViewUri"]="ExtensionDetailsViewUriTemplate";t["ExtensionRatingViewUri"]="ExtensionRatingViewUriTemplate";t["ExtensionResourceUri"]="ExtensionResourceUriTemplate";t["ContactSupportUri"]="ContactSupportUri"})(lT||(lT={}));var cT;(function(t){t["None"]="None";t["IncludeVersions"]="IncludeVersions";t["IncludeFiles"]="IncludeFiles";t["IncludeCategoryAndTags"]="IncludeCategoryAndTags";t["IncludeSharedAccounts"]="IncludeSharedAccounts";t["IncludeVersionProperties"]="IncludeVersionProperties";t["ExcludeNonValidated"]="ExcludeNonValidated";t["IncludeInstallationTargets"]="IncludeInstallationTargets";t["IncludeAssetUri"]="IncludeAssetUri";t["IncludeStatistics"]="IncludeStatistics";t["IncludeLatestVersionOnly"]="IncludeLatestVersionOnly";t["Unpublished"]="Unpublished";t["IncludeNameConflictInfo"]="IncludeNameConflictInfo";t["IncludeLatestPrereleaseAndStableVersionOnly"]="IncludeLatestPrereleaseAndStableVersionOnly"})(cT||(cT={}));var eS;(function(t){t["Available"]="available";t["RequiresSignIn"]="requiresSignIn";t["AccessDenied"]="accessDenied";t["Unavailable"]="unavailable"})(eS||(eS={}));const N5=te("extensionsWorkbenchService");I_(8366,"Extensions");var tS;(function(t){t[t["Installing"]=0]="Installing";t[t["Installed"]=1]="Installed";t[t["Uninstalling"]=2]="Uninstalling";t[t["Uninstalled"]=3]="Uninstalled"})(tS||(tS={}));var uT;(function(t){t["ReloadWindow"]="reloadWindow";t["RestartExtensions"]="restartExtensions";t["DownloadUpdate"]="downloadUpdate";t["ApplyUpdate"]="applyUpdate";t["QuitAndInstall"]="quitAndInstall"})(uT||(uT={}));var dT;(function(t){t["Readme"]="readme";t["Features"]="features";t["Changelog"]="changelog";t["Dependencies"]="dependencies";t["ExtensionPack"]="extensionPack"})(dT||(dT={}));let hT=class xq extends me{constructor(e,i){super();this.containers=e;this._register(i.onChange(this.update,this))}set extension(e){this.containers.forEach(i=>i.extension=e)}update(e){for(const i of this.containers){if(e&&i.extension){if(eM(i.extension.identifier,e.identifier)){if(i.extension.server&&e.server&&i.extension.server!==e.server){if(i.updateWhenCounterExtensionChanges){i.update()}}else{i.extension=e}}}else{i.update()}}}};hT=W([P(1,N5)],hT);new E("defaultExtensionViews",true);new E("hasOutdatedExtensions",false);new E("hasGallery",false);new E("extensionsGalleryStatus",eS.Unavailable);new E("extensionResultListFocused ",true);new E("searchMcpServers",false);new T("extensionsSearchActionsMenu");new T("extensionsFilterSubMenu");const aB="vscode_searchExtensions_internal";({icon:Kt.fromId(_e.extensions.id),displayName:h(8379,"Search Extensions"),userDescription:h(8380,"Search for VS Code extensions"),source:Bo.Internal});let fT=class Eq{constructor(e){this.extensionWorkbenchService=e}async invoke(e,i,n,s){const r=e.parameters;if(!r.keywords?.length&&!r.category&&!r.ids?.length){return{content:[{kind:"text",value:h(8381,"Please provide a category or keywords or ids to search for.")}]}}const o=new Map;const a=u=>{for(const d of u){if(d.deprecationInfo||d.isMalicious){continue}o.set(d.identifier.id.toLowerCase(),{id:d.identifier.id,name:d.displayName,description:d.description,installed:d.state===tS.Installed,installCount:d.installCount??0,rating:d.rating??0,categories:d.categories??[],tags:d.gallery?.tags??[]})}};const l=async u=>{const d=await this.extensionWorkbenchService.queryGallery({text:u,pageSize:10,sortBy:cw.InstallCount},s);if(d.firstPage.length){a(d.firstPage)}};if(r.ids?.length){const u=await this.extensionWorkbenchService.getExtensions(r.ids.map(d=>({id:d})),s);a(u)}if(r.keywords?.length){for(const u of r.keywords??[]){if(u==="featured"){await l("featured")}else{let d=r.category?`category:"${r.category}"`:"";d=u?`${d} ${u}`.trim():d;await l(d)}}}else{await l(`category:"${r.category}"`)}const c=Array.from(o.values());return{content:[{kind:"text",value:`Here are the list of extensions:
${JSON.stringify(c)}
. Important: Use the following format to display extensions to the user because there is a renderer available to parse these extensions in this format and display them with all details. So, do not describe about the extensions to the user.
\`\`\`vscode-extensions
extensionId1,extensionId2
\`\`\`
.`}],toolResultDetails:{input:JSON.stringify(r),output:[{type:"embed",isText:true,value:JSON.stringify(c.map(u=>u.id))}]}}}};fT=W([P(0,N5)],fT);class pT{constructor(e){this._data=e}update(e){this._data=e;this._apiObject=void 0;this._apiObjectWithChatParticipantAdditions=void 0}get data(){return this._data}get apiObject(){if(!this._apiObject){this._apiObject=Object.freeze({name:this._data.id,description:this._data.modelDescription,inputSchema:this._data.inputSchema,tags:this._data.tags??[],source:void 0})}return this._apiObject}get apiObjectWithChatParticipantAdditions(){if(!this._apiObjectWithChatParticipantAdditions){this._apiObjectWithChatParticipantAdditions=Object.freeze({name:this._data.id,description:this._data.modelDescription,inputSchema:this._data.inputSchema,tags:this._data.tags??[],source:Sy.to(this._data.source)})}return this._apiObjectWithChatParticipantAdditions}}class lB{constructor(e,i){this._languageModels=i;this._registeredTools=new Map;this._tokenCountFuncs=new Map;this._allTools=new Map;this._proxy=e.getProxy(ee.MainThreadLanguageModelTools);this._proxy.$getTools().then(n=>{for(const s of n){this._allTools.set(s.id,new pT(Wi(s)))}})}async $countTokensForInvocation(e,i,n){const s=this._tokenCountFuncs.get(e);if(!s){throw new Error(`Tool invocation call ${e} not found`)}return await s(i,n)}async invokeTool(e,i,n,s){const r=typeof i==="string"?i:i.name;const o=Pi();if(n.tokenizationOptions){this._tokenCountFuncs.set(o,n.tokenizationOptions.countTokens)}try{if(n.toolInvocationToken&&!h3(n.toolInvocationToken)){throw new Error(`Invalid tool invocation token`)}if((r===q0||r===JI)&&!it(e,"chatParticipantPrivate")){throw new Error(`Invalid tool: ${r}`)}const a=await this._proxy.$invokeTool({toolId:r,callId:o,parameters:n.input,tokenBudget:n.tokenizationOptions?.tokenBudget,context:n.toolInvocationToken,chatRequestId:it(e,"chatParticipantPrivate")?n.chatRequestId:void 0,chatInteractionId:it(e,"chatParticipantPrivate")?n.chatInteractionId:void 0,subAgentInvocationId:it(e,"chatParticipantPrivate")?n.subAgentInvocationId:void 0,chatStreamToolCallId:it(e,"chatParticipantAdditions")?n.chatStreamToolCallId:void 0,preToolUseResult:it(e,"chatParticipantPrivate")?n.preToolUseResult:void 0},s);const l=a instanceof ji?a.value:a;return i_.to(Wi(l))}finally{this._tokenCountFuncs.delete(o)}}$onDidChangeTools(e){const i=new Set(this._allTools.keys());for(const n of e){i.delete(n.id);const s=this._allTools.get(n.id);if(s){s.update(n)}else{this._allTools.set(n.id,new pT(Wi(n)))}}for(const n of i){this._allTools.delete(n)}}getTools(e){const i=it(e,"chatParticipantPrivate");return Array.from(this._allTools.values()).map(n=>i?n.apiObjectWithChatParticipantAdditions:n.apiObject).filter(n=>{switch(n.name){case q0:case JI:case XH:case aB:return it(e,"chatParticipantPrivate");default:return true}})}async $invokeTool(e,i){const n=this._registeredTools.get(e.toolId);if(!n){throw new Error(`Unknown tool ${e.toolId}`)}const s={input:e.parameters,toolInvocationToken:Wi(e.context)};if(it(n.extension,"chatParticipantPrivate")){s.chatRequestId=e.chatRequestId;s.chatInteractionId=e.chatInteractionId;s.chatSessionId=e.context?.sessionId;s.chatSessionResource=b.revive(e.context?.sessionResource);s.subAgentInvocationId=e.subAgentInvocationId}if(it(n.extension,"chatParticipantAdditions")&&e.modelId){s.model=await this.getModel(e.modelId,n.extension)}if(it(n.extension,"chatParticipantAdditions")&&e.chatStreamToolCallId){s.chatStreamToolCallId=e.chatStreamToolCallId}if(e.tokenBudget!==void 0){s.tokenizationOptions={tokenBudget:e.tokenBudget,countTokens:this._tokenCountFuncs.get(e.callId)||((a,l=Ze.None)=>this._proxy.$countTokensForInvocation(e.callId,a,l))}}let r;if(it(n.extension,"toolProgress")){let a;r={report:l=>{if(l.increment!==void 0){a=(a??0)+l.increment}this._proxy.$acceptToolProgress(e.callId,{message:we.fromStrict(l.message),progress:a===void 0?void 0:a/100})}}}const o=await w4(Promise.resolve(n.tool.invoke(s,i,r)),i);if(!o){throw new Vi}return i_.from(o,n.extension)}async getModel(e,i){let n;if(e){n=await this._languageModels.getLanguageModelByIdentifier(i,e)}if(!n){n=await this._languageModels.getDefaultLanguageModel(i);if(!n){throw new Error("Language model unavailable")}}return n}async $handleToolStream(e,i,n){const s=this._registeredTools.get(e);if(!s){throw new Error(`Unknown tool ${e}`)}if(!s.tool.handleToolStream){return void 0}O(s.extension,"chatParticipantAdditions");const r={rawInput:i.rawInput,chatRequestId:i.chatRequestId,chatSessionId:i.chatSessionId,chatSessionResource:i.chatSessionResource,chatInteractionId:i.chatInteractionId};const o=await s.tool.handleToolStream(r,n);if(!o){return void 0}return{invocationMessage:we.fromStrict(o.invocationMessage)}}async $prepareToolInvocation(e,i,n){const s=this._registeredTools.get(e);if(!s){throw new Error(`Unknown tool ${e}`)}const r={input:i.parameters,chatRequestId:i.chatRequestId,chatSessionId:i.chatSessionId,chatSessionResource:i.chatSessionResource,chatInteractionId:i.chatInteractionId,forceConfirmationReason:i.forceConfirmationReason};if(i.forceConfirmationReason){O(s.extension,"chatParticipantPrivate")}if(s.tool.prepareInvocation){const o=await s.tool.prepareInvocation(r,n);if(!o){return void 0}if(o.pastTenseMessage||o.presentation){O(s.extension,"chatParticipantPrivate")}return{confirmationMessages:o.confirmationMessages?{title:typeof o.confirmationMessages.title==="string"?o.confirmationMessages.title:we.from(o.confirmationMessages.title),message:typeof o.confirmationMessages.message==="string"?o.confirmationMessages.message:we.from(o.confirmationMessages.message)}:void 0,invocationMessage:we.fromStrict(o.invocationMessage),pastTenseMessage:we.fromStrict(o.pastTenseMessage),presentation:o.presentation}}return void 0}registerTool(e,i,n){this._registeredTools.set(i,{extension:e,tool:n});this._proxy.$registerTool(i,typeof n.handleToolStream==="function");return ye(()=>{this._registeredTools.delete(i);this._proxy.$unregisterTool(i)})}registerToolDefinition(e,i,n){O(e,"languageModelToolSupportsModel");const s=i.name;const r={id:s,displayName:i.displayName,toolReferenceName:i.toolReferenceName,userDescription:i.userDescription,modelDescription:i.description,inputSchema:i.inputSchema,source:{type:"extension",label:e.displayName??e.name,extensionId:e.identifier},icon:Fr.from(i.icon),models:i.models,toolSet:i.toolSet};this._registeredTools.set(s,{extension:e,tool:n});this._proxy.$registerToolWithDefinition(e.identifier,r,typeof n.handleToolStream==="function");return ye(()=>{this._registeredTools.delete(s);this._proxy.$unregisterTool(s)})}}class cB{constructor(e,i,n,s){this._documents=i;this._commands=n;this._uriTransformer=s;this._languageIds=[];this._handlePool=0;this._ids=new Set;this._proxy=e.getProxy(ee.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,i){await this._proxy.$changeLanguage(e,i);const n=this._documents.getDocumentData(e);if(!n){throw new Error(`document '${e.toString()}' NOT found`)}return n.document}async tokenAtPosition(e,i){const n=e.version;const s=ut.from(i);const r=await this._proxy.$tokensAtPosition(e.uri,s);const o={type:ko.Other,range:e.getWordRangeAtPosition(i)??new Fe(i.line,i.character,i.line,i.character)};if(!r){return o}const a={range:V.to(r.range),type:Ub.to(r.type)};if(!a.range.contains(i)){return o}if(n!==e.version){return o}return a}createLanguageStatusItem(e,i,n){const s=this._handlePool++;const r=this._proxy;const o=this._ids;const a=`${e.identifier.value}/${i}`;if(o.has(a)){throw new Error(`LanguageStatusItem with id '${i}' ALREADY exists`)}o.add(a);const l={selector:n,id:i,name:e.displayName??e.name,severity:fc.Information,command:void 0,text:"",detail:"",busy:false};let c;const u=new pe;const d=()=>{c?.dispose();if(!o.has(a)){console.warn(`LanguageStatusItem (${i}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}c=s8(()=>{u.clear();this._proxy.$setLanguageStatus(s,{id:a,name:l.name??e.displayName??e.name,source:e.displayName??e.name,selector:hl.from(l.selector,this._uriTransformer),label:l.text,detail:l.detail??"",severity:l.severity===fc.Error?gt.Error:l.severity===fc.Warning?gt.Warning:gt.Info,command:l.command&&this._commands.toInternal(l.command,u),accessibilityInfo:l.accessibilityInformation,busy:l.busy})},0)};const f={dispose(){u.dispose();c?.dispose();r.$removeLanguageStatus(s);o.delete(a)},get id(){return l.id},get name(){return l.name},set name(p){l.name=p;d()},get selector(){return l.selector},set selector(p){l.selector=p;d()},get text(){return l.text},set text(p){l.text=p;d()},set text2(p){O(e,"languageStatusText");l.text=p;d()},get text2(){O(e,"languageStatusText");return l.text},get detail(){return l.detail},set detail(p){l.detail=p;d()},get severity(){return l.severity},set severity(p){l.severity=p;d()},get accessibilityInformation(){return l.accessibilityInformation},set accessibilityInformation(p){l.accessibilityInformation=p;d()},get command(){return l.command},set command(p){l.command=p;d()},get busy(){return l.busy},set busy(p){l.busy=p;d()}};d();return f}}function uB(t){return t&&t.title}let iS=class Cq{constructor(e,i){this._logService=i;this._proxy=e.getProxy(ee.MainThreadMessageService)}showMessage(e,i,n,s,r){const o={source:{identifier:e.identifier,label:e.displayName||e.name}};let a;if(typeof s==="string"||uB(s)){a=[s,...r]}else{o.modal=s?.modal;o.useCustom=s?.useCustom;o.detail=s?.detail;a=r}if(o.useCustom){O(e,"resolvers")}const l=[];let c=false;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d==="string"){l.push({title:d,handle:u,isCloseAffordance:false})}else if(typeof d==="object"){const{title:f,isCloseAffordance:p}=d;l.push({title:f,isCloseAffordance:!!p,handle:u});if(p){if(c){this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,d)}else{c=true}}}else{this._logService.warn(`[${e.identifier}] Invalid message item:`,d)}}return this._proxy.$showMessage(i,n,o,l).then(u=>{if(typeof u==="number"){return a[u]}return void 0})}};iS=W([P(1,et)],iS);class f1{constructor(e,i,n,s){this.start=e;this.deletedCount=i;this.deletedItems=n;this.items=s}asApiEvent(){return{range:new tr(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}}class nS{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:false,versionId:1,encoding:"utf8"}}constructor(e,i,n){this.notebook=e;this._extHostDocument=i;this._cellData=n;this.handle=n.handle;this.uri=b.revive(n.uri);this.cellKind=n.cellKind;this._outputs=n.outputs.map(qo.to);this._internalMetadata=n.internalMetadata??{};this._metadata=Object.freeze(n.metadata??{});this._previousResult=Object.freeze(au.to(n.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this;const i=this._extHostDocument.getDocument(this.uri);if(!i){throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`)}const n={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:Uh.to(this._cellData.cellKind),document:i.document,get mime(){return e._mime},set mime(s){e._mime=s},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(n)}return this._apiCell}setOutputs(e){this._outputs=e.map(qo.to)}setOutputItems(e,i,n){const s=n.map(cu.to);const r=this._outputs.find(o=>o.id===e);if(r){if(!i){r.items.length=0}r.items.push(...s);if(r.items.length>1&&r.items.every(o=>eP(o.mime))){const o=new Map;const a=[];r.items.forEach(l=>{let c;if(o.has(l.mime)){c=o.get(l.mime)}else{c=[];o.set(l.mime,c);a.push(l.mime)}c.push(l.data)});r.items.length=0;a.forEach(l=>{const c=ON(o.get(l));r.items.push({mime:l,data:c.data.buffer})})}}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e;this._previousResult=Object.freeze(au.to(e))}setMime(e){}}class Vx{static{this._handlePool=0}constructor(e,i,n,s,r){this._proxy=e;this._textDocumentsAndEditors=i;this._textDocuments=n;this.uri=s;this.handle=Vx._handlePool++;this._cells=[];this._versionId=0;this._isDirty=false;this._disposed=false;this._notebookType=r.viewType;this._metadata=Object.freeze(r.metadata??Object.create(null));this._spliceNotebookCells([[0,0,r.cells]],true,void 0);this._versionId=r.versionId}dispose(){this._disposed=true}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this;const i={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===ne.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(n){n=e._validateIndex(n);return e._cells[n].apiCell},getCells(n){const s=n?e._getCells(n):e._cells;return s.map(r=>r.apiCell)},save(){return e._save()},[Symbol.for("debug.description")](){return`NotebookDocument(${this.uri.toString()})`}};this._notebook=Object.freeze(i)}return this._notebook}acceptDocumentPropertiesChanged(e){if(e.metadata){this._metadata=Object.freeze({...this._metadata,...e.metadata})}}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,i,n){this._versionId=e.versionId;this._isDirty=i;this.acceptDocumentPropertiesChanged({metadata:n});const s={notebook:this.apiNotebook,metadata:n,cellChanges:[],contentChanges:[]};const r=[];for(const a of e.rawEvents){if(a.kind===us.ModelChange){this._spliceNotebookCells(a.changes,false,s.contentChanges)}else if(a.kind===us.Move){this._moveCells(a.index,a.length,a.newIdx,s.contentChanges)}else if(a.kind===us.Output){this._setCellOutputs(a.index,a.outputs);r.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})}else if(a.kind===us.OutputItem){this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems);r.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})}else if(a.kind===us.ChangeCellLanguage){this._changeCellLanguage(a.index,a.language);r.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})}else if(a.kind===us.ChangeCellContent){r.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})}else if(a.kind===us.ChangeCellMime){this._changeCellMime(a.index,a.mime)}else if(a.kind===us.ChangeCellMetadata){this._changeCellMetadata(a.index,a.metadata);r.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})}else if(a.kind===us.ChangeCellInternalMetadata){this._changeCellInternalMetadata(a.index,a.internalMetadata);r.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary})}}const o=new Map;for(let a=0;a<r.length;a++){const l=r[a];const c=o.get(l.cell);if(c===void 0){const u=s.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...l});o.set(l.cell,u-1)}else{s.cellChanges[c]={...s.cellChanges[c],...l}}}return s}_validateIndex(e){e=e|0;if(e<0){return 0}else if(e>=this._cells.length){return this._cells.length-1}else{return e}}_validateRange(e){let i=e.start|0;let n=e.end|0;if(i<0){i=0}if(n>this._cells.length){n=this._cells.length}return e.with({start:i,end:n})}_getCells(e){e=this._validateRange(e);const i=[];for(let n=e.start;n<e.end;n++){i.push(this._cells[n])}return i}async _save(){if(this._disposed){return Promise.reject(new Error("Notebook has been closed"))}return this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,i,n){if(this._disposed){return}const s=[];const r=[];const o=[];e.reverse().forEach(a=>{const l=a[2];const c=l.map(f=>{const p=new nS(this,this._textDocumentsAndEditors,f);if(!i){r.push(nS.asModelAddData(f))}return p});const u=new f1(a[0],a[1],[],c);const d=this._cells.splice(a[0],a[1],...c);for(const f of d){o.push(f.uri);u.deletedItems.push(f.apiCell)}s.push(u)});this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:r,removedDocuments:o});if(n){for(const a of s){n.push(a.asApiEvent())}}}_moveCells(e,i,n,s){const r=this._cells.splice(e,i);this._cells.splice(n,0,...r);const o=[new f1(e,i,r.map(a=>a.apiCell),[]),new f1(n,0,[],r)];for(const a of o){s.push(a.asApiEvent())}}_setCellOutputs(e,i){const n=this._cells[e];n.setOutputs(i)}_setCellOutputItems(e,i,n,s){const r=this._cells[e];r.setOutputItems(i,n,s)}_changeCellLanguage(e,i){const n=this._cells[e];if(n.apiCell.document.languageId!==i){this._textDocuments.$acceptModelLanguageChanged(n.uri,i)}}_changeCellMime(e,i){const n=this._cells[e];n.apiCell.mime=i}_changeCellMetadata(e,i){const n=this._cells[e];n.setMetadata(i)}_changeCellInternalMetadata(e,i){const n=this._cells[e];n.setInternalMetadata(i)}getCellFromApiCell(e){return this._cells.find(i=>i.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(i=>i.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}}class nf{static{this.apiEditorsToExtHost=new WeakMap}constructor(e,i,n,s,r,o,a){this.id=e;this._proxy=i;this.notebookData=n;this._visibleRanges=s;this._selections=r;this._viewColumn=o;this.viewType=a;this._visible=false}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(i){this.selections=[i]},get selections(){return e._selections},set selections(i){if(!Array.isArray(i)||!i.every(tr.isNotebookRange)){throw Ge("selections")}e._selections=i.length===0?[new tr(0,0)]:i;e._trySetSelections(e._selections)},get visibleRanges(){return e._visibleRanges},revealRange(i,n){e._proxy.$tryRevealRange(e.id,ar.from(i),n??lm.Default)},get viewColumn(){return e._viewColumn},get replOptions(){if(e.viewType==="repl"){return{appendIndex:this.notebook.cellCount-1}}return void 0},[Symbol.for("debug.description")](){return`NotebookEditor(${this.notebook.uri.toString()})`}};nf.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(ar.from))}_acceptViewColumn(e){this._viewColumn=e}}class sS{constructor(e,i){this.piece=e;this.color=i;this.size_left=0;this.lf_left=0;this.parent=this;this.left=this;this.right=this}next(){if(this.right!==ve){return zx(this.right)}let e=this;while(e.parent!==ve){if(e.parent.left===e){break}e=e.parent}if(e.parent===ve){return ve}else{return e.parent}}prev(){if(this.left!==ve){return M5(this.left)}let e=this;while(e.parent!==ve){if(e.parent.right===e){break}e=e.parent}if(e.parent===ve){return ve}else{return e.parent}}detach(){this.parent=null;this.left=null;this.right=null}}var $e;(function(t){t[t["Black"]=0]="Black";t[t["Red"]=1]="Red"})($e||($e={}));const ve=new sS(null,$e.Black);ve.parent=ve;ve.left=ve;ve.right=ve;ve.color=$e.Black;function zx(t){while(t.left!==ve){t=t.left}return t}function M5(t){while(t.right!==ve){t=t.right}return t}function qx(t){if(t===ve){return 0}return t.size_left+t.piece.length+qx(t.right)}function jx(t){if(t===ve){return 0}return t.lf_left+t.piece.lineFeedCnt+jx(t.right)}function p1(){ve.parent=ve}function Ud(t,e){const i=e.right;i.size_left+=e.size_left+(e.piece?e.piece.length:0);i.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0);e.right=i.left;if(i.left!==ve){i.left.parent=e}i.parent=e.parent;if(e.parent===ve){t.root=i}else if(e.parent.left===e){e.parent.left=i}else{e.parent.right=i}i.left=e;e.parent=i}function $d(t,e){const i=e.left;e.left=i.right;if(i.right!==ve){i.right.parent=e}i.parent=e.parent;e.size_left-=i.size_left+(i.piece?i.piece.length:0);e.lf_left-=i.lf_left+(i.piece?i.piece.lineFeedCnt:0);if(e.parent===ve){t.root=i}else if(e===e.parent.right){e.parent.right=i}else{e.parent.left=i}i.right=e;e.parent=i}function jf(t,e){let i;let n;if(e.left===ve){n=e;i=n.right}else if(e.right===ve){n=e;i=n.left}else{n=zx(e.right);i=n.right}if(n===t.root){t.root=i;i.color=$e.Black;e.detach();p1();t.root.parent=ve;return}const s=n.color===$e.Red;if(n===n.parent.left){n.parent.left=i}else{n.parent.right=i}if(n===e){i.parent=n.parent;rd(t,i)}else{if(n.parent===e){i.parent=n}else{i.parent=n.parent}rd(t,i);n.left=e.left;n.right=e.right;n.parent=e.parent;n.color=e.color;if(e===t.root){t.root=n}else{if(e===e.parent.left){e.parent.left=n}else{e.parent.right=n}}if(n.left!==ve){n.left.parent=n}if(n.right!==ve){n.right.parent=n}n.size_left=e.size_left;n.lf_left=e.lf_left;rd(t,n)}e.detach();if(i.parent.left===i){const o=qx(i);const a=jx(i);if(o!==i.parent.size_left||a!==i.parent.lf_left){const l=o-i.parent.size_left;const c=a-i.parent.lf_left;i.parent.size_left=o;i.parent.lf_left=a;wr(t,i.parent,l,c)}}rd(t,i.parent);if(s){p1();return}let r;while(i!==t.root&&i.color===$e.Black){if(i===i.parent.left){r=i.parent.right;if(r.color===$e.Red){r.color=$e.Black;i.parent.color=$e.Red;Ud(t,i.parent);r=i.parent.right}if(r.left.color===$e.Black&&r.right.color===$e.Black){r.color=$e.Red;i=i.parent}else{if(r.right.color===$e.Black){r.left.color=$e.Black;r.color=$e.Red;$d(t,r);r=i.parent.right}r.color=i.parent.color;i.parent.color=$e.Black;r.right.color=$e.Black;Ud(t,i.parent);i=t.root}}else{r=i.parent.left;if(r.color===$e.Red){r.color=$e.Black;i.parent.color=$e.Red;$d(t,i.parent);r=i.parent.left}if(r.left.color===$e.Black&&r.right.color===$e.Black){r.color=$e.Red;i=i.parent}else{if(r.left.color===$e.Black){r.right.color=$e.Black;r.color=$e.Red;Ud(t,r);r=i.parent.left}r.color=i.parent.color;i.parent.color=$e.Black;r.left.color=$e.Black;$d(t,i.parent);i=t.root}}}i.color=$e.Black;p1()}function gT(t,e){rd(t,e);while(e!==t.root&&e.parent.color===$e.Red){if(e.parent===e.parent.parent.left){const i=e.parent.parent.right;if(i.color===$e.Red){e.parent.color=$e.Black;i.color=$e.Black;e.parent.parent.color=$e.Red;e=e.parent.parent}else{if(e===e.parent.right){e=e.parent;Ud(t,e)}e.parent.color=$e.Black;e.parent.parent.color=$e.Red;$d(t,e.parent.parent)}}else{const i=e.parent.parent.left;if(i.color===$e.Red){e.parent.color=$e.Black;i.color=$e.Black;e.parent.parent.color=$e.Red;e=e.parent.parent}else{if(e===e.parent.left){e=e.parent;$d(t,e)}e.parent.color=$e.Black;e.parent.parent.color=$e.Red;Ud(t,e.parent.parent)}}}t.root.color=$e.Black}function wr(t,e,i,n){while(e!==t.root&&e!==ve){if(e.parent.left===e){e.parent.size_left+=i;e.parent.lf_left+=n}e=e.parent}}function rd(t,e){let i=0;let n=0;if(e===t.root){return}while(e!==t.root&&e===e.parent.right){e=e.parent}if(e===t.root){return}e=e.parent;i=qx(e.left)-e.size_left;n=jx(e.left)-e.lf_left;e.size_left+=i;e.lf_left+=n;while(e!==t.root&&(i!==0||n!==0)){if(e.parent.left===e){e.parent.size_left+=i;e.parent.lf_left+=n}e=e.parent}}const pr=65535;function O5(t){let e;if(t[t.length-1]<65536){e=new Uint16Array(t.length)}else{e=new Uint32Array(t.length)}e.set(t,0);return e}class dB{constructor(e,i,n,s,r){this.lineStarts=e;this.cr=i;this.lf=n;this.crlf=s;this.isBasicASCII=r}}function Cr(t,e=true){const i=[0];let n=1;for(let s=0,r=t.length;s<r;s++){const o=t.charCodeAt(s);if(o===M.CarriageReturn){if(s+1<r&&t.charCodeAt(s+1)===M.LineFeed){i[n++]=s+2;s++}else{i[n++]=s+1}}else if(o===M.LineFeed){i[n++]=s+1}}if(e){return O5(i)}else{return i}}function hB(t,e){t.length=0;t[0]=0;let i=1;let n=0,s=0,r=0;let o=true;for(let l=0,c=e.length;l<c;l++){const u=e.charCodeAt(l);if(u===M.CarriageReturn){if(l+1<c&&e.charCodeAt(l+1)===M.LineFeed){r++;t[i++]=l+2;l++}else{n++;t[i++]=l+1}}else if(u===M.LineFeed){s++;t[i++]=l+1}else{if(o){if(u!==M.Tab&&(u<32||u>126)){o=false}}}}const a=new dB(O5(t),n,s,r,o);t.length=0;return a}class ln{constructor(e,i,n,s,r){this.bufferIndex=e;this.start=i;this.end=n;this.lineFeedCnt=s;this.length=r}}class Sa{constructor(e,i){this.buffer=e;this.lineStarts=i}}class fB{constructor(e,i){this._pieces=[];this._tree=e;this._BOM=i;this._index=0;if(e.root!==ve){e.iterate(e.root,n=>{if(n!==ve){this._pieces.push(n.piece)}return true})}}read(){if(this._pieces.length===0){if(this._index===0){this._index++;return this._BOM}else{return null}}if(this._index>this._pieces.length-1){return null}if(this._index===0){return this._BOM+this._tree.getPieceContent(this._pieces[this._index++])}return this._tree.getPieceContent(this._pieces[this._index++])}}class pB{constructor(e){this._limit=e;this._cache=[]}get(e){for(let i=this._cache.length-1;i>=0;i--){const n=this._cache[i];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e){return n}}return null}get2(e){for(let i=this._cache.length-1;i>=0;i--){const n=this._cache[i];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e){return n}}return null}set(e){if(this._cache.length>=this._limit){this._cache.shift()}this._cache.push(e)}validate(e){let i=false;const n=this._cache;for(let s=0;s<n.length;s++){const r=n[s];if(r.node.parent===null||r.nodeStartOffset>=e){n[s]=null;i=true;continue}}if(i){const s=[];for(const r of n){if(r!==null){s.push(r)}}this._cache=s}}}class gB{constructor(e,i,n){this.create(e,i,n)}create(e,i,n){this._buffers=[new Sa("",[0])];this._lastChangeBufferPos={line:0,column:0};this.root=ve;this._lineCnt=1;this._length=0;this._EOL=i;this._EOLLength=i.length;this._EOLNormalized=n;let s=null;for(let r=0,o=e.length;r<o;r++){if(e[r].buffer.length>0){if(!e[r].lineStarts){e[r].lineStarts=Cr(e[r].buffer)}const a=new ln(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]);s=this.rbInsertRight(s,a)}}this._searchCache=new pB(1);this._lastVisitedLine={lineNumber:0,value:""};this.computeBufferMetadata()}normalizeEOL(e){const i=pr;const n=i-Math.floor(i/3);const s=n*2;let r="";let o=0;const a=[];this.iterate(this.root,l=>{const c=this.getNodeContent(l);const u=c.length;if(o<=n||o+u<s){r+=c;o+=u;return true}const d=r.replace(/\r\n|\r|\n/g,e);a.push(new Sa(d,Cr(d)));r=c;o=u;return true});if(o>0){const l=r.replace(/\r\n|\r|\n/g,e);a.push(new Sa(l,Cr(l)))}this.create(a,e,true)}getEOL(){return this._EOL}setEOL(e){this._EOL=e;this._EOLLength=this._EOL.length;this.normalizeEOL(e)}createSnapshot(e){return new fB(this,e)}equal(e){if(this.getLength()!==e.getLength()){return false}if(this.getLineCount()!==e.getLineCount()){return false}let i=0;const n=this.iterate(this.root,s=>{if(s===ve){return true}const r=this.getNodeContent(s);const o=r.length;const a=e.nodeAt(i);const l=e.nodeAt(i+o);const c=e.getValueInRange2(a,l);i+=o;return r===c});return n}getOffsetAt(e,i){let n=0;let s=this.root;while(s!==ve){if(s.left!==ve&&s.lf_left+1>=e){s=s.left}else if(s.lf_left+s.piece.lineFeedCnt+1>=e){n+=s.size_left;const r=this.getAccumulatedValue(s,e-s.lf_left-2);return n+=r+i-1}else{e-=s.lf_left+s.piece.lineFeedCnt;n+=s.size_left+s.piece.length;s=s.right}}return n}getPositionAt(e){e=Math.floor(e);e=Math.max(0,e);let i=this.root;let n=0;const s=e;while(i!==ve){if(i.size_left!==0&&i.size_left>=e){i=i.left}else if(i.size_left+i.piece.length>=e){const r=this.getIndexOf(i,e-i.size_left);n+=i.lf_left+r.index;if(r.index===0){const o=this.getOffsetAt(n+1,1);const a=s-o;return new $n(n+1,a+1)}return new $n(n+1,r.remainder+1)}else{e-=i.size_left+i.piece.length;n+=i.lf_left+i.piece.lineFeedCnt;if(i.right===ve){const r=this.getOffsetAt(n+1,1);const o=s-e-r;return new $n(n+1,o+1)}else{i=i.right}}}return new $n(1,1)}getValueInRange(e,i){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn){return""}const n=this.nodeAt2(e.startLineNumber,e.startColumn);const s=this.nodeAt2(e.endLineNumber,e.endColumn);const r=this.getValueInRange2(n,s);if(i){if(i!==this._EOL||!this._EOLNormalized){return r.replace(/\r\n|\r|\n/g,i)}if(i===this.getEOL()&&this._EOLNormalized){return r}return r.replace(/\r\n|\r|\n/g,i)}return r}getValueInRange2(e,i){if(e.node===i.node){const a=e.node;const l=this._buffers[a.piece.bufferIndex].buffer;const c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+i.remainder)}let n=e.node;const s=this._buffers[n.piece.bufferIndex].buffer;const r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);let o=s.substring(r+e.remainder,r+n.piece.length);n=n.next();while(n!==ve){const a=this._buffers[n.piece.bufferIndex].buffer;const l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===i.node){o+=a.substring(l,l+i.remainder);break}else{o+=a.substr(l,n.piece.length)}n=n.next()}return o}getLinesContent(){const e=[];let i=0;let n="";let s=false;this.iterate(this.root,r=>{if(r===ve){return true}const o=r.piece;let a=o.length;if(a===0){return true}const l=this._buffers[o.bufferIndex].buffer;const c=this._buffers[o.bufferIndex].lineStarts;const u=o.start.line;const d=o.end.line;let f=c[u]+o.start.column;if(s){if(l.charCodeAt(f)===M.LineFeed){f++;a--}e[i++]=n;n="";s=false;if(a===0){return true}}if(u===d){if(!this._EOLNormalized&&l.charCodeAt(f+a-1)===M.CarriageReturn){s=true;n+=l.substr(f,a-1)}else{n+=l.substr(f,a)}return true}n+=this._EOLNormalized?l.substring(f,Math.max(f,c[u+1]-this._EOLLength)):l.substring(f,c[u+1]).replace(/(\r\n|\r|\n)$/,"");e[i++]=n;for(let p=u+1;p<d;p++){n=this._EOLNormalized?l.substring(c[p],c[p+1]-this._EOLLength):l.substring(c[p],c[p+1]).replace(/(\r\n|\r|\n)$/,"");e[i++]=n}if(!this._EOLNormalized&&l.charCodeAt(c[d]+o.end.column-1)===M.CarriageReturn){s=true;if(o.end.column===0){i--}else{n=l.substr(c[d],o.end.column-1)}}else{n=l.substr(c[d],o.end.column)}return true});if(s){e[i++]=n;n=""}e[i++]=n;return e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){if(this._lastVisitedLine.lineNumber===e){return this._lastVisitedLine.value}this._lastVisitedLine.lineNumber=e;if(e===this._lineCnt){this._lastVisitedLine.value=this.getLineRawContent(e)}else if(this._EOLNormalized){this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength)}else{this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,"")}return this._lastVisitedLine.value}_getCharCode(e){if(e.remainder===e.node.piece.length){const i=e.node.next();if(!i){return 0}const n=this._buffers[i.piece.bufferIndex];const s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.buffer.charCodeAt(s)}else{const i=this._buffers[e.node.piece.bufferIndex];const n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start);const s=n+e.remainder;return i.buffer.charCodeAt(s)}}getLineCharCode(e,i){const n=this.nodeAt2(e,i+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){const i=this.getOffsetAt(e,1);return this.getLength()-i}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const i=this.nodeAt(e);return this._getCharCode(i)}getNearestChunk(e){const i=this.nodeAt(e);if(i.remainder===i.node.piece.length){const n=i.node.next();if(!n||n===ve){return""}const s=this._buffers[n.piece.bufferIndex];const r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s.buffer.substring(r,r+n.piece.length)}else{const n=this._buffers[i.node.piece.bufferIndex];const s=this.offsetInBuffer(i.node.piece.bufferIndex,i.node.piece.start);const r=s+i.remainder;const o=s+i.node.piece.length;return n.buffer.substring(r,o)}}findMatchesInNode(e,i,n,s,r,o,a,l,c,u,d){const f=this._buffers[e.piece.bufferIndex];const p=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);const m=this.offsetInBuffer(e.piece.bufferIndex,r);const v=this.offsetInBuffer(e.piece.bufferIndex,o);let y;const k={line:0,column:0};let S;let R;if(i._wordSeparators){S=f.buffer.substring(m,v);R=K=>K+m;i.reset(0)}else{S=f.buffer;R=K=>K;i.reset(m)}do{y=i.next(S);if(y){if(R(y.index)>=v){return u}this.positionInBuffer(e,R(y.index)-p,k);const K=this.getLineFeedCnt(e.piece.bufferIndex,r,k);const q=k.line===r.line?k.column-r.column+s:k.column+1;const se=q+y[0].length;d[u++]=BD(new _t(n+K,q,n+K,se),y,l);if(R(y.index)+y[0].length>=v){return u}if(u>=c){return u}}}while(y);return u}findMatchesLineByLine(e,i,n,s){const r=[];let o=0;const a=new bF(i.wordSeparators,i.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null){return[]}const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null){return[]}let u=this.positionInBuffer(l.node,l.remainder);const d=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node){this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,u,d,i,n,s,o,r);return r}let f=e.startLineNumber;let p=l.node;while(p!==c.node){const v=this.getLineFeedCnt(p.piece.bufferIndex,u,p.piece.end);if(v>=1){const k=this._buffers[p.piece.bufferIndex].lineStarts;const S=this.offsetInBuffer(p.piece.bufferIndex,p.piece.start);const R=k[u.line+v];const K=f===e.startLineNumber?e.startColumn:1;o=this.findMatchesInNode(p,a,f,K,u,this.positionInBuffer(p,R-S),i,n,s,o,r);if(o>=s){return r}f+=v}const y=f===e.startLineNumber?e.startColumn-1:0;if(f===e.endLineNumber){const k=this.getLineContent(f).substring(y,e.endColumn-1);o=this._findMatchesInLine(i,a,k,e.endLineNumber,y,o,r,n,s);return r}o=this._findMatchesInLine(i,a,this.getLineContent(f).substr(y),f,y,o,r,n,s);if(o>=s){return r}f++;l=this.nodeAt2(f,1);p=l.node;u=this.positionInBuffer(l.node,l.remainder)}if(f===e.endLineNumber){const v=f===e.startLineNumber?e.startColumn-1:0;const y=this.getLineContent(f).substring(v,e.endColumn-1);o=this._findMatchesInLine(i,a,y,e.endLineNumber,v,o,r,n,s);return r}const m=f===e.startLineNumber?e.startColumn:1;o=this.findMatchesInNode(c.node,a,f,m,u,d,i,n,s,o,r);return r}_findMatchesInLine(e,i,n,s,r,o,a,l,c){const u=e.wordSeparators;if(!l&&e.simpleSearch){const f=e.simpleSearch;const p=f.length;const m=n.length;let v=-p;while((v=n.indexOf(f,v+p))!==-1){if(!u||QA(u,n,m,v,p)){a[o++]=new J1(new _t(s,v+1+r,s,v+1+p+r),null);if(o>=c){return o}}}return o}let d;i.reset(0);do{d=i.next(n);if(d){a[o++]=BD(new _t(s,d.index+1+r,s,d.index+1+d[0].length+r),d,l);if(o>=c){return o}}}while(d);return o}insert(e,i,n=false){this._EOLNormalized=this._EOLNormalized&&n;this._lastVisitedLine.lineNumber=0;this._lastVisitedLine.value="";if(this.root!==ve){const{node:s,remainder:r,nodeStartOffset:o}=this.nodeAt(e);const a=s.piece;const l=a.bufferIndex;const c=this.positionInBuffer(s,r);if(s.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&i.length<pr){this.appendToNode(s,i);this.computeBufferMetadata();return}if(o===e){this.insertContentToNodeLeft(i,s);this._searchCache.validate(e)}else if(o+s.piece.length>e){const u=[];let d=new ln(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(i)){const m=this.nodeCharCodeAt(s,r);if(m===10){const v={line:d.start.line+1,column:0};d=new ln(d.bufferIndex,v,d.end,this.getLineFeedCnt(d.bufferIndex,v,d.end),d.length-1);i+="\n"}}if(this.shouldCheckCRLF()&&this.startWithLF(i)){const m=this.nodeCharCodeAt(s,r-1);if(m===13){const v=this.positionInBuffer(s,r-1);this.deleteNodeTail(s,v);i="\r"+i;if(s.piece.length===0){u.push(s)}}else{this.deleteNodeTail(s,c)}}else{this.deleteNodeTail(s,c)}const f=this.createNewPieces(i);if(d.length>0){this.rbInsertRight(s,d)}let p=s;for(let m=0;m<f.length;m++){p=this.rbInsertRight(p,f[m])}this.deleteNodes(u)}else{this.insertContentToNodeRight(i,s)}}else{const s=this.createNewPieces(i);let r=this.rbInsertLeft(null,s[0]);for(let o=1;o<s.length;o++){r=this.rbInsertRight(r,s[o])}}this.computeBufferMetadata()}delete(e,i){this._lastVisitedLine.lineNumber=0;this._lastVisitedLine.value="";if(i<=0||this.root===ve){return}const n=this.nodeAt(e);const s=this.nodeAt(e+i);const r=n.node;const o=s.node;if(r===o){const f=this.positionInBuffer(r,n.remainder);const p=this.positionInBuffer(r,s.remainder);if(n.nodeStartOffset===e){if(i===r.piece.length){const m=r.next();jf(this,r);this.validateCRLFWithPrevNode(m);this.computeBufferMetadata();return}this.deleteNodeHead(r,p);this._searchCache.validate(e);this.validateCRLFWithPrevNode(r);this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+i){this.deleteNodeTail(r,f);this.validateCRLFWithNextNode(r);this.computeBufferMetadata();return}this.shrinkNode(r,f,p);this.computeBufferMetadata();return}const a=[];const l=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,l);this._searchCache.validate(e);if(r.piece.length===0){a.push(r)}const c=this.positionInBuffer(o,s.remainder);this.deleteNodeHead(o,c);if(o.piece.length===0){a.push(o)}const u=r.next();for(let f=u;f!==ve&&f!==o;f=f.next()){a.push(f)}const d=r.piece.length===0?r.prev():r;this.deleteNodes(a);this.validateCRLFWithNextNode(d);this.computeBufferMetadata()}insertContentToNodeLeft(e,i){const n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(i)){const o=i.piece;const a={line:o.start.line+1,column:0};const l=new ln(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);i.piece=l;e+="\n";wr(this,i,-1,-1);if(i.piece.length===0){n.push(i)}}const s=this.createNewPieces(e);let r=this.rbInsertLeft(i,s[s.length-1]);for(let o=s.length-2;o>=0;o--){r=this.rbInsertLeft(r,s[o])}this.validateCRLFWithPrevNode(r);this.deleteNodes(n)}insertContentToNodeRight(e,i){if(this.adjustCarriageReturnFromNext(e,i)){e+="\n"}const n=this.createNewPieces(e);const s=this.rbInsertRight(i,n[0]);let r=s;for(let o=1;o<n.length;o++){r=this.rbInsertRight(r,n[o])}this.validateCRLFWithPrevNode(s)}positionInBuffer(e,i,n){const s=e.piece;const r=e.piece.bufferIndex;const o=this._buffers[r].lineStarts;const a=o[s.start.line]+s.start.column;const l=a+i;let c=s.start.line;let u=s.end.line;let d=0;let f=0;let p=0;while(c<=u){d=c+(u-c)/2|0;p=o[d];if(d===u){break}f=o[d+1];if(l<p){u=d-1}else if(l>=f){c=d+1}else{break}}if(n){n.line=d;n.column=l-p;return null}return{line:d,column:l-p}}getLineFeedCnt(e,i,n){if(n.column===0){return n.line-i.line}const s=this._buffers[e].lineStarts;if(n.line===s.length-1){return n.line-i.line}const r=s[n.line+1];const o=s[n.line]+n.column;if(r>o+1){return n.line-i.line}const a=o-1;const l=this._buffers[e].buffer;if(l.charCodeAt(a)===13){return n.line-i.line+1}else{return n.line-i.line}}offsetInBuffer(e,i){const n=this._buffers[e].lineStarts;return n[i.line]+i.column}deleteNodes(e){for(let i=0;i<e.length;i++){jf(this,e[i])}}createNewPieces(e){if(e.length>pr){const u=[];while(e.length>pr){const f=e.charCodeAt(pr-1);let p;if(f===M.CarriageReturn||f>=55296&&f<=56319){p=e.substring(0,pr-1);e=e.substring(pr-1)}else{p=e.substring(0,pr);e=e.substring(pr)}const m=Cr(p);u.push(new ln(this._buffers.length,{line:0,column:0},{line:m.length-1,column:p.length-m[m.length-1]},m.length-1,p.length));this._buffers.push(new Sa(p,m))}const d=Cr(e);u.push(new ln(this._buffers.length,{line:0,column:0},{line:d.length-1,column:e.length-d[d.length-1]},d.length-1,e.length));this._buffers.push(new Sa(e,d));return u}let i=this._buffers[0].buffer.length;const n=Cr(e,false);let s=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===i&&i!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1};s=this._lastChangeBufferPos;for(let u=0;u<n.length;u++){n[u]+=i+1}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));this._buffers[0].buffer+="_"+e;i+=1}else{if(i!==0){for(let u=0;u<n.length;u++){n[u]+=i}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));this._buffers[0].buffer+=e}const r=this._buffers[0].buffer.length;const o=this._buffers[0].lineStarts.length-1;const a=r-this._buffers[0].lineStarts[o];const l={line:o,column:a};const c=new ln(0,s,l,this.getLineFeedCnt(0,s,l),r-i);this._lastChangeBufferPos=l;return[c]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,i=0){let n=this.root;let s="";const r=this._searchCache.get2(e);if(r){n=r.node;const o=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1);const a=this._buffers[n.piece.bufferIndex].buffer;const l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e){s=a.substring(l+o,l+n.piece.length)}else{const c=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return a.substring(l+o,l+c-i)}}else{let o=0;const a=e;while(n!==ve){if(n.left!==ve&&n.lf_left>=e-1){n=n.left}else if(n.lf_left+n.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(n,e-n.lf_left-2);const c=this.getAccumulatedValue(n,e-n.lf_left-1);const u=this._buffers[n.piece.bufferIndex].buffer;const d=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);o+=n.size_left;this._searchCache.set({node:n,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-n.lf_left)});return u.substring(d+l,d+c-i)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(n,e-n.lf_left-2);const c=this._buffers[n.piece.bufferIndex].buffer;const u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);s=c.substring(u+l,u+n.piece.length);break}else{e-=n.lf_left+n.piece.lineFeedCnt;o+=n.size_left+n.piece.length;n=n.right}}}n=n.next();while(n!==ve){const o=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(n,0);const l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);s+=o.substring(l,l+a-i);return s}else{const a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);s+=o.substr(a,n.piece.length)}n=n.next()}return s}computeBufferMetadata(){let e=this.root;let i=1;let n=0;while(e!==ve){i+=e.lf_left+e.piece.lineFeedCnt;n+=e.size_left+e.piece.length;e=e.right}this._lineCnt=i;this._length=n;this._searchCache.validate(this._length)}getIndexOf(e,i){const n=e.piece;const s=this.positionInBuffer(e,i);const r=s.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===i){const o=this.getLineFeedCnt(e.piece.bufferIndex,n.start,s);if(o!==r){return{index:o,remainder:0}}}return{index:r,remainder:s.column}}getAccumulatedValue(e,i){if(i<0){return 0}const n=e.piece;const s=this._buffers[n.bufferIndex].lineStarts;const r=n.start.line+i+1;if(r>n.end.line){return s[n.end.line]+n.end.column-s[n.start.line]-n.start.column}else{return s[r]-s[n.start.line]-n.start.column}}deleteNodeTail(e,i){const n=e.piece;const s=n.lineFeedCnt;const r=this.offsetInBuffer(n.bufferIndex,n.end);const o=i;const a=this.offsetInBuffer(n.bufferIndex,o);const l=this.getLineFeedCnt(n.bufferIndex,n.start,o);const c=l-s;const u=a-r;const d=n.length+u;e.piece=new ln(n.bufferIndex,n.start,o,l,d);wr(this,e,u,c)}deleteNodeHead(e,i){const n=e.piece;const s=n.lineFeedCnt;const r=this.offsetInBuffer(n.bufferIndex,n.start);const o=i;const a=this.getLineFeedCnt(n.bufferIndex,o,n.end);const l=this.offsetInBuffer(n.bufferIndex,o);const c=a-s;const u=r-l;const d=n.length+u;e.piece=new ln(n.bufferIndex,o,n.end,a,d);wr(this,e,u,c)}shrinkNode(e,i,n){const s=e.piece;const r=s.start;const o=s.end;const a=s.length;const l=s.lineFeedCnt;const c=i;const u=this.getLineFeedCnt(s.bufferIndex,s.start,c);const d=this.offsetInBuffer(s.bufferIndex,i)-this.offsetInBuffer(s.bufferIndex,r);e.piece=new ln(s.bufferIndex,s.start,c,u,d);wr(this,e,d-a,u-l);const f=new ln(s.bufferIndex,n,o,this.getLineFeedCnt(s.bufferIndex,n,o),this.offsetInBuffer(s.bufferIndex,o)-this.offsetInBuffer(s.bufferIndex,n));const p=this.rbInsertRight(e,f);this.validateCRLFWithPrevNode(p)}appendToNode(e,i){if(this.adjustCarriageReturnFromNext(i,e)){i+="\n"}const n=this.shouldCheckCRLF()&&this.startWithLF(i)&&this.endWithCR(e);const s=this._buffers[0].buffer.length;this._buffers[0].buffer+=i;const r=Cr(i,false);for(let p=0;p<r.length;p++){r[p]+=s}if(n){const p=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop();this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:s-p}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));const o=this._buffers[0].lineStarts.length-1;const a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o];const l={line:o,column:a};const c=e.piece.length+i.length;const u=e.piece.lineFeedCnt;const d=this.getLineFeedCnt(0,e.piece.start,l);const f=d-u;e.piece=new ln(e.piece.bufferIndex,e.piece.start,l,d,c);this._lastChangeBufferPos=l;wr(this,e,i.length,f)}nodeAt(e){let i=this.root;const n=this._searchCache.get(e);if(n){return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset}}let s=0;while(i!==ve){if(i.size_left>e){i=i.left}else if(i.size_left+i.piece.length>=e){s+=i.size_left;const r={node:i,remainder:e-i.size_left,nodeStartOffset:s};this._searchCache.set(r);return r}else{e-=i.size_left+i.piece.length;s+=i.size_left+i.piece.length;i=i.right}}return null}nodeAt2(e,i){let n=this.root;let s=0;while(n!==ve){if(n.left!==ve&&n.lf_left>=e-1){n=n.left}else if(n.lf_left+n.piece.lineFeedCnt>e-1){const r=this.getAccumulatedValue(n,e-n.lf_left-2);const o=this.getAccumulatedValue(n,e-n.lf_left-1);s+=n.size_left;return{node:n,remainder:Math.min(r+i-1,o),nodeStartOffset:s}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){const r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+i-1<=n.piece.length){return{node:n,remainder:r+i-1,nodeStartOffset:s}}else{i-=n.piece.length-r;break}}else{e-=n.lf_left+n.piece.lineFeedCnt;s+=n.size_left+n.piece.length;n=n.right}}n=n.next();while(n!==ve){if(n.piece.lineFeedCnt>0){const r=this.getAccumulatedValue(n,0);const o=this.offsetOfNode(n);return{node:n,remainder:Math.min(i-1,r),nodeStartOffset:o}}else{if(n.piece.length>=i-1){const r=this.offsetOfNode(n);return{node:n,remainder:i-1,nodeStartOffset:r}}else{i-=n.piece.length}}n=n.next()}return null}nodeCharCodeAt(e,i){if(e.piece.lineFeedCnt<1){return-1}const n=this._buffers[e.piece.bufferIndex];const s=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+i;return n.buffer.charCodeAt(s)}offsetOfNode(e){if(!e){return 0}let i=e.size_left;while(e!==this.root){if(e.parent.right===e){i+=e.parent.size_left+e.parent.piece.length}e=e.parent}return i}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL==="\n")}startWithLF(e){if(typeof e==="string"){return e.charCodeAt(0)===10}if(e===ve||e.piece.lineFeedCnt===0){return false}const i=e.piece;const n=this._buffers[i.bufferIndex].lineStarts;const s=i.start.line;const r=n[s]+i.start.column;if(s===n.length-1){return false}const o=n[s+1];if(o>r+1){return false}return this._buffers[i.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){if(typeof e==="string"){return e.charCodeAt(e.length-1)===13}if(e===ve||e.piece.lineFeedCnt===0){return false}return this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const i=e.prev();if(this.endWithCR(i)){this.fixCRLF(i,e)}}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=e.next();if(this.startWithLF(i)){this.fixCRLF(e,i)}}}fixCRLF(e,i){const n=[];const s=this._buffers[e.piece.bufferIndex].lineStarts;let r;if(e.piece.end.column===0){r={line:e.piece.end.line-1,column:s[e.piece.end.line]-s[e.piece.end.line-1]-1}}else{r={line:e.piece.end.line,column:e.piece.end.column-1}}const o=e.piece.length-1;const a=e.piece.lineFeedCnt-1;e.piece=new ln(e.piece.bufferIndex,e.piece.start,r,a,o);wr(this,e,-1,-1);if(e.piece.length===0){n.push(e)}const l={line:i.piece.start.line+1,column:0};const c=i.piece.length-1;const u=this.getLineFeedCnt(i.piece.bufferIndex,l,i.piece.end);i.piece=new ln(i.piece.bufferIndex,l,i.piece.end,u,c);wr(this,i,-1,-1);if(i.piece.length===0){n.push(i)}const d=this.createNewPieces("\r\n");this.rbInsertRight(e,d[0]);for(let f=0;f<n.length;f++){jf(this,n[f])}}adjustCarriageReturnFromNext(e,i){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const n=i.next();if(this.startWithLF(n)){e+="\n";if(n.piece.length===1){jf(this,n)}else{const s=n.piece;const r={line:s.start.line+1,column:0};const o=s.length-1;const a=this.getLineFeedCnt(s.bufferIndex,r,s.end);n.piece=new ln(s.bufferIndex,r,s.end,a,o);wr(this,n,-1,-1)}return true}}return false}iterate(e,i){if(e===ve){return i(ve)}const n=this.iterate(e.left,i);if(!n){return n}return i(e)&&this.iterate(e.right,i)}getNodeContent(e){if(e===ve){return""}const i=this._buffers[e.piece.bufferIndex];const n=e.piece;const s=this.offsetInBuffer(n.bufferIndex,n.start);const r=this.offsetInBuffer(n.bufferIndex,n.end);const o=i.buffer.substring(s,r);return o}getPieceContent(e){const i=this._buffers[e.bufferIndex];const n=this.offsetInBuffer(e.bufferIndex,e.start);const s=this.offsetInBuffer(e.bufferIndex,e.end);const r=i.buffer.substring(n,s);return r}rbInsertRight(e,i){const n=new sS(i,$e.Red);n.left=ve;n.right=ve;n.parent=ve;n.size_left=0;n.lf_left=0;const s=this.root;if(s===ve){this.root=n;n.color=$e.Black}else if(e.right===ve){e.right=n;n.parent=e}else{const r=zx(e.right);r.left=n;n.parent=r}gT(this,n);return n}rbInsertLeft(e,i){const n=new sS(i,$e.Red);n.left=ve;n.right=ve;n.parent=ve;n.size_left=0;n.lf_left=0;if(this.root===ve){this.root=n;n.color=$e.Black}else if(e.left===ve){e.left=n;n.parent=e}else{const s=M5(e.left);s.right=n;n.parent=s}gT(this,n);return n}getContentOfSubTree(e){let i="";this.iterate(e,n=>{i+=this.getNodeContent(n);return true});return i}}var Ur;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Invalid"]=3]="Invalid";t[t["LF"]=1]="LF";t[t["CRLF"]=2]="CRLF"})(Ur||(Ur={}));function g1(t){let e=0;let i=0;let n=0;let s=Ur.Unknown;for(let r=0,o=t.length;r<o;r++){const a=t.charCodeAt(r);if(a===M.CarriageReturn){if(e===0){i=r}e++;if(r+1<o&&t.charCodeAt(r+1)===M.LineFeed){s|=Ur.CRLF;r++}else{s|=Ur.Invalid}n=r+1}else if(a===M.LineFeed){s|=Ur.LF;if(e===0){i=r}e++;n=r+1}}if(e===0){i=t.length}return[e,i,t.length-n,s]}let m1;function mB(){if(!m1){m1=new TextDecoder("UTF-16LE")}return m1}function _B(t,e,i){const n=new Uint16Array(t.buffer,e,i);if(i>0&&(n[0]===65279||n[0]===65534)){return vB(t,e,i)}return mB().decode(n)}function vB(t,e,i){const n=[];let s=0;for(let r=0;r<i;r++){const o=pR(t,e);e+=2;n[s++]=String.fromCharCode(o)}return n.join("")}function Gf(t){return t.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class ds{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,i,n,s){this.oldPosition=e;this.oldText=i;this.newPosition=n;this.newText=s}toString(){if(this.oldText.length===0){return`(insert@${this.oldPosition} "${Gf(this.newText)}")`}if(this.newText.length===0){return`(delete@${this.oldPosition} "${Gf(this.oldText)}")`}return`(replace@${this.oldPosition} "${Gf(this.oldText)}" with "${Gf(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,i,n){const s=i.length;Yf(e,s,n);n+=4;for(let r=0;r<s;r++){gR(e,i.charCodeAt(r),n);n+=2}return n}static _readString(e,i){const n=Jf(e,i);i+=4;return _B(e,i,n)}writeSize(){return 4+4+ds._writeStringSize(this.oldText)+ds._writeStringSize(this.newText)}write(e,i){Yf(e,this.oldPosition,i);i+=4;Yf(e,this.newPosition,i);i+=4;i=ds._writeString(e,this.oldText,i);i=ds._writeString(e,this.newText,i);return i}static read(e,i,n){const s=Jf(e,i);i+=4;const r=Jf(e,i);i+=4;const o=ds._readString(e,i);i+=ds._writeStringSize(o);const a=ds._readString(e,i);i+=ds._writeStringSize(a);n.push(new ds(s,o,r,a));return i}}class nc extends me{get onDidChangeContent(){return this._onDidChangeContent.event}constructor(e,i,n,s,r,o,a){super();this._onDidChangeContent=this._register(new L);this._BOM=i;this._mightContainNonBasicASCII=!o;this._mightContainRTL=s;this._mightContainUnusualLineTerminators=r;this._pieceTree=new gB(e,n,a)}equals(e){if(!(e instanceof nc)){return false}if(this._BOM!==e._BOM){return false}if(this.getEOL()!==e.getEOL()){return false}return this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=false}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,i){return this._pieceTree.getOffsetAt(e,i)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,i){const n=e+i;const s=this.getPositionAt(e);const r=this.getPositionAt(n);return new _t(s.lineNumber,s.column,r.lineNumber,r.column)}getValueInRange(e,i=Sr.TextDefined){if(e.isEmpty()){return""}const n=this._getEndOfLine(i);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,i=Sr.TextDefined){if(e.isEmpty()){return 0}if(e.startLineNumber===e.endLineNumber){return e.endColumn-e.startColumn}const n=this.getOffsetAt(e.startLineNumber,e.startColumn);const s=this.getOffsetAt(e.endLineNumber,e.endColumn);let r=0;const o=this._getEndOfLine(i);const a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length;const c=e.endLineNumber-e.startLineNumber;r=l*c}return s-n+r}getCharacterCountInRange(e,i=Sr.TextDefined){if(this._mightContainNonBasicASCII){let n=0;const s=e.startLineNumber;const r=e.endLineNumber;for(let o=s;o<=r;o++){const a=this.getLineContent(o);const l=o===s?e.startColumn-1:0;const c=o===r?e.endColumn-1:a.length;for(let u=l;u<c;u++){if(kS(a.charCodeAt(u))){n=n+1;u=u+1}else{n=n+1}}}n+=this._getEndOfLine(i).length*(r-s);return n}return this.getValueLengthInRange(e,i)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,i){return this._pieceTree.getLineCharCode(e,i)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const i=Lv(this.getLineContent(e));if(i===-1){return 0}return i+1}getLineLastNonWhitespaceColumn(e){const i=EL(this.getLineContent(e));if(i===-1){return 0}return i+2}_getEndOfLine(e){switch(e){case Sr.LF:return"\n";case Sr.CRLF:return"\r\n";case Sr.TextDefined:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,i,n){let s=this._mightContainRTL;let r=this._mightContainUnusualLineTerminators;let o=this._mightContainNonBasicASCII;let a=true;let l=[];for(let v=0;v<e.length;v++){const y=e[v];if(a&&y._isTracked){a=false}const k=y.range;if(y.text){let se=true;if(!o){se=!RL(y.text);o=se}if(!s&&se){s=p4(y.text)}if(!r&&se){r=g4(y.text)}}let S="";let R=0;let K=0;let q=0;if(y.text){let se;[R,K,q,se]=g1(y.text);const j=this.getEOL();const Q=j==="\r\n"?Ur.CRLF:Ur.LF;if(se===Ur.Unknown||se===Q){S=y.text}else{S=y.text.replace(/\r\n|\r|\n/g,j)}}l[v]={sortIndex:v,identifier:y.identifier||null,range:k,rangeOffset:this.getOffsetAt(k.startLineNumber,k.startColumn),rangeLength:this.getValueLengthInRange(k),text:S,eolCount:R,firstLineLength:K,lastLineLength:q,forceMoveMarkers:Boolean(y.forceMoveMarkers),isAutoWhitespaceEdit:y.isAutoWhitespaceEdit||false}}l.sort(nc._sortOpsAscending);let c=false;for(let v=0,y=l.length-1;v<y;v++){const k=l[v].range.getEndPosition();const S=l[v+1].range.getStartPosition();if(S.isBeforeOrEqual(k)){if(S.isBefore(k)){throw new Error("Overlapping ranges are not allowed!")}c=true}}if(a){l=this._reduceOperations(l)}const u=n||i?nc._getInverseEditRanges(l):[];const d=[];if(i){for(let v=0;v<l.length;v++){const y=l[v];const k=u[v];if(y.isAutoWhitespaceEdit&&y.range.isEmpty()){for(let S=k.startLineNumber;S<=k.endLineNumber;S++){let R="";if(S===k.startLineNumber){R=this.getLineContent(y.range.startLineNumber);if(Lv(R)!==-1){continue}}d.push({lineNumber:S,oldContent:R})}}}}let f=null;if(n){let v=0;f=[];for(let y=0;y<l.length;y++){const k=l[y];const S=u[y];const R=this.getValueInRange(k.range);const K=k.rangeOffset+v;v+=k.text.length-R.length;f[y]={sortIndex:k.sortIndex,identifier:k.identifier,range:S,text:R,textChange:new ds(k.rangeOffset,R,K,k.text)}}if(!c){f.sort((y,k)=>y.sortIndex-k.sortIndex)}}this._mightContainRTL=s;this._mightContainUnusualLineTerminators=r;this._mightContainNonBasicASCII=o;const p=this._doApplyEdits(l);let m=null;if(i&&d.length>0){d.sort((v,y)=>y.lineNumber-v.lineNumber);m=[];for(let v=0,y=d.length;v<y;v++){const k=d[v].lineNumber;if(v>0&&d[v-1].lineNumber===k){continue}const S=d[v].oldContent;const R=this.getLineContent(k);if(R.length===0||R===S||Lv(R)!==-1){continue}m.push(k)}}this._onDidChangeContent.fire();return new a9(f,p,m)}_reduceOperations(e){if(e.length<1e3){return e}return[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let i=false;const n=e[0].range;const s=e[e.length-1].range;const r=new _t(n.startLineNumber,n.startColumn,s.endLineNumber,s.endColumn);let o=n.startLineNumber;let a=n.startColumn;const l=[];for(let p=0,m=e.length;p<m;p++){const v=e[p];const y=v.range;i=i||v.forceMoveMarkers;l.push(this.getValueInRange(new _t(o,a,y.startLineNumber,y.startColumn)));if(v.text.length>0){l.push(v.text)}o=y.endLineNumber;a=y.endColumn}const c=l.join("");const[u,d,f]=g1(c);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,Sr.TextDefined),text:c,eolCount:u,firstLineLength:d,lastLineLength:f,forceMoveMarkers:i,isAutoWhitespaceEdit:false}}_doApplyEdits(e){e.sort(nc._sortOpsDescending);const i=[];for(let n=0;n<e.length;n++){const s=e[n];const r=s.range.startLineNumber;const o=s.range.startColumn;const a=s.range.endLineNumber;const l=s.range.endColumn;if(r===a&&o===l&&s.text.length===0){continue}if(s.text){this._pieceTree.delete(s.rangeOffset,s.rangeLength);this._pieceTree.insert(s.rangeOffset,s.text,true)}else{this._pieceTree.delete(s.rangeOffset,s.rangeLength)}const c=new _t(r,o,a,l);i.push({range:c,rangeLength:s.rangeLength,text:s.text,rangeOffset:s.rangeOffset,forceMoveMarkers:s.forceMoveMarkers})}return i}findMatchesLineByLine(e,i,n,s){return this._pieceTree.findMatchesLineByLine(e,i,n,s)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,i){const n=e.startLineNumber;const s=e.startColumn;const[r,o,a]=g1(i);let l;if(i.length>0){const c=r+1;if(c===1){l=new _t(n,s,n,s+o)}else{l=new _t(n,s,n+c-1,a+1)}}else{l=new _t(n,s,n,s)}return l}static _getInverseEditRanges(e){const i=[];let n=0;let s=0;let r=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c;let u;if(r){if(r.range.endLineNumber===l.range.startLineNumber){c=n;u=s+(l.range.startColumn-r.range.endColumn)}else{c=n+(l.range.startLineNumber-r.range.endLineNumber);u=l.range.startColumn}}else{c=l.range.startLineNumber;u=l.range.startColumn}let d;if(l.text.length>0){const f=l.eolCount+1;if(f===1){d=new _t(c,u,c,u+l.firstLineLength)}else{d=new _t(c,u,c+f-1,l.lastLineLength+1)}}else{d=new _t(c,u,c,u)}n=d.endLineNumber;s=d.endColumn;i.push(d);r=l}return i}static _sortOpsAscending(e,i){const n=_t.compareRangesUsingEnds(e.range,i.range);if(n===0){return e.sortIndex-i.sortIndex}return n}static _sortOpsDescending(e,i){const n=_t.compareRangesUsingEnds(e.range,i.range);if(n===0){return i.sortIndex-e.sortIndex}return-n}}class wB{constructor(e,i,n,s,r,o,a,l,c){this._chunks=e;this._bom=i;this._cr=n;this._lf=s;this._crlf=r;this._containsRTL=o;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=c}_getEOL(e){const i=this._cr+this._lf+this._crlf;const n=this._cr+this._crlf;if(i===0){return e===Jd.LF?"\n":"\r\n"}if(n>i/2){return"\r\n"}return"\n"}create(e){const i=this._getEOL(e);const n=this._chunks;if(this._normalizeEOL&&(i==="\r\n"&&(this._cr>0||this._lf>0)||i==="\n"&&(this._cr>0||this._crlf>0))){for(let r=0,o=n.length;r<o;r++){const a=n[r].buffer.replace(/\r\n|\r|\n/g,i);const l=Cr(a);n[r]=new Sa(a,l)}}const s=new nc(n,this._bom,i,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:s,disposable:s}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class mT{constructor(){this.chunks=[];this.BOM="";this._hasPreviousChar=false;this._previousChar=0;this._tmpLineStarts=[];this.cr=0;this.lf=0;this.crlf=0;this.containsRTL=false;this.containsUnusualLineTerminators=false;this.isBasicASCII=true}acceptChunk(e){if(e.length===0){return}if(this.chunks.length===0){if(ML(e)){this.BOM=NL;e=e.substr(1)}}const i=e.charCodeAt(e.length-1);if(i===M.CarriageReturn||i>=55296&&i<=56319){this._acceptChunk1(e.substr(0,e.length-1),false);this._hasPreviousChar=true;this._previousChar=i}else{this._acceptChunk1(e,false);this._hasPreviousChar=false;this._previousChar=i}}_acceptChunk1(e,i){if(!i&&e.length===0){return}if(this._hasPreviousChar){this._acceptChunk2(String.fromCharCode(this._previousChar)+e)}else{this._acceptChunk2(e)}}_acceptChunk2(e){const i=hB(this._tmpLineStarts,e);this.chunks.push(new Sa(e,i.lineStarts));this.cr+=i.cr;this.lf+=i.lf;this.crlf+=i.crlf;if(!i.isBasicASCII){this.isBasicASCII=false;if(!this.containsRTL){this.containsRTL=p4(e)}if(!this.containsUnusualLineTerminators){this.containsUnusualLineTerminators=g4(e)}}}finish(e=true){this._finish();return new wB(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0){this._acceptChunk1("",true)}if(this._hasPreviousChar){this._hasPreviousChar=false;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const i=Cr(e.buffer);e.lineStarts=i;if(this._previousChar===M.CarriageReturn){this.cr++}}}}class bB extends me{constructor(e,i,n){super();this._source=e;this._inputTextBuffer=i;this._outputs=n;this._outputTextBuffers=void 0}_getFullModelRange(e){const i=e.getLineCount();return new _t(1,1,i,this._getLineMaxColumn(e,i))}_getLineMaxColumn(e,i){if(i<1||i>e.getLineCount()){throw new Error("Illegal value for lineNumber")}return e.getLineLength(i)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new mT;e.acceptChunk(this._source);const i=e.finish(true);const{textBuffer:n,disposable:s}=i.create(Jd.LF);this._inputTextBuffer=n;this._register(s)}return this._inputTextBuffer}get outputTextBuffers(){if(!this._outputTextBuffers){this._outputTextBuffers=this._outputs.map(e=>{const i=new mT;i.acceptChunk(e);const n=i.finish(true);const{textBuffer:s,disposable:r}=n.create(Jd.LF);this._register(r);return s})}return this._outputTextBuffers}findInInputs(e){const i=new HD(e,false,false,null);const n=i.parseSearchRequest();if(!n){return[]}const s=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(s,n,true,5e3)}findInOutputs(e){const i=new HD(e,false,false,null);const n=i.parseSearchRequest();if(!n){return[]}return this.outputTextBuffers.map(s=>{const r=s.findMatchesLineByLine(this._getFullModelRange(s),n,true,5e3);if(r.length===0){return void 0}return{textBuffer:s,matches:r}}).filter(s=>!!s)}}function _T(t,e){let i=-1;const n=[];let s=[];t.forEach(o=>{if(o.range.startLineNumber!==i){if(s.length>0){n.push([...s]);s=[]}}s.push(o);i=o.range.endLineNumber});if(s.length>0){n.push([...s])}const r=n.map(o=>{const a=[];const l=o[0].range.startLineNumber;const c=o[o.length-1].range.endLineNumber;for(let u=l;u<=c;u++){a.push(e.getLineContent(u))}return new zM(a.join("\n")+"\n",o.map(u=>new _t(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))});return r}const yB=te("remoteAgentService");const SB=te("IUserDataProfilesService");const xB=Object.freeze({"id":"workbench","order":7,"title":h(3974,"Workbench"),"type":"object"});const EB=Object.freeze({"id":"security","scope":At.APPLICATION,"title":h(3975,"Security"),"type":"object","order":7});Object.freeze({"id":"problems","title":h(3976,"Problems"),"type":"object","order":101});const CB=Object.freeze({"id":"window","order":8,"title":h(3977,"Window"),"type":"object"});const kB={ConfigurationMigration:"base.contributions.configuration.migration"};class DB{constructor(){this.migrations=[];this._onDidRegisterConfigurationMigrations=new L;this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}}const Tp=new DB;ei.add(kB.ConfigurationMigration,Tp);let vT=class kq extends me{static{this.ID="workbench.contrib.configurationMigration"}constructor(e,i){super();this.configurationService=e;this.workspaceService=i;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async n=>{for(const s of n.added){await this.migrateConfigurationsForFolder(s,Tp.migrations)}}));this.migrateConfigurations(Tp.migrations);this._register(Tp.onDidRegisterConfigurationMigration(n=>this.migrateConfigurations(n)))}async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(const i of this.workspaceService.getWorkspace().folders){await this.migrateConfigurationsForFolder(i,e)}}async migrateConfigurationsForFolder(e,i){await Promise.all([i.map(n=>this.migrateConfigurationsForFolderAndOverride(n,e?.uri))])}async migrateConfigurationsForFolderAndOverride(e,i){const n=this.configurationService.inspect(e.key,{resource:i});const s=this.workspaceService.getWorkbenchState()===qp.WORKSPACE?[["user",ri.USER],["userLocal",ri.USER_LOCAL],["userRemote",ri.USER_REMOTE],["workspace",ri.WORKSPACE],["workspaceFolder",ri.WORKSPACE_FOLDER]]:[["user",ri.USER],["userLocal",ri.USER_LOCAL],["userRemote",ri.USER_REMOTE],["workspace",ri.WORKSPACE]];for(const[r,o]of s){const a=n[r];if(!a){continue}const l=[];if(a.value!==void 0){const c=await this.runMigration(e,r,a.value,i,void 0);for(const u of c??[]){l.push([u,[]])}}for(const{identifiers:c,value:u}of a.overrides??[]){if(u!==void 0){const d=await this.runMigration(e,r,u,i,c);for(const f of d??[]){l.push([f,c])}}}if(l.length){await Promise.allSettled(l.map(async([[c,u],d])=>this.configurationService.updateValue(c,u.value,{resource:i,overrideIdentifiers:d},o)))}}}async runMigration(e,i,n,s,r){const o=l=>{const c=this.configurationService.inspect(l,{resource:s});const u=c[i];if(!u){return void 0}if(!r){return u.value}return u.overrides?.find(({identifiers:d})=>Gi(d,r))?.value};const a=await e.migrateFn(n,o);return Array.isArray(a)?a:[[e.key,a]]}};vT=W([P(0,Xo),P(1,Dx)],vT);let wT=class Dq extends me{static{this.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration"}constructor(e){super();this.remoteAgentService=e;this._ready=new Bn;this.ready=this._ready.p;this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!nn){const i=await this.remoteAgentService.getEnvironment();if(i?.os!==Hn.Windows){return}}const e=ei.as(Yo.Configuration);e.registerConfiguration({...EB,"properties":{"security.allowedUNCHosts":{"type":"array","items":{"type":"string","pattern":"^[^\\\\]+$","patternErrorMessage":h(3978,"UNC host names must not contain backslashes.")},"default":[],"markdownDescription":h(3979,"A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),"scope":At.APPLICATION_MACHINE},"security.restrictUNCAccess":{"type":"boolean","default":true,"markdownDescription":h(3980,"If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),"scope":At.APPLICATION_MACHINE}}})}};wT=W([P(0,yB)],wT);const Ju="window.newWindowProfile";let bT=class Iq extends me{static{this.ID="workbench.contrib.dynamicWindowConfiguration"}constructor(e,i){super();this.userDataProfilesService=e;this.configurationService=i;this.registerNewWindowProfileConfiguration();this._register(this.userDataProfilesService.onDidChangeProfiles(n=>this.registerNewWindowProfileConfiguration()));this.setNewWindowProfile();this.checkAndResetNewWindowProfileConfig();this._register(i.onDidChangeConfiguration(n=>{if(n.source!==ri.DEFAULT&&n.affectsConfiguration(Ju)){this.setNewWindowProfile()}}));this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}registerNewWindowProfileConfiguration(){const e=ei.as(Yo.Configuration);const i={...CB,"properties":{[Ju]:{"type":["string","null"],"default":null,"enum":[...this.userDataProfilesService.profiles.map(n=>n.name),null],"enumItemLabels":[...this.userDataProfilesService.profiles.map(()=>""),h(3981,"Active Window")],"description":h(3982,"Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),"scope":At.APPLICATION}}};if(this.configurationNode){e.updateConfigurations({add:[i],remove:[this.configurationNode]})}else{e.registerConfiguration(i)}this.configurationNode=i}setNewWindowProfile(){const e=this.configurationService.getValue(Ju);this.newWindowProfile=e?this.userDataProfilesService.profiles.find(i=>i.name===e):void 0}checkAndResetNewWindowProfileConfig(){const e=this.configurationService.getValue(Ju);if(!e){return}const i=this.newWindowProfile?this.userDataProfilesService.profiles.find(n=>n.id===this.newWindowProfile.id):void 0;if(e===i?.name){return}this.configurationService.updateValue(Ju,i?.name)}};bT=W([P(0,SB),P(1,Xo)],bT);const IB=ei.as(Yo.Configuration);const TB={...xB,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h(14470,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};IB.registerConfiguration(TB);var rS;(function(t){t["builtin"]="builtin";t["option"]="option";t["exclusive"]="exclusive";t["default"]="default"})(rS||(rS={}));var yT;(function(t){t[t["ABORT"]=1]="ABORT";t[t["NONE"]=2]="NONE"})(yT||(yT={}));function PB(t,e){const i=new Set([ne.extension,ne.webviewPanel,ne.vscodeWorkspaceTrust,ne.vscodeSettings]);if(i.has(e.scheme)){return false}const n=typeof t==="string"&&t.indexOf(mt.sep)>=0;const s=n?`${e.scheme}:${e.path}`:ts(e);return dc(t,s,{ignoreCase:true})}class sc{static{this._notebookStatusBarItemProviderHandlePool=0}get activeNotebookEditor(){return this._activeNotebookEditor?.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(e,i,n,s,r,o,a){this._textDocumentsAndEditors=n;this._textDocuments=s;this._extHostFileSystem=r;this._extHostSearch=o;this._logService=a;this._notebookStatusBarItemProviders=new Map;this._documents=new It;this._editors=new Map;this._onDidChangeActiveNotebookEditor=new L;this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event;this._visibleNotebookEditors=[];this._onDidOpenNotebookDocument=new L;this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event;this._onDidCloseNotebookDocument=new L;this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event;this._onDidChangeVisibleNotebookEditors=new L;this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event;this._statusBarCache=new Wn("NotebookCellStatusBarCache");this._handlePool=0;this._notebookSerializer=new Map;this._notebookProxy=e.getProxy(ee.MainThreadNotebook);this._notebookDocumentsProxy=e.getProxy(ee.MainThreadNotebookDocuments);this._notebookEditorsProxy=e.getProxy(ee.MainThreadNotebookEditors);this._commandsConverter=i.converter;i.registerArgumentProcessor({processArgument:l=>{if(l&&l.$mid===nt.NotebookCellActionContext){const c=l.notebookEditor?.notebookUri;const u=l.cell.handle;const d=this._documents.get(c);const f=d?.getCell(u);if(f){return f.apiCell}}if(l&&l.$mid===nt.NotebookActionContext){const c=l.uri;const u=this._documents.get(c);if(u){return u.apiNotebook}}return l}});sc._registerApiCommands(i)}getEditorById(e){const i=this._editors.get(e);if(!i){throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `)}return i}getIdByEditor(e){for(const[i,n]of this._editors){if(n.apiEditor===e){return i}}return void 0}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,i){const n=this._documents.get(e);if(!n&&!i){throw new Error(`NO notebook document for '${e}'`)}return n}static _convertNotebookRegistrationData(e,i){if(!i){return}const n=i.filenamePattern.map(s=>Om.from(s)).filter(s=>s!==void 0);if(i.filenamePattern&&!n){console.warn(`Notebook content provider view options file name pattern is invalid ${i.filenamePattern}`);return void 0}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:i.displayName,filenamePattern:n,priority:i.exclusive?rS.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(e,i,n){const s=sc._notebookStatusBarItemProviderHandlePool++;const r=typeof n.onDidChangeCellStatusBarItems==="function"?sc._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(s,n);this._notebookProxy.$registerNotebookCellStatusBarItemProvider(s,r,i);let o;if(r!==void 0){o=n.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(r))}return new Ve(()=>{this._notebookStatusBarItemProviders.delete(s);this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(s,r);o?.dispose()})}async createNotebookDocument(e){const i=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&uo.from(e.content)});return b.revive(i)}async openNotebookDocument(e){const i=this._documents.get(e);if(i){return i.apiNotebook}const n=await this._notebookDocumentsProxy.$tryOpenNotebook(e);const s=this._documents.get(b.revive(n));return Lc(s?.apiNotebook)}async showNotebookDocument(e,i){let n;if(typeof i==="object"){n={position:_i.from(i.viewColumn),preserveFocus:i.preserveFocus,selections:i.selections&&i.selections.map(ar.from),pinned:typeof i.preview==="boolean"?!i.preview:void 0,label:typeof i.asRepl==="string"?i.asRepl:typeof i.asRepl==="object"?i.asRepl.label:void 0}}else{n={preserveFocus:false,pinned:true}}const s=!!i?.asRepl?"repl":e.notebookType;const r=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,s,n);const o=r&&this._editors.get(r)?.apiEditor;if(o){return o}if(r){throw new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`)}else{throw new Error(`Could NOT open editor for "${e.uri.toString()}".`)}}async $provideNotebookCellStatusBarItems(e,i,n,s){const r=this._notebookStatusBarItemProviders.get(e);const o=b.revive(i);const a=this._documents.get(o);if(!a||!r){return}const l=a.getCellFromIndex(n);if(!l){return}const c=await r.provideCellStatusBarItems(l.apiCell,s);if(!c){return void 0}const u=new pe;const d=this._statusBarCache.add([u]);const f=Array.isArray(c)?c:[c];const p=f.map(m=>ey.from(m,this._commandsConverter,u));return{cacheId:d,items:p}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,i,n,s,r){if(Oc(i)){throw new Error(`viewType cannot be empty or just whitespace`)}const o=this._handlePool++;this._notebookSerializer.set(o,{viewType:i,serializer:n,options:s});this._notebookProxy.$registerNotebookSerializer(o,{id:e.identifier,location:e.extensionLocation},i,iy.from(s),sc._convertNotebookRegistrationData(e,r));return ye(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(e,i,n){const s=this._notebookSerializer.get(e);if(!s){throw new Error("NO serializer found")}const r=await s.serializer.deserializeNotebook(i.buffer,n);return new ji(uo.from(r))}async $notebookToData(e,i,n){const s=this._notebookSerializer.get(e);if(!s){throw new Error("NO serializer found")}const r=await s.serializer.serializeNotebook(uo.to(i.value),n);return ae.wrap(r)}async $saveNotebook(e,i,n,s,r){const o=b.revive(i);const a=this._notebookSerializer.get(e);this.trace(`enter saveNotebook(versionId: ${n}, ${o.toString()})`);try{if(!a){throw new _1("NO serializer found")}const l=this._documents.get(o);if(!l){throw new _1("Document NOT found")}if(l.versionId!==n){throw new _1("Document version mismatch, expected: "+n+", actual: "+l.versionId)}if(!this._extHostFileSystem.value.isWritableFileSystem(o.scheme)){throw new np(h(2701,"Unable to modify read-only file '{0}'",this._resourceForError(o)),Mn.FILE_PERMISSION_DENIED)}const c={metadata:zE(l.apiNotebook.metadata,m=>!(a.options?.transientDocumentMetadata??{})[m]),cells:[]};for(const m of l.apiNotebook.getCells()){const v=new W_(m.kind,m.document.getText(),m.document.languageId,m.mime,!a.options?.transientOutputs?[...m.outputs]:[],m.metadata,m.executionSummary);v.metadata=zE(m.metadata,y=>!(a.options?.transientCellMetadata??{})[y]);c.cells.push(v)}await this._validateWriteFile(o,s);if(r.isCancellationRequested){throw new Vi}const u=await a.serializer.serializeNotebook(c,r);if(r.isCancellationRequested){throw new Vi}this.trace(`serialized versionId: ${n} ${o.toString()}`);await this._extHostFileSystem.value.writeFile(o,u);this.trace(`Finished write versionId: ${n} ${o.toString()}`);const d=this._extHostFileSystem.getFileSystemProviderExtUri(o.scheme);const f=await this._extHostFileSystem.value.stat(o);const p={name:d.basename(o),isFile:(f.type&Wa.File)!==0,isDirectory:(f.type&Wa.Directory)!==0,isSymbolicLink:(f.type&Wa.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:Boolean((f.permissions??0)&Va.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(o.scheme),locked:Boolean((f.permissions??0)&Va.Locked),executable:Boolean((f.permissions??0)&Va.Executable),etag:jE({mtime:f.mtime,size:f.size})};this.trace(`exit saveNotebook(versionId: ${n}, ${o.toString()})`);return p}catch(l){if(l instanceof np){return{...l,message:l.message}}throw l}}async $searchInNotebooks(e,i,n,s,r){const o=this._notebookSerializer.get(e)?.serializer;if(!o){return{limitHit:false,results:[]}}const a=new ad;const l=async(f,p,m)=>{await Promise.all(f.map(async v=>await Promise.all(v.filenamePatterns.map(y=>{const k={_reason:m._reason,folderQueries:m.folderQueries,includePattern:m.includePattern,excludePattern:m.excludePattern,maxResults:m.maxResults,type:il.File,filePattern:y};return this._extHostSearch.doInternalFileSearchWithCustomCallback(k,p,S=>{S.forEach(R=>{if(a.has(R)){return}const K=s.some(q=>{if(v.isFromSettings&&!q.isFromSettings){return false}else{return q.filenamePatterns.some(se=>PB(se,R))}});if(K){return}a.add(R)})}).catch(S=>{if(S.code==="ENOENT"){console.warn(`Could not find notebook search results, ignoring notebook results.`);return{limitHit:false,messages:[]}}else{throw S}})}))));return};await l(n,r,i);const c=new It;let u=false;const d=Array.from(a).map(async f=>{const p=[];try{if(r.isCancellationRequested){return}if(i.maxResults&&[...c.values()].reduce((k,S)=>k+S.cellResults.length,0)>i.maxResults){u=true;return}const m=[];const v=this._documents.get(f);if(v){const k=v.apiNotebook.getCells();k.forEach(S=>m.push({input:S.document.getText(),outputs:S.outputs.flatMap(R=>R.items.map(K=>K.data.toString()))}))}else{const k=await this._extHostFileSystem.value.readFile(f);const S=ae.fromString(k.toString());const R=await o.deserializeNotebook(S.buffer,r);if(r.isCancellationRequested){return}const K=uo.from(R);K.cells.forEach(q=>m.push({input:q.source,outputs:q.outputs.flatMap(se=>se.items.map(j=>j.valueBytes.toString()))}))}if(r.isCancellationRequested){return}m.forEach((k,S)=>{const R=i.contentPattern.pattern;const K=new bB(k.input,void 0,k.outputs);const q=K.findInInputs(R);const se=K.findInOutputs(R);const j=se.flatMap(Q=>_T(Q.matches,Q.textBuffer)).map((Q,le)=>{Q.webviewIndex=le;return Q});if(q.length>0||se.length>0){const Q={index:S,contentResults:_T(q,K.inputTextBuffer),webviewResults:j};p.push(Q)}});const y={resource:f,cellResults:p};c.set(f,y);return}catch(m){return}});await Promise.all(d);return{limitHit:u,results:[...c.values()]}}async _validateWriteFile(e,i){const n=await this._extHostFileSystem.value.stat(e);if(typeof i?.mtime==="number"&&typeof i.etag==="string"&&i.etag!==L8&&typeof n.mtime==="number"&&typeof n.size==="number"&&i.mtime<n.mtime&&i.etag!==jE({mtime:i.mtime,size:n.size})){throw new np(h(2702,"File Modified Since"),Mn.FILE_MODIFIED_SINCE,i)}return}_resourceForError(e){return e.scheme===ne.file?e.fsPath:e.toString()}_createExtHostEditor(e,i,n){if(this._editors.has(i)){throw new Error(`editor with id ALREADY EXSIST: ${i}`)}const s=new nf(i,this._notebookEditorsProxy,e,n.visibleRanges.map(ar.to),n.selections.map(ar.to),typeof n.viewColumn==="number"?_i.to(n.viewColumn):void 0,n.viewType);this._editors.set(i,s)}$acceptDocumentAndEditorsDelta(e){if(e.value.removedDocuments){for(const i of e.value.removedDocuments){const n=b.revive(i);const s=this._documents.get(n);if(s){s.dispose();this._documents.delete(n);this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:s.apiNotebook.getCells().map(r=>r.document.uri)});this._onDidCloseNotebookDocument.fire(s.apiNotebook)}for(const r of this._editors.values()){if(r.notebookData.uri.toString()===n.toString()){this._editors.delete(r.id)}}}}if(e.value.addedDocuments){const i=[];for(const n of e.value.addedDocuments){const s=b.revive(n.uri);if(this._documents.has(s)){throw new Error(`adding EXISTING notebook ${s} `)}const r=new Vx(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,s,n);i.push(...n.cells.map(o=>nS.asModelAddData(o)));this._documents.get(s)?.dispose();this._documents.set(s,r);this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:i});this._onDidOpenNotebookDocument.fire(r.apiNotebook)}}if(e.value.addedEditors){for(const i of e.value.addedEditors){if(this._editors.has(i.id)){return}const n=b.revive(i.documentUri);const s=this._documents.get(n);if(s){this._createExtHostEditor(s,i.id,i)}}}if(e.value.removedEditors){for(const i of e.value.removedEditors){const n=this._editors.get(i);if(n){this._editors.delete(i);if(this._activeNotebookEditor?.id===n.id){this._activeNotebookEditor=void 0}}}}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(n=>this._editors.get(n)).filter(n=>!!n);const i=new Set;this._visibleNotebookEditors.forEach(n=>i.add(n.id));for(const n of this._editors.values()){const s=i.has(n.id);n._acceptVisibility(s)}this._visibleNotebookEditors=[...this._editors.values()].map(n=>n).filter(n=>n.visible);this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}if(e.value.newActiveEditor===null){this._activeNotebookEditor=void 0}else if(e.value.newActiveEditor){const i=this._editors.get(e.value.newActiveEditor);if(!i){console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`)}this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)}if(e.value.newActiveEditor!==void 0){this._onDidChangeActiveNotebookEditor.fire(this._activeNotebookEditor?.apiEditor)}}static _registerApiCommands(e){const i=z.String.with("notebookType","A notebook type");const n=new Pe("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[i,new z("data","Bytes to convert to data",r=>r instanceof Uint8Array,r=>ae.wrap(r))],new De("Notebook Data",r=>uo.to(r.value)));const s=new Pe("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[i,new z("NotebookData","Notebook data to convert to bytes",r=>true,r=>new ji(uo.from(r)))],new De("Bytes",r=>r.buffer));e.registerApiCommand(n);e.registerApiCommand(s)}trace(e){this._logService.trace(`[Extension Host Notebook] ${e}`)}}class _1 extends Error{constructor(e){super(e);this.name="NotebookSaveError"}}class AB{constructor(e,i,n,s={timeout:1500,errors:3}){this._logService=e;this._notebooksAndEditors=i;this._mainThreadBulkEdits=n;this._thresholds=s;this._onWillSaveNotebookDocumentEvent=new ld}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(i,n,s)=>{const r=function o(a){i.call(n,a)};r.extension=e;return this._onWillSaveNotebookDocumentEvent.event(r,void 0,s)}}async $participateInSave(e,i,n){const s=b.revive(e);const r=this._notebooksAndEditors.getNotebookDocument(s);if(!r){throw new Error("Unable to resolve notebook document")}const o=[];await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:r.apiNotebook,reason:Rm.to(i)},n,async(l,c)=>{const u=Date.now();const d=await await Promise.resolve(l);if(Date.now()-u>this._thresholds.timeout){this._logService.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier)}if(n.isCancellationRequested){return}if(d){if(d instanceof cl){o.push(d)}else{this._logService.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier,"ignored due to invalid data")}}return});if(n.isCancellationRequested){return false}if(o.length===0){return true}const a={edits:[]};for(const l of o){const{edits:c}=Pn.from(l);a.edits=a.edits.concat(c)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new ji(a))}}class RB{constructor(e){this._notebooksAndEditors=e;this._onDidSaveNotebookDocument=new L;this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event;this._onDidChangeNotebookDocument=new L;this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,i,n,s){const r=this._notebooksAndEditors.getNotebookDocument(b.revive(e));const o=r.acceptModelChanged(i.value,n,s);this._onDidChangeNotebookDocument.fire(o)}$acceptDirtyStateChanged(e,i){const n=this._notebooksAndEditors.getNotebookDocument(b.revive(e));n.acceptDirty(i)}$acceptModelSaved(e){const i=this._notebooksAndEditors.getNotebookDocument(b.revive(e));this._onDidSaveNotebookDocument.fire(i.apiNotebook)}}let oS=class Tq{constructor(e,i){this._logService=e;this._notebooksAndEditors=i;this._onDidChangeNotebookEditorSelection=new L;this._onDidChangeNotebookEditorVisibleRanges=new L;this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event;this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,i){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,i);const n=this._notebooksAndEditors.getEditorById(e);if(i.visibleRanges){n._acceptVisibleRanges(i.visibleRanges.ranges.map(ar.to))}if(i.selections){n._acceptSelections(i.selections.selections.map(ar.to))}if(i.visibleRanges){this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:n.apiEditor,visibleRanges:n.apiEditor.visibleRanges})}if(i.selections){this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:n.apiEditor,selections:n.apiEditor.selections}))}}$acceptEditorViewColumns(e){for(const i in e){const n=this._notebooksAndEditors.getEditorById(i);n._acceptViewColumn(_i.to(e[i]))}}};oS=W([P(0,et)],oS);var rc;(function(t){t[t["Output"]=1]="Output";t[t["OutputItems"]=2]="OutputItems";t[t["ExecutionState"]=3]="ExecutionState"})(rc||(rc={}));const LB=100;var ST;(function(t){t[t["Disconnected"]=1]="Disconnected";t[t["Connected"]=2]="Connected";t[t["Initializing"]=3]="Initializing"})(ST||(ST={}));let aS=class Pq{constructor(e,i,n,s,r){this._initData=i;this._extHostNotebook=n;this._commands=s;this._logService=r;this._activeExecutions=new It;this._activeNotebookExecutions=new It;this._kernelDetectionTask=new Map;this._kernelDetectionTaskHandlePool=0;this._kernelSourceActionProviders=new Map;this._kernelSourceActionProviderHandlePool=0;this._kernelData=new Map;this._handlePool=0;this.id=0;this.variableStore={};this._proxy=e.getProxy(ee.MainThreadNotebookKernels);const o=new Pe("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new z("options","Select kernel options",l=>true,l=>{if(l&&"notebookEditor"in l&&"id"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);return{id:l.id,extension:l.extension,notebookEditorId:c}}else if(l&&"notebookEditor"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);if(c===void 0){throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${l.notebookEditor.notebook.uri.toString()}`)}if("skipIfAlreadySelected"in l){return{notebookEditorId:c,skipIfAlreadySelected:l.skipIfAlreadySelected}}return{notebookEditorId:c}}return l})],De.Void);const a=new Pe("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[z.Uri],new De("A promise that resolves to an array of variables",(l,c)=>{return l.map(u=>{return{variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}})}));this._commands.registerApiCommand(o);this._commands.registerApiCommand(a)}createNotebookController(e,i,n,s,r,o){for(const q of this._kernelData.values()){if(q.controller.id===i&&ht.equals(e.identifier,q.extensionId)){throw new Error(`notebook controller with id '${i}' ALREADY exist`)}}const a=this._handlePool++;const l=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${i}`);const c=()=>console.warn(`NO execute handler from notebook controller '${p.id}' of extension: '${e.identifier}'`);let u=false;const d=new L;const f=new L;const p={id:Kf(e.identifier,i),notebookType:n,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:s||e.identifier.value,preloads:o?o.map(Fm.from):[]};let m=r??c;let v;let y;this._proxy.$addKernel(a,p).catch(q=>{console.log(q);u=true});let k=0;const S=()=>{if(u){return}const q=++k;Promise.resolve().then(()=>{if(q===k){this._proxy.$updateKernel(a,p)}})};const R=new It;const K={get id(){return i},get notebookType(){return p.notebookType},onDidChangeSelectedNotebooks:d.event,get label(){return p.label},set label(q){p.label=q??e.displayName??e.name;S()},get detail(){return p.detail??""},set detail(q){p.detail=q;S()},get description(){return p.description??""},set description(q){p.description=q;S()},get supportedLanguages(){return p.supportedLanguages},set supportedLanguages(q){p.supportedLanguages=q;S()},get supportsExecutionOrder(){return p.supportsExecutionOrder??false},set supportsExecutionOrder(q){p.supportsExecutionOrder=q;S()},get rendererScripts(){return p.preloads?p.preloads.map(Fm.to):[]},get executeHandler(){return m},set executeHandler(q){m=q??c},get interruptHandler(){return v},set interruptHandler(q){v=q;p.supportsInterrupt=Boolean(q);S()},set variableProvider(q){O(e,"notebookVariableProvider");y=q;p.hasVariableProvider=!!q;q?.onDidChangeVariables(se=>l._proxy.$variablesUpdated(se.uri));S()},get variableProvider(){return y},createNotebookCellExecution(q){if(u){throw new Error("notebook controller is DISPOSED")}if(!R.has(q.notebook.uri)){l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(R.keys()).map(se=>se.toString()));throw new Error(`notebook controller is NOT associated to notebook: ${q.notebook.uri.toString()}`)}return l._createNotebookCellExecution(q,Kf(e.identifier,this.id))},createNotebookExecution(q){O(e,"notebookExecution");if(u){throw new Error("notebook controller is DISPOSED")}if(!R.has(q.uri)){l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(R.keys()).map(se=>se.toString()));throw new Error(`notebook controller is NOT associated to notebook: ${q.uri.toString()}`)}return l._createNotebookExecution(q,Kf(e.identifier,this.id))},dispose:()=>{if(!u){this._logService.trace(`NotebookController[${a}], DISPOSED`);u=true;this._kernelData.delete(a);d.dispose();f.dispose();this._proxy.$removeKernel(a)}},updateNotebookAffinity(q,se){if(se===cm.Hidden){O(e,"notebookControllerAffinityHidden")}l._proxy.$updateNotebookPriority(a,q.uri,se)},onDidReceiveMessage:f.event,postMessage(q,se){O(e,"notebookMessaging");return l._proxy.$postMessage(a,se&&l._extHostNotebook.getIdByEditor(se),q)},asWebviewUri(q){O(e,"notebookMessaging");return Od(q,l._initData.remote)}};this._kernelData.set(a,{extensionId:e.identifier,controller:K,onDidReceiveMessage:f,onDidChangeSelection:d,associatedNotebooks:R});return K}getIdByController(e){for(const[i,n]of this._kernelData){if(n.controller===e){return Kf(n.extensionId,e.id)}}return null}createNotebookControllerDetectionTask(e,i){const n=this._kernelDetectionTaskHandlePool++;const s=this;this._logService.trace(`NotebookControllerDetectionTask[${n}], CREATED by ${e.identifier.value}`);this._proxy.$addKernelDetectionTask(n,i);const r={dispose:()=>{this._kernelDetectionTask.delete(n);s._proxy.$removeKernelDetectionTask(n)}};this._kernelDetectionTask.set(n,r);return r}registerKernelSourceActionProvider(e,i,n){const s=this._kernelSourceActionProviderHandlePool++;const r=typeof n.onDidChangeNotebookKernelSourceActions==="function"?s:void 0;const o=this;this._kernelSourceActionProviders.set(s,n);this._logService.trace(`NotebookKernelSourceActionProvider[${s}], CREATED by ${e.identifier.value}`);this._proxy.$addKernelSourceActionProvider(s,s,i);let a;if(r!==void 0){a=n.onDidChangeNotebookKernelSourceActions(l=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(r))}return{dispose:()=>{this._kernelSourceActionProviders.delete(s);o._proxy.$removeKernelSourceActionProvider(s,s);a?.dispose()}}}async $provideKernelSourceActions(e,i){const n=this._kernelSourceActionProviders.get(e);if(n){const s=new pe;const r=await n.provideNotebookKernelSourceActions(i);return(r??[]).map(o=>ty.from(o,this._commands.converter,s))}return[]}$acceptNotebookAssociation(e,i,n){const s=this._kernelData.get(e);if(s){const r=this._extHostNotebook.getNotebookDocument(b.revive(i));if(n){s.associatedNotebooks.set(r.uri,true)}else{s.associatedNotebooks.delete(r.uri)}this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,r.uri.toString(),n);s.onDidChangeSelection.fire({selected:n,notebook:r.apiNotebook})}}async $executeCells(e,i,n){const s=this._kernelData.get(e);if(!s){return}const r=this._extHostNotebook.getNotebookDocument(b.revive(i));const o=[];for(const a of n){const l=r.getCell(a);if(l){o.push(l.apiCell)}}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,r.uri.toString(),o.length);await s.controller.executeHandler.call(s.controller,o,r.apiNotebook,s.controller)}catch(a){this._logService.error(`NotebookController[${e}] execute cells FAILED`,a);console.error(a)}}async $cancelCells(e,i,n){const s=this._kernelData.get(e);if(!s){return}const r=this._extHostNotebook.getNotebookDocument(b.revive(i));if(s.controller.interruptHandler){await s.controller.interruptHandler.call(s.controller,r.apiNotebook)}else{for(const o of n){const a=r.getCell(o);if(a){this._activeExecutions.get(a.uri)?.cancel()}}}if(s.controller.interruptHandler){const o=this._activeNotebookExecutions.get(r.uri);this._activeNotebookExecutions.delete(r.uri);if(n.length&&Array.isArray(o)&&o.length){o.forEach(a=>a.dispose())}}}async $provideVariables(e,i,n,s,r,o,a){const l=this._kernelData.get(e);if(!l){return}const c=this._extHostNotebook.getNotebookDocument(b.revive(n));const u=l.controller.variableProvider;if(!u){return}let d=void 0;if(s!==void 0){d=this.variableStore[s];if(!d){return}}else{this.variableStore={}}const f=r==="named"?kh.Named:kh.Indexed;const p=u.provideVariables(c.apiNotebook,d,f,o,a);let m=0;for await(const v of p){if(a.isCancellationRequested){return}const y={id:this.id++,name:v.variable.name,value:v.variable.value,type:v.variable.type,interfaces:v.variable.interfaces,language:v.variable.language,expression:v.variable.expression,hasNamedChildren:v.hasNamedChildren,indexedChildrenCount:v.indexedChildrenCount,extensionId:l.extensionId.value};this.variableStore[y.id]=v.variable;this._proxy.$receiveVariable(i,y);if(m++>=LB){return}}}$acceptKernelMessageFromRenderer(e,i,n){const s=this._kernelData.get(e);if(!s){return}const r=this._extHostNotebook.getEditorById(i);s.onDidReceiveMessage.fire(Object.freeze({editor:r.apiEditor,message:n}))}_createNotebookCellExecution(e,i){if(e.index<0){throw new Error("CANNOT execute cell that has been REMOVED from notebook")}const n=this._extHostNotebook.getNotebookDocument(e.notebook.uri);const s=n.getCellFromApiCell(e);if(!s){throw new Error("invalid cell")}if(this._activeExecutions.has(s.uri)){throw new Error(`duplicate execution for ${s.uri}`)}const r=new Gx(i,s,this._proxy);this._activeExecutions.set(s.uri,r);const o=r.onDidChangeState(()=>{if(r.state===gs.Resolved){r.dispose();o.dispose();this._activeExecutions.delete(s.uri)}});return r.asApiObject()}_createNotebookExecution(e,i){const n=this._extHostNotebook.getNotebookDocument(e.uri);const s=e.getCells().find(a=>{const l=n.getCellFromApiCell(a);return l&&this._activeExecutions.has(l.uri)});if(s){throw new Error(`duplicate cell execution for ${s.document.uri}`)}if(this._activeNotebookExecutions.has(n.uri)){throw new Error(`duplicate notebook execution for ${n.uri}`)}const r=new Kx(i,n,this._proxy);const o=r.onDidChangeState(()=>{if(r.state===Tr.Resolved){r.dispose();o.dispose();this._activeNotebookExecutions.delete(n.uri)}});this._activeNotebookExecutions.set(n.uri,[r,o]);return r.asApiObject()}};aS=W([P(4,et)],aS);var gs;(function(t){t[t["Init"]=0]="Init";t[t["Started"]=1]="Started";t[t["Resolved"]=2]="Resolved"})(gs||(gs={}));class Gx extends me{static{this.HANDLE=0}get state(){return this._state}constructor(e,i,n){super();this._cell=i;this._proxy=n;this._handle=Gx.HANDLE++;this._onDidChangeState=new L;this.onDidChangeState=this._onDidChangeState.event;this._state=gs.Init;this._tokenSource=this._register(new Tt);this._collector=new MB(10,s=>this.update(s));this._executionOrder=i.internalMetadata.executionOrder;this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const i=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new ji(i))}verifyStateForOutput(){if(this._state===gs.Init){throw new Error("Must call start before modifying cell output")}if(this._state===gs.Resolved){throw new Error("Cannot modify cell output after calling resolve")}}cellIndexToHandle(e){let i=this._cell;if(e){i=this._cell.notebook.getCellFromApiCell(e)}if(!i){throw new Error("INVALID cell")}return i.handle}validateAndConvertOutputs(e){return e.map(i=>{const n=Mg.ensureUniqueMimeTypes(i.items,true);if(n===i.items){return qo.from(i)}return qo.from({items:n,id:i.id,metadata:i.metadata})})}async updateOutputs(e,i,n){const s=this.cellIndexToHandle(i);const r=this.validateAndConvertOutputs(Zn(e));return this.updateSoon({editType:rc.Output,cellHandle:s,append:n,outputs:r})}async updateOutputItems(e,i,n){e=Mg.ensureUniqueMimeTypes(Zn(e),true);return this.updateSoon({editType:rc.OutputItems,items:e.map(cu.from),outputId:i.id,append:n})}asApiObject(){const e=this;const i={get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(n){e._executionOrder=n;e.update([{editType:rc.ExecutionState,executionOrder:e._executionOrder}])},start(n){if(e._state===gs.Resolved||e._state===gs.Started){throw new Error("Cannot call start again")}e._state=gs.Started;e._onDidChangeState.fire();e.update({editType:rc.ExecutionState,runStartTime:n})},end(n,s,r){if(e._state===gs.Resolved){throw new Error("Cannot call resolve twice")}e._state=gs.Resolved;e._onDidChangeState.fire();e._collector.flush();const o=NB(r);e._proxy.$completeExecution(e._handle,new ji({runEndTime:s,lastRunSuccess:n,error:o}))},clearOutput(n){e.verifyStateForOutput();return e.updateOutputs([],n,false)},appendOutput(n,s){e.verifyStateForOutput();return e.updateOutputs(n,s,true)},replaceOutput(n,s){e.verifyStateForOutput();return e.updateOutputs(n,s,false)},appendOutputItems(n,s){e.verifyStateForOutput();return e.updateOutputItems(n,s,true)},replaceOutputItems(n,s){e.verifyStateForOutput();return e.updateOutputItems(n,s,false)}};return Object.freeze(i)}}function NB(t){const e=s=>s?{startLineNumber:s.start.line,startColumn:s.start.character,endLineNumber:s.end.line,endColumn:s.end.character}:void 0;const i=s=>({uri:s.uri,position:s.position,label:s.label});const n=t?{name:t.name,message:t.message,stack:t.stack instanceof Array?t.stack.map(s=>i(s)):t.stack,location:e(t.location),uri:t.uri}:void 0;return n}var Tr;(function(t){t[t["Init"]=0]="Init";t[t["Started"]=1]="Started";t[t["Resolved"]=2]="Resolved"})(Tr||(Tr={}));class Kx extends me{static{this.HANDLE=0}get state(){return this._state}constructor(e,i,n){super();this._notebook=i;this._proxy=n;this._handle=Kx.HANDLE++;this._onDidChangeState=new L;this.onDidChangeState=this._onDidChangeState.event;this._state=Tr.Init;this._tokenSource=this._register(new Tt);this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){const e={start:()=>{if(this._state===Tr.Resolved||this._state===Tr.Started){throw new Error("Cannot call start again")}this._state=Tr.Started;this._onDidChangeState.fire();this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===Tr.Resolved){throw new Error("Cannot call resolve twice")}this._state=Tr.Resolved;this._onDidChangeState.fire();this._proxy.$completeNotebookExecution(this._handle)}};return Object.freeze(e)}}class MB{constructor(e,i){this.delay=e;this.callback=i;this.batch=[];this.startedTimer=Date.now()}addItem(e){this.batch.push(e);if(!this.currentDeferred){this.currentDeferred=new Bn;this.startedTimer=Date.now();Ts(this.delay).then(()=>{return this.flush()})}if(Date.now()-this.startedTimer>this.delay){return this.flush()}return this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred){return Promise.resolve()}const e=this.currentDeferred;this.currentDeferred=void 0;const i=this.batch;this.batch=[];return this.callback(i).finally(()=>e.complete())}}function Kf(t,e){return`${t.value}/${e}`}class OB{constructor(e,i){this._extHostNotebook=i;this._rendererMessageEmitters=new Map;this.proxy=e.getProxy(ee.MainThreadNotebookRenderers)}$postRendererMessage(e,i,n){const s=this._extHostNotebook.getEditorById(e);this._rendererMessageEmitters.get(i)?.fire({editor:s.apiEditor,message:n})}createRendererMessaging(e,i){if(!e.contributes?.notebookRenderer?.some(s=>s.id===i)){throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${i})`)}const n={onDidReceiveMessage:(s,r,o)=>{return this.getOrCreateEmitterFor(i).event(s,r,o)},postMessage:(s,r)=>{if(nf.apiEditorsToExtHost.has(s)){[s,r]=[r,s]}const o=r&&nf.apiEditorsToExtHost.get(r);return this.proxy.$postMessage(o?.id,i,s)}};return n}getOrCreateEmitterFor(e){let i=this._rendererMessageEmitters.get(e);if(i){return i}i=new L({onDidRemoveLastListener:()=>{i?.dispose();this._rendererMessageEmitters.delete(e)}});this._rendererMessageEmitters.set(e,i);return i}}class FB{constructor(e){this.handlers=new Map;this.proxy=e.getProxy(ee.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,i,n){O(e,"profileContentHandlers");if(this.handlers.has(i)){throw new Error(`Handler with id '${i}' already registered`)}this.handlers.set(i,n);this.proxy.$registerProfileContentHandler(i,n.name,n.description,e.identifier.value);return ye(()=>{this.handlers.delete(i);this.proxy.$unregisterProfileContentHandler(i)})}async $saveProfile(e,i,n,s){const r=this.handlers.get(e);if(!r){throw new Error(`Unknown handler with id: ${e}`)}return r.saveProfile(i,n,s)}async $readProfile(e,i,n){const s=this.handlers.get(e);if(!s){throw new Error(`Unknown handler with id: ${e}`)}return s.readProfile(Xe(i)?i:b.revive(i),n)}}class Qx{static{this.handlePool=0}constructor(e,i){this.uriTransformer=i;this.providers=new Map;this.proxy=e.getProxy(ee.MainThreadQuickDiff)}$provideOriginalResource(e,i,n){const s=b.revive(i);const r=this.providers.get(e);if(!r){return Promise.resolve(null)}return Hi(()=>r.provideOriginalResource(s,n)).then(o=>o||null)}registerQuickDiffProvider(e,i,n,s,r,o){const a=Qx.handlePool++;this.providers.set(a,n);const l=ht.toKey(e.identifier);this.proxy.$registerQuickDiffProvider(a,hl.from(i,this.uriTransformer),`${l}.${s}`,r,o);return{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(a);this.providers.delete(a)}}}}function UB(t,e,i){const n=t.getProxy(ee.MainThreadQuickOpen);class s{constructor(c,u){this._sessions=new Map;this._instances=0;this._workspace=c;this._commands=u}showQuickPick(c,u,d,f=Ze.None){this._onDidSelectItem=void 0;const p=Promise.resolve(u);const m=++this._instances;const v=n.$show(m,{title:d?.title,placeHolder:d?.placeHolder,prompt:d?.prompt,matchOnDescription:d?.matchOnDescription,matchOnDetail:d?.matchOnDetail,ignoreFocusLost:d?.ignoreFocusOut,canPickMany:d?.canPickMany},f);const y={};const k=v.then(()=>y);return Promise.race([k,p]).then(S=>{if(S===y){return void 0}return p.then(R=>{const K=[];for(let q=0;q<R.length;q++){const se=R[q];if(typeof se==="string"){K.push({label:se,handle:q})}else if(se.kind===Ch.Separator){K.push({type:"separator",label:se.label})}else{if(se.tooltip){O(c,"quickPickItemTooltip")}K.push({label:se.label,iconPathDto:Fr.from(se.iconPath),description:se.description,detail:se.detail,picked:se.picked,alwaysShow:se.alwaysShow,tooltip:we.fromStrict(se.tooltip),resourceUri:se.resourceUri,handle:q})}}if(d&&typeof d.onDidSelectItem==="function"){this._onDidSelectItem=q=>{d.onDidSelectItem(R[q])}}n.$setItems(m,K);return v.then(q=>{if(typeof q==="number"){return R[q]}else if(Array.isArray(q)){return q.map(se=>R[se])}return void 0})})}).then(void 0,S=>{if(Ls(S)){return void 0}n.$setError(m,S);return Promise.reject(S)})}$onItemSelected(c){this._onDidSelectItem?.(c)}showInput(c,u=Ze.None){this._validateInput=c?.validateInput;return n.$input(c,typeof this._validateInput==="function",u).then(void 0,d=>{if(Ls(d)){return void 0}return Promise.reject(d)})}async $validateInput(c){if(!this._validateInput){return}const u=await this._validateInput(c);if(!u||typeof u==="string"){return u}let d;switch(u.severity){case xc.Info:d=gt.Info;break;case xc.Warning:d=gt.Warning;break;case xc.Error:d=gt.Error;break;default:d=u.message?gt.Error:gt.Ignore;break}return{content:u.message,severity:d}}async showWorkspaceFolderPick(c,u=Ze.None){const d=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[c]);if(!d){return void 0}const f=await this._workspace.getWorkspaceFolders2();if(!f){return void 0}return f.find(p=>p.uri.toString()===d.uri.toString())}createQuickPick(c){const u=new o(c,()=>this._sessions.delete(u._id));this._sessions.set(u._id,u);return u}createInputBox(c){const u=new a(c,()=>this._sessions.delete(u._id));this._sessions.set(u._id,u);return u}$onDidChangeValue(c,u){const d=this._sessions.get(c);d?._fireDidChangeValue(u)}$onDidAccept(c){const u=this._sessions.get(c);u?._fireDidAccept()}$onDidChangeActive(c,u){const d=this._sessions.get(c);if(d instanceof o){d._fireDidChangeActive(u)}}$onDidChangeSelection(c,u){const d=this._sessions.get(c);if(d instanceof o){d._fireDidChangeSelection(u)}}$onDidTriggerButton(c,u,d){const f=this._sessions.get(c);f?._fireDidTriggerButton(u,d)}$onDidTriggerItemButton(c,u,d,f){const p=this._sessions.get(c);if(p instanceof o){p._fireDidTriggerItemButton(u,d,f)}}$onDidHide(c){const u=this._sessions.get(c);u?._fireDidHide()}}class r{static{this._nextId=1}constructor(c,u){this._extension=c;this._onDidDispose=u;this._id=o._nextId++;this._visible=false;this._expectingHide=false;this._enabled=true;this._busy=false;this._ignoreFocusOut=true;this._value="";this._valueSelection=void 0;this._buttons=[];this._handlesToButtons=new Map;this._onDidAcceptEmitter=new L;this._onDidChangeValueEmitter=new L;this._onDidTriggerButtonEmitter=new L;this._onDidHideEmitter=new L;this._pendingUpdate={id:this._id};this._disposed=false;this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter];this.onDidChangeValue=this._onDidChangeValueEmitter.event;this.onDidAccept=this._onDidAcceptEmitter.event;this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event;this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(c){this._title=c;this.update({title:c})}get step(){return this._steps}set step(c){this._steps=c;this.update({step:c})}get totalSteps(){return this._totalSteps}set totalSteps(c){this._totalSteps=c;this.update({totalSteps:c})}get enabled(){return this._enabled}set enabled(c){this._enabled=c;this.update({enabled:c})}get busy(){return this._busy}set busy(c){this._busy=c;this.update({busy:c})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(c){this._ignoreFocusOut=c;this.update({ignoreFocusOut:c})}get value(){return this._value}set value(c){this._value=c;this.update({value:c})}get valueSelection(){return this._valueSelection}set valueSelection(c){this._valueSelection=c;this.update({valueSelection:c})}get placeholder(){return this._placeholder}set placeholder(c){this._placeholder=c;this.update({placeholder:c})}get buttons(){return this._buttons}set buttons(c){this._buttons=c.slice();this._handlesToButtons.clear();c.forEach((u,d)=>{const f=u===Eh.Back?-1:d;this._handlesToButtons.set(f,u)});this.update({buttons:c.map((u,d)=>{return{iconPathDto:Fr.from(u.iconPath),tooltip:u.tooltip,handle:u===Eh.Back?-1:d,location:typeof u.location==="number"?u.location:void 0,toggle:typeof u.toggle==="object"&&typeof u.toggle.checked==="boolean"?{checked:u.toggle.checked}:void 0}})})}show(){this._visible=true;this._expectingHide=true;this.update({visible:true})}hide(){this._visible=false;this.update({visible:false})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(c){this._value=c;this._onDidChangeValueEmitter.fire(c)}_fireDidTriggerButton(c,u){const d=this._handlesToButtons.get(c);if(d){if(u!==void 0&&d.toggle){d.toggle.checked=u}this._onDidTriggerButtonEmitter.fire(d)}}_fireDidHide(){if(this._expectingHide){this._expectingHide=this._visible;this._onDidHideEmitter.fire()}}dispose(){if(this._disposed){return}this._disposed=true;this._fireDidHide();this._disposables=Jn(this._disposables);if(this._updateTimeout){clearTimeout(this._updateTimeout);this._updateTimeout=void 0}this._onDidDispose();n.$dispose(this._id)}update(c){if(this._disposed){return}for(const u of Object.keys(c)){const d=c[u];this._pendingUpdate[u]=d===void 0?null:d}if("visible"in this._pendingUpdate){if(this._updateTimeout){clearTimeout(this._updateTimeout);this._updateTimeout=void 0}this.dispatchUpdate()}else if(this._visible&&!this._updateTimeout){this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0;this.dispatchUpdate()},0)}}dispatchUpdate(){n.$createOrUpdate(this._pendingUpdate);this._pendingUpdate={id:this._id}}}class o extends r{constructor(c,u){super(c,u);this._items=[];this._handlesToItems=new Map;this._itemsToHandles=new Map;this._canSelectMany=false;this._matchOnDescription=true;this._matchOnDetail=true;this._sortByLabel=true;this._keepScrollPosition=false;this._activeItems=[];this._onDidChangeActiveEmitter=new L;this._selectedItems=[];this._onDidChangeSelectionEmitter=new L;this._onDidTriggerItemButtonEmitter=new L;this.onDidChangeActive=this._onDidChangeActiveEmitter.event;this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event;this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event;this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter);this.update({type:"quickPick"})}get items(){return this._items}set items(c){this._items=c.slice();this._handlesToItems.clear();this._itemsToHandles.clear();c.forEach((d,f)=>{this._handlesToItems.set(f,d);this._itemsToHandles.set(d,f)});const u=[];for(let d=0;d<c.length;d++){const f=c[d];if(f.kind===Ch.Separator){u.push({type:"separator",label:f.label})}else{if(f.tooltip){O(this._extension,"quickPickItemTooltip")}u.push({handle:d,label:f.label,iconPathDto:Fr.from(f.iconPath),description:f.description,detail:f.detail,picked:f.picked,alwaysShow:f.alwaysShow,tooltip:we.fromStrict(f.tooltip),resourceUri:f.resourceUri,buttons:f.buttons?.map((p,m)=>{return{iconPathDto:Fr.from(p.iconPath),tooltip:p.tooltip,handle:m,toggle:typeof p.toggle==="object"&&typeof p.toggle.checked==="boolean"?{checked:p.toggle.checked}:void 0}})})}}this.update({items:u})}get canSelectMany(){return this._canSelectMany}set canSelectMany(c){this._canSelectMany=c;this.update({canSelectMany:c})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(c){this._matchOnDescription=c;this.update({matchOnDescription:c})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(c){this._matchOnDetail=c;this.update({matchOnDetail:c})}get sortByLabel(){return this._sortByLabel}set sortByLabel(c){this._sortByLabel=c;this.update({sortByLabel:c})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(c){this._keepScrollPosition=c;this.update({keepScrollPosition:c})}get prompt(){return this._prompt}set prompt(c){this._prompt=c;this.update({prompt:c})}get activeItems(){return this._activeItems}set activeItems(c){this._activeItems=c.filter(u=>this._itemsToHandles.has(u));this.update({activeItems:this._activeItems.map(u=>this._itemsToHandles.get(u))})}get selectedItems(){return this._selectedItems}set selectedItems(c){this._selectedItems=c.filter(u=>this._itemsToHandles.has(u));this.update({selectedItems:this._selectedItems.map(u=>this._itemsToHandles.get(u))})}_fireDidChangeActive(c){const u=zt(c.map(d=>this._handlesToItems.get(d)));this._activeItems=u;this._onDidChangeActiveEmitter.fire(u)}_fireDidChangeSelection(c){const u=zt(c.map(d=>this._handlesToItems.get(d)));this._selectedItems=u;this._onDidChangeSelectionEmitter.fire(u)}_fireDidTriggerItemButton(c,u,d){const f=this._handlesToItems.get(c);if(!f||!f.buttons||!f.buttons.length){return}const p=f.buttons[u];if(p){if(d!==void 0&&p.toggle){p.toggle.checked=d}this._onDidTriggerItemButtonEmitter.fire({button:p,item:f})}}}class a extends r{constructor(c,u){super(c,u);this._password=false;this.update({type:"inputBox"})}get password(){return this._password}set password(c){this._password=c;this.update({password:c})}get prompt(){return this._prompt}set prompt(c){this._prompt=c;this.update({prompt:c})}get validationMessage(){return this._validationMessage}set validationMessage(c){this._validationMessage=c;if(!c){this.update({validationMessage:void 0,severity:gt.Ignore})}else if(typeof c==="string"){this.update({validationMessage:c,severity:gt.Error})}else{this.update({validationMessage:c.message,severity:c.severity??gt.Error})}}}return new s(e,i)}const xT=new $i(()=>{const t=sv.Collator(void 0,{numeric:true,sensitivity:"base"}).value;return{collator:t,collatorIsNumeric:t.resolvedOptions().numeric}});new $i(()=>{const t=sv.Collator(void 0,{numeric:true}).value;return{collator:t}});new $i(()=>{const t=sv.Collator(void 0,{numeric:true,sensitivity:"accent"}).value;return{collator:t}});function $B(t,e,i=false){const n=t||"";const s=e||"";const r=xT.value.collator.compare(n,s);if(xT.value.collatorIsNumeric&&r===0&&n!==s){return n<s?-1:1}return r}function HB(t,e,i=false){if(!i){t=t&&t.toLowerCase();e=e&&e.toLowerCase()}if(t===e){return 0}return t<e?-1:1}function Pp(t,e,i=false){const n=t.split(Yn);const s=e.split(Yn);const r=n.length-1;const o=s.length-1;let a,l;for(let c=0;;c++){a=r===c;l=o===c;if(a&&l){return $B(n[c],s[c],i)}else if(a){return-1}else if(l){return 1}const u=HB(n[c],s[c],i);if(u!==0){return u}}}function ET(t){return t instanceof b}function BB(t,e){if(t.scheme===ne.file&&e.scheme===ne.file&&Fo){return t.toString()===e.toString()}return t.toString().toLowerCase()===e.toString().toLowerCase()}function v1(t){if(!t){return void 0}else if(typeof t.iconPath==="string"){return b.file(t.iconPath)}else if(b.isUri(t.iconPath)){return t.iconPath}else if(Kt.isThemeIcon(t.iconPath)){return t.iconPath}else{return void 0}}function Ys(t){if(!t){return void 0}else if(b.isUri(t)){return t}else if(Kt.isThemeIcon(t)){return t}else{const e=t;return{light:e.light,dark:e.dark}}}function CT(t){const e=Ys(t.authorIcon);const i=Array.isArray(t.tooltip)?we.fromMany(t.tooltip):t.tooltip?we.from(t.tooltip):void 0;const n=t.references?.map(s=>({...s,icon:Ys(s.icon)}));return{...t,authorIcon:e,references:n,tooltip:i}}function w1(t){return t?{...t,icon:Ys(t.icon)}:void 0}function b1(t,e){if(!t.iconPath&&!e.iconPath){return 0}else if(!t.iconPath){return-1}else if(!e.iconPath){return 1}const i=typeof t.iconPath==="string"?t.iconPath:b.isUri(t.iconPath)?t.iconPath.fsPath:t.iconPath.id;const n=typeof e.iconPath==="string"?e.iconPath:b.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id;return Pp(i,n)}function WB(t,e){let i=0;if(t.strikeThrough!==e.strikeThrough){return t.strikeThrough?1:-1}if(t.faded!==e.faded){return t.faded?1:-1}if(t.tooltip!==e.tooltip){return(t.tooltip||"").localeCompare(e.tooltip||"")}i=b1(t,e);if(i!==0){return i}if(t.light&&e.light){i=b1(t.light,e.light)}else if(t.light){return 1}else if(e.light){return-1}if(i!==0){return i}if(t.dark&&e.dark){i=b1(t.dark,e.dark)}else if(t.dark){return 1}else if(e.dark){return-1}return i}function VB(t,e){if(t.command!==e.command){return t.command<e.command?-1:1}if(t.title!==e.title){return t.title<e.title?-1:1}if(t.tooltip!==e.tooltip){if(t.tooltip!==void 0&&e.tooltip!==void 0){return t.tooltip<e.tooltip?-1:1}else if(t.tooltip!==void 0){return 1}else if(e.tooltip!==void 0){return-1}}if(t.arguments===e.arguments){return 0}else if(!t.arguments){return-1}else if(!e.arguments){return 1}else if(t.arguments.length!==e.arguments.length){return t.arguments.length-e.arguments.length}for(let i=0;i<t.arguments.length;i++){const n=t.arguments[i];const s=e.arguments[i];if(n===s){continue}if(ET(n)&&ET(s)&&BB(n,s)){continue}return n<s?-1:1}return 0}function kT(t,e){let i=Pp(t.resourceUri.fsPath,e.resourceUri.fsPath,true);if(i!==0){return i}if(t.command&&e.command){i=VB(t.command,e.command)}else if(t.command){return 1}else if(e.command){return-1}if(i!==0){return i}if(t.decorations&&e.decorations){i=WB(t.decorations,e.decorations)}else if(t.decorations){return 1}else if(e.decorations){return-1}if(i!==0){return i}if(t.multiFileDiffEditorModifiedUri&&e.multiFileDiffEditorModifiedUri){i=Pp(t.multiFileDiffEditorModifiedUri.fsPath,e.multiFileDiffEditorModifiedUri.fsPath,true)}else if(t.multiFileDiffEditorModifiedUri){return 1}else if(e.multiFileDiffEditorModifiedUri){return-1}if(i!==0){return i}if(t.multiDiffEditorOriginalUri&&e.multiDiffEditorOriginalUri){i=Pp(t.multiDiffEditorOriginalUri.fsPath,e.multiDiffEditorOriginalUri.fsPath,true)}else if(t.multiDiffEditorOriginalUri){return 1}else if(e.multiDiffEditorOriginalUri){return-1}return i}function zB(t,e){for(let i=0;i<t.length;i++){if(t[i]!==e[i]){return false}}return true}function qB(t,e){return t.command===e.command&&t.title===e.title&&t.tooltip===e.tooltip&&(t.arguments&&e.arguments?zB(t.arguments,e.arguments):t.arguments===e.arguments)}function jB(t,e){return mn(t,e,qB)}class GB{#e;#t;get value(){return this._value}set value(e){e=e??"";this.#e.$setInputBoxValue(this._sourceControlHandle,e);this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){this.#e.$setInputBoxPlaceholder(this._sourceControlHandle,e);this._placeholder=e}get validateInput(){O(this._extension,"scmValidation");return this._validateInput}set validateInput(e){O(this._extension,"scmValidation");if(e&&typeof e!=="function"){throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`)}this._validateInput=e;this.#e.$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e;if(this._enabled===e){return}this._enabled=e;this.#e.$setInputBoxEnablement(this._sourceControlHandle,e)}get visible(){return this._visible}set visible(e){e=!!e;if(this._visible===e){return}this._visible=e;this.#e.$setInputBoxVisibility(this._sourceControlHandle,e)}get document(){O(this._extension,"scmTextDocument");return this.#t.getDocument(this._documentUri)}constructor(e,i,n,s,r){this._extension=e;this._sourceControlHandle=s;this._documentUri=r;this._value="";this._onDidChange=new L;this._placeholder="";this._enabled=true;this._visible=true;this.#t=i;this.#e=n}showValidationMessage(e,i){O(this._extension,"scmValidation");this.#e.$showValidationMessage(this._sourceControlHandle,e,Ey.from(i))}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e;this._onDidChange.fire(e)}}class Jx{static{this._handlePool=0}get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e;this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get contextValue(){return this._contextValue}set contextValue(e){this._contextValue=e;this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e;this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{contextValue:this.contextValue,hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e];this._onDidUpdateResourceStates.fire()}constructor(e,i,n,s,r,o,a){this._proxy=e;this._commands=i;this._sourceControlHandle=n;this._id=s;this._label=r;this.multiDiffEditorEnableViewChanges=o;this._extension=a;this._resourceHandlePool=0;this._resourceStates=[];this._resourceStatesMap=new Map;this._resourceStatesCommandsMap=new Map;this._resourceStatesDisposablesMap=new Map;this._onDidUpdateResourceStates=new L;this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event;this._disposed=false;this._onDidDispose=new L;this.onDidDispose=this._onDidDispose.event;this._handlesSnapshot=[];this._resourceSnapshot=[];this._contextValue=void 0;this._hideWhenEmpty=void 0;this.handle=Jx._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,i){const n=this._resourceStatesCommandsMap.get(e);if(!n){return Promise.resolve(void 0)}return Hi(()=>this._commands.executeCommand(n.command,...n.arguments||[],i))}_takeResourceStateSnapshot(){const e=[...this._resourceStates].sort(kT);const i=NT(this._resourceSnapshot,e,kT);const n=i.map(o=>{const a=o.toInsert.map(l=>{const c=this._resourceHandlePool++;this._resourceStatesMap.set(c,l);const u=l.resourceUri;let d;if(l.command){if(l.command.command==="vscode.open"||l.command.command==="vscode.diff"||l.command.command==="vscode.changes"){const Q=new pe;d=this._commands.converter.toInternal(l.command,Q);this._resourceStatesDisposablesMap.set(c,Q)}else{this._resourceStatesCommandsMap.set(c,l.command)}}const f=it(this._extension,"scmMultiDiffEditor");const p=f?l.multiDiffEditorOriginalUri:void 0;const m=f?l.multiFileDiffEditorModifiedUri:void 0;const v=v1(l.decorations);const y=l.decorations&&v1(l.decorations.light)||v;const k=l.decorations&&v1(l.decorations.dark)||v;const S=[y,k];const R=l.decorations&&l.decorations.tooltip||"";const K=l.decorations&&!!l.decorations.strikeThrough;const q=l.decorations&&!!l.decorations.faded;const se=l.contextValue||"";const j=[c,u,S,R,K,q,se,d,p,m];return{rawResource:j,handle:c}});return{start:o.start,deleteCount:o.deleteCount,toInsert:a}});const s=n.map(({start:o,deleteCount:a,toInsert:l})=>[o,a,l.map(c=>c.rawResource)]);const r=n.reverse();for(const{start:o,deleteCount:a,toInsert:l}of r){const c=l.map(d=>d.handle);const u=this._handlesSnapshot.splice(o,a,...c);for(const d of u){this._resourceStatesMap.delete(d);this._resourceStatesCommandsMap.delete(d);this._resourceStatesDisposablesMap.get(d)?.dispose();this._resourceStatesDisposablesMap.delete(d)}}this._resourceSnapshot=e;return s}dispose(){this._disposed=true;this._onDidDispose.fire()}}class _l{static{this._handlePool=0}#e;get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get contextValue(){O(this._extension,"scmProviderOptions");return this._contextValue}set contextValue(e){O(this._extension,"scmProviderOptions");if(this._contextValue===e){return}this._contextValue=e;this.#e.$updateSourceControl(this.handle,{contextValue:e})}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){if(this._count===e){return}this._count=e;this.#e.$updateSourceControl(this.handle,{count:e})}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let i=void 0;if(it(this._extension,"quickDiffProvider")){i=e?.label}this.#e.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:i})}get secondaryQuickDiffProvider(){O(this._extension,"quickDiffProvider");return this._secondaryQuickDiffProvider}set secondaryQuickDiffProvider(e){O(this._extension,"quickDiffProvider");this._secondaryQuickDiffProvider=e;const i=e?.label;this.#e.$updateSourceControl(this.handle,{hasSecondaryQuickDiffProvider:!!e,secondaryQuickDiffLabel:i})}get historyProvider(){O(this._extension,"scmHistoryProvider");return this._historyProvider}set historyProvider(e){O(this._extension,"scmHistoryProvider");this._historyProvider=e;this._historyProviderDisposable.value=new pe;this.#e.$updateSourceControl(this.handle,{hasHistoryProvider:!!e});if(e){this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemRefs(()=>{const i=w1(e?.currentHistoryItemRef);const n=w1(e?.currentHistoryItemRemoteRef);const s=w1(e?.currentHistoryItemBaseRef);this.#e.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle,i,n,s)}));this._historyProviderDisposable.value.add(e.onDidChangeHistoryItemRefs(i=>{if(i.added.length===0&&i.modified.length===0&&i.removed.length===0){return}const n=i.added.map(o=>({...o,icon:Ys(o.icon)}));const s=i.modified.map(o=>({...o,icon:Ys(o.icon)}));const r=i.removed.map(o=>({...o,icon:Ys(o.icon)}));this.#e.$onDidChangeHistoryProviderHistoryItemRefs(this.handle,{added:n,modified:s,removed:r,silent:i.silent})}))}}get artifactProvider(){O(this._extension,"scmArtifactProvider");return this._artifactProvider}set artifactProvider(e){O(this._extension,"scmArtifactProvider");this._artifactProvider=e;this._artifactProviderDisposable.value=new pe;this.#e.$updateSourceControl(this.handle,{hasArtifactProvider:!!e});if(e){this._artifactProviderDisposable.value.add(e.onDidChangeArtifacts(i=>{if(i.length!==0){this.#e.$onDidChangeArtifacts(this.handle,i)}}))}}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){if(e===this._commitTemplate){return}this._commitTemplate=e;this.#e.$updateSourceControl(this.handle,{commitTemplate:e})}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new pe;this._acceptInputCommand=e;const i=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);this.#e.$updateSourceControl(this.handle,{acceptInputCommand:i})}get actionButton(){O(this._extension,"scmActionButton");return this._actionButton}set actionButton(e){O(this._extension,"scmActionButton");if(Zd(this._actionButton,e)){return}const i=this._actionButtonDisposables;this._actionButtonDisposables=new pe;this._actionButton=e;const n=e!==void 0?{command:{...this._commands.converter.toInternal(e.command,this._actionButtonDisposables),shortTitle:e.command.shortTitle},secondaryCommands:e.secondaryCommands?.map(s=>{return s.map(r=>this._commands.converter.toInternal(r,this._actionButtonDisposables))}),enabled:e.enabled}:null;this.#e.$updateSourceControl(this.handle,{actionButton:n}).finally(()=>i.dispose())}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&jB(this._statusBarCommands,e)){return}const i=this._statusBarDisposables;this._statusBarDisposables=new pe;this._statusBarCommands=e;const n=(e||[]).map(s=>this._commands.converter.toInternal(s,this._statusBarDisposables));this.#e.$updateSourceControl(this.handle,{statusBarCommands:n}).finally(()=>i.dispose())}get selected(){return this._selected}constructor(e,i,n,s,r,o,a,l,c,u){this._extension=e;this._commands=s;this._id=r;this._label=o;this._rootUri=a;this._onDidDispose=new L;this.onDidDispose=this._onDidDispose.event;this._groups=new Map;this._contextValue=void 0;this._count=void 0;this._quickDiffProvider=void 0;this._secondaryQuickDiffProvider=void 0;this._historyProviderDisposable=new $r;this._artifactProviderDisposable=new $r;this._commitTemplate=void 0;this._acceptInputDisposables=new $r;this._acceptInputCommand=void 0;this._actionButtonDisposables=new pe;this._statusBarDisposables=new pe;this._statusBarCommands=void 0;this._selected=false;this._onDidChangeSelection=new L;this.onDidChangeSelection=this._onDidChangeSelection.event;this._artifactCommandsDisposables=new af;this.handle=_l._handlePool++;this.createdResourceGroups=new Map;this.updatedResourceGroups=new Set;this.#e=n;const d=b.from({scheme:ne.vscodeSourceControl,path:`${r}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new GB(e,i,this.#e,this.handle,d);this.#e.$registerSourceControl(this.handle,u?.handle,r,o,a,Ys(l),c,d);this.onDidDisposeParent=u?u.onDidDispose:wt.None}createResourceGroup(e,i,n){const s=it(this._extension,"scmMultiDiffEditor")&&n?.multiDiffEditorEnableViewChanges===true;const r=new Jx(this.#e,this._commands,this.handle,e,i,s,this._extension);const o=wt.once(r.onDidDispose)(()=>this.createdResourceGroups.delete(r));this.createdResourceGroups.set(r,o);this.eventuallyAddResourceGroups();return r}eventuallyAddResourceGroups(){const e=[];const i=[];for(const[n,s]of this.createdResourceGroups){s.dispose();const r=n.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(n);this.eventuallyUpdateResourceStates()});wt.once(n.onDidDispose)(()=>{this.updatedResourceGroups.delete(n);r.dispose();this._groups.delete(n.handle);this.#e.$unregisterGroup(this.handle,n.handle)});e.push([n.handle,n.id,n.label,n.features,n.multiDiffEditorEnableViewChanges]);const o=n._takeResourceStateSnapshot();if(o.length>0){i.push([n.handle,o])}this._groups.set(n.handle,n)}this.#e.$registerGroups(this.handle,e,i);this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach(i=>{const n=i._takeResourceStateSnapshot();if(n.length===0){return}e.push([i.handle,n])});if(e.length>0){this.#e.$spliceResourceStates(this.handle,e)}this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e;this._onDidChangeSelection.fire(e)}async provideArtifacts(e,i){const n=new pe;const s=await this.artifactProvider?.provideArtifacts(e,i);const r=s?.map(o=>({...o,icon:Ys(o.icon),command:o.command?this._commands.converter.toInternal(o.command,n):void 0}));this._artifactCommandsDisposables.get(e)?.dispose();this._artifactCommandsDisposables.set(e,n);return r}dispose(){this._acceptInputDisposables.dispose();this._actionButtonDisposables.dispose();this._statusBarDisposables.dispose();this._historyProviderDisposable.dispose();this._artifactProviderDisposable.dispose();this._artifactCommandsDisposables.dispose();this._groups.forEach(e=>e.dispose());this.#e.$unregisterSourceControl(this.handle);this._onDidDispose.fire();this._onDidDispose.dispose()}}_l.__decorator=W([GA(100)],_l.prototype,"eventuallyAddResourceGroups",null);_l.__decorator=W([GA(100)],_l.prototype,"eventuallyUpdateResourceStates",null);let lS=class Aq{get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,i,n,s){this._commands=i;this._extHostDocuments=n;this.logService=s;this._sourceControls=new Map;this._sourceControlsByExtension=new $o;this._onDidChangeActiveProvider=new L;this._proxy=e.getProxy(ee.MainThreadSCM);this._telemetry=e.getProxy(ee.MainThreadTelemetry);i.registerArgumentProcessor({processArgument:r=>{if(r&&r.$mid===nt.ScmResource){const o=this._sourceControls.get(r.sourceControlHandle);if(!o){return r}const a=o.getResourceGroup(r.groupHandle);if(!a){return r}return a.getResourceState(r.handle)}else if(r&&r.$mid===nt.ScmResourceGroup){const o=this._sourceControls.get(r.sourceControlHandle);if(!o){return r}return o.getResourceGroup(r.groupHandle)}else if(r&&r.$mid===nt.ScmProvider){const o=this._sourceControls.get(r.handle);if(!o){return r}return o}return r}})}createSourceControl(e,i,n,s,r,o,a){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,i,n,s);this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const l=a?qi.find(this._sourceControls.values(),d=>d===a):void 0;const c=new _l(e,this._extHostDocuments,this._proxy,this._commands,i,n,s,r,o,l);this._sourceControls.set(c.handle,c);const u=this._sourceControlsByExtension.get(e.identifier)||[];u.push(c);this._sourceControlsByExtension.set(e.identifier,u);return c}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const i=this._sourceControlsByExtension.get(e.identifier);const n=i&&i[i.length-1];return n&&n.inputBox}$provideOriginalResource(e,i,n){const s=b.revive(i);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,s.toString());const r=this._sourceControls.get(e);if(!r||!r.quickDiffProvider||!r.quickDiffProvider.provideOriginalResource){return Promise.resolve(null)}return Hi(()=>r.quickDiffProvider.provideOriginalResource(s,n)).then(o=>o||null)}$provideSecondaryOriginalResource(e,i,n){const s=b.revive(i);this.logService.trace("ExtHostSCM#$provideSecondaryOriginalResource",e,s.toString());const r=this._sourceControls.get(e);if(!r||!r.secondaryQuickDiffProvider||!r.secondaryQuickDiffProvider.provideOriginalResource){return Promise.resolve(null)}return Hi(()=>r.secondaryQuickDiffProvider.provideOriginalResource(s,n)).then(o=>o||null)}$onInputBoxValueChange(e,i){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const n=this._sourceControls.get(e);if(!n){return Promise.resolve(void 0)}n.inputBox.$onInputBoxValueChange(i);return Promise.resolve(void 0)}$executeResourceCommand(e,i,n,s){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,i,n);const r=this._sourceControls.get(e);if(!r){return Promise.resolve(void 0)}const o=r.getResourceGroup(i);if(!o){return Promise.resolve(void 0)}return o.$executeResourceCommand(n,s)}$validateInput(e,i,n){this.logService.trace("ExtHostSCM#$validateInput",e);const s=this._sourceControls.get(e);if(!s){return Promise.resolve(void 0)}if(!s.inputBox.validateInput){return Promise.resolve(void 0)}return Hi(()=>s.inputBox.validateInput(i,n)).then(r=>{if(!r){return Promise.resolve(void 0)}const o=we.fromStrict(r.message);if(!o){return Promise.resolve(void 0)}return Promise.resolve([o,r.type])})}$setSelectedSourceControl(e){this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e);if(this._selectedSourceControlHandle===e){return Promise.resolve(void 0)}if(e!==void 0){this._sourceControls.get(e)?.setSelectionState(true)}if(this._selectedSourceControlHandle!==void 0){this._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(false)}this._selectedSourceControlHandle=e;return Promise.resolve(void 0)}async $resolveHistoryItem(e,i,n){try{const s=this._sourceControls.get(e)?.historyProvider;const r=await s?.resolveHistoryItem(i,n);return r?CT(r):void 0}catch(s){this.logService.error("ExtHostSCM#$resolveHistoryItem",s);return void 0}}async $resolveHistoryItemChatContext(e,i,n){try{const s=this._sourceControls.get(e)?.historyProvider;const r=await s?.resolveHistoryItemChatContext(i,n);return r??void 0}catch(s){this.logService.error("ExtHostSCM#$resolveHistoryItemChatContext",s);return void 0}}async $resolveHistoryItemChangeRangeChatContext(e,i,n,s,r){try{const o=this._sourceControls.get(e)?.historyProvider;const a=await o?.resolveHistoryItemChangeRangeChatContext?.(i,n,s,r);return a??void 0}catch(o){this.logService.error("ExtHostSCM#$resolveHistoryItemChangeRangeChatContext",o);return void 0}}async $resolveHistoryItemRefsCommonAncestor(e,i,n){try{const s=this._sourceControls.get(e)?.historyProvider;const r=await s?.resolveHistoryItemRefsCommonAncestor(i,n);return r??void 0}catch(s){this.logService.error("ExtHostSCM#$resolveHistoryItemRefsCommonAncestor",s);return void 0}}async $provideHistoryItemRefs(e,i,n){try{const s=this._sourceControls.get(e)?.historyProvider;const r=await s?.provideHistoryItemRefs(i,n);return r?.map(o=>({...o,icon:Ys(o.icon)}))??void 0}catch(s){this.logService.error("ExtHostSCM#$provideHistoryItemRefs",s);return void 0}}async $provideHistoryItems(e,i,n){try{const s=this._sourceControls.get(e)?.historyProvider;const r=await s?.provideHistoryItems(i,n);return r?.map(o=>CT(o))??void 0}catch(s){this.logService.error("ExtHostSCM#$provideHistoryItems",s);return void 0}}async $provideHistoryItemChanges(e,i,n,s){try{const r=this._sourceControls.get(e)?.historyProvider;const o=await r?.provideHistoryItemChanges(i,n,s);return o??void 0}catch(r){this.logService.error("ExtHostSCM#$provideHistoryItemChanges",r);return void 0}}async $provideArtifactGroups(e,i){try{const n=this._sourceControls.get(e)?.artifactProvider;const s=await n?.provideArtifactGroups(i);return s?.map(r=>({...r,icon:Ys(r.icon)}))}catch(n){this.logService.error("ExtHostSCM#$provideArtifactGroups",n);return void 0}}async $provideArtifacts(e,i,n){try{const s=this._sourceControls.get(e);return s?.provideArtifacts(i,n)}catch(s){this.logService.error("ExtHostSCM#$provideArtifacts",s);return void 0}}};lS=W([P(3,et)],lS);class Yx{static{this.handlePool=0}constructor(e,i){this.uriTransformer=i;this.providers=new Map;this.proxy=e.getProxy(ee.MainThreadShare)}async $provideShare(e,i,n){const s=this.providers.get(e);const r=await s?.provideShare({selection:V.to(i.selection),resourceUri:b.revive(i.resourceUri)},n);return r??void 0}registerShareProvider(e,i){const n=Yx.handlePool++;this.providers.set(n,i);this.proxy.$registerShareProvider(n,hl.from(e,this.uriTransformer),i.id,i.label,i.priority);return{dispose:()=>{this.proxy.$unregisterShareProvider(n);this.providers.delete(n)}}}}class Xx{static{this.ID_POOL=1}constructor(e){this.providers=new Map;this.sessions=new Map;this.synthesizers=new Map;this.proxy=e.getProxy(ee.MainThreadSpeech)}async $createSpeechToTextSession(e,i,n){const s=this.providers.get(e);if(!s){return}const r=new pe;const o=new Tt;this.sessions.set(i,o);const a=await s.provideSpeechToTextSession(o.token,n?{language:n}:void 0);if(!a){return}r.add(a.onDidChange(l=>{if(o.token.isCancellationRequested){return}this.proxy.$emitSpeechToTextEvent(i,l)}));r.add(o.token.onCancellationRequested(()=>r.dispose()))}async $cancelSpeechToTextSession(e){this.sessions.get(e)?.dispose(true);this.sessions.delete(e)}async $createTextToSpeechSession(e,i,n){const s=this.providers.get(e);if(!s){return}const r=new pe;const o=new Tt;this.sessions.set(i,o);const a=await s.provideTextToSpeechSession(o.token,n?{language:n}:void 0);if(!a){return}this.synthesizers.set(i,a);r.add(a.onDidChange(l=>{if(o.token.isCancellationRequested){return}this.proxy.$emitTextToSpeechEvent(i,l)}));r.add(o.token.onCancellationRequested(()=>r.dispose()))}async $synthesizeSpeech(e,i){this.synthesizers.get(e)?.synthesize(i)}async $cancelTextToSpeechSession(e){this.sessions.get(e)?.dispose(true);this.sessions.delete(e);this.synthesizers.delete(e)}async $createKeywordRecognitionSession(e,i){const n=this.providers.get(e);if(!n){return}const s=new pe;const r=new Tt;this.sessions.set(i,r);const o=await n.provideKeywordRecognitionSession(r.token);if(!o){return}s.add(o.onDidChange(a=>{if(r.token.isCancellationRequested){return}this.proxy.$emitKeywordRecognitionEvent(i,a)}));s.add(r.token.onCancellationRequested(()=>s.dispose()))}async $cancelKeywordRecognitionSession(e){this.sessions.get(e)?.dispose(true);this.sessions.delete(e)}registerProvider(e,i,n){const s=Xx.ID_POOL++;this.providers.set(s,n);this.proxy.$registerProvider(s,i,{extension:e,displayName:e.value});return ye(()=>{this.proxy.$unregisterProvider(s);this.providers.delete(s)})}}class Hd{static{this.ID_GEN=0}static{this.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new gh("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new gh("statusBarItem.warningForeground")]])}#e;#t;constructor(e,i,n,s,r,o=Co.Left,a,l){this._onDispose=l;this._disposed=false;this._text="";this._staleCommandRegistrations=new pe;this.#e=e;this.#t=i;if(r&&s){this._entryId=pM(s.identifier,r);const c=n.get(this._entryId);if(c){o=c.alignLeft?Co.Left:Co.Right;a=c.priority;this._visible=true;this.name=c.name;this.text=c.text;this.tooltip=c.tooltip;this.command=c.command;this.accessibilityInformation=c.accessibilityInformation}}else{this._entryId=String(Hd.ID_GEN++)}this._extension=s;this._id=r;this._alignment=o;this._priority=this.validatePriority(a)}validatePriority(e){if(!$a(e)){return void 0}if(e===Number.POSITIVE_INFINITY){return Number.MAX_VALUE}if(e===Number.NEGATIVE_INFINITY){return-Number.MAX_VALUE}return e}get id(){return this._id??this._extension.identifier.value}get entryId(){return this._entryId}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get tooltip2(){if(this._extension){O(this._extension,"statusBarItemTooltip")}return this._tooltip2}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){return this._command?.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e;this.update()}set name(e){this._name=e;this.update()}set tooltip(e){this._tooltip=e;this.update()}set tooltip2(e){if(this._extension){O(this._extension,"statusBarItemTooltip")}this._tooltip2=e;this.update()}set color(e){this._color=e;this.update()}set backgroundColor(e){if(e&&!Hd.ALLOWED_BACKGROUND_COLORS.has(e.id)){e=void 0}this._backgroundColor=e;this.update()}set command(e){if(this._command?.fromApi===e){return}if(this._latestCommandRegistration){this._staleCommandRegistrations.add(this._latestCommandRegistration)}this._latestCommandRegistration=new pe;if(typeof e==="string"){this._command={fromApi:e,internal:this.#t.toInternal({title:"",command:e},this._latestCommandRegistration)}}else if(e){this._command={fromApi:e,internal:this.#t.toInternal(e,this._latestCommandRegistration)}}else{this._command=void 0}this.update()}set accessibilityInformation(e){this._accessibilityInformation=e;this.update()}show(){this._visible=true;this.update()}hide(){clearTimeout(this._timeoutHandle);this._visible=false;this.#e.$disposeEntry(this._entryId)}update(){if(this._disposed||!this._visible){return}clearTimeout(this._timeoutHandle);this._timeoutHandle=setTimeout(()=>{this._timeoutHandle=void 0;let e;if(this._extension){if(this._id){e=`${this._extension.identifier.value}.${this._id}`}else{e=this._extension.identifier.value}}else{e=this._id}let i;if(this._name){i=this._name}else{i=h(2703,"{0} (Extension)",this._extension.displayName||this._extension.name)}let n=this._color;if(this._backgroundColor){n=Hd.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id)}let s;let r;if(typeof this._tooltip2==="function"){s=we.fromStrict(this._tooltip);r=true}else{s=we.fromStrict(this._tooltip2??this._tooltip);r=false}this.#e.$setEntry(this._entryId,e,this._extension?.identifier.value,i,this._text,s,r,this._command?.internal,n,this._backgroundColor,this._alignment===Co.Left,this._priority,this._accessibilityInformation);this._staleCommandRegistrations.clear()},0)}dispose(){this.hide();this._onDispose?.();this._disposed=true}}class KB{constructor(e){this._messages=[];this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",Co.Left,Number.MIN_VALUE);this._item.name=h(2704,"Extension Status")}dispose(){this._messages.length=0;this._item.dispose()}setMessage(e){const i={message:e};this._messages.unshift(i);this._update();return new Ve(()=>{const n=this._messages.indexOf(i);if(n>=0){this._messages.splice(n,1);this._update()}})}_update(){if(this._messages.length>0){this._item.text=this._messages[0].message;this._item.show()}else{this._item.hide()}}}class QB{constructor(e,i){this._entries=new Map;this._existingItems=new Map;this._proxy=e.getProxy(ee.MainThreadStatusBar);this._commands=i;this._statusMessage=new KB(this)}$acceptStaticEntries(e){for(const i of e){this._existingItems.set(i.entryId,i)}}async $provideTooltip(e,i){const n=this._entries.get(e);if(!n){return void 0}const s=typeof n.tooltip2==="function"?await n.tooltip2(i):n.tooltip2;return!i.isCancellationRequested?we.fromStrict(s):void 0}createStatusBarEntry(e,i,n,s){const r=new Hd(this._proxy,this._commands,this._existingItems,e,i,n,s,()=>this._entries.delete(r.entryId));this._entries.set(r.entryId,r);return r}setStatusBarMessage(e,i){const n=this._statusMessage.setMessage(e);let s;if(typeof i==="number"){s=setTimeout(()=>n.dispose(),i)}else if(typeof i!=="undefined"){i.then(()=>n.dispose(),()=>n.dispose())}return new Ve(()=>{n.dispose();clearTimeout(s)})}}class JB extends me{constructor(e,i){super();this._extHostDocumentsAndEditors=i;this._onDidChangeTextEditorSelection=new L;this._onDidChangeTextEditorOptions=new L;this._onDidChangeTextEditorVisibleRanges=new L;this._onDidChangeTextEditorViewColumn=new L;this._onDidChangeTextEditorDiffInformation=new L;this._onDidChangeActiveTextEditor=new L;this._onDidChangeVisibleTextEditors=new L;this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event;this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event;this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event;this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event;this.onDidChangeTextEditorDiffInformation=this._onDidChangeTextEditorDiffInformation.event;this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event;this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event;this._proxy=e.getProxy(ee.MainThreadTextEditors);this._register(this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(n=>this._onDidChangeVisibleTextEditors.fire(n)));this._register(this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(n=>this._onDidChangeActiveTextEditor.fire(n)))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const i=this._extHostDocumentsAndEditors.allEditors();return e?i:i.map(n=>n.value)}async showTextDocument(e,i,n){let s;if(typeof i==="number"){s={position:_i.from(i),preserveFocus:n}}else if(typeof i==="object"){s={position:_i.from(i.viewColumn),preserveFocus:i.preserveFocus,selection:typeof i.selection==="object"?V.from(i.selection):void 0,pinned:typeof i.preview==="boolean"?!i.preview:void 0}}else{s={preserveFocus:false}}const r=await this._proxy.$tryShowTextDocument(e.uri,s);const o=r&&this._extHostDocumentsAndEditors.getEditor(r);if(o){return o.value}if(r){throw new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`)}else{throw new Error(`Could NOT open editor for "${e.uri.toString()}".`)}}createTextEditorDecorationType(e,i){return new Lx(this._proxy,e,i).value}$acceptEditorPropertiesChanged(e,i){const n=this._extHostDocumentsAndEditors.getEditor(e);if(!n){throw new Error("unknown text editor")}if(i.options){n._acceptOptions(i.options)}if(i.selections){const s=i.selections.selections.map(Ms.to);n._acceptSelections(s)}if(i.visibleRanges){const s=zt(i.visibleRanges.map(V.to));n._acceptVisibleRanges(s)}if(i.options){this._onDidChangeTextEditorOptions.fire({textEditor:n.value,options:{...i.options,lineNumbers:Dc.to(i.options.lineNumbers)}})}if(i.selections){const s=Gc.fromValue(i.selections.source);const r=i.selections.selections.map(Ms.to);this._onDidChangeTextEditorSelection.fire({textEditor:n.value,selections:r,kind:s})}if(i.visibleRanges){const s=zt(i.visibleRanges.map(V.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:n.value,visibleRanges:s})}}$acceptEditorPositionData(e){for(const i in e){const n=this._extHostDocumentsAndEditors.getEditor(i);if(!n){throw new Error("Unknown text editor")}const s=_i.to(e[i]);if(n.value.viewColumn!==s){n._acceptViewColumn(s);this._onDidChangeTextEditorViewColumn.fire({textEditor:n.value,viewColumn:s})}}}$acceptEditorDiffInformation(e,i){const n=this._extHostDocumentsAndEditors.getEditor(e);if(!n){throw new Error("unknown text editor")}if(!i){n._acceptDiffInformation(void 0);this._onDidChangeTextEditorDiffInformation.fire({textEditor:n.value,diffInformation:void 0});return}const s=this;const r=i.map(o=>{const a=b.revive(o.original);const l=b.revive(o.modified);const c=o.changes.map(u=>{const[d,f,p,m]=u;let v;if(d===f){v=vc.Addition}else if(p===m){v=vc.Deletion}else{v=vc.Modification}return{original:{startLineNumber:d,endLineNumberExclusive:f},modified:{startLineNumber:p,endLineNumberExclusive:m},kind:v}});return Object.freeze({documentVersion:o.documentVersion,original:a,modified:l,changes:c,get isStale(){const u=s._extHostDocumentsAndEditors.getDocument(l);return u?.version!==o.documentVersion}})});n._acceptDiffInformation(r);this._onDidChangeTextEditorDiffInformation.fire({textEditor:n.value,diffInformation:r})}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let cS=class Rq{constructor(e){this._actual=new om(yo.Dark);this._onDidChangeActiveColorTheme=new L}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let i;switch(e){case"light":i=yo.Light;break;case"hcDark":i=yo.HighContrast;break;case"hcLight":i=yo.HighContrastLight;break;default:i=yo.Dark}this._actual=new om(i);this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};cS=W([P(0,st)],cS);class YB{constructor(e,i){this._providers=new Map;this._itemsBySourceAndUriMap=new Map;this._proxy=e.getProxy(ee.MainThreadTimeline);i.registerArgumentProcessor({processArgument:(n,s)=>{if(n&&n.$mid===nt.TimelineActionContext){if(this._providers.get(n.source)&&s&&it(s,"timeline")){const r=n.uri===void 0?void 0:b.revive(n.uri);return this._itemsBySourceAndUriMap.get(n.source)?.get(DT(r))?.get(n.handle)}else{return void 0}}return n}})}async $getTimeline(e,i,n,s){const r=this._providers.get(e);return r?.provider.provideTimeline(b.revive(i),n,s)}registerTimelineProvider(e,i,n,s){const r=new pe;const o=this.convertTimelineItem(i.id,s,r).bind(this);let a;if(i.onDidChange){a=i.onDidChange(c=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:true,...c,id:i.id}),this)}const l=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...i,scheme:e,onDidChange:void 0,async provideTimeline(c,u,d){if(u?.resetCache){r.clear();l.get(i.id)?.clear()}const f=await i.provideTimeline(c,u,d);if(f===void 0||f===null){return void 0}const p=o(c,u);return{...f,source:i.id,items:f.items.map(p)}},dispose(){for(const c of l.values()){c.get(i.id)?.clear()}a?.dispose();r.dispose()}},n)}convertTimelineItem(e,i,n){return(s,r)=>{let o;if(r?.cacheResults){let a=this._itemsBySourceAndUriMap.get(e);if(a===void 0){a=new Map;this._itemsBySourceAndUriMap.set(e,a)}const l=DT(s);o=a.get(l);if(o===void 0){o=new Map;a.set(l,o)}}return a=>{const{iconPath:l,...c}=a;const u=`${e}|${a.id??a.timestamp}`;o?.set(u,a);let d;let f;let p;if(a.iconPath){if(l instanceof _n){p={id:l.id,color:l.color}}else if(b.isUri(l)){d=l;f=l}else{({light:d,dark:f}=l)}}let m;if(rn.isMarkdownString(c.tooltip)){m=we.from(c.tooltip)}else if(Xe(c.tooltip)){m=c.tooltip}else if(rn.isMarkdownString(c.detail)){console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip");m=we.from(c.detail)}else if(Xe(c.detail)){console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip");m=c.detail}return{...c,id:c.id??void 0,handle:u,source:e,command:a.command?i.toInternal(a.command,n):void 0,icon:d,iconDark:f,themeIcon:p,tooltip:m,accessibilityInformation:a.accessibilityInformation}}}}registerTimelineProviderCore(e,i){const n=this._providers.get(e.id);if(n){throw new Error(`Timeline Provider ${e.id} already exists.`)}this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme});this._providers.set(e.id,{provider:e,extension:i});return ye(()=>{for(const s of this._itemsBySourceAndUriMap.values()){s.get(e.id)?.clear()}this._providers.delete(e.id);this._proxy.$unregisterTimelineProvider(e.id);e.dispose()})}}function DT(t){return t?.toString()}h(4225,"Views");vf("default-view-icon",_e.window,h(4226,"Default view icon."));var k_;(function(t){t.ViewContainersRegistry="workbench.registry.view.containers";t.ViewsRegistry="workbench.registry.view"})(k_||(k_={}));var Bd;(function(t){t[t["Sidebar"]=0]="Sidebar";t[t["Panel"]=1]="Panel";t[t["AuxiliaryBar"]=2]="AuxiliaryBar"})(Bd||(Bd={}));[Bd.Sidebar,Bd.Panel,Bd.AuxiliaryBar];class XB extends me{constructor(){super(...arguments);this._onDidRegister=this._register(new L);this.onDidRegister=this._onDidRegister.event;this._onDidDeregister=this._register(new L);this.onDidDeregister=this._onDidDeregister.event;this.viewContainers=new Map;this.defaultViewContainers=[]}get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,i,n){const s=this.get(e.id);if(s){return s}const r=e;r.openCommandActionDescriptor=n?.doNotRegisterOpenCommand?void 0:r.openCommandActionDescriptor??{id:r.id};const o=K5(this.viewContainers,i,[]);o.push(r);if(n?.isDefault){this.defaultViewContainers.push(r)}this._onDidRegister.fire({viewContainer:r,viewContainerLocation:i});return r}deregisterViewContainer(e){for(const i of this.viewContainers.keys()){const n=this.viewContainers.get(i);const s=n?.indexOf(e);if(s!==-1){n?.splice(s,1);if(n.length===0){this.viewContainers.delete(i)}this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:i});return}}}get(e){return this.all.filter(i=>i.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(i=>this.getViewContainers(i).filter(n=>n?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(i=>this.getViewContainerLocation(i)===e)}}ei.add(k_.ViewContainersRegistry,new XB);var D_;(function(t){t["Open"]="2_open";t["Debug"]="4_debug";t["SCM"]="5_scm";t["More"]="9_more"})(D_||(D_={}));function ZB(t,e){const i=t.group??D_.More;const n=e.group??D_.More;if(i!==n){return i.localeCompare(n)}return(t.order??5)-(e.order??5)}class eW extends me{constructor(){super(...arguments);this._onViewsRegistered=this._register(new L);this.onViewsRegistered=this._onViewsRegistered.event;this._onViewsDeregistered=this._register(new L);this.onViewsDeregistered=this._onViewsDeregistered.event;this._onDidChangeContainer=this._register(new L);this.onDidChangeContainer=this._onDidChangeContainer.event;this._onDidChangeViewWelcomeContent=this._register(new L);this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;this._viewContainers=[];this._views=new Map;this._viewWelcomeContents=new Z5}registerViews(e,i){this.registerViews2([{views:e,viewContainer:i}])}registerViews2(e){e.forEach(({views:i,viewContainer:n})=>this.addViews(i,n));this._onViewsRegistered.fire(e)}deregisterViews(e,i){const n=this.removeViews(e,i);if(n.length){this._onViewsDeregistered.fire({views:n,viewContainer:i})}}moveViews(e,i){for(const n of this._views.keys()){if(n!==i){const s=this.removeViews(e,n);if(s.length){this.addViews(s,i);this._onDidChangeContainer.fire({views:s,from:n,to:i})}}}}getViews(e){return this._views.get(e)||[]}getView(e){for(const i of this._viewContainers){const n=(this._views.get(i)||[]).filter(s=>s.id===e)[0];if(n){return n}}return null}getViewContainer(e){for(const i of this._viewContainers){const n=(this._views.get(i)||[]).filter(s=>s.id===e)[0];if(n){return i}}return null}registerViewWelcomeContent(e,i){this._viewWelcomeContents.add(e,i);this._onDidChangeViewWelcomeContent.fire(e);return ye(()=>{this._viewWelcomeContents.delete(e,i);this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,i){const n=new Map;for(const[s,r]of i){this._viewWelcomeContents.add(e,r);n.set(s,ye(()=>{this._viewWelcomeContents.delete(e,r);this._onDidChangeViewWelcomeContent.fire(e)}))}this._onDidChangeViewWelcomeContent.fire(e);return n}getViewWelcomeContent(e){const i=[];this._viewWelcomeContents.forEach(e,n=>i.push(n));return i.sort(ZB)}addViews(e,i){let n=this._views.get(i);if(!n){n=[];this._views.set(i,n);this._viewContainers.push(i)}for(const s of e){if(this.getView(s.id)!==null){throw new Error(h(4227,"A view with id '{0}' is already registered",s.id))}n.push(s)}}removeViews(e,i){const n=this._views.get(i);if(!n){return[]}const s=[];const r=[];for(const o of n){if(!e.includes(o)){r.push(o)}else{s.push(o)}}if(s.length){if(r.length){this._views.set(i,r)}else{this._views.delete(i);this._viewContainers.splice(this._viewContainers.indexOf(i),1)}}return s}}ei.add(k_.ViewsRegistry,new eW);var IT;(function(t){t[t["Default"]=0]="Default";t[t["Expand"]=1]="Expand"})(IT||(IT={}));var TT;(function(t){t[t["None"]=0]="None";t[t["Collapsed"]=1]="Collapsed";t[t["Expanded"]=2]="Expanded"})(TT||(TT={}));class gr extends Error{constructor(e){super(h(4228,"No tree view with id '{0}' registered.",e));this.name="NoTreeViewError"}static is(e){return!!e&&e.name==="NoTreeViewError"}}class tW{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const i=this._dragOperations.get(e);this._dragOperations.delete(e);return i}return void 0}addDragOperationTransfer(e,i){this._dragOperations.set(e,i)}}function PT(t,e){if(Xe(t)){return{label:t}}if(t&&typeof t==="object"&&t.label){let i=void 0;if(Array.isArray(t.highlights)){i=t.highlights.filter((n=>n.length===2&&typeof n[0]==="number"&&typeof n[1]==="number"));i=i.length?i:void 0}if(Xe(t.label)){return{label:t.label,highlights:i}}else if(rn.isMarkdownString(t.label)){O(e,"treeItemMarkdownLabel");return{label:we.from(t.label),highlights:i}}}return void 0}class iW extends me{constructor(e,i,n){super();this._proxy=e;this._commands=i;this._logService=n;this._treeViews=new Map;this._treeDragAndDropService=new tW;function s(r){return r&&r.$treeViewId&&(r.$treeItemHandle||r.$selectedTreeItems||r.$focusedTreeItem)}i.registerArgumentProcessor({processArgument:r=>{if(s(r)){return this._convertArgument(r)}else if(Array.isArray(r)&&r.length>0){return r.map(o=>{if(s(o)){return this._convertArgument(o)}return o})}return r}})}registerTreeDataProvider(e,i,n){const s=this.createTreeView(e,{treeDataProvider:i},n);return{dispose:()=>s.dispose()}}createTreeView(e,i,n){if(!i||!i.treeDataProvider){throw new Error("Options with treeDataProvider is mandatory")}const s=i.dragAndDropController?.dropMimeTypes??[];const r=i.dragAndDropController?.dragMimeTypes??[];const o=!!i.dragAndDropController?.handleDrag;const a=!!i.dragAndDropController?.handleDrop;const l=this._createExtHostTreeView(e,i,n);const c={showCollapseAll:!!i.showCollapseAll,canSelectMany:!!i.canSelectMany,dropMimeTypes:s,dragMimeTypes:r,hasHandleDrag:o,hasHandleDrop:a,manuallyManageCheckboxes:!!i.manageCheckboxStateManually};const u=this._proxy.$registerTreeViewDataProvider(e,c);const d={get onDidCollapseElement(){return l.onDidCollapseElement},get onDidExpandElement(){return l.onDidExpandElement},get selection(){return l.selectedElements},get onDidChangeSelection(){return l.onDidChangeSelection},get activeItem(){O(n,"treeViewActiveItem");return l.focusedElement},get onDidChangeActiveItem(){O(n,"treeViewActiveItem");return l.onDidChangeActiveItem},get visible(){return l.visible},get onDidChangeVisibility(){return l.onDidChangeVisibility},get onDidChangeCheckboxState(){return l.onDidChangeCheckboxState},get message(){return l.message},set message(f){if(Qo(f)){O(n,"treeViewMarkdownMessage")}l.message=f},get title(){return l.title},set title(f){l.title=f},get description(){return l.description},set description(f){l.description=f},get badge(){return l.badge},set badge(f){if(f!==void 0&&eb.isViewBadge(f)){l.badge={value:Math.floor(Math.abs(f.value)),tooltip:f.tooltip}}else if(f===void 0){l.badge=void 0}},reveal:(f,p)=>{return l.reveal(f,p)},dispose:async()=>{await u;this._treeViews.delete(e);l.dispose()}};this._register(d);return d}async $getChildren(e,i){const n=this._treeViews.get(e);if(!n){return Promise.reject(new gr(e))}if(!i){const r=await n.getChildren();return r?[[0,...r]]:void 0}const s=[];for(let r=0;r<i.length;r++){const o=i[r];const a=await n.getChildren(o);if(a){s.push([r,...a])}}return s}async $handleDrop(e,i,n,s,r,o,a,l){const c=this._treeViews.get(e);if(!c){return Promise.reject(new gr(e))}const u=hu.toDataTransfer(n,async d=>{return(await this._proxy.$resolveDropFileData(e,i,d)).buffer});if(a===e&&l){await this._addAdditionalTransferItems(u,c,l,r,o)}return c.onDrop(u,s,r)}async _addAdditionalTransferItems(e,i,n,s,r){const o=this._treeDragAndDropService.removeDragOperationTransfer(r);if(o){(await o)?.forEach((a,l)=>{if(a){e.set(l,a)}})}else if(r&&i.handleDrag){const a=i.handleDrag(n,e,s);this._treeDragAndDropService.addDragOperationTransfer(r,a);await a}return e}async $handleDrag(e,i,n,s){const r=this._treeViews.get(e);if(!r){return Promise.reject(new gr(e))}const o=await this._addAdditionalTransferItems(new Yc,r,i,s,n);if(!o||s.isCancellationRequested){return}return hu.from(o)}async $hasResolve(e){const i=this._treeViews.get(e);if(!i){throw new gr(e)}return i.hasResolve}$resolve(e,i,n){const s=this._treeViews.get(e);if(!s){throw new gr(e)}return s.resolveTreeItem(i,n)}$setExpanded(e,i,n){const s=this._treeViews.get(e);if(!s){throw new gr(e)}s.setExpanded(i,n)}$setSelectionAndFocus(e,i,n){const s=this._treeViews.get(e);if(!s){throw new gr(e)}s.setSelectionAndFocus(i,n)}$setVisible(e,i){const n=this._treeViews.get(e);if(!n){if(!i){return}throw new gr(e)}n.setVisible(i)}$changeCheckboxState(e,i){const n=this._treeViews.get(e);if(!n){throw new gr(e)}n.setCheckboxState(i)}_createExtHostTreeView(e,i,n){const s=this._register(new oc(e,i,this._proxy,this._commands.converter,this._logService,n));this._treeViews.set(e,s);return s}_convertArgument(e){const i=this._treeViews.get(e.$treeViewId);const n=e;if(i&&n.$treeItemHandle){return i.getExtensionElement(n.$treeItemHandle)}const s=e;if(i&&s.$focusedTreeItem){return i.focusedElement}return null}}class oc extends me{static{this.LABEL_HANDLE_PREFIX="0"}static{this.ID_HANDLE_PREFIX="1"}static{this.ROOT_FETCH_KEY=Symbol("extHostTreeViewRoot")}get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!ai(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,i,n,s,r,o){super();this._viewId=e;this._proxy=n;this._commands=s;this._logService=r;this._extension=o;this._roots=void 0;this._elements=new Map;this._nodes=new Map;this._childrenFetchTokens=new Map;this._globalFetchTokenCounter=0;this._visible=false;this._selectedHandles=[];this._focusedHandle=void 0;this._onDidExpandElement=this._register(new L);this.onDidExpandElement=this._onDidExpandElement.event;this._onDidCollapseElement=this._register(new L);this.onDidCollapseElement=this._onDidCollapseElement.event;this._onDidChangeSelection=this._register(new L);this.onDidChangeSelection=this._onDidChangeSelection.event;this._onDidChangeActiveItem=this._register(new L);this.onDidChangeActiveItem=this._onDidChangeActiveItem.event;this._onDidChangeVisibility=this._register(new L);this.onDidChangeVisibility=this._onDidChangeVisibility.event;this._onDidChangeCheckboxState=this._register(new L);this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event;this._onDidChangeData=this._register(new L);this._refreshPromise=Promise.resolve();this._refreshQueue=Promise.resolve();this._nodesToClear=new Set;this._message="";this._title="";this._refreshCancellationSource=new Tt;if(o.contributes&&o.contributes.views){for(const u in o.contributes.views){for(const d of o.contributes.views[u]){if(d.id===e){this._title=d.name}}}}this._dataProvider=i.treeDataProvider;this._dndController=i.dragAndDropController;if(this._dataProvider.onDidChangeTreeData){this._register(this._dataProvider.onDidChangeTreeData(u=>{if(Array.isArray(u)&&u.length===0){return}this._onDidChangeData.fire({message:false,element:u})}))}let a;let l;const c=wt.debounce(this._onDidChangeData.event,(u,d)=>{if(!u){u={message:false,elements:[]}}if(d.element!==false){if(!a){a=new Promise(f=>l=f);this._refreshPromise=this._refreshPromise.then(()=>a)}if(Array.isArray(d.element)){u.elements.push(...d.element)}else{u.elements.push(d.element)}}if(d.message){u.message=true}return u},200,true);this._register(c(({message:u,elements:d})=>{if(d.length){d=Ea(d);this._refreshQueue=this._refreshQueue.then(()=>{const f=l;a=null;const p=Array.from(this._nodesToClear);this._nodesToClear.clear();this._debugLogRefresh("start",d,p);return this._refresh(d).then(()=>{this._debugLogRefresh("done",d,p);this._clearNodes(p);return f()}).catch(m=>{const v=m instanceof Error?m.message:JSON.stringify(m);this._debugLogRefresh("error",d,p);this._clearNodes(p);this._logService.error(`Unable to refresh tree view ${this._viewId}: ${v}`);return f()})})}if(u){this._proxy.$setMessage(this._viewId,we.fromStrict(this._message)??"")}}))}_debugCollectHandles(e){const i=[];for(const s of e){if(!s){i.push("<root>");continue}const r=this._nodes.get(s);if(r){i.push(r.item.handle)}}const n=this._roots?.map(s=>s.item.handle)??[];return{changed:i,roots:n}}_debugLogRefresh(e,i,n){if(!this._isDebugLogging()){return}try{const s=this._debugCollectHandles(i);s.clearing=n.map(a=>a.item.handle);const r=s.changed.length;const o=n.length;this._logService.debug(`[TreeView:${this._viewId}] refresh ${e} changed=${r} nodesToClear=${o} elements.size=${this._elements.size} nodes.size=${this._nodes.size} handles=${JSON.stringify(s)}`)}catch{this._logService.debug(`[TreeView:${this._viewId}] refresh ${e} (snapshot failed)`)}}_isDebugLogging(){try{const e=this._logService.getLevel();return e===xe.Debug||e===xe.Trace}catch{return false}}async getChildren(e){const i=e?this.getExtensionElement(e):void 0;if(e&&!i){this._logService.error(`No tree item with id '${e}' found.`);return Promise.resolve([])}let n=this._getChildrenNodes(e);if(!n){n=await this._fetchChildrenNodes(i)}return n?n.map(s=>s.item):void 0}getExtensionElement(e){return this._elements.get(e)}reveal(e,i){i=i?i:{select:true,focus:false};const n=ai(i.select)?true:i.select;const s=ai(i.focus)?false:i.focus;const r=ai(i.expand)?false:i.expand;if(typeof this._dataProvider.getParent!=="function"){return Promise.reject(new Error(`Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method`))}if(e){return this._refreshPromise.then(()=>this._resolveUnknownParentChain(e)).then(o=>this._resolveTreeNode(e,o[o.length-1]).then(a=>this._proxy.$reveal(this._viewId,{item:a.item,parentChain:o.map(l=>l.item)},{select:n,focus:s,expand:r})),o=>this._logService.error(o))}else{return this._proxy.$reveal(this._viewId,void 0,{select:n,focus:s,expand:r})}}get message(){return this._message}set message(e){this._message=e;this._onDidChangeData.fire({message:true,element:false})}get title(){return this._title}set title(e){this._title=e;this._proxy.$setTitle(this._viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e;this._proxy.$setTitle(this._viewId,this._title,e)}get badge(){return this._badge}set badge(e){if(this._badge?.value===e?.value&&this._badge?.tooltip===e?.tooltip){return}this._badge=Um.from(e);this._proxy.$setBadge(this._viewId,e)}setExpanded(e,i){const n=this.getExtensionElement(e);if(n){if(i){this._onDidExpandElement.fire(Object.freeze({element:n}))}else{this._onDidCollapseElement.fire(Object.freeze({element:n}))}}}setSelectionAndFocus(e,i){const n=!mn(this._selectedHandles,e);this._selectedHandles=e;const s=this._focusedHandle!==i;this._focusedHandle=i;if(n){this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements}))}if(s){this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}}setVisible(e){if(e!==this._visible){this._visible=e;this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible}))}}async setCheckboxState(e){const i=(await Promise.all(e.map(async n=>{const s=this.getExtensionElement(n.treeItemHandle);if(s){return{extensionItem:s,treeItem:await this._dataProvider.getTreeItem(s),newState:n.newState?Js.Checked:Js.Unchecked}}return Promise.resolve(void 0)}))).filter(n=>n!==void 0);i.forEach(n=>{n.treeItem.checkboxState=n.newState?Js.Checked:Js.Unchecked});this._onDidChangeCheckboxState.fire({items:i.map(n=>[n.extensionItem,n.newState])})}async handleDrag(e,i,n){const s=[];for(const r of e){const o=this.getExtensionElement(r);if(o){s.push(o)}}if(!this._dndController?.handleDrag||s.length===0){return}await this._dndController.handleDrag(s,i,n);return i}get hasHandleDrag(){return!!this._dndController?.handleDrag}async onDrop(e,i,n){const s=i?this.getExtensionElement(i):void 0;if(!s&&i||!this._dndController?.handleDrop){return}return Hi(()=>this._dndController?.handleDrop?this._dndController.handleDrop(s,e,n):void 0)}get hasResolve(){return!!this._dataProvider.resolveTreeItem}async resolveTreeItem(e,i){if(!this._dataProvider.resolveTreeItem){return}const n=this._elements.get(e);if(n){const s=this._nodes.get(n);if(s){const r=await this._dataProvider.resolveTreeItem(s.extensionItem,n,i)??s.extensionItem;this._validateTreeItem(r);s.item.tooltip=this._getTooltip(r.tooltip);s.item.command=this._getCommand(s.disposableStore,r.command);return s.item}}return}_resolveUnknownParentChain(e){return this._resolveParent(e).then(i=>{if(!i){return Promise.resolve([])}return this._resolveUnknownParentChain(i).then(n=>this._resolveTreeNode(i,n[n.length-1]).then(s=>{n.push(s);return n}))})}_resolveParent(e){const i=this._nodes.get(e);if(i){return Promise.resolve(i.parent?this._elements.get(i.parent.item.handle):void 0)}return Hi(()=>this._dataProvider.getParent(e))}async _resolveTreeNode(e,i){const n=this._nodes.get(e);if(n){return n}const s=await Hi(()=>this._dataProvider.getTreeItem(e));const r=this._createHandle(e,s,i,true);const o=await this.getChildren(i?i.item.handle:void 0);if(o===void 0){this._logService.warn(`[${this._viewId}] Concurrent refresh detected in _resolveTreeNode for element ${r} from extension ${this._extension.identifier.value}, waiting for refresh to complete`);this._proxy.$logResolveTreeNodeRetry(this._extension.identifier.value,1,false);await this._refreshPromise;const l=this.getExtensionElement(r);if(l){const c=this._nodes.get(l);if(c){return c}}this._proxy.$logResolveTreeNodeRetry(this._extension.identifier.value,1,true);throw new Error(`Cannot resolve tree item for element ${r} from extension ${this._extension.identifier.value}`)}const a=this.getExtensionElement(r);if(a){const l=this._nodes.get(a);if(l){return l}}throw new Error(`Cannot resolve tree item for element ${r} from extension ${this._extension.identifier.value}`)}_getChildrenNodes(e){if(e){let i;if(typeof e==="string"){const n=this.getExtensionElement(e);i=n?this._nodes.get(n):void 0}else{i=e}return i?i.children||void 0:void 0}return this._roots}_getFetchKey(e){return e??oc.ROOT_FETCH_KEY}async _fetchChildrenNodes(e){this._addChildrenToClear(e);const i=this._getFetchKey(e);const n=++this._globalFetchTokenCounter;this._childrenFetchTokens.set(i,n);const s=new Tt(this._refreshCancellationSource.token);try{const r=await this._dataProvider.getChildren(e);if(this._childrenFetchTokens.get(i)!==n){return void 0}const o=e?this._nodes.get(e):void 0;if(s.token.isCancellationRequested){return void 0}const a=zt(r||[]);const l=await Promise.all(zt(a).map(u=>{return this._dataProvider.getTreeItem(u)}));if(this._childrenFetchTokens.get(i)!==n){return void 0}if(s.token.isCancellationRequested){return void 0}const c=l.map((u,d)=>u?this._createAndRegisterTreeNode(a[d],u,o):null);if(this._childrenFetchTokens.get(i)!==n){return void 0}return zt(c)}finally{s.dispose()}}_refresh(e){const i=e.some(n=>!n);if(i){this._refreshCancellationSource.dispose(true);this._refreshCancellationSource=new Tt;this._addChildrenToClear();return this._proxy.$refresh(this._viewId)}else{const n=this._getHandlesToRefresh(e);if(n.length){return this._refreshHandles(n)}}return Promise.resolve(void 0)}_getHandlesToRefresh(e){const i=new Set;const n=e.map(r=>this._nodes.get(r));for(const r of n){if(r&&!i.has(r.item.handle)){let o=r;while(o&&o.parent&&n.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1){const a=this._elements.get(o.parent.item.handle);o=a?this._nodes.get(a):void 0}if(o&&!o.parent){i.add(r.item.handle)}}}const s=[];i.forEach(r=>{const o=this._elements.get(r);if(o){const a=this._nodes.get(o);if(a&&(!a.parent||!i.has(a.parent.item.handle))){s.push(r)}}});return s}_refreshHandles(e){const i={};return Promise.all(e.map(n=>this._refreshNode(n).then(s=>{if(s){i[n]=s.item}}))).then(()=>Object.keys(i).length?this._proxy.$refresh(this._viewId,i):void 0)}_refreshNode(e){const i=this.getExtensionElement(e);if(i){const n=this._nodes.get(i);if(n){this._addChildrenToClear(i);return Hi(()=>this._dataProvider.getTreeItem(i)).then(s=>{if(s){const r=this._createTreeNode(i,s,n.parent);this._updateNodeCache(i,r,n,n.parent);n.dispose();return r}return null})}}return Promise.resolve(null)}_createAndRegisterTreeNode(e,i,n){const s=i.id?`${oc.ID_HANDLE_PREFIX}/${i.id}`:void 0;if(s){const o=this._elements.get(s);if(o){if(o!==e){throw new Error(h(2707,"Element with id {0} is already registered",i.id))}const a=this._nodes.get(o);if(a){const l=this._createTreeNode(e,i,n);this._updateNodeCache(e,l,a,n);a.dispose();return l}}}const r=this._createTreeNode(e,i,n);this._addNodeToCache(e,r);this._addNodeToParentCache(r,n);return r}_getTooltip(e){if(rn.isMarkdownString(e)){return we.from(e)}return e}_getCommand(e,i){return i?{...this._commands.toInternal(i,e),originalId:i.command}:void 0}_getCheckbox(e){if(e.checkboxState===void 0){return void 0}let i;let n=void 0;let s=void 0;if(typeof e.checkboxState==="number"){i=e.checkboxState}else{i=e.checkboxState.state;n=e.checkboxState.tooltip;s=e.checkboxState.accessibilityInformation}return{isChecked:i===Js.Checked,tooltip:n,accessibilityInformation:s}}_validateTreeItem(e){if(!Qg.isTreeItem(e,this._extension)){throw new Error(`Extension ${this._extension.identifier.value} has provided an invalid tree item.`)}}_createTreeNode(e,i,n){this._validateTreeItem(i);const s=this._register(new pe);const r=this._createHandle(e,i,n);const o=this._getLightIconPath(i);const a={handle:r,parentHandle:n?n.item.handle:void 0,label:PT(i.label,this._extension),description:i.description,resourceUri:i.resourceUri,tooltip:this._getTooltip(i.tooltip),command:this._getCommand(s,i.command),contextValue:i.contextValue,icon:o,iconDark:this._getDarkIconPath(i)||o,themeIcon:this._getThemeIcon(i),collapsibleState:ai(i.collapsibleState)?Qa.None:i.collapsibleState,accessibilityInformation:i.accessibilityInformation,checkbox:this._getCheckbox(i)};return{item:a,extensionItem:i,parent:n,children:void 0,disposableStore:s,dispose(){s.dispose()}}}_getThemeIcon(e){return e.iconPath instanceof _n?e.iconPath:void 0}_createHandle(e,{id:i,label:n,resourceUri:s},r,o){if(i){return`${oc.ID_HANDLE_PREFIX}/${i}`}const a=PT(n,this._extension);const l=r?r.item.handle:oc.LABEL_HANDLE_PREFIX;let c="";if(a){if(Qo(a.label)){c=a.label.value}else{c=a.label}}let u=c||(s?ts(s):"");u=u.indexOf("/")!==-1?u.replace("/","//"):u;const d=this._nodes.has(e)?this._nodes.get(e).item.handle:void 0;const f=this._getChildrenNodes(r)||[];let p;let m=0;do{p=`${l}/${m}:${u}`;if(o||!this._elements.has(p)||d===p){break}m++}while(m<=f.length);return p}_getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof _n)){if(typeof e.iconPath==="string"||b.isUri(e.iconPath)){return this._getIconPath(e.iconPath)}return this._getIconPath(e.iconPath.light)}return void 0}_getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof _n)&&e.iconPath.dark){return this._getIconPath(e.iconPath.dark)}return void 0}_getIconPath(e){if(b.isUri(e)){return e}return b.file(e)}_addNodeToCache(e,i){this._elements.set(i.item.handle,e);this._nodes.set(e,i)}_updateNodeCache(e,i,n,s){this._elements.delete(i.item.handle);this._nodes.delete(e);if(i.item.handle!==n.item.handle){this._elements.delete(n.item.handle)}this._addNodeToCache(e,i);const r=this._getChildrenNodes(s)||[];const o=r.filter(a=>a.item.handle===n.item.handle)[0];if(o){r.splice(r.indexOf(o),1,i)}}_addNodeToParentCache(e,i){if(i){if(!i.children){i.children=[]}i.children.push(e)}else{if(!this._roots){this._roots=[]}this._roots.push(e)}}_addChildrenToClear(e){if(e){const i=this._nodes.get(e);if(i){if(i.children){for(const n of i.children){this._nodesToClear.add(n);const s=this._elements.get(n.item.handle);if(s){this._addChildrenToClear(s);this._nodes.delete(s);this._elements.delete(n.item.handle)}}}i.children=void 0}}else{this._addAllToClear()}}_addAllToClear(){this._roots=void 0;this._nodes.forEach(e=>{this._nodesToClear.add(e)});this._nodes.clear();this._elements.clear();this._childrenFetchTokens.clear()}_clearNodes(e){Jn(e)}_clearAll(){this._roots=void 0;this._elements.clear();Jn(this._nodes.values());this._nodes.clear();Jn(this._nodesToClear);this._nodesToClear.clear();this._childrenFetchTokens.clear()}dispose(){super.dispose();this._refreshCancellationSource.dispose();this._clearAll();this._proxy.$disposeTree(this._viewId)}}class Zx{static{this.supportedSchemes=new Set([ne.http,ne.https])}constructor(e){this._openers=new Map;this._proxy=e.getProxy(ee.MainThreadUriOpeners)}registerExternalUriOpener(e,i,n,s){if(this._openers.has(i)){throw new Error(`Opener with id '${i}' already registered`)}const r=s.schemes.find(o=>!Zx.supportedSchemes.has(o));if(r){throw new Error(`Scheme '${r}' is not supported. Only http and https are currently supported.`)}this._openers.set(i,n);this._proxy.$registerUriOpener(i,s.schemes,e,s.label);return ye(()=>{this._openers.delete(i);this._proxy.$unregisterUriOpener(i)})}async $canOpenUri(e,i,n){const s=this._openers.get(e);if(!s){throw new Error(`Unknown opener with id: ${e}`)}const r=b.revive(i);return s.canOpenExternalUri(r,n)}async $openUri(e,i,n){const s=this._openers.get(e);if(!s){throw new Error(`Unknown opener id: '${e}'`)}return s.openExternalUri(b.revive(i.resolvedUri),{sourceUri:b.revive(i.sourceUri)},n)}}class nW extends me{#e;#t;#i;#n;#o;#r;#l;#a;#c;#u;#s;#h;#d;constructor(e,i,n,s){super();this.#a=void 0;this.#c=true;this.#s=false;this.#h=this._register(new L);this.onDidDispose=this.#h.event;this.#d=this._register(new L);this.onDidChangeViewState=this.#d.event;this.#e=e;this.#t=i;this.#n=n;this.#i=s.viewType;this.#o=s.panelOptions;this.#a=s.viewColumn;this.#r=s.title;this.#u=s.active}dispose(){if(this.#s){return}this.#s=true;this.#h.fire();this.#t.$disposeWebview(this.#e);this.#n.dispose();super.dispose()}get webview(){this.assertNotDisposed();return this.#n}get viewType(){this.assertNotDisposed();return this.#i}get title(){this.assertNotDisposed();return this.#r}set title(e){this.assertNotDisposed();if(this.#r!==e){this.#r=e;this.#t.$setTitle(this.#e,e)}}get iconPath(){this.assertNotDisposed();return this.#l}set iconPath(e){this.assertNotDisposed();if(this.#l!==e){this.#l=e;if(b.isUri(e)){this.#t.$setIconPath(this.#e,{light:e,dark:e})}else{this.#t.$setIconPath(this.#e,e)}}}get options(){return this.#o}get viewColumn(){this.assertNotDisposed();if(typeof this.#a==="number"&&this.#a<0){return void 0}return this.#a}get active(){this.assertNotDisposed();return this.#u}get visible(){this.assertNotDisposed();return this.#c}_updateViewState(e){if(this.#s){return}if(this.active!==e.active||this.visible!==e.visible||this.viewColumn!==e.viewColumn){this.#u=e.active;this.#c=e.visible;this.#a=e.viewColumn;this.#d.fire({webviewPanel:this})}}reveal(e,i){this.assertNotDisposed();this.#t.$reveal(this.#e,{viewColumn:typeof e==="undefined"?void 0:_i.from(e),preserveFocus:!!i})}assertNotDisposed(){if(this.#s){throw new Error("Webview is disposed")}}}class eE extends me{static newHandle(){return Pi()}constructor(e,i,n){super();this.webviews=i;this.workspace=n;this._webviewPanels=new Map;this._serializers=new Map;this._proxy=e.getProxy(ee.MainThreadWebviewPanels)}dispose(){super.dispose();this._webviewPanels.forEach(e=>e.dispose());this._webviewPanels.clear()}createWebviewPanel(e,i,n,s,r={}){const o=typeof s==="object"?s.viewColumn:s;const a={viewColumn:_i.from(o),preserveFocus:typeof s==="object"&&!!s.preserveFocus};const l=mu(e);const c=eE.newHandle();this._proxy.$createWebviewPanel(w_(e),c,i,{title:n,panelOptions:sW(r),webviewOptions:x5(e,this.workspace,r),serializeBuffersForPostMessage:l},a);const u=this.webviews.createNewWebview(c,r,e);const d=this.createNewWebviewPanel(c,i,n,o,r,u,true);return d}$onDidChangeWebviewPanelViewStates(e){const i=Object.keys(e);i.sort((n,s)=>{const r=e[n];const o=e[s];if(r.active){return 1}if(o.active){return-1}return+r.visible-+o.visible});for(const n of i){const s=this.getWebviewPanel(n);if(!s){continue}const r=e[n];s._updateViewState({active:r.active,visible:r.visible,viewColumn:_i.to(r.position)})}}async $onDidDisposeWebviewPanel(e){const i=this.getWebviewPanel(e);i?.dispose();this._webviewPanels.delete(e);this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,i,n){if(this._serializers.has(i)){throw new Error(`Serializer for '${i}' already registered`)}this._serializers.set(i,{serializer:n,extension:e});this._proxy.$registerSerializer(i,{serializeBuffersForPostMessage:mu(e)});return new Ve(()=>{this._serializers.delete(i);this._proxy.$unregisterSerializer(i)})}async $deserializeWebviewPanel(e,i,n,s){const r=this._serializers.get(i);if(!r){throw new Error(`No serializer found for '${i}'`)}const{serializer:o,extension:a}=r;const l=this.webviews.createNewWebview(e,n.webviewOptions,a);const c=this.createNewWebviewPanel(e,i,n.title,s,n.panelOptions,l,n.active);await o.deserializeWebviewPanel(c,n.state)}createNewWebviewPanel(e,i,n,s,r,o,a){const l=new nW(e,this._proxy,o,{viewType:i,title:n,viewColumn:s,panelOptions:r,active:a});this._webviewPanels.set(e,l);return l}getWebviewPanel(e){return this._webviewPanels.get(e)}}function sW(t){return{enableFindWidget:t.enableFindWidget,retainContextWhenHidden:t.retainContextWhenHidden}}class rW extends me{#e;#t;#i;#n;#o;#r;#l;#a;#c;constructor(e,i,n,s,r,o){super();this.#o=false;this.#u=this._register(new L);this.onDidChangeVisibility=this.#u.event;this.#s=this._register(new L);this.onDidDispose=this.#s.event;this.#i=n;this.#l=s;this.#e=e;this.#t=i;this.#n=r;this.#r=o}dispose(){if(this.#o){return}this.#o=true;this.#s.fire();this.#n.dispose();super.dispose()}#u;#s;get title(){this.assertNotDisposed();return this.#l}set title(e){this.assertNotDisposed();if(this.#l!==e){this.#l=e;this.#t.$setWebviewViewTitle(this.#e,e)}}get description(){this.assertNotDisposed();return this.#a}set description(e){this.assertNotDisposed();if(this.#a!==e){this.#a=e;this.#t.$setWebviewViewDescription(this.#e,e)}}get visible(){return this.#r}get webview(){return this.#n}get viewType(){return this.#i}_setVisible(e){if(e===this.#r||this.#o){return}this.#r=e;this.#u.fire()}get badge(){this.assertNotDisposed();return this.#c}set badge(e){this.assertNotDisposed();if(e?.value===this.#c?.value&&e?.tooltip===this.#c?.tooltip){return}this.#c=Um.from(e);this.#t.$setWebviewViewBadge(this.#e,e)}show(e){this.assertNotDisposed();this.#t.$show(this.#e,!!e)}assertNotDisposed(){if(this.#o){throw new Error("Webview is disposed")}}}class oW{constructor(e,i){this._extHostWebview=i;this._viewProviders=new Map;this._webviewViews=new Map;this._proxy=e.getProxy(ee.MainThreadWebviewViews)}registerWebviewViewProvider(e,i,n,s){if(this._viewProviders.has(i)){throw new Error(`View provider for '${i}' already registered`)}this._viewProviders.set(i,{provider:n,extension:e});this._proxy.$registerWebviewViewProvider(w_(e),i,{retainContextWhenHidden:s?.retainContextWhenHidden,serializeBuffersForPostMessage:mu(e)});return new Ve(()=>{this._viewProviders.delete(i);this._proxy.$unregisterWebviewViewProvider(i)})}async $resolveWebviewView(e,i,n,s,r){const o=this._viewProviders.get(i);if(!o){throw new Error(`No view provider found for '${i}'`)}const{provider:a,extension:l}=o;const c=this._extHostWebview.createNewWebview(e,{},l);const u=new rW(e,this._proxy,i,n,c,true);this._webviewViews.set(e,u);await a.resolveWebviewView(u,{state:s},r)}async $onDidChangeWebviewViewVisibility(e,i){const n=this.getWebviewView(e);n._setVisible(i)}async $disposeWebviewView(e){const i=this.getWebviewView(e);this._webviewViews.delete(e);i.dispose();this._extHostWebview.deleteWebview(e)}getWebviewView(e){const i=this._webviewViews.get(e);if(!i){throw new Error("No webview found")}return i}}let uS=class Lq extends me{constructor(e,i){super();this._commands=i;this._handlePool=0;this._providers=new Map;this._itemPool=0;this._globalItems=new Map;this._providerItems=new Map;this._proxy=e.getProxy(ee.MainThreadChatContext)}async $provideWorkspaceChatContext(e,i){this._clearProviderItems(e);const n=this._providers.get(e);if(!n||n.type!=="workspace"){throw new Error("Workspace context provider not found")}const s=n.provider;const r=await s.provideChatContext(i)??[];return this._convertItems(e,r)}async $provideExplicitChatContext(e,i){this._clearProviderItems(e);const n=this._providers.get(e);if(!n||n.type!=="explicit"){throw new Error("Explicit context provider not found")}const s=n.provider;const r=await s.provideChatContext(i)??[];return this._convertItems(e,r)}async $resolveExplicitChatContext(e,i,n){const s=this._providers.get(e);if(!s||s.type!=="explicit"){throw new Error("Explicit context provider not found")}const r=s.provider;const o=this._globalItems.get(i.handle);if(!o){throw new Error("Chat context item not found")}return this._doResolve(r.resolveChatContext.bind(r),i,o,n)}async $provideResourceChatContext(e,i,n){const s=this._providers.get(e);if(!s||s.type!=="resource"){throw new Error("Resource context provider not found")}const r=s.provider;const o=await r.provideChatContext({resource:b.revive(i.resource)},n);if(!o){return void 0}const a=this._addTrackedItem(e,o);const l={handle:a,icon:o.icon,label:o.label,modelDescription:o.modelDescription,tooltip:o.tooltip?we.from(o.tooltip):void 0,value:i.withValue?o.value:void 0,command:o.command?{id:o.command.command}:void 0};if(i.withValue&&!l.value){const c=await r.resolveChatContext(o,n);l.value=c?.value;l.tooltip=c?.tooltip?we.from(c.tooltip):l.tooltip}return l}async $resolveResourceChatContext(e,i,n){const s=this._providers.get(e);if(!s||s.type!=="resource"){throw new Error("Resource context provider not found")}const r=s.provider;const o=this._globalItems.get(i.handle);if(!o){throw new Error("Chat context item not found")}return this._doResolve(r.resolveChatContext.bind(r),i,o,n)}async $executeChatContextItemCommand(e){const i=this._globalItems.get(e);if(!i){throw new Error("Chat context item not found")}if(!i.command){throw new Error("Chat context item has no command")}const n=i.command.arguments?[i,...i.command.arguments]:[i];await this._commands.executeCommand(i.command.command,...n)}registerChatWorkspaceContextProvider(e,i){const n=this._handlePool++;const s=new pe;this._providers.set(n,{type:"workspace",provider:i,disposables:s});this._listenForWorkspaceContextChanges(n,i,s);this._proxy.$registerChatWorkspaceContextProvider(n,e);return{dispose:()=>{this._providers.delete(n);this._clearProviderItems(n);this._providerItems.delete(n);this._proxy.$unregisterChatContextProvider(n);s.dispose()}}}registerChatExplicitContextProvider(e,i){const n=this._handlePool++;const s=new pe;this._providers.set(n,{type:"explicit",provider:i,disposables:s});this._proxy.$registerChatExplicitContextProvider(n,e);return{dispose:()=>{this._providers.delete(n);this._clearProviderItems(n);this._providerItems.delete(n);this._proxy.$unregisterChatContextProvider(n);s.dispose()}}}registerChatResourceContextProvider(e,i,n){const s=this._handlePool++;const r=new pe;this._providers.set(s,{type:"resource",provider:n,disposables:r});this._proxy.$registerChatResourceContextProvider(s,i,hl.from(e));return{dispose:()=>{this._providers.delete(s);this._clearProviderItems(s);this._providerItems.delete(s);this._proxy.$unregisterChatContextProvider(s);r.dispose()}}}registerChatContextProvider(e,i,n){const s=[];if(n.provideWorkspaceChatContext){const r={onDidChangeWorkspaceChatContext:n.onDidChangeWorkspaceChatContext,provideChatContext:o=>n.provideWorkspaceChatContext(o)};s.push(this.registerChatWorkspaceContextProvider(i,r))}if(n.provideChatContextExplicit){const r={provideChatContext:o=>n.provideChatContextExplicit(o),resolveChatContext:n.resolveChatContext?(o,a)=>n.resolveChatContext(o,a):o=>o};s.push(this.registerChatExplicitContextProvider(i,r))}if(n.provideChatContextForResource&&e){const r={provideChatContext:(o,a)=>n.provideChatContextForResource(o,a),resolveChatContext:n.resolveChatContext?(o,a)=>n.resolveChatContext(o,a):o=>o};s.push(this.registerChatResourceContextProvider(e,i,r))}return{dispose:()=>{for(const r of s){r.dispose()}}}}_clearProviderItems(e){const i=this._providerItems.get(e);if(i){for(const n of i){this._globalItems.delete(n)}i.clear()}}_addTrackedItem(e,i){const n=this._itemPool++;this._globalItems.set(n,i);if(!this._providerItems.has(e)){this._providerItems.set(e,new Set)}this._providerItems.get(e).add(n);return n}_convertItems(e,i){const n=[];for(const s of i){const r=this._addTrackedItem(e,s);n.push({handle:r,icon:s.icon,label:s.label,modelDescription:s.modelDescription,tooltip:s.tooltip?we.from(s.tooltip):void 0,value:s.value,command:s.command?{id:s.command.command}:void 0})}return n}async _doResolve(e,i,n,s){const r=await e(n,s);if(r){return{handle:i.handle,icon:r.icon,label:r.label,modelDescription:r.modelDescription,tooltip:r.tooltip?we.from(r.tooltip):void 0,value:r.value,command:r.command?{id:r.command.command}:void 0}}return i}_listenForWorkspaceContextChanges(e,i,n){if(!i.onDidChangeWorkspaceChatContext){return}const s=async()=>{const r=await i.provideChatContext(Ze.None);const o=this._convertItems(e,r??[]);return this._proxy.$updateWorkspaceContextItems(e,o)};n.add(i.onDidChangeWorkspaceChatContext(async()=>s()));s()}dispose(){super.dispose();for(const{disposables:e}of this._providers.values()){e.dispose()}}};uS=W([P(0,st),P(1,Zo)],uS);function aW(t){const e=t.get(wi);const i=t.get(bu);const n=t.get(Z_);const s=t.get(ea);const r=t.get(ur);const o=t.get(ev);const a=t.get(jr);const l=t.get(P_);const c=t.get(st);const u=t.get(wx);const d=t.get(bx);const f=t.get(Ko);const p=t.get(et);const m=t.get(yx);const v=t.get(_f);const y=t.get(tv);const k=t.get(iv);const S=t.get(Ix);const R=t.get(wf);const K=t.get(Px);const q=t.get(nv);const se=t.get(Cx);const j=t.get(kx);const Q=t.get(N0);const le=t.get(g5);c.set(ge.ExtHostFileSystemInfo,i);c.set(ge.ExtHostLogLevelServiceShape,f);c.set(ge.ExtHostWorkspace,r);c.set(ge.ExtHostConfiguration,a);c.set(ge.ExtHostExtensionService,s);c.set(ge.ExtHostStorage,u);c.set(ge.ExtHostTunnelService,m);c.set(ge.ExtHostWindow,y);c.set(ge.ExtHostUrls,k);c.set(ge.ExtHostSecretState,S);c.set(ge.ExtHostTelemetry,o);c.set(ge.ExtHostEditorTabs,R);c.set(ge.ExtHostManagedSockets,K);c.set(ge.ExtHostProgress,q);c.set(ge.ExtHostAuthentication,se);c.set(ge.ExtHostChatProvider,j);c.set(ge.ExtHostDataChannels,le);const Re=c.set(ge.ExtHostDecorations,t.get(n5));const Ne=c.set(ge.ExtHostDocumentsAndEditors,t.get(Iu));const He=c.set(ge.ExtHostCommands,t.get(Zo));const Z=c.set(ge.ExtHostTerminalService,t.get(Du));const Y=c.set(ge.ExtHostTerminalShellIntegration,t.get(p5));const J=c.set(ge.ExtHostDebugService,t.get(u5));const re=c.set(ge.ExtHostSearch,t.get(f5));const ce=c.set(ge.ExtHostTask,t.get(o5));const Le=c.set(ge.ExtHostOutputService,t.get(i5));const qe=c.set(ge.ExtHostLocalization,t.get(Tx));const ze=c.set(ge.ExtHostDocuments,new oH(c,Ne));const ct=c.set(ge.ExtHostDocumentContentProviders,new Fx(c,Ne,p));const Lt=c.set(ge.ExtHostDocumentSaveParticipant,new rH(p,ze,c.getProxy(ee.MainThreadBulkEdits)));const Ke=c.set(ge.ExtHostNotebook,new sc(c,He,Ne,ze,n,re,p));const Ht=c.set(ge.ExtHostNotebookDocuments,new RB(Ke));const bi=c.set(ge.ExtHostNotebookEditors,new oS(p,Ke));const ti=c.set(ge.ExtHostNotebookKernels,new aS(c,e,Ke,He,p));const Us=c.set(ge.ExtHostNotebookRenderers,new OB(c,Ke));const is=c.set(ge.ExtHostNotebookDocumentSaveParticipant,new AB(p,Ke,c.getProxy(ee.MainThreadBulkEdits)));const Qi=c.set(ge.ExtHostEditors,new JB(c,Ne));const Pu=c.set(ge.ExtHostTreeViews,new iW(c.getProxy(ee.MainThreadTreeViews),He,p));const bf=c.set(ge.ExtHostEditorInsets,new F$(c.getProxy(ee.MainThreadEditorInsets),Qi,e.remote));const Gr=c.set(ge.ExtHostDiagnostics,new z0(c,p,i,Ne));const Vn=c.set(ge.ExtHostLanguages,new cB(c,ze,He.converter,l));const Be=c.set(ge.ExtHostLanguageFeatures,new hi(c,l,ze,He,Gr,p,v,o));const uv=c.set(ge.ExtHostCodeMapper,new Ox(c));const dv=c.set(ge.ExtHostFileSystem,new S_(c,Be));const tt=c.set(ge.ExtHostFileSystemEventService,new mH(c,p,Ne));const ta=c.set(ge.ExtHostQuickOpen,UB(c,r,He));const yf=c.set(ge.ExtHostSCM,new lS(c,He,ze,p));const Sf=c.set(ge.ExtHostQuickDiff,new Qx(c,l));const Kr=c.set(ge.ExtHostShare,new Yx(c,l));const hv=c.set(ge.ExtHostComments,U$(c,He,ze));const fv=c.set(ge.ExtHostLabelService,new vH(c));const xf=c.set(ge.ExtHostTheming,new cS(c));const pv=c.set(ge.ExtHostTimeline,new YB(c,He));const bn=c.set(ge.ExtHostWebviews,new K$(c,e.remote,r,p,v));const Au=c.set(ge.ExtHostWebviewPanels,new eE(c,bn,r));const gv=c.set(ge.ExtHostCustomEditors,new eH(c,ze,d,bn,Au));const mv=c.set(ge.ExtHostWebviewViews,new oW(c,bn));const Qr=c.set(ge.ExtHostTesting,t.get(ov));const Dl=c.set(ge.ExtHostUriOpeners,new Zx(c));const Il=c.set(ge.ExtHostProfileContentHandlers,new FB(c));const Ru=c.set(ge.ExtHostChatOutputRenderer,new I$(c,bn));c.set(ge.ExtHostInteractive,new _H(c,Ke,Ne,He,p));const Jr=c.set(ge.ExtHostLanguageModelTools,new lB(c,j));const ia=c.set(ge.ExtHostChatSessions,new W0(He,j,c,p));const yn=c.set(ge.ExtHostChatAgents2,new ic(c,p,He,ze,Ne,j,Gr,Jr));const dr=c.set(ge.ExtHostChatContext,new uS(c,He));const on=c.set(ge.ExtHostAiRelatedInformation,new v$(c));const na=c.set(ge.ExtHostAiEmbeddingVector,new lH(c));const Qt=c.set(ge.ExtHostAiSettingsSearch,new w$(c));const Ef=c.set(ge.ExtHostStatusBar,new QB(c,He.converter));const _v=c.set(ge.ExtHostSpeech,new Xx(c));const ui=c.set(ge.ExtHostEmbeddings,new aH(c));c.set(ge.ExtHostMcp,t.get(N0));const vv=Object.values(ge);c.assertRegistered(vv);const wv=new $0(c,Ne);const bv=new N$(c);const Lu=new iS(c,p);const Cf=new sH(c);const yv=new R$(c);E$.register(He);return function(x,$s,Nu){function fe(_){return(w,I,ke)=>{const ot=_(Jt=>{try{w.call(I,Jt)}catch(H5){S1(new D4(x.identifier,H5,"FAILED to handle event"))}});ke?.push(ot);return ot}}const pt=(function(){let _=!x.isUnderDevelopment;function w(){if(!_){p.info(`Extension '${x.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`);_=true}}return function I(ke){if(Array.isArray(ke)){ke.forEach(I)}else if(typeof ke==="string"){w()}else{const ot=ke;if(typeof ot.scheme==="undefined"){w()}if(typeof ot.exclusive==="boolean"){O(x,"documentFiltersExclusive")}}return ke}})();const Sv={getSession(_,w,I){if(typeof I?.forceNewSession==="object"&&I.forceNewSession.learnMore||typeof I?.createIfNone==="object"&&I.createIfNone.learnMore){O(x,"authLearnMore")}if(I?.authorizationServer){O(x,"authIssuers")}return se.getSession(x,_,w,I)},getAccounts(_){return se.getAccounts(_)},async hasSession(_,w){O(x,"authSession");return!!await se.getSession(x,_,w,{silent:true})},get onDidChangeSessions(){return fe(se.getExtensionScopedSessionsEvent(x.identifier.value))},registerAuthenticationProvider(_,w,I,ke){if(ke?.supportedAuthorizationServers){O(x,"authIssuers")}return se.registerAuthenticationProvider(_,w,I,ke)}};const xv={registerCommand(_,w,I){return He.registerCommand(true,_,w,I,void 0,x)},registerTextEditorCommand(_,w,I){return He.registerCommand(true,_,(...ke)=>{const ot=Qi.getActiveTextEditor();if(!ot){p.warn("Cannot execute "+_+" because there is no active text editor.");return void 0}return ot.edit(Jt=>{w.apply(I,[ot,Jt,...ke])}).then(Jt=>{if(!Jt){p.warn("Edits from command "+_+" were not applied.")}},Jt=>{p.warn("An error occurred while running command "+_,Jt)})},void 0,void 0,x)},registerDiffInformationCommand:(_,w,I)=>{O(x,"diffCommand");return He.registerCommand(true,_,async(...ke)=>{const ot=Ne.activeEditor(true);if(!ot){p.warn("Cannot execute "+_+" because there is no active text editor.");return void 0}const Jt=await Qi.getDiffInformation(ot.id);w.apply(I,[Jt,...ke])},void 0,void 0,x)},executeCommand(_,...w){return He.executeCommand(_,...w)},getCommands(_=false){return He.getCommands(_)}};const Ev={get machineId(){return e.telemetryInfo.machineId},get devDeviceId(){O(x,"devDeviceId");return e.telemetryInfo.devDeviceId??e.telemetryInfo.machineId},get isAppPortable(){O(x,"envIsAppPortable");return e.environment.isPortable??false},get sessionId(){return e.telemetryInfo.sessionId},get language(){return e.environment.appLanguage},get appName(){return e.environment.appName},get appRoot(){return e.environment.appRoot?.fsPath??""},get appHost(){return e.environment.appHost},get uriScheme(){return e.environment.appUriScheme},get clipboard(){return bv.value},get shell(){return Z.getDefaultShell(false)},get onDidChangeShell(){return fe(Z.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return fe(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){O(x,"telemetry");return o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){O(x,"telemetry");return fe(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return BA(e.telemetryInfo.firstSessionDate)},createTelemetryLogger(_,w){HA.validateSender(_);return o.instantiateLogger(x,_,w)},async openExternal(_,w){return y.openUri(_,{allowTunneling:e.remote.isRemote??(e.remote.authority?await m.hasTunnelProvider():false),allowContributedOpeners:w?.allowContributedOpeners})},async asExternalUri(_){if(_.scheme===e.environment.appUriScheme){return k.createAppUri(_)}try{return await y.asExternalUri(_,{allowTunneling:!!e.remote.authority})}catch(w){if(O1(_,ne.http)||O1(_,ne.https)){return _}throw w}},get remoteName(){return k4(e.remote.authority)},get remoteAuthority(){O(x,"resolvers");return e.remote.authority},get uiKind(){return e.uiKind},get logLevel(){return p.getLevel()},get onDidChangeLogLevel(){return fe(p.onDidChangeLogLevel)},get appQuality(){O(x,"resolvers");return e.quality},get appCommit(){O(x,"resolvers");return e.commit},getDataChannel(_){O(x,"dataChannels");return le.createDataChannel(x,_)}};const Cv={createTestController(_,w,I){return Qr.createTestController(x,_,w,I)},createTestObserver(){O(x,"testObserver");return Qr.createTestObserver()},runTests(_){O(x,"testObserver");return Qr.runTests(_)},registerTestFollowupProvider(_){O(x,"testObserver");return Qr.registerTestFollowupProvider(_)},get onDidChangeTestResults(){O(x,"testObserver");return fe(Qr.onResultsChanged)},get testResults(){O(x,"testObserver");return Qr.results}};const Yr=e.remote.isRemote?Ja.Workspace:Ja.UI;const kv={getExtension(_,w){if(!it(x,"extensionsAny")){w=false}const I=$s.mine.getExtensionDescription(_);if(I){return new nd(s,x.identifier,I,Yr,false)}if(w){const ke=$s.all.getExtensionDescription(_);if(ke){return new nd(s,x.identifier,ke,Yr,true)}}return void 0},get all(){const _=[];for(const w of $s.mine.getAllExtensionDescriptions()){_.push(new nd(s,x.identifier,w,Yr,false))}return _},get allAcrossExtensionHosts(){O(x,"extensionsAny");const _=new bl($s.mine.getAllExtensionDescriptions().map(I=>I.identifier));const w=[];for(const I of $s.all.getAllExtensionDescriptions()){const ke=!_.has(I.identifier);w.push(new nd(s,x.identifier,I,Yr,ke))}return w},get onDidChange(){if(it(x,"extensionsAny")){return fe(wt.any($s.mine.onDidChange,$s.all.onDidChange))}return fe($s.mine.onDidChange)}};const Dv={createDiagnosticCollection(_){return Gr.createDiagnosticCollection(x.identifier,_)},get onDidChangeDiagnostics(){return fe(Gr.onDidChangeDiagnostics)},getDiagnostics:_=>{return Gr.getDiagnostics(_)},getLanguages(){return Vn.getLanguages()},setTextDocumentLanguage(_,w){return Vn.changeLanguage(_.uri,w)},match(_,w){const I=Zb.from(_);let ke;if(_5(I)){ke=Ke.notebookDocuments.find(ot=>ot.apiNotebook.getCells().find(Jt=>Jt.document===w))?.apiNotebook}return m5(I,w.uri,w.languageId,true,ke?.uri,ke?.notebookType)},registerCodeActionsProvider(_,w,I){return Be.registerCodeActionProvider(x,pt(_),w,I)},registerDocumentPasteEditProvider(_,w,I){return Be.registerDocumentPasteEditProvider(x,pt(_),w,I)},registerCodeLensProvider(_,w){return Be.registerCodeLensProvider(x,pt(_),w)},registerDefinitionProvider(_,w){return Be.registerDefinitionProvider(x,pt(_),w)},registerDeclarationProvider(_,w){return Be.registerDeclarationProvider(x,pt(_),w)},registerImplementationProvider(_,w){return Be.registerImplementationProvider(x,pt(_),w)},registerTypeDefinitionProvider(_,w){return Be.registerTypeDefinitionProvider(x,pt(_),w)},registerHoverProvider(_,w){return Be.registerHoverProvider(x,pt(_),w,x.identifier)},registerEvaluatableExpressionProvider(_,w){return Be.registerEvaluatableExpressionProvider(x,pt(_),w,x.identifier)},registerInlineValuesProvider(_,w){return Be.registerInlineValuesProvider(x,pt(_),w,x.identifier)},registerDocumentHighlightProvider(_,w){return Be.registerDocumentHighlightProvider(x,pt(_),w)},registerMultiDocumentHighlightProvider(_,w){return Be.registerMultiDocumentHighlightProvider(x,pt(_),w)},registerLinkedEditingRangeProvider(_,w){return Be.registerLinkedEditingRangeProvider(x,pt(_),w)},registerReferenceProvider(_,w){return Be.registerReferenceProvider(x,pt(_),w)},registerRenameProvider(_,w){return Be.registerRenameProvider(x,pt(_),w)},registerNewSymbolNamesProvider(_,w){O(x,"newSymbolNamesProvider");return Be.registerNewSymbolNamesProvider(x,pt(_),w)},registerDocumentSymbolProvider(_,w,I){return Be.registerDocumentSymbolProvider(x,pt(_),w,I)},registerWorkspaceSymbolProvider(_){return Be.registerWorkspaceSymbolProvider(x,_)},registerDocumentFormattingEditProvider(_,w){return Be.registerDocumentFormattingEditProvider(x,pt(_),w)},registerDocumentRangeFormattingEditProvider(_,w){return Be.registerDocumentRangeFormattingEditProvider(x,pt(_),w)},registerOnTypeFormattingEditProvider(_,w,I,...ke){return Be.registerOnTypeFormattingEditProvider(x,pt(_),w,[I].concat(ke))},registerDocumentSemanticTokensProvider(_,w,I){return Be.registerDocumentSemanticTokensProvider(x,pt(_),w,I)},registerDocumentRangeSemanticTokensProvider(_,w,I){return Be.registerDocumentRangeSemanticTokensProvider(x,pt(_),w,I)},registerSignatureHelpProvider(_,w,I,...ke){if(typeof I==="object"){return Be.registerSignatureHelpProvider(x,pt(_),w,I)}return Be.registerSignatureHelpProvider(x,pt(_),w,typeof I==="undefined"?[]:[I,...ke])},registerCompletionItemProvider(_,w,...I){return Be.registerCompletionItemProvider(x,pt(_),w,I)},registerInlineCompletionItemProvider(_,w,I){if(w.handleDidShowCompletionItem){O(x,"inlineCompletionsAdditions")}if(w.handleDidPartiallyAcceptCompletionItem){O(x,"inlineCompletionsAdditions")}if(I){O(x,"inlineCompletionsAdditions")}return Be.registerInlineCompletionsProvider(x,pt(_),w,I)},get inlineCompletionsUnificationState(){O(x,"inlineCompletionsAdditions");return Be.inlineCompletionsUnificationState},onDidChangeCompletionsUnificationState(_,w,I){O(x,"inlineCompletionsAdditions");return fe(Be.onDidChangeInlineCompletionsUnificationState)(_,w,I)},registerDocumentLinkProvider(_,w){return Be.registerDocumentLinkProvider(x,pt(_),w)},registerColorProvider(_,w){return Be.registerColorProvider(x,pt(_),w)},registerFoldingRangeProvider(_,w){return Be.registerFoldingRangeProvider(x,pt(_),w)},registerSelectionRangeProvider(_,w){return Be.registerSelectionRangeProvider(x,_,w)},registerCallHierarchyProvider(_,w){return Be.registerCallHierarchyProvider(x,_,w)},registerTypeHierarchyProvider(_,w){return Be.registerTypeHierarchyProvider(x,_,w)},setLanguageConfiguration:(_,w)=>{return Be.setLanguageConfiguration(x,_,w)},getTokenInformationAtPosition(_,w){O(x,"tokenInformation");return Vn.tokenAtPosition(_,w)},registerInlayHintsProvider(_,w){return Be.registerInlayHintsProvider(x,_,w)},createLanguageStatusItem(_,w){return Vn.createLanguageStatusItem(x,_,w)},registerDocumentDropEditProvider(_,w,I){return Be.registerDocumentOnDropEditProvider(x,_,w,I)}};const Iv={get activeTextEditor(){return Qi.getActiveTextEditor()},get visibleTextEditors(){return Qi.getVisibleTextEditors()},get activeTerminal(){return Z.activeTerminal},get terminals(){return Z.terminals},async showTextDocument(_,w,I){if(b.isUri(_)&&_.scheme===ne.vscodeRemote&&!_.authority){v.report("workspace.showTextDocument",x,`A URI of 'vscode-remote' scheme requires an authority.`)}const ke=await(b.isUri(_)?Promise.resolve(C.openTextDocument(_)):Promise.resolve(_));return Qi.showTextDocument(ke,w,I)},createTextEditorDecorationType(_){return Qi.createTextEditorDecorationType(x,_)},onDidChangeActiveTextEditor(_,w,I){return fe(Qi.onDidChangeActiveTextEditor)(_,w,I)},onDidChangeVisibleTextEditors(_,w,I){return fe(Qi.onDidChangeVisibleTextEditors)(_,w,I)},onDidChangeTextEditorSelection(_,w,I){return fe(Qi.onDidChangeTextEditorSelection)(_,w,I)},onDidChangeTextEditorOptions(_,w,I){return fe(Qi.onDidChangeTextEditorOptions)(_,w,I)},onDidChangeTextEditorVisibleRanges(_,w,I){return fe(Qi.onDidChangeTextEditorVisibleRanges)(_,w,I)},onDidChangeTextEditorViewColumn(_,w,I){return fe(Qi.onDidChangeTextEditorViewColumn)(_,w,I)},onDidChangeTextEditorDiffInformation(_,w,I){O(x,"textEditorDiffInformation");return fe(Qi.onDidChangeTextEditorDiffInformation)(_,w,I)},onDidCloseTerminal(_,w,I){return fe(Z.onDidCloseTerminal)(_,w,I)},onDidOpenTerminal(_,w,I){return fe(Z.onDidOpenTerminal)(_,w,I)},onDidChangeActiveTerminal(_,w,I){return fe(Z.onDidChangeActiveTerminal)(_,w,I)},onDidChangeTerminalDimensions(_,w,I){O(x,"terminalDimensions");return fe(Z.onDidChangeTerminalDimensions)(_,w,I)},onDidChangeTerminalState(_,w,I){return fe(Z.onDidChangeTerminalState)(_,w,I)},onDidWriteTerminalData(_,w,I){O(x,"terminalDataWriteEvent");return fe(Z.onDidWriteTerminalData)(_,w,I)},onDidExecuteTerminalCommand(_,w,I){O(x,"terminalExecuteCommandEvent");return fe(Z.onDidExecuteTerminalCommand)(_,w,I)},onDidChangeTerminalShellIntegration(_,w,I){return fe(Y.onDidChangeTerminalShellIntegration)(_,w,I)},onDidStartTerminalShellExecution(_,w,I){return fe(Y.onDidStartTerminalShellExecution)(_,w,I)},onDidEndTerminalShellExecution(_,w,I){return fe(Y.onDidEndTerminalShellExecution)(_,w,I)},get state(){return y.getState()},onDidChangeWindowState(_,w,I){return fe(y.onDidChangeWindowState)(_,w,I)},showInformationMessage(_,...w){return Lu.showMessage(x,gt.Info,_,w[0],w.slice(1))},showWarningMessage(_,...w){return Lu.showMessage(x,gt.Warning,_,w[0],w.slice(1))},showErrorMessage(_,...w){return Lu.showMessage(x,gt.Error,_,w[0],w.slice(1))},showQuickPick(_,w,I){return ta.showQuickPick(x,_,w,I)},showWorkspaceFolderPick(_){return ta.showWorkspaceFolderPick(_)},showInputBox(_,w){return ta.showInput(_,w)},showOpenDialog(_){return Cf.showOpenDialog(_)},showSaveDialog(_){return Cf.showSaveDialog(_)},createStatusBarItem(_,w,I){let ke;let ot;let Jt;if(typeof _==="string"){ke=_;ot=w;Jt=I}else{ot=_;Jt=w}return Ef.createStatusBarEntry(x,ke,ot,Jt)},setStatusBarMessage(_,w){return Ef.setStatusBarMessage(_,w)},withScmProgress(_){v.report("window.withScmProgress",x,`Use 'withProgress' instead.`);return q.withProgress(x,{location:Mo.SourceControl},(w,I)=>_({report(ke){}}))},withProgress(_,w){return q.withProgress(x,_,w)},createOutputChannel(_,w){return Le.createOutputChannel(_,w,x)},createWebviewPanel(_,w,I,ke){return Au.createWebviewPanel(x,_,w,I,ke)},createWebviewTextEditorInset(_,w,I,ke){O(x,"editorInsets");return bf.createWebviewEditorInset(_,w,I,ke,x)},createTerminal(_,w,I){if(typeof _==="object"){if("pty"in _){return Z.createExtensionTerminal(_)}return Z.createTerminalFromOptions(_)}return Z.createTerminal(_,w,I)},registerTerminalLinkProvider(_){return Z.registerLinkProvider(_)},registerTerminalProfileProvider(_,w){return Z.registerProfileProvider(x,_,w)},registerTerminalCompletionProvider(_,...w){O(x,"terminalCompletionProvider");return Z.registerTerminalCompletionProvider(x,_,...w)},registerTerminalQuickFixProvider(_,w){O(x,"terminalQuickFixProvider");return Z.registerTerminalQuickFixProvider(_,x.identifier.value,w)},registerTreeDataProvider(_,w){return Pu.registerTreeDataProvider(_,w,x)},createTreeView(_,w){return Pu.createTreeView(_,w,x)},registerWebviewPanelSerializer:(_,w)=>{return Au.registerWebviewPanelSerializer(x,_,w)},registerCustomEditorProvider:(_,w,I={})=>{return gv.registerCustomEditorProvider(x,_,w,I)},registerFileDecorationProvider(_){return Re.registerFileDecorationProvider(_,x)},registerUriHandler(_){return k.registerUriHandler(x,_)},createQuickPick(){return ta.createQuickPick(x)},createInputBox(){return ta.createInputBox(x)},get activeColorTheme(){return xf.activeColorTheme},onDidChangeActiveColorTheme(_,w,I){return fe(xf.onDidChangeActiveColorTheme)(_,w,I)},registerWebviewViewProvider(_,w,I){return mv.registerWebviewViewProvider(x,_,w,I?.webviewOptions)},get activeNotebookEditor(){return Ke.activeNotebookEditor},onDidChangeActiveNotebookEditor(_,w,I){return fe(Ke.onDidChangeActiveNotebookEditor)(_,w,I)},get visibleNotebookEditors(){return Ke.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return fe(Ke.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(_,w,I){return fe(bi.onDidChangeNotebookEditorSelection)(_,w,I)},onDidChangeNotebookEditorVisibleRanges(_,w,I){return fe(bi.onDidChangeNotebookEditorVisibleRanges)(_,w,I)},showNotebookDocument(_,w){return Ke.showNotebookDocument(_,w)},registerExternalUriOpener(_,w,I){O(x,"externalUriOpener");return Dl.registerExternalUriOpener(x.identifier,_,w,I)},registerProfileContentHandler(_,w){O(x,"profileContentHandlers");return Il.registerProfileContentHandler(x,_,w)},registerQuickDiffProvider(_,w,I,ke,ot){O(x,"quickDiffProvider");return Sf.registerQuickDiffProvider(x,pt(_),w,I,ke,ot)},get tabGroups(){return R.tabGroups},registerShareProvider(_,w){O(x,"shareProvider");return Kr.registerShareProvider(pt(_),w)},get nativeHandle(){O(x,"nativeWindowHandle");return y.nativeHandle},createChatStatusItem:_=>{O(x,"chatStatusItem");return yv.createChatStatusItem(x,_)}};const C={get rootPath(){v.report("workspace.rootPath",x,`Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath`);return r.getPath()},set rootPath(_){throw new xa("rootPath")},getWorkspaceFolder(_){return r.getWorkspaceFolder(_)},get workspaceFolders(){return r.getWorkspaceFolders()},get name(){return r.name},set name(_){throw new xa("name")},get workspaceFile(){return r.workspaceFile},set workspaceFile(_){throw new xa("workspaceFile")},get isAgentSessionsWorkspace(){O(x,"agentSessionsWorkspace");return r.isAgentSessionsWorkspace},updateWorkspaceFolders:(_,w,...I)=>{return r.updateWorkspaceFolders(x,_,w||0,...I)},onDidChangeWorkspaceFolders:function(_,w,I){return fe(r.onDidChangeWorkspace)(_,w,I)},asRelativePath:(_,w)=>{return r.getRelativePath(_,w)},findFiles:(_,w,I,ke)=>{return r.findFiles(_,w,I,x.identifier,ke)},findFiles2:(_,w,I)=>{O(x,"findFiles2");return r.findFiles2(_,w,x.identifier,I)},findTextInFiles:(_,w,I,ke)=>{O(x,"findTextInFiles");let ot;let Jt;if(typeof w==="object"){ot=w;Jt=I}else{ot={};Jt=w;ke=I}return r.findTextInFiles(_,ot||{},Jt,x.identifier,ke)},findTextInFiles2:(_,w,I)=>{O(x,"findTextInFiles2");O(x,"textSearchProvider2");return r.findTextInFiles2(_,w,x.identifier,I)},save:_=>{return r.save(_)},saveAs:_=>{return r.saveAs(_)},saveAll:_=>{return r.saveAll(_)},applyEdit(_,w){return wv.applyWorkspaceEdit(_,x,w)},createFileSystemWatcher:(_,w,I,ke)=>{const ot={ignoreCreateEvents:Boolean(w),ignoreChangeEvents:Boolean(I),ignoreDeleteEvents:Boolean(ke)};return tt.createFileSystemWatcher(r,Nu,i,x,_,ot)},get textDocuments(){return ze.getAllDocumentData().map(_=>_.document)},set textDocuments(_){throw new xa("textDocuments")},openTextDocument(_,w){let I;w=w??_;if(typeof _==="string"){I=Promise.resolve(b.file(_))}else if(b.isUri(_)){I=Promise.resolve(_)}else if(!w||typeof w==="object"){I=ze.createDocumentData(w)}else{throw new Error("illegal argument - uriOrFileNameOrOptions")}return I.then(ke=>{p.trace(`openTextDocument from ${x.identifier}`);if(ke.scheme===ne.vscodeRemote&&!ke.authority){v.report("workspace.openTextDocument",x,`A URI of 'vscode-remote' scheme requires an authority.`)}return ze.ensureDocumentData(ke,w).then(ot=>{return ot.document})})},onDidOpenTextDocument:(_,w,I)=>{return fe(ze.onDidAddDocument)(_,w,I)},onDidCloseTextDocument:(_,w,I)=>{return fe(ze.onDidRemoveDocument)(_,w,I)},onDidChangeTextDocument:(_,w,I)=>{if(it(x,"textDocumentChangeReason")){return fe(ze.onDidChangeDocumentWithReason)(_,w,I)}return fe(ze.onDidChangeDocument)(_,w,I)},onDidSaveTextDocument:(_,w,I)=>{return fe(ze.onDidSaveDocument)(_,w,I)},onWillSaveTextDocument:(_,w,I)=>{return fe(Lt.getOnWillSaveTextDocumentEvent(x))(_,w,I)},get notebookDocuments(){return Ke.notebookDocuments.map(_=>_.apiNotebook)},async openNotebookDocument(_,w){let I;if(b.isUri(_)){I=_;await Ke.openNotebookDocument(_)}else if(typeof _==="string"){I=b.revive(await Ke.createNotebookDocument({viewType:_,content:w}))}else{throw new Error("Invalid arguments")}return Ke.getNotebookDocument(I).apiNotebook},onDidSaveNotebookDocument(_,w,I){return fe(Ht.onDidSaveNotebookDocument)(_,w,I)},onDidChangeNotebookDocument(_,w,I){return fe(Ht.onDidChangeNotebookDocument)(_,w,I)},onWillSaveNotebookDocument(_,w,I){return fe(is.getOnWillSaveNotebookDocumentEvent(x))(_,w,I)},get onDidOpenNotebookDocument(){return fe(Ke.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return fe(Ke.onDidCloseNotebookDocument)},registerNotebookSerializer(_,w,I,ke){return Ke.registerNotebookSerializer(x,_,w,I,it(x,"notebookLiveShare")?ke:void 0)},onDidChangeConfiguration:(_,w,I)=>{return fe(Nu.onDidChangeConfiguration)(_,w,I)},getConfiguration(_,w){w=arguments.length===1?void 0:w;return Nu.getConfiguration(_,w,x)},registerTextDocumentContentProvider(_,w){return ct.registerTextDocumentContentProvider(_,w)},registerTaskProvider:(_,w)=>{v.report("window.registerTaskProvider",x,`Use the corresponding function on the 'tasks' namespace instead`);return ce.registerTaskProvider(x,_,w)},registerFileSystemProvider(_,w,I){return vS(dv.registerFileSystemProvider(x,_,w,I),n.addFileSystemProvider(_,w,I))},get fs(){return n.value},registerFileSearchProvider:(_,w)=>{O(x,"fileSearchProvider");return re.registerFileSearchProviderOld(_,w)},registerTextSearchProvider:(_,w)=>{O(x,"textSearchProvider");return re.registerTextSearchProviderOld(_,w)},registerAITextSearchProvider:(_,w)=>{O(x,"aiTextSearchProvider");O(x,"textSearchProvider2");return re.registerAITextSearchProvider(_,w)},registerFileSearchProvider2:(_,w)=>{O(x,"fileSearchProvider2");return re.registerFileSearchProvider(_,w)},registerTextSearchProvider2:(_,w)=>{O(x,"textSearchProvider2");return re.registerTextSearchProvider(_,w)},registerRemoteAuthorityResolver:(_,w)=>{O(x,"resolvers");return s.registerRemoteAuthorityResolver(_,w)},registerResourceLabelFormatter:_=>{O(x,"resolvers");return fv.$registerResourceLabelFormatter(_)},getRemoteExecServer:_=>{O(x,"resolvers");return s.getRemoteExecServer(_)},onDidCreateFiles:(_,w,I)=>{return fe(tt.onDidCreateFile)(_,w,I)},onDidDeleteFiles:(_,w,I)=>{return fe(tt.onDidDeleteFile)(_,w,I)},onDidRenameFiles:(_,w,I)=>{return fe(tt.onDidRenameFile)(_,w,I)},onWillCreateFiles:(_,w,I)=>{return fe(tt.getOnWillCreateFileEvent(x))(_,w,I)},onWillDeleteFiles:(_,w,I)=>{return fe(tt.getOnWillDeleteFileEvent(x))(_,w,I)},onWillRenameFiles:(_,w,I)=>{return fe(tt.getOnWillRenameFileEvent(x))(_,w,I)},openTunnel:_=>{O(x,"tunnels");return m.openTunnel(x,_).then(w=>{if(!w){throw new Error("cannot open tunnel")}return w})},get tunnels(){O(x,"tunnels");return m.getTunnels()},onDidChangeTunnels:(_,w,I)=>{O(x,"tunnels");return fe(m.onDidChangeTunnels)(_,w,I)},registerPortAttributesProvider:(_,w)=>{O(x,"portsAttributes");return m.registerPortsAttributesProvider(_,w)},registerTunnelProvider:(_,w)=>{O(x,"tunnelFactory");return m.registerTunnelProvider(_,w)},registerTimelineProvider:(_,w)=>{O(x,"timeline");return pv.registerTimelineProvider(_,w,x.identifier,He.converter)},get isTrusted(){return r.trusted},requestResourceTrust:_=>{O(x,"workspaceTrust");return r.requestResourceTrust(_)},requestWorkspaceTrust:_=>{O(x,"workspaceTrust");return r.requestWorkspaceTrust(_)},isResourceTrusted:_=>{O(x,"workspaceTrust");return r.isResourceTrusted(_)},onDidChangeWorkspaceTrustedFolders:(_,w,I)=>{O(x,"workspaceTrust");return fe(r.onDidChangeWorkspaceTrustedFolders)(_,w,I)},onDidGrantWorkspaceTrust:(_,w,I)=>{return fe(r.onDidGrantWorkspaceTrust)(_,w,I)},registerEditSessionIdentityProvider:(_,w)=>{O(x,"editSessionIdentityProvider");return r.registerEditSessionIdentityProvider(_,w)},onWillCreateEditSessionIdentity:(_,w,I)=>{O(x,"editSessionIdentityProvider");return fe(r.getOnWillCreateEditSessionIdentityEvent(x))(_,w,I)},registerCanonicalUriProvider:(_,w)=>{O(x,"canonicalUriProvider");return r.registerCanonicalUriProvider(_,w)},getCanonicalUri:(_,w,I)=>{O(x,"canonicalUriProvider");return r.provideCanonicalUri(_,w,I)},decode(_,w){return r.decode(_,w)},encode(_,w){return r.encode(_,w)}};const U={get inputBox(){v.report("scm.inputBox",x,`Use 'SourceControl.inputBox' instead`);return yf.getLastInputBox(x)},createSourceControl(_,w,I,ke,ot,Jt){if(ke||ot||Jt){O(x,"scmProviderOptions")}return yf.createSourceControl(x,_,w,I,ke,ot,Jt)}};const H={createCommentController(_,w){return hv.createCommentController(x,_,w)}};const de={get activeDebugSession(){return J.activeDebugSession},get activeDebugConsole(){return J.activeDebugConsole},get breakpoints(){return J.breakpoints},get activeStackItem(){return J.activeStackItem},registerDebugVisualizationProvider(_,w){O(x,"debugVisualization");return J.registerDebugVisualizationProvider(x,_,w)},registerDebugVisualizationTreeProvider(_,w){O(x,"debugVisualization");return J.registerDebugVisualizationTree(x,_,w)},onDidStartDebugSession(_,w,I){return fe(J.onDidStartDebugSession)(_,w,I)},onDidTerminateDebugSession(_,w,I){return fe(J.onDidTerminateDebugSession)(_,w,I)},onDidChangeActiveDebugSession(_,w,I){return fe(J.onDidChangeActiveDebugSession)(_,w,I)},onDidReceiveDebugSessionCustomEvent(_,w,I){return fe(J.onDidReceiveDebugSessionCustomEvent)(_,w,I)},onDidChangeBreakpoints(_,w,I){return fe(J.onDidChangeBreakpoints)(_,w,I)},onDidChangeActiveStackItem(_,w,I){return fe(J.onDidChangeActiveStackItem)(_,w,I)},registerDebugConfigurationProvider(_,w,I){return J.registerDebugConfigurationProvider(_,w,I||mg.Initial)},registerDebugAdapterDescriptorFactory(_,w){return J.registerDebugAdapterDescriptorFactory(x,_,w)},registerDebugAdapterTrackerFactory(_,w){return J.registerDebugAdapterTrackerFactory(_,w)},startDebugging(_,w,I){if(!I||typeof I==="object"&&"configuration"in I){return J.startDebugging(_,w,{parentSession:I})}return J.startDebugging(_,w,I||{})},stopDebugging(_){return J.stopDebugging(_)},addBreakpoints(_){return J.addBreakpoints(_)},removeBreakpoints(_){return J.removeBreakpoints(_)},asDebugSourceUri(_,w){return J.asDebugSourceUri(_,w)}};const X={registerTaskProvider:(_,w)=>{return ce.registerTaskProvider(x,_,w)},fetchTasks:_=>{return ce.fetchTasks(_)},executeTask:_=>{return ce.executeTask(x,_)},get taskExecutions(){return ce.taskExecutions},onDidStartTask:(_,w,I)=>{const ke=ot=>{if(!it(x,"taskExecutionTerminal")){if(ot?.execution?.terminal!==void 0){ot.execution.terminal=void 0}}const Jt={...ot,execution:ot.execution};return _.call(w,Jt)};return fe(ce.onDidStartTask)(ke,w,I)},onDidEndTask:(_,w,I)=>{return fe(ce.onDidEndTask)(_,w,I)},onDidStartTaskProcess:(_,w,I)=>{return fe(ce.onDidStartTaskProcess)(_,w,I)},onDidEndTaskProcess:(_,w,I)=>{return fe(ce.onDidEndTaskProcess)(_,w,I)},onDidStartTaskProblemMatchers:(_,w,I)=>{O(x,"taskProblemMatcherStatus");return fe(ce.onDidStartTaskProblemMatchers)(_,w,I)},onDidEndTaskProblemMatchers:(_,w,I)=>{O(x,"taskProblemMatcherStatus");return fe(ce.onDidEndTaskProblemMatchers)(_,w,I)}};const Ie={createNotebookController(_,w,I,ke,ot){return ti.createNotebookController(x,_,w,I,ke,it(x,"notebookMessaging")?ot:void 0)},registerNotebookCellStatusBarItemProvider:(_,w)=>{return Ke.registerNotebookCellStatusBarItemProvider(x,_,w)},createRendererMessaging(_){return Us.createRendererMessaging(x,_)},createNotebookControllerDetectionTask(_){O(x,"notebookKernelSource");return ti.createNotebookControllerDetectionTask(x,_)},registerKernelSourceActionProvider(_,w){O(x,"notebookKernelSource");return ti.registerKernelSourceActionProvider(x,_,w)}};const We={t(..._){if(typeof _[0]==="string"){const w=_.shift();const I=!_||typeof _[0]!=="object"?_:_[0];return qe.getMessage(x.identifier.value,{message:w,args:I})}return qe.getMessage(x.identifier.value,_[0])},get bundle(){return qe.getBundle(x.identifier.value)},get uri(){return qe.getBundleUri(x.identifier.value)}};const Ye={transferActiveChat(_){O(x,"interactive");return yn.transferActiveChat(_)}};const dt={getRelatedInformation(_,w){O(x,"aiRelatedInformation");return on.getRelatedInformation(x,_,w)},registerRelatedInformationProvider(_,w){O(x,"aiRelatedInformation");return on.registerRelatedInformationProvider(x,_,w)},registerEmbeddingVectorProvider(_,w){O(x,"aiRelatedInformation");return na.registerEmbeddingVectorProvider(x,_,w)},registerSettingsSearchProvider(_){O(x,"aiSettingsSearch");return Qt.registerSettingsSearchProvider(x,_)}};const zn={registerMappedEditsProvider(_,w){O(x,"mappedEditsProvider");return{dispose(){}}},registerMappedEditsProvider2(_){O(x,"mappedEditsProvider");return uv.registerMappedEditsProvider(x,_)},createChatParticipant(_,w){return yn.createChatAgent(x,_,w)},createDynamicChatParticipant(_,w,I){O(x,"chatParticipantPrivate");return yn.createDynamicChatAgent(x,_,w,I)},registerChatParticipantDetectionProvider(_){O(x,"chatParticipantPrivate");return yn.registerChatParticipantDetectionProvider(x,_)},onDidDisposeChatSession:(_,w,I)=>{O(x,"chatParticipantPrivate");return fe(yn.onDidDisposeChatSession)(_,w,I)},registerChatSessionItemProvider:(_,w)=>{O(x,"chatSessionsProvider");return ia.registerChatSessionItemProvider(x,_,w)},createChatSessionItemController:(_,w)=>{O(x,"chatSessionsProvider");return ia.createChatSessionItemController(x,_,w)},registerChatSessionContentProvider(_,w,I,ke){O(x,"chatSessionsProvider");return ia.registerChatSessionContentProvider(x,_,I,w,ke)},registerChatOutputRenderer:(_,w)=>{O(x,"chatOutputRenderer");return Ru.registerChatOutputRenderer(x,_,w)},registerChatWorkspaceContextProvider(_,w){O(x,"chatContextProvider");return dr.registerChatWorkspaceContextProvider(`${x.id}-${_}`,w)},registerChatExplicitContextProvider(_,w){O(x,"chatContextProvider");return dr.registerChatExplicitContextProvider(`${x.id}-${_}`,w)},registerChatResourceContextProvider(_,w,I){O(x,"chatContextProvider");return dr.registerChatResourceContextProvider(pt(_),`${x.id}-${w}`,I)},registerChatContextProvider(_,w,I){O(x,"chatContextProvider");return dr.registerChatContextProvider(_?pt(_):void 0,`${x.id}-${w}`,I)},registerCustomAgentProvider(_){O(x,"chatPromptFiles");return yn.registerPromptFileProvider(x,Ct.agent,_)},registerInstructionsProvider(_){O(x,"chatPromptFiles");return yn.registerPromptFileProvider(x,Ct.instructions,_)},registerPromptFileProvider(_){O(x,"chatPromptFiles");return yn.registerPromptFileProvider(x,Ct.prompt,_)},registerSkillProvider(_){O(x,"chatPromptFiles");return yn.registerPromptFileProvider(x,Ct.skill,_)}};const qn={selectChatModels:_=>{return j.selectLanguageModels(x,_??{})},onDidChangeChatModels:(_,w,I)=>{return j.onDidChangeProviders(_,w,I)},registerLanguageModelChatProvider:(_,w)=>{return j.registerLanguageModelChatProvider(x,_,w)},get isModelProxyAvailable(){O(x,"languageModelProxy");return j.isModelProxyAvailable},onDidChangeModelProxyAvailability:(_,w,I)=>{O(x,"languageModelProxy");return j.onDidChangeModelProxyAvailability(_,w,I)},getModelProxy:()=>{O(x,"languageModelProxy");return j.getModelProxy(x)},registerLanguageModelProxyProvider:_=>{O(x,"chatParticipantPrivate");return j.registerLanguageModelProxyProvider(x,_)},get embeddingModels(){O(x,"embeddings");return ui.embeddingsModels},onDidChangeEmbeddingModels:(_,w,I)=>{O(x,"embeddings");return ui.onDidChange(_,w,I)},registerEmbeddingsProvider(_,w){O(x,"embeddings");return ui.registerEmbeddingsProvider(x,_,w)},async computeEmbeddings(_,w,I){O(x,"embeddings");if(typeof w==="string"){return ui.computeEmbeddings(_,w,I)}else{return ui.computeEmbeddings(_,w,I)}},registerTool(_,w){return Jr.registerTool(x,_,w)},registerToolDefinition(_,w){return Jr.registerToolDefinition(x,_,w)},invokeTool(_,w,I){if(typeof _!=="string"){O(x,"chatParticipantAdditions")}return Jr.invokeTool(x,_,w,I)},get tools(){return Jr.getTools(x)},fileIsIgnored(_,w){return j.fileIsIgnored(x,_,w)},registerIgnoredFileProvider(_){return j.registerIgnoredFileProvider(x,_)},registerMcpServerDefinitionProvider(_,w){return Q.registerMcpConfigurationProvider(x,_,w)},onDidChangeMcpServerDefinitions:(..._)=>{O(x,"mcpServerDefinitions");return fe(Q.onDidChangeMcpServerDefinitions)(..._)},get mcpServerDefinitions(){O(x,"mcpServerDefinitions");return Q.mcpServerDefinitions},onDidChangeChatRequestTools(..._){O(x,"chatParticipantAdditions");return fe(yn.onDidChangeChatRequestTools)(..._)}};const Ji={registerSpeechProvider(_,w){O(x,"speech");return _v.registerProvider(x.identifier,_,w)}};return{version:e.version,ai:dt,authentication:Sv,commands:xv,comments:H,chat:zn,debug:de,env:Ev,extensions:kv,interactive:Ye,l10n:We,languages:Dv,lm:qn,notebooks:Ie,scm:U,speech:Ji,tasks:X,tests:Cv,window:Iv,workspace:C,Breakpoint:Xc,TerminalOutputAnchor:Fw,ChatResultFeedbackKind:Ih,ChatVariableLevel:bb,ChatCompletionItem:NM,ChatReferenceDiagnostic:gx,CallHierarchyIncomingCall:XP,CallHierarchyItem:tx,CallHierarchyOutgoingCall:ZP,CancellationError:Vi,CancellationTokenSource:Tt,CandidatePortSource:L1,CodeAction:lh,CodeActionKind:$t,CodeActionTriggerKind:ah,CodeLens:Hg,Color:Qc,ColorInformation:jg,ColorPresentation:Gg,ColorThemeKind:yo,CommentMode:ob,CommentState:ab,CommentThreadCollapsibleState:bh,CommentThreadState:yh,CommentThreadApplicability:Sh,CommentThreadFocus:xh,CompletionItem:Vg,CompletionItemKind:Te,CompletionItemTag:uh,CompletionList:jc,CompletionTriggerKind:pc,ConfigurationTarget:bc,CustomExecution:ix,DebugAdapterExecutable:Zg,DebugAdapterInlineImplementation:_h,DebugAdapterNamedPipeServer:em,DebugAdapterServer:mh,DebugConfigurationProviderTriggerKind:mg,DebugConsoleMode:rm,DebugVisualization:DM,DecorationRangeBehavior:Na,Diagnostic:Lg,DiagnosticRelatedInformation:ih,DiagnosticSeverity:Oi,DiagnosticTag:Aa,Disposable:Ve,DocumentHighlight:Ug,DocumentHighlightKind:rh,MultiDocumentHighlight:$g,DocumentLink:qg,DocumentSymbol:oh,EndOfLine:Ds,EnvironmentVariableMutatorType:hc,EvaluatableExpression:tm,InlineValueText:im,InlineValueVariableLookup:nm,InlineValueEvaluatableExpression:sm,InlineCompletionTriggerKind:vh,InlineCompletionsDisposeReasonKind:kr,EventEmitter:L,ExtensionKind:Ja,ExtensionMode:Ec,ExternalUriOpenerPriority:gb,FileChangeType:Sc,FileDecoration:ub,FileDecoration2:ub,FileSystemError:fi,FileType:Wa,FilePermission:Va,FoldingRange:rb,FoldingRangeKind:Dr,FunctionBreakpoint:Oa,InlineCompletionItem:zw,InlineCompletionList:qw,Hover:Og,VerboseHover:Fg,HoverVerbosityAction:Uw,IndentAction:O0,Location:Tn,MarkdownString:rn,OverviewRulerLane:Q1,ParameterInformation:$w,PortAutoForwardAction:_b,Position:je,ProcessExecution:Jc,ProgressLocation:Mo,QuickInputButtonLocation:cb,QuickInputButtons:Eh,Range:Fe,RelativePattern:yc,Selection:or,SelectionRange:ch,SemanticTokens:Zc,SemanticTokensBuilder:nx,SemanticTokensEdit:sA,SemanticTokensEdits:_p,SemanticTokensLegend:lb,ShellExecution:ul,ShellQuoting:Zw,SignatureHelp:Bw,SignatureHelpTriggerKind:Ww,SignatureInformation:Hw,SnippetString:ll,SourceBreakpoint:Ma,StandardTokenType:ko,StatusBarAlignment:Co,SymbolInformation:sh,SymbolKind:Dt,SymbolTag:nh,Task:Kg,TaskEventKind:Yw,TaskGroup:ph,TaskPanelKind:Xw,TaskRevealKind:Jw,TaskScope:Vo,TerminalLink:gM,TerminalQuickFixTerminalCommand:_M,TerminalQuickFixOpener:mM,TerminalLocation:Kw,TerminalProfile:vM,TerminalExitReason:jw,TerminalShellExecutionCommandLineConfidence:fh,TerminalCompletionItem:wM,TerminalCompletionItemKind:Qw,TerminalCompletionList:bM,TerminalShellType:Gw,TextDocumentSaveReason:_c,TextEdit:Wo,SnippetTextEdit:Ka,TextEditorCursorStyle:Qn,TextEditorChangeKind:vc,TextEditorLineNumbersStyle:fs,TextEditorRevealType:zg,TextEditorSelectionChangeKind:Gc,SyntaxTokenType:Kc,TextDocumentChangeReason:hh,ThemeColor:gh,ThemeIcon:_n,TreeItem:Qg,TreeItemCheckboxState:Js,TreeItemCollapsibleState:Qa,TypeHierarchyItem:sx,UIKind:Wd,Uri:b,ViewColumn:dh,WorkspaceEdit:cl,DocumentPasteTriggerKind:ib,DocumentDropEdit:tb,DocumentDropOrPasteEditKind:Xn,DocumentPasteEdit:xM,InlayHint:Wg,InlayHintLabelPart:Bg,InlayHintKind:Vw,RemoteAuthorityResolverError:Qs,ResolvedAuthority:fM,ManagedResolvedAuthority:mp,SourceControlInputBoxValidationType:wc,ExtensionRuntime:um,TimelineItem:fb,NotebookRange:tr,NotebookCellKind:Ra,NotebookCellExecutionState:db,NotebookCellData:W_,NotebookData:QP,NotebookRendererScript:rA,NotebookCellStatusBarAlignment:am,NotebookEditorRevealType:lm,NotebookCellOutput:Mg,NotebookCellOutputItem:JP,CellErrorStackFrame:IM,NotebookCellStatusBarItem:TM,NotebookControllerAffinity:hb,NotebookControllerAffinity2:cm,NotebookEdit:Ng,NotebookKernelSourceAction:PM,NotebookVariablesRequestKind:kh,PortAttributes:RM,LinkedEditingRanges:AM,TestResultState:pb,TestRunRequest:dm,TestMessage:hm,TestMessageStackFrame:LM,TestTag:Dh,TestRunProfileKind:Cc,TextSearchCompleteMessageType:n_,DataTransfer:Yc,DataTransferItem:Jg,TestCoverageCount:vp,FileCoverage:eu,StatementCoverage:aA,BranchCoverage:lA,DeclarationCoverage:cA,WorkspaceTrustState:mb,LanguageStatusSeverity:fc,QuickPickItemKind:Ch,InputBoxValidationSeverity:xc,TabInputText:rx,TabInputTextDiff:fm,TabInputTextMerge:uA,TabInputCustom:ox,TabInputNotebook:ax,TabInputNotebookDiff:lx,TabInputWebview:dA,TabInputTerminal:hA,TabInputInteractiveWindow:fA,TabInputChat:pA,TabInputTextMultiDiff:gA,TelemetryTrustedValue:ex,LogLevel:xe,EditSessionIdentityMatch:F0,InteractiveSessionVoteDirection:vb,ChatCopyKind:wb,ChatSessionChangedFile:FM,ChatSessionChangedFile2:UM,ChatEditingSessionActionOutcome:js,InteractiveEditorResponseFeedbackKind:Sb,DebugStackFrame:iA,DebugThread:nA,RelatedInformationType:Ab,SpeechToTextStatus:Lb,TextToSpeechStatus:Nb,PartialAcceptTriggerKind:La,InlineCompletionEndOfLifeReasonKind:gc,InlineCompletionDisplayLocationKind:mc,KeywordRecognitionStatus:Mb,ChatImageMimeType:Pb,ChatResponseMarkdownPart:V_,ChatResponseFileTreePart:z_,ChatResponseAnchorPart:Ph,ChatResponseProgressPart:ux,ChatResponseProgressPart2:bp,ChatResponseThinkingProgressPart:kc,ChatResponseHookPart:q_,ChatResponseReferencePart:Ya,ChatResponseReferencePart2:Ya,ChatResponseCodeCitationPart:gm,ChatResponseCodeblockUriPart:G_,ChatResponseWarningPart:Ah,ChatResponseTextEditPart:Lh,ChatResponseNotebookEditPart:mm,ChatResponseWorkspaceEditPart:fx,ChatResponseMarkdownWithVulnerabilitiesPart:Th,ChatResponseCommandButtonPart:j_,ChatResponseConfirmationPart:pm,ChatQuestion:mA,ChatQuestionType:Gs,ChatResponseQuestionCarouselPart:Rh,ChatResponseMovePart:K_,ChatResponseExtensionsPart:dx,ChatResponseExternalEditPart:xb,ChatResponsePullRequestPart:hx,ChatResponseMultiDiffPart:cx,ChatResponseReferencePartStatusKind:Cb,ChatResponseClearToPreviousToolInvocationReason:kb,ChatRequestTurn:_m,ChatRequestTurn2:_m,ChatResponseTurn:_A,ChatResponseTurn2:OM,ChatToolInvocationPart:px,ChatLocation:ps,ChatSessionStatus:Eb,ChatRequestEditorData:vA,ChatRequestNotebookData:wA,ChatReferenceBinaryData:bA,ChatRequestEditedFileEventKind:yb,LanguageModelChatMessageRole:Dn,LanguageModelChatMessage:yA,LanguageModelChatMessage2:SA,LanguageModelToolResultPart:tu,LanguageModelToolResultPart2:tu,LanguageModelTextPart:ci,LanguageModelTextPart2:ci,LanguageModelPartAudience:vm,ToolResultAudience:vm,LanguageModelToolCallPart:dl,LanguageModelThinkingPart:iu,LanguageModelError:Ci,LanguageModelToolResult:Q_,LanguageModelToolResult2:$M,LanguageModelDataPart:xi,LanguageModelDataPart2:xi,LanguageModelToolExtensionSource:xA,LanguageModelToolMCPSource:EA,ExtendedLanguageModelToolResult:HM,LanguageModelChatToolMode:wm,LanguageModelPromptTsxPart:zo,NewSymbolName:CM,NewSymbolNameTag:sb,NewSymbolNameTriggerKind:wh,ExcludeSettingOptions:Ir,TextSearchContext2:mx,TextSearchMatch2:Do,AISearchKeyword:Dy,TextSearchCompleteMessageTypeNew:n_,ChatErrorLevel:Db,McpHttpServerDefinition:Fb,McpHttpServerDefinition2:Fb,McpStdioServerDefinition:Ob,McpStdioServerDefinition2:Ob,McpToolAvailability:bm,McpToolInvocationContentData:MM,SettingsSearchResultKind:Rb}}}var Ap;let dS=class Nq{constructor(e,i,n,s,r,o,a){this._apiFactory=e;this._extensionRegistry=i;this._instaService=n;this._extHostConfiguration=s;this._extHostExtensionService=r;this._initData=o;this._logService=a;this._factories=new Map;this._alternatives=[]}async install(){this._installInterceptor();pn("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();pn("code/extHost/didWaitForConfig");const i=await this._extHostExtensionService.getExtensionPathIndex();this.register(new lW(this._apiFactory,i,this._extensionRegistry,e,this._logService));this.register(this._instaService.createInstance(hS));if(this._initData.remote.isRemote){this.register(this._instaService.createInstance(fS,i,this._initData.environment.appUriScheme))}}register(e){if("nodeModuleName"in e){if(Array.isArray(e.nodeModuleName)){for(const i of e.nodeModuleName){this._factories.set(i,e)}}else{this._factories.set(e.nodeModuleName,e)}}if(typeof e.alternativeModuleName==="function"){this._alternatives.push(i=>{return e.alternativeModuleName(i)})}}};dS=W([P(2,yl),P(3,jr),P(4,ea),P(5,wi),P(6,et)],dS);let hS=class Mq{static{Ap=this}static{this.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]])}constructor(e){if(e.environment.appRoot&&Ap.aliased.size){const i=sl(this.forceForwardSlashes(e.environment.appRoot.fsPath));const n=`[a-z0-9_.-]`;const s=`@${n}+\\/${n}+|${n}+`;const r="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${i}/${r}\\/)(${s})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re){return}const i=this.re.exec(this.forceForwardSlashes(e));if(!i){return}const[,n,s,r]=i;const o=Ap.aliased.get(s);if(o===void 0){return}console.warn(`${s} as been renamed to ${o}, please update your imports`);return n+o+r}forceForwardSlashes(e){return e.replace(/\\/g,"/")}};hS=Ap=W([P(0,wi)],hS);class lW{constructor(e,i,n,s,r){this._apiFactory=e;this._extensionPaths=i;this._extensionRegistry=n;this._configProvider=s;this._logService=r;this.nodeModuleName="vscode";this._extApiImpl=new $o}load(e,i){const n=this._extensionPaths.findSubstr(i);if(n){let s=this._extApiImpl.get(n.identifier);if(!s){s=this._apiFactory(n,this._extensionRegistry,this._configProvider);this._extApiImpl.set(n.identifier,s)}return s}if(!this._defaultApiImpl){let s="";this._extensionPaths.forEach((r,o)=>s+=`	${o} -> ${r.identifier.value}
`);this._logService.warn(`Could not identify extension for 'vscode' require call from ${i}. These are the extension path mappings: 
${s}`);this._defaultApiImpl=this._apiFactory(tM,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let fS=class Oq{constructor(e,i,n){this._extensionPaths=e;this._appUriScheme=i;this.nodeModuleName=["open","opn"];this._mainThreadTelemetry=n.getProxy(ee.MainThreadTelemetry);const s=n.getProxy(ee.MainThreadWindow);this._impl=(r,o)=>{const a=b.parse(r);if(o){return this.callOriginal(r,o)}if(a.scheme==="http"||a.scheme==="https"){return s.$openUri(a,r,{allowTunneling:true})}else if(a.scheme==="mailto"||a.scheme===this._appUriScheme){return s.$openUri(a,r,{})}return this.callOriginal(r,o)}}load(e,i,n){const s=this._extensionPaths.findSubstr(i);if(s){this._extensionId=s.identifier.value;this.sendShimmingTelemetry()}this._original=n(e);return this._impl}callOriginal(e,i){this.sendNoForwardTelemetry();return this._original(e,i)}sendShimmingTelemetry(){if(!this._extensionId){return}this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){if(!this._extensionId){return}this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};fS=W([P(2,st)],fS);let pS=class Fq{constructor(e,i){this._mainThreadConsole=e.getProxy(ee.MainThreadConsole);this._includeStack=i.consoleForward.includeStack;this._logNative=i.consoleForward.logNative;this._wrapConsoleMethod("info","log");this._wrapConsoleMethod("log","log");this._wrapConsoleMethod("warn","warn");this._wrapConsoleMethod("debug","debug");this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,i){const n=this;const s=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>(function(){n._handleConsoleCall(e,i,s,arguments)})})}_handleConsoleCall(e,i,n,s){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:i,arguments:uW(s,this._includeStack)});if(this._logNative){this._nativeConsoleLogMessage(e,n,s)}}};pS=W([P(0,st),P(1,wi)],pS);const cW=1e5;function uW(t,e){const i=[];if(t.length){for(let n=0;n<t.length;n++){let s=t[n];if(typeof s==="undefined"){s="undefined"}else if(s instanceof Error){const r=s;if(r.stack){s=r.stack}else{s=r.toString()}}i.push(s)}}if(e){const n=new Error().stack;if(n){i.push({__$stack:n.split("\n").slice(3).join("\n")})}}try{const n=P8(i);if(n.length>cW){return"Output omitted for a large object that exceeds the limits"}return n}catch(n){return`Output omitted for an object that cannot be inspected ('${n.toString()}')`}}let gS=class Uq extends pS{constructor(e,i){super(e,i)}_nativeConsoleLogMessage(e,i,n){i.apply(console,n)}};gS=W([P(0,st),P(1,wi)],gS);class dW extends dS{_installInterceptor(){}getModule(e,i){for(const n of this._alternatives){const s=n(e);if(s){e=s;break}}if(this._factories.has(e)){return this._factories.get(e).load(e,i,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}return void 0}}class hW extends l0{constructor(){super(...arguments);this.extensionRuntime=um.Webworker}async _beforeAlmostReadyToRunExtensions(){if(qd){this._instaService.createInstance(gS)}this._apiFactory=this._instaService.invokeFunction(aW);this._fakeModules=this._instaService.createInstance(dW,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry});await this._fakeModules.install();performance.mark("code/extHost/didInitAPI");await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,i,n){i=i.with({path:fW(i.path,".js")});const s=e?.identifier.value;if(s){performance.mark(`code/extHost/willFetchExtensionCode/${s}`)}const r=b.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(i));const o=await fetch(r.toString(true));if(s){performance.mark(`code/extHost/didFetchExtensionCode/${s}`)}if(o.status!==200){throw new Error(o.statusText)}const a=await o.text();const l=`${i.toString(true)}#vscode-extension`;const c=`${a}
//# sourceURL=${l}`;let u;try{u=new Function("module","exports","require",c)}catch(m){if(s){console.error(`Loading code for extension ${s} failed: ${m.message}`)}else{console.error(`Loading code failed: ${m.message}`)}console.error(`${i.toString(true)}${typeof m.line==="number"?` line ${m.line}`:""}${typeof m.column==="number"?` column ${m.column}`:""}`);console.error(m);throw m}if(e){await this._extHostLocalizationService.initializeLocalizedMessages(e)}const d={};const f={exports:d};const p=m=>{const v=this._fakeModules.getModule(m,i);if(v===void 0){throw new Error(`Cannot load module '${m}'`)}return v};try{n.codeLoadingStart();if(s){performance.mark(`code/extHost/willLoadExtensionCode/${s}`)}u(f,d,p);return f.exports!==d?f.exports:d}finally{if(s){performance.mark(`code/extHost/didLoadExtensionCode/${s}`)}n.codeLoadingStop()}}_loadESMModule(e,i,n){throw new Error("ESM modules are not supported in the web worker extension host")}async $setRemoteEnvironment(e){return}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug){return}const i=Date.now()+e;while(Date.now()<i&&!("__jsDebugIsReady"in globalThis)){await Ts(10)}}}function fW(t,e){const i=Up(t);return i?t:t+e}xt(Cx,t0,bt.Eager);xt(ea,hW,bt.Eager);xt(bx,Uy,bt.Eager);xt(ev,new vs(qy,[true],true));const F5=self.close.bind(self);self.close=()=>console.trace(`'close' has been blocked`);const U5=postMessage.bind(self);self.postMessage=()=>console.trace(`'postMessage' has been blocked`);function AT(t){return/^(file|extension-file|vscode-remote):/i.test(t)}const RT=fetch.bind(self);function pW(t){self.fetch=async function(e,i){if(e instanceof Request){return RT(e,i)}if(AT(String(e))){e=(await t(b.parse(String(e)))).toString(true)}return RT(e,i)};self.XMLHttpRequest=class extends XMLHttpRequest{open(e,i,n,s,r){(async()=>{if(AT(i.toString())){i=(await t(b.parse(i.toString()))).toString(true)}super.open(e,i,n??true,s,r)})()}}}self.importScripts=()=>{throw new Error(`'importScripts' has been blocked`)};self.addEventListener=()=>console.trace(`'addEventListener' has been blocked`);self["AMDLoader"]=void 0;self["NLSLoaderPlugin"]=void 0;self["define"]=void 0;self["require"]=void 0;self["webkitRequestFileSystem"]=void 0;self["webkitRequestFileSystemSync"]=void 0;self["webkitResolveLocalFileSystemSyncURL"]=void 0;self["webkitResolveLocalFileSystemURL"]=void 0;function gW(t,e){if(self.Worker){const i=self.Worker;Worker=function(n,s){if(/^vscode-remote:/i.test(n.toString())){throw new Error(`Creating workers from remote extensions is currently not supported.`)}async function r(a){const[l,c]=await Promise.all([t(a).then(p=>p.toString(true)),e().then(p=>Object.fromEntries(p.map(([m,v])=>[m.toString(true),v.toString(true)])))]);const u=(function p(m,v){function y(R){if(typeof R==="string"||R instanceof URL){R=String(R).replace(/^file:\/\//i,"vscode-file://vscode-app");return v[R]??R}return R}const k=fetch.bind(self);self.fetch=function(R,K){if(R instanceof Request){return k(R,K)}return k(y(R),K)};self.XMLHttpRequest=class extends XMLHttpRequest{constructor(){super(...arguments);this.notFound=false}open(R,K,q,se,j){const Q=y(K);this.notFound=Q.startsWith("extension-file:");return super.open(R,Q,q??true,se,j)}send(R){if(this.notFound){return}super.send(R)}get status(){return this.notFound?404:super.status}};const S=importScripts.bind(self);self.importScripts=(...R)=>{S(...R.map(y))};self.importExt=R=>{return new Function("url","return import(url)")(y(R))};S(m)}).toString();const d=`(${u}('${l}', ${JSON.stringify(c)}))`;const f=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(f)}s=s||{};s.name=`${name} -> ${s.name||kn(n.toString())}`;class o{constructor(l,c){this._onmessage=null;this._onmessageerror=null;this._onerror=null;this.workerPromise=r(b.parse(l instanceof URL?l.toString():l)).then(u=>{return new i(u,c)})}set onmessage(l){this._onmessage=l;this.workerPromise.then(c=>{c.onmessage=l},console.error)}get onmessage(){return this._onmessage}set onmessageerror(l){this._onmessageerror=l;this.workerPromise.then(c=>{c.onmessageerror=l},console.error)}get onmessageerror(){return this._onmessageerror}set onerror(l){this._onerror=l;this.workerPromise.then(c=>{c.onerror=l},console.error)}get onerror(){return this._onerror}postMessage(l,c){this.workerPromise.then(u=>{u.postMessage(l,c)},console.error)}terminate(){this.workerPromise.then(l=>{l.terminate()},console.error)}addEventListener(l,c,u){this.workerPromise.then(d=>{d.addEventListener(l,c,u)},console.error)}removeEventListener(l,c,u){this.workerPromise.then(d=>{d.removeEventListener(l,c,u)},console.error)}dispatchEvent(l){this.workerPromise.then(c=>{c.dispatchEvent(l)},console.error);return false}}return new o(n,s)}}else{self.Worker=class extends zF{constructor(i,n){super(U5,i,{name:kn(i.toString()),...n})}}}}const mW=new class{constructor(){this.pid=void 0}exit(t){F5()}};class _W{constructor(){const e=new MessageChannel;const i=new L;let n=false;U5(e.port2,[e.port2]);e.port1.onmessage=s=>{const{data:r}=s;if(!(r instanceof ArrayBuffer)){console.warn("UNKNOWN data received",r);return}const o=ae.wrap(new Uint8Array(r,0,r.byteLength));if(OR(o,Is.Terminate)){n=true;$5("received terminate message from renderer");return}i.fire(o)};this.protocol={onMessage:i.event,send:s=>{if(!n){const r=s.buffer.buffer.slice(s.buffer.byteOffset,s.buffer.byteOffset+s.buffer.byteLength);e.port1.postMessage(r,[r])}}}}}function vW(t){return new Promise(e=>{const i=t.onMessage(n=>{i.dispose();const s=JSON.parse(n.toString());t.send(dE(Is.Initialized));e({protocol:t,initData:s})});t.send(dE(Is.Ready))})}let $5=t=>F5();function wW(t){return!!t&&typeof t==="object"&&t.type==="vscode.init"&&t.data instanceof Map}function bW(){pn(`code/extHost/willConnectToRenderer`);const t=new _W;return{onmessage(e){if(!wW(e)){return}vW(t.protocol).then(i=>{pn(`code/extHost/didWaitForInitData`);const n=new Ax(i.protocol,i.initData,mW,null,e.data);pW(s=>n.asBrowserUri(s));gW(s=>n.asBrowserUri(s),()=>n.getAllStaticBrowserUris());$5=s=>n.terminate(s)})}}}const yW=bW();self.onmessage=t=>yW.onmessage(t.data);
